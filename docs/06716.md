# å°† pwa ä½œä¸º Chrome æ‰©å±•è¿›è¡Œè¿è¾“

> åŸæ–‡:[https://dev . to/chromium dev/shipping-pwas-as-chrome-extensions-3l5c](https://dev.to/chromiumdev/shipping-pwas-as-chrome-extensions-3l5c)

æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œæˆ– PWAsï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ç§ç¦»çº¿å·¥ä½œçš„ç½‘ç«™ï¼Œå¯èƒ½åŒ…æ‹¬ç±»ä¼¼äºåŸç”Ÿåº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚ä½†å®é™…ä¸Šï¼ŒPWA [çš„ç»°å·](https://google.com/search?q=define%3Amoniker)æ˜¯ä½ å‘Šè¯‰ä½ çš„è€æ¿ã€ä½ çš„æŠ•èµ„è€…ï¼Œæ— è®ºæ˜¯è°ï¼Œè¿™æ ·ä»–ä»¬å°±å¯ä»¥æ¦‚å¿µåŒ–ä½ æ­£åœ¨å»ºç«‹çš„è¿™ä¸ªç½‘ç»œã€‚

æ‰€ä»¥ä½ å·²ç»å»ºç«‹äº†ä¸€ä¸ª PWAï¼Œåˆ›å»ºäº†ä½ çš„æœåŠ¡äººå‘˜ï¼Œå¹¶è·Ÿéš[æ‰€æœ‰](https://developers.google.com/web/progressive-web-apps/) [å‘å¯¼](https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/)ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œé‚£å°±æ˜¯[è¡¨æƒ…è¾“å…¥å™¨](https://emojityper.com):ä¸€ä¸ªç®€å•çš„ PWAï¼Œä½ å¯ä»¥åœ¨é‚£é‡Œè¾“å…¥å•è¯ï¼Œå¹¶æ¥æ”¶è¡¨æƒ…ç¬¦å·ã€‚è¿™éå¸¸é€‚åˆæ¡Œé¢å’Œåœ¨ä¸æ”¯æŒè¡¨æƒ…ç¬¦å·çš„ç¼–è¾‘å™¨ä¸­è¾“å…¥è¡¨æƒ…ç¬¦å·ã€‚âŒ¨ï¸ğŸ”œğŸ¤£

[![Emojityper Chrome Extension showing its browser action](../Images/2180131a72f819b797848505ab321e95.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--oBQodEco--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/mgv1tc3rt3bgciuatgrm.png)

ä½†æ˜¯ä¸€æ—¦ä½ å»ºç«‹äº†è¿™ç§ä¼Ÿå¤§çš„ä½“éªŒï¼Œä½ å°±ä¸ä»…ä»…å±€é™äºåœ¨â€œç½‘ç»œâ€ä¸Šä¼ æ’­å®ƒäº†ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»æˆ‘å¦‚ä½•å°† [Emojityper](https://emojityper.com) ä½œä¸º [Chrome æ‰©å±•](https://chrome.google.com/webstore/detail/emojityper/cbkooiohnnlhpelnllknmenlhiglnkap)ï¼Œé€šè¿‡[æµè§ˆå™¨åŠ¨ä½œ](https://developer.chrome.com/extensions/browserAction)è®¿é—®ã€‚

* * *

**ä¸ºæ‚¨çš„ PWA åˆ›å»ºä¸€ä¸ªæ‰©å±•éå¸¸ç®€å•ã€‚**ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå¦‚æœä½ çš„ PWA å·²ç»ç¦»çº¿å·¥ä½œï¼Œä½ å¯ä»¥åˆ©ç”¨ Chrome å·²ç»ä¸ºä½ çš„ç”¨æˆ·ç¼“å­˜å®ƒçš„äº‹å®ã€‚æˆ‘ä»¬å®é™…ä¸Šåªæ˜¯åœ¨æ„å»ºä¸€ä¸ªå°å‹åµŒå…¥å™¨ï¼Œå°†æ‚¨çš„ç«™ç‚¹åŒ…å«åœ¨ä¸€ä¸ª`iframe`ä¸­ã€‚å¼€å§‹å§ï¼ğŸ

## [](#extension-files)æ‰©å±•åæ–‡ä»¶

åŸºæœ¬ä¸Šæœ‰ä¸¤ä¸ªæ–‡ä»¶ç»„æˆäº†æˆ‘ä»¬çš„ Chrome æ‰©å±•ã€‚é¦–å…ˆæ˜¯`manifest.json`æ–‡ä»¶ï¼Œæè¿°ä¸€äº›å…ƒæ•°æ®:

```
{  "name":  "Emojityper",  "version":  "0.2",  "description":  "Type emoji on your keyboard!",  "browser_action":  {  "default_popup":  "embedder.html",  "default_title":  "Emojityper",  "default_icon":  {"128":  "i128.png",  "32":  "i32.png",  "16":  "i16.png"}  },  "icons":  {"128":  "i128.png",  "32":  "i32.png",  "16":  "i16.png"}  "manifest_version":  2  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªæ¸…å•ä¹Ÿå¯ä»¥è¯·æ±‚å¯¹ Chrome æ‰©å±•å¯ç”¨çš„ç‰¹æ€§çš„é¢å¤–è®¸å¯ã€‚ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬åªæ˜¯åµŒå…¥äº†ä¸€ä¸ªå·²ç»åˆ©ç”¨äº† web å¹³å°ç‰¹æ€§çš„ PWA æ‚¨åº”è¯¥å°½é‡é¿å…å®ƒã€‚

æ¥ä¸‹æ¥æ˜¯`embedder.html`æ–‡ä»¶ï¼Œå®ƒå°†ä½ çš„ PWA åµŒå…¥åˆ°ä¸€ä¸ª`iframe` :
ä¸­

```
<!DOCTYPE html>
<html>
<head>
<style>
  body {
    background: #2c3e50;
    margin: 0;
    width: 380px;
    height: 200px;
  }
  iframe {
    width: 100%;
    height: 100%;
    border: 0;
  }
</style>
</head>
<body>
  <iframe id="iframe" src="https://emojityper.com/?utm_source=chrome_ext"></iframe>
</body>
</html> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¿å­˜è¿™ä¸¤ä¸ªæ–‡ä»¶ğŸ’¾â¬‡ï¸ğŸ“‚åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­(è¿åŒä¸€äº›å›¾æ ‡â€” `i16.png`ã€`i32.png`ã€`i128.png`ï¼Œæˆ–è€…å¦‚æœä½ èƒ½é€ƒè„±çš„è¯å¯èƒ½æ›´å°‘)ï¼Œç„¶åå‰å¾€`chrome://extensions`ï¼Œå¯ç”¨å¼€å‘è€…æ¨¡å¼ï¼Œå¹¶é€‰æ‹©â€œåŠ è½½æœªæ‰“åŒ…çš„æ‰©å±•â€ã€‚

[![Extension development](../Images/d35e44dad714bf503fb49fe9f0d4c6a2.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--r37zQiOp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/sduvftzakknj1odyjuxt.png)

å¤ªå¥½äº†ï¼ç°åœ¨ï¼Œæ‚¨å°†çœ‹åˆ° Emojityper åº”ç”¨ç¨‹åºå‡ºç°åœ¨æ‚¨çš„æ‰©å±•æ ä¸­ï¼Œå•å‡»å®ƒå°†è°ƒå‡ºæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„æ˜¾ç¤ºã€‚

* * *

# [](#challenges)æŒ‘æˆ˜

æ‚¨çš„ PWA å¯èƒ½ä¼šå¼€å§‹æ­£å¸¸å·¥ä½œã€‚æ‚¨å·²ç»åµŒå…¥äº†ä¸€ä¸ªæ–¹ä¾¿çš„å¼¹å‡ºçª—å£ï¼Œå¸Œæœ›å¯¹æ‚¨çš„ç”¨æˆ·æœ‰æ‰€å¸®åŠ©ã€‚ä½†æ˜¯æœ‰ä¸¤ä¸ªç»†å¾®å·®åˆ«ã€‚

## [](#responsive-design)å“åº”å¼è®¾è®¡

æˆ‘ä»¬çš„æ‰©å±•ä½äº 380 åƒç´ å®½ 200 åƒç´ é«˜çš„åŒºåŸŸã€‚å½“ç„¶ï¼Œä½ å¯ä»¥æŠŠå®ƒæ”¾å¤§ï¼Œä½†é‡ç‚¹æ˜¯æä¾›ä¸€ä¸ªæ–¹ä¾¿çš„å° UIã€‚è™½ç„¶æµè§ˆå™¨æ ‡ç­¾ä¹Ÿå¯ä»¥ç¼©å°åˆ°è¿™ä¸ªå°ºå¯¸â€”â€”åœ¨æˆ‘çš„ Mac ä¸Šï¼Œæˆ‘èƒ½åšçš„æœ€å°çš„ Chrome çª—å£æ˜¯ 400 å®½ 159 é«˜â€”â€”ä½†ä½ çš„ç”¨æˆ·å¯èƒ½ä¼šå¸Œæœ›åœ¨ä»–ä»¬çš„æ¡Œé¢ä¸Šä½¿ç”¨ä½ çš„ PWA [ä½œä¸ºä¸€ä¸ªå°éŸ³ä¹æ§åˆ¶å™¨æˆ–å…¶ä»–â€œå°å·¥å…·â€ã€‚ğŸ¶ğŸ”](https://developers.google.com/web/updates/2018/05/dpwa)

è¿™åŸºæœ¬ä¸Šæ„å‘³ç€ä½ å¯èƒ½éœ€è¦åœ¨ä½ çš„å“åº”å¼è®¾è®¡ä¸­åŠ å…¥ä¸€ä¸ªâ€œå¾®â€æ¨¡å¼ã€‚Emojityper é€šè¿‡ä¸º 400 åƒç´ æˆ–æ›´ä½çš„é«˜åº¦æ·»åŠ  CSSï¼Œä»æ··ä¹±å˜å¾—ç®€å•:

[![Clutter to simple](../Images/55a98f19184137d4be0664a3a75948ad.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--vKCGAg2B--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/wvbh4g2xgwg6jcqt3ypo.png)

## [](#extension-perks)å»¶æœŸæ´¥è´´

æˆ‘ä»¬åµŒå…¥çš„ PWA èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå› ä¸ºæ‚¨åˆ©ç”¨äº†ç½‘ç»œå¹³å°ã€‚ä½†æ˜¯æ€»æœ‰ä¸€äº›äº‹æƒ…æ˜¯æ‰©å±•å¯ä»¥åšçš„ï¼Œè€Œä½ çš„ PWA ä¸èƒ½ã€‚

åœ¨ Emojityper çš„ä¾‹å­ä¸­ï¼Œç‚¹å‡»â€œå¤åˆ¶â€æŒ‰é’®å®é™…ä¸Šåº”è¯¥å…³é—­æ‰©å±•çª—å£ã€‚è¿™æ˜¯é€šè¿‡è®© PWA å¯»æ‰¾å®ƒçš„â€œçˆ¶é¡µé¢â€:å®¹å™¨/åµŒå…¥é¡µé¢ï¼Œå¹¶è®©çˆ¶é¡µé¢çŸ¥é“å¤åˆ¶å®Œæˆçš„æ—¶é—´æ¥å®ç°çš„ã€‚åœ¨ Emojityper å†…éƒ¨ï¼Œæˆ‘åšäº†è¿™æ ·çš„äº‹æƒ…:

```
function notifyParentCopy() {
  // notify parent (for ext)
  if (window.parent) {
    window.parent.postMessage('copy', '*');
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨æ‰©å±•ä¸­ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªåŒ…å«çš„ JS æ–‡ä»¶ï¼Œå®ƒç›‘å¬æ¶ˆæ¯å¹¶é‡‡å–è¡ŒåŠ¨:

```
window.addEventListener('message', (ev) => {
  switch (ev.data) {
  case 'copy':
    window.close();
    break;
  default:
    console.warn('got unhandled message', ev.data);
  }
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

(å› ä¸ºæˆ‘ä»¬çš„æ‰©å±•å®é™…ä¸Šä¸æ˜¯æ‰˜ç®¡åœ¨ä¸€ä¸ªåŸŸä¸Šï¼Œå®ƒå¯ä»¥ä¸åµŒå…¥å¼çš„`iframe`è¿›è¡Œé€šä¿¡ï¼Œæ²¡æœ‰ä»»ä½•å®‰å…¨æŒ‘æˆ˜ã€‚)

æ˜¯å¦å€¼å¾—æ£€æµ‹â€œæ‰©å±•æ¨¡å¼â€å¹¶æä¾›é™„åŠ åŠŸèƒ½ï¼Ÿè¿™å–å†³äºä½ ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯å…³äºæŠŠä½ çš„ PWA å¸¦åˆ°ä½ çš„ç”¨æˆ·æ‰€åœ¨çš„åœ°æ–¹ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºåªæœ‰æœ€å°‘çš„é™„åŠ ç‰¹æ€§å¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„(å°±åƒä½ å¯èƒ½ä¸éœ€è¦è¯·æ±‚ä»»ä½•æƒé™ä¸€æ ·)ã€‚

* * *

æ„Ÿè°¢é˜…è¯»ï¼æˆ‘å¸Œæœ›ä½ å·²ç»äº†è§£äº†æ›´å¤šå…³äº [Emojityper](https://emojityper.com) å’Œå®ƒçš„ [Chrome æ‰©å±•](https://chrome.google.com/webstore/detail/emojityper/cbkooiohnnlhpelnllknmenlhiglnkap)çš„çŸ¥è¯†ã€‚ğŸ˜‚

ä½ å¯ä»¥é‡‡å–ç±»ä¼¼çš„æ–¹æ³•ï¼Œé€šè¿‡ç½‘ç»œè§†å›¾å°†ä½ çš„ PWA åŒ…å«åœ¨ Androidã€iOS æˆ–æ¡Œé¢åŸç”Ÿåº”ç”¨ä¸­ã€‚ä½ çš„ PWA å¯ä»¥æ‰©å±•å®ƒçš„åˆ†å¸ƒï¼Œå»ä½ çš„ç”¨æˆ·æƒ³å»çš„åœ°æ–¹ã€‚ğŸ”œğŸ‘¥ğŸ‘ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»