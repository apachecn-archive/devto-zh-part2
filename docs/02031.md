# ç”¨ PostgreSQL æŒä¹…åŒ–ä¸€ä¸ªèŠ‚ç‚¹ APIï¼Œä¸éœ€è¦ ORM çš„å¸®åŠ©ã€‚

> åŸæ–‡:[https://dev . to/ogwurjohnson/-persisting-a-node-API-with-PostgreSQL-with-the-help-of-orms-like-sequelize-5d C5](https://dev.to/ogwurujohnson/-persisting-a-node-api-with-postgresql-without-the-help-of-orms-like-sequelize-5dc5)

å½“æˆ‘ä»¬ä½¿ç”¨æœ¯è¯­â€œæŒç»­â€æ—¶ï¼Œæˆ‘ä»¬çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿåœ¨æˆ‘ä»¬çš„æ—¥å¸¸è‹±è¯­ä¸­ï¼ŒæŒä¹…æ€§æ˜¯â€œä¸€ä¸ªç»“æœåœ¨å®ƒçš„åŸå› è¢«ç§»é™¤åçš„æŒç»­æ€§â€ï¼Œåœ¨å°†æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ä¸Šä¸‹æ–‡ä¸­ï¼ŒæŒä¹…æ€§æŒ‡çš„æ˜¯è®°å½•åœ¨åˆ›å»ºå®ƒçš„è¿‡ç¨‹ç»“æŸåä»ç„¶å­˜åœ¨çš„èƒ½åŠ›ã€‚

ä¸åƒå…¶ä»– NodeJS æ•™ç¨‹é‚£æ ·ä½¿ç”¨ MongoDB è¿›è¡Œæ•°æ®æŒä¹…åŒ–ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PostgreSQLã€‚å¦å¤–ï¼Œä¸ºäº†ç¡®ä¿æˆ‘ä»¬æŒæ¡ä½¿ç”¨ NodeJs å’Œ PostgreSQL å¼€å‘ Restful API çš„åŸºç¡€çŸ¥è¯†ï¼Œæˆ‘ä»¬å°†é¿å…ä½¿ç”¨ ORM(å¯¹è±¡å…³ç³»æ˜ å°„),è¯·é˜…è¯»æ›´å¤šç›¸å…³å†…å®¹ğŸ‘‰[æ­¤å¤„](https://en.wikipedia.org/wiki/Object-relational_mapping)ã€‚

**å…ˆå†³æ¡ä»¶**:

1.  æµè§ˆæˆ‘å…³äºç”¨ Express å’Œ Es6 ç¼–å†™åŸºæœ¬ NodeJs API çš„è¯¾ç¨‹ï¼Œä½ å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°å®ƒğŸ‘‡[![ogwurujohnson](../Images/5a9b1758658be88756f92622cacdc96a.png)](/ogwurujohnson) [## å¸¦æœ‰ NodeJs å’Œ ES6 çš„ç®€å• Restful Api .

    ### çº¦ç¿°é€Š å¥¥æ ¼æ­¦é² 9 æœˆ 28 æ—¥ 186 åˆ†é’Ÿé˜…è¯»

    #èŠ‚ç‚¹# JavaScript#æ•™ç¨‹](/ogwurujohnson/basic-api-with-nodejs-1el8)
2.  å¯¹ SQL æŸ¥è¯¢è¯­æ³•æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œå› ä¸ºæœ¬æ•™ç¨‹ä¸ä¼šæ¶‰åŠè¿™äº›
3.  NodeJs å’Œ Express çš„åŸºæœ¬çŸ¥è¯†
4.  å·²ç»å®‰è£…äº† NodeJsï¼Œä¸‹é¢æ˜¯ä¸‹è½½[é“¾æ¥](https://nodejs.org/en/download/)
5.  å·²ç»å®‰è£…äº† PostgreSQLï¼Œä¸‹é¢æ˜¯ä¸‹è½½[é“¾æ¥](https://www.postgresql.org/download/)
6.  å®‰è£…åï¼Œæœç´¢åº”ç”¨ç¨‹åº`pgAdmin`å¹¶å¯åŠ¨å®ƒï¼Œå®ƒéš PostgreSQL ä¸€èµ·å®‰è£…ã€‚pgAdmin æ˜¯ PostgreSQL çš„ GUI ç®¡ç†å’Œå¼€å‘å¹³å°(è¿™æ„å‘³ç€å®ƒæœ‰åŠ©äºä½¿æˆ‘ä»¬çš„æ•°æ®åº“ç®¡ç†æ›´åŠ å®¹æ˜“å’Œå‹å¥½)

**å…¥é—¨:**
åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¸ºä¸€ä¸ªç±»æ³¨å†Œè¡¨åˆ›å»ºä¸€ä¸ª APIï¼Œæˆ‘ä»¬å°†å¼€å§‹åˆ›å»ºå’Œè®¾ç½®æˆ‘ä»¬çš„æ•°æ®åº“ã€‚

æŒ‰ç…§ä¸‹é¢çš„è¯´æ˜ä½¿ç”¨ pgAdmin:
`1\. Double click on the PostgreSQL server`åˆ›å»ºæ•°æ®åº“ã€‚

`2\. Right-lick on Login Roles, assuming you have none and select new login role`ã€‚

`3\. Type your preferred Role name, mine is school_reg`ã€‚

`4\. Move to the next tab *Definition* and set your password for this role, mine is school_reg`ã€‚

`5\. Click on *OK* to save`ã€‚

`6\. Right-click on Databases and select New Database`ã€‚

`7\. Type Database name in the space for Name, mine is school_register`ã€‚

`8\. Select owner of Database, here we would select the login role or user we created, remember mine is school_reg`ã€‚

`9\. Click *OK* to save`ã€‚

ä¸Šå›¾è¯´æ˜äº†ä¸Šé¢çš„è¿‡ç¨‹ï¼Œæ”¾å¤§çœ‹æ¸…æ¥š:

[![Image illustrating creation of Database](../Images/8281bc0ba9cf1de76e93af8d2414973d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--eAToWpk---/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/12ohrcjxdpiubxl2rjn3.png)

åˆ›å»ºæ•°æ®åº“åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºè¡¨å’Œè¡¨å…³ç³»ï¼Œç”¨æå®¢çš„è¯æ¥è¯´ï¼Œ*è®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„æ¨¡å¼*ã€‚ç°åœ¨æˆ‘ä»¬åªæœ‰ä¸€ä¸ªè¡¨ï¼Œæˆ‘ä»¬çš„`student`è¡¨ï¼Œå®ƒåŒ…å«å­¦ç”Ÿçš„åŸºæœ¬ä¿¡æ¯ï¼Œéšç€åº”ç”¨ç¨‹åºçš„å¢é•¿ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©æ‰©å±•ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸åˆ›å»ºæ›´å¤šçš„è¡¨ã€‚

**é¡¹ç›®è®¾ç½®:**

1.  æˆ‘ä»¬å°†ä»åˆ›å»ºæˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶å¤¹å¼€å§‹ï¼Œæˆ‘å°†æˆ‘çš„æ–‡ä»¶å¤¹å‘½åä¸º`AwesomeNodepostgres`ï¼Œæ˜¯çš„ï¼Œæˆ‘çŸ¥é“å®ƒå¾ˆé•¿ï¼Œä½ å¯ä»¥è‡ªç”±é€‰æ‹©ä¸€ä¸ªè¾ƒçŸ­çš„åç§°ã€‚

2.  å½“æ‚¨ä»å‘½ä»¤è¡Œæ‰¾åˆ°é¡¹ç›®æ–‡ä»¶å¤¹æ—¶ï¼Œé€šè¿‡ä»å‘½ä»¤è¡Œè¿è¡Œ`npm init`å°†æ‚¨çš„é¡¹ç›®åˆå§‹åŒ–ä¸ºèŠ‚ç‚¹é¡¹ç›®ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰è¿™æ ·åšï¼Œè¯·å‚è€ƒä¸Šä¸€ç¯‡æ•™ç¨‹æ¥å¼„æ¸…æ¥šå¦‚ä½•åšã€‚

ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ çš„é¡¹ç›®ç›®å½•åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œå‡è®¾ä½ ä½¿ç”¨çš„æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä»£ç ç¼–è¾‘å™¨ [vscodeã€‚](https://code.visualstudio.com/download)
[![vscode shot](../Images/7ae09862ab56f2554f40db5d7432ef1e.png)T5ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qPSHBbY3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ztjxqe2gbkh10dbjrav9.PNG)

ç°åœ¨è¿™å·²ç»è§£å†³äº†ï¼Œè®©æˆ‘ä»¬ä»å®‰è£…ä¸€äº›ç¼–å†™åº”ç”¨ç¨‹åºæ‰€éœ€çš„åŒ…å¼€å§‹ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†éœ€è¦ä»¥ä¸‹èŠ‚ç‚¹åŒ…ï¼›

1.  Expressï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­å·²ç»é‡åˆ°çš„
2.  ä¸ºäº†ä¸æˆ‘ä»¬çš„ postgres æ•°æ®åº“é€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåä¸º [node-postgres](https://node-postgres.com/) çš„åŒ…ã€‚
3.  ä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„æœåŠ¡å™¨æ€»æ˜¯ç›‘å¬å˜åŒ–å¹¶é‡å¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬è¿˜å°†å®‰è£…å¦ä¸€ä¸ªåŒ… [nodemon](https://www.npmjs.com/package/nodemon) ã€‚

è¦å®‰è£…å‰ä¸¤ä¸ªåŒ…ï¼Œè¯·ç¡®ä¿ä»å‘½ä»¤è¡Œè¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ã€‚ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼›

```
 npm install express pg --save
            npm install nodemon --save-dev 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`--save-dev`è¿™é‡Œçš„æ„æ€æ˜¯ä¿å­˜ï¼Œåªåœ¨å¼€å‘æœŸé—´ä½¿ç”¨ nodemon ä½œä¸ºå¼€å‘ä¾èµ–ï¼Œæ‰€ä»¥åœ¨ç”Ÿäº§æœŸé—´ä¸ä¼šä½¿ç”¨ nodemonã€‚

ç°åœ¨ï¼Œä¸ºäº†å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹`services`ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`db.js`çš„æ–‡ä»¶ã€‚
æ‰€ä»¥åœ¨`services/db.js`é‡Œé¢ï¼Œé”®å…¥ä¸‹é¢çš„ä»£ç ï¼›

```
const pg = require('pg');

const config = {
  user: 'school_reg', //this is the db user credential
  database: 'school_register',
  password: 'school_reg',
  port: 5432,
  max: 10, // max number of clients in the pool
  idleTimeoutMillis: 30000,
};

const pool = new pg.Pool(config);

pool.on('connect', () => {
  console.log('connected to the Database');
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è¦åˆ›å»ºæˆ‘ä»¬çš„è¡¨ï¼Œåœ¨å‰é¢çš„ä»£ç å—ä¸‹é”®å…¥ä¸‹é¢çš„ä»£ç ï¼›

```
const createTables = () => {
  const schoolTable = `CREATE TABLE IF NOT EXISTS
      students(
        id SERIAL PRIMARY KEY,
        student_name VARCHAR(128) NOT NULL,
        student_age INT NOT NULL,
        student_class VARCHAR(128) NOT NULL,
        parent_contact VARCHAR(128) NOT NULL,
        admission_date VARCHAR(128) NOT NULL
      )`;
  pool.query(schoolTable)
    .then((res) => {
      console.log(res);
      pool.end();
    })
    .catch((err) => {
      console.log(err);
      pool.end();
    });
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†ç”¨è¿™ä¸ªè„šæœ¬åˆ›å»ºæˆ‘ä»¬çš„è¡¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç§æ–¹æ³•åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œè¿™ä¸ªä»£ç ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªåä¸º`make-runnable`çš„åŒ…ï¼Œå®‰è£…è¿™ä¸ªåŒ…ï¼›`npm install make-runnable --save`ï¼Œå®‰è£…å®Œæˆåï¼Œå›åˆ°ä½ çš„ä»£ç åº“é¡µé¢ä¸‹æ–¹ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼›

```
pool.on('remove', () => {
  console.log('client removed');
  process.exit(0);
});

//export pool and createTables to be accessible  from an where within the application
module.exports = {
  createTables,
  pool,
};

require('make-runnable'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨åˆ›å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œè®©æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„`package.json`æ–‡ä»¶ä¸Šå†™ä¸€ä¸ªè„šæœ¬ï¼Œå½“ä»å‘½ä»¤è¡Œè¿è¡Œæ—¶ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¡¨ã€‚åœ¨æ‚¨çš„`package.json`æ–‡ä»¶ä¸­æ‰¾åˆ°å¯¹è±¡è„šæœ¬ï¼Œç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢å¯¹è±¡å†…éƒ¨çš„å†…å®¹ï¼›

```
"create": "node ./services/db createTables" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä»ç„¶åœ¨é¡¹ç›®ç›®å½•ä¸­æ—¶ï¼Œè½¬åˆ°å‘½ä»¤è¡Œå¹¶è¿è¡Œï¼›

```
npm run create 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹å›¾æ˜¾ç¤ºäº†å½“æ‚¨è¿™æ ·åšæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œå¹¶ä¸”ä»”ç»†æŸ¥çœ‹äº†æ‚¨å°†åœ¨ pgAdmin åº”ç”¨ç¨‹åºä¸Šå®šä½æ–°åˆ›å»ºçš„è¡¨çš„ä½ç½®ã€‚

[![runing npm run create](../Images/2def3dde1302c9775c57caedd5994279.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--oM2MS0IJ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/13p79ijvxdpe1485kw9k.PNG)

[![viewing newly created table](../Images/51231c8ba0b4e8dae64bb7da2964cd19.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--VIAaKY2v--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fbd3ceify55uu6ws76ju.PNG)

éšç€æ•°æ®åº“å’Œè¡¨çš„åˆ›å»ºå®Œæˆï¼Œæ˜¯æ—¶å€™å¼€å§‹åœ¨æ•°æ®åº“ä¸­å­˜å‚¨æ•°æ®å¹¶æ£€ç´¢è¿™äº›å­˜å‚¨çš„æ•°æ®äº†ã€‚

åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„`index.js`æ–‡ä»¶ï¼Œå®ƒå°†åŒ…å«æˆ‘ä»¬çš„æœåŠ¡å™¨å’Œ express ä»£ç ï¼Œåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`index.js`çš„æ–‡ä»¶ã€‚åœ¨æˆ‘ä»¬çš„`index.js`ä¸­è¾“å…¥ä¸‹é¢çš„ä»£ç ã€‚

```
 const express = require('express');
   const app = express();

   const port = process.env.PORT || 3000;

   // Add route code Here
   app.get('/', (req, res) => {
      res.send('Welcome to Our SCHOOL API');
   });

   app.listen(port, () => {
      console.log(`We are live at 127.0.0.1:${port}`);
   }); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¦è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œè®©æˆ‘ä»¬åœ¨`package.json`æ–‡ä»¶ä¸­æ‰¾åˆ°çš„`scripts`å¯¹è±¡ä¸Šæ·»åŠ ä¸¤ä¸ªé¢å¤–çš„ä»£ç ï¼Œåœ¨åˆ›å»ºä¹‹å‰ï¼Œåˆ é™¤è¿™ä¸¤ä¸ªä»£ç ï¼›

```
 "dev": "nodemon index.js",
    "start": "node index.js", 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![scripts for running](../Images/e4bc4ff94bca38eaf0a0e0962eb6faad.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--tppLIN1s--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/xzmkpbst4blgcvk2sbed.PNG)

ç°åœ¨è¦è¿è¡Œæˆ‘ä»¬çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ nodemon é€‰é¡¹ï¼Œæ‰€ä»¥æ— è®ºæˆ‘ä»¬åšä»€ä¹ˆæ›´æ”¹ï¼Œæˆ‘ä»¬éƒ½èƒ½å¤Ÿæ³¨æ„åˆ°ã€‚å½“æ‚¨åšå‡ºæ›´æ”¹å¹¶ä¿å­˜å®ƒæ—¶ï¼Œå°è¯•è§‚å¯Ÿ nodemon å¦‚ä½•é‡æ–°å¯åŠ¨æœåŠ¡å™¨ã€‚

[![nodemon starting server](../Images/f7f9553224fa5dc89b25755d923772f3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--f9yEkfYS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/be0e50wwq98koh8pmw5g.PNG)

å½“æˆ‘ä»¬çš„æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œè®¿é—®ä½ çš„æœåŠ¡å™¨æ­£åœ¨ç›‘å¬çš„é“¾æ¥ï¼Œ`127.0.0.1:3000`æ­£å¦‚æˆ‘çš„æœåŠ¡å™¨æ‰€æŒ‡å®šçš„ã€‚æ‰“å¼€æ‚¨çš„ postman åº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨è¯¥é“¾æ¥å‘å‡º GET è¯·æ±‚ã€‚

[![postman](../Images/d8ba438addea34dc40b3c05a962c627d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--U4EhxoDq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fegqytuigbeclqeezbu3.PNG)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºå¤„ç†åˆ›å»ºå­¦ç”Ÿå’Œè·å–æ‰€æœ‰å­¦ç”Ÿçš„è·¯ç”±ã€‚åœ¨ä½ çš„`index.js`æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªè·¯å¾„ä¹‹åï¼Œæ·»åŠ ä¸‹é¢çš„ä»£ç ï¼Œè¿™äº›ä»£ç å°†å¤„ç†ï¼Œæ’å…¥ä¸€ä¸ªå­¦ç”Ÿï¼Œè·å–æ‰€æœ‰å­¦ç”Ÿã€‚ä¸ºäº†èƒ½å¤Ÿæ’å…¥åˆ°æˆ‘ä»¬çš„æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿé€‰æ‹©æä¾›ç»™ä»»ä½•è¯·æ±‚ä½“çš„å€¼ï¼Œä¸ºæ­¤æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º [body-parser](https://www.npmjs.com/package/body-parser) çš„èŠ‚ç‚¹åŒ…ã€‚

```
npm install body-parser 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨å®‰è£…äº†ä¸Šé¢çš„åŒ…ä¹‹åï¼Œåœ¨ç»§ç»­æˆ‘ä»¬çš„è·¯çº¿ä¹‹å‰ï¼Œå°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°æˆ‘ä»¬çš„`index.js`ä¸­ã€‚åœ¨ä¸‹é¢æ·»åŠ ä»¥ä¸‹å†…å®¹`const app = express();`

```
const bodyParser = require('body-parser');
app.use(bodyParser.json());
app.use(bodyparser.urlencoded({extended:true})); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­æˆ‘ä»¬çš„è·¯çº¿ï¼›

```
app.get('/student', (req, res) => {
pool.connect((err, client, done) => {
    const query = 'SELECT * FROM students';
    client.query(query, (error, result) => {
      done();
      if (error) {
        res.status(400).json({error})
      } 
      if(result.rows < '1') {
        res.status(404).send({
        status: 'Failed',
        message: 'No student information found',
        });
      } else {
        res.status(200).send({
        status: 'Successful',
        message: 'Students Information retrieved',
        students: result.rows,
        });
      }
    });
  });
});

app.post('/student', (req, res) => {
  const data = {
    name : req.body.studentName,
    age : req.body.studentAge,
    classroom : req.body.studentClass,
    parents : req.body.parentContact,
    admission : req.body.admissionDate,
  }

  pool.connect((err, client, done) => {
    const query = 'INSERT INTO students(student_name,student_age, student_class, parent_contact, admission_date) VALUES($1,$2,$3,$4,$5) RETURNING *';
    const values = [data.name, data.age, data.classroom, data.parents, data.admission];

    client.query(query, values, (error, result) => {
      done();
      if (error) {
        res.status(400).json({error});
      }
      res.status(202).send({
        status: 'SUccessful',
        result: result.rows[0],
      });
    });
  });
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œè®¿é—® postman ä¸Šçš„é“¾æ¥ï¼Œè¿™ä¸€æ¬¡è®¿é—®æ¯ä¸ªè¯·æ±‚çš„ GET å’Œ POST ä¹‹é—´äº¤æ›¿çš„é“¾æ¥`127.0.0.1/student`ã€‚çœ‹çœ‹ä¸‹é¢çš„æˆªå›¾ï¼Œå¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•ç”¨ postman æµ‹è¯•ï¼Œåšå®Œå…¨ç›¸åŒçš„äº‹æƒ…ã€‚

1.  é¦–å…ˆä½ åœ¨é‚®é€’å‘˜ä¸Šè®¾ç½®ä½ çš„å¤´ä¿¡æ¯:
    [![header information](../Images/fa45ffc7dd6ced3c54077b01956a74af.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--3Xew142N--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/b3wzwl1ry2li1651o03y.PNG)

2.  ä¹‹åï¼Œæˆ‘ä»¬å°†è®¾ç½®ä½“å€¼ï¼Œå¦‚ä¸‹å›¾:
    [![body config](../Images/19984d3191c818450baf7098beb3925d.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--Uejs0-Cl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/b20ynnvjsvx80os60xbr.PNG)

3.  ç„¶åä½ ç‚¹å‡»å‘é€ï¼Œä½ å°±ä¼šå¾—åˆ°ä½ çš„ç»“æœ
    [![result](../Images/d5251ba007dd10a99bfaa735cbb2ce5c.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--FPwD3q3l--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/91r3z8iyu5ogorsi6p0s.PNG)

ç°åœ¨è¦è¿è¡Œ get è¯·æ±‚ï¼Œè¯·å°†è¯·æ±‚ç±»å‹æ›´æ”¹ä¸º GETï¼Œç„¶åå•å‡» sendã€‚

[![get](../Images/1d1b5e60a99c08bd2f4f5c864a16ab44.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Tu_NMjpb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/76hvmzqtj5t75b8mup1g.PNG)

æ²ƒæ‹‰ã€‚ï¼ï¼ç°åœ¨æˆ‘ä»¬æœ‰äº† API è·å–å¹¶å‘é€åˆ°æ•°æ®åº“ã€‚

**æ³¨æ„**:å°†æˆ‘ä»¬çš„ routeã€server å’Œ express åº”ç”¨ç¨‹åºæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ˜¯ä¸å¥½çš„åšæ³•ï¼Œåœ¨ GitHub ä¸Šå¯åŠ¨è¿™ä¸ªé¡¹ç›®åº“ï¼Œfork å¹¶æäº¤ PRï¼Œå½“æˆ‘ç»§ç»­å·¥ä½œæ—¶ï¼Œå­¦ä¹ å¦‚ä½•åšï¼Œæˆ–è€…ä½ å¯ä»¥å°è¯•è‡ªå·±å·¥ä½œå¹¶æäº¤ä¸€ä¸ª push è¯·æ±‚ã€‚

è®©æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­å†æ·»åŠ ä¸€ä¸ªè·¯ç”±ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦è·å–ä¸€ä¸ªç‰¹å®šçš„å­¦ç”Ÿä¿¡æ¯ï¼Œæˆ‘ä»¬å°†ç¼–å†™è·¯ç”±ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›æ‚¨ç¼–å†™æŸ¥è¯¢å¹¶æ ¹æ®æ‚¨æ‰€å­¦çš„å†…å®¹è¿”å›ä¸€ä¸ªå“åº”ã€‚

```
app.get('/student/:id', (req,res) => {
  const id = req.params.id;
  res.send(`Student ${id} profile`);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“æˆ‘ä»¬å‘æ–°çš„ç«¯ç‚¹å‘å‡ºè¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°:

[![individual student](../Images/674aaabffeaf4b6c354d8c67aea59823.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--8K57dPsy--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/6ueg6oyhidf35e7ac9eq.PNG)

å› æ­¤ï¼Œå°è¯•å®Œæˆä»£ç ï¼Œä»æ•°æ®åº“ä¸­é€‰æ‹©æ‚¨æ‰€å¼•ç”¨çš„ id çš„å­¦ç”Ÿã€‚

ä¸‹é¢é™„ä¸Šæ‰¿è¯ºçš„ GitHub å›è´­ã€‚ï¼Œåˆ«å¿˜äº†æ˜æ˜Ÿã€‚è°¢äº†ã€‚

åœ¨æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šçœ‹åˆ°å¦‚ä½•è®¤è¯æˆ‘ä»¬çš„è·¯ç”±ï¼Œæ‰€ä»¥æ²¡æœ‰æ­£ç¡®çš„è®¤è¯ï¼Œç”¨æˆ·å°±ä¸èƒ½è®¿é—®è·¯ç”±ã€‚

## ![GitHub logo](../Images/75095a8afc1e0f207cda715962e75c8d.png) [å¥¥æ ¼æ­¦é²å¼ºæ£®](https://github.com/ogwurujohnson) / [ AwesomeNodePostgres](https://github.com/ogwurujohnson/AwesomeNodePostgres)

### è¿™æ˜¯ä¸€ä¸ªé¡¹ç›®ï¼Œæ—¨åœ¨æ•™æˆåœ¨ä½¿ç”¨ NodeJs åˆ›å»º API æ—¶å¦‚ä½•ä½¿ç”¨ PostgreSQL æŒä¹…åŒ–æ•°æ®

<article class="markdown-body entry-content container-lg" itemprop="text">**N**ode **E**xpress **P**postgresÂ 

# **å¼€å‘åˆ°**çš„èŠ‚ç‚¹ API æ•™ç¨‹çš„ä»£ç åº“

### åœ¨æ•°æ®åº“ä¸­å­˜å‚¨è®°å½•

### ä»æ•°æ®åº“ä¸­æ£€ç´¢è®°å½•

### æ›´æ–°æ•°æ®åº“ä¸­çš„è®°å½•ç­‰

[![image](../Images/12c35acf65122b97bae0c662e75509b2.png)T2ã€‘](https://user-images.githubusercontent.com/14821816/47576850-65dcc600-d93d-11e8-9b70-93754a902a84.png)

## é¡¹ç›®

[![GitHub issues](../Images/411d3d7903c608404c2d1257a7b595b3.png)](https://github.com/ogwurujohnson/AwesomeNodePostgres/issues)[![GitHub forks](../Images/790771e798029e10c9621295b26e3303.png)](https://github.com/ogwurujohnson/AwesomeNodePostgres/network)[![GitHub stars](../Images/d83dbf46c46f1558dad1707c2fc28cbe.png)](https://github.com/ogwurujohnson/AwesomeNodePostgres/stargazers)[![GitHub license](../Images/2e3f640db9a9d9e366819c8f56ba9859.png)](https://github.com/ogwurujohnson/AwesomeNodePostgres/blob/master/LICENSE)[![price](../Images/544ae72165fec19dbdaf9af41f363c8b.png)](https://camo.githubusercontent.com/c26c1d49c6f2f99bd3c2768edc5bb0f067794f81cf88119b8b44d734c70b6c72/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f50726963652d467265652d677265656e2e737667)

[![Twitter](../Images/08552cbcee9a9d4c457926a1b96a1678.png)T2ã€‘](https://twitter.com/intent/tweet?text=Wow:&url=https%3A%2F%2Fgithub.com%2Fogwurujohnson%2FAwesomeNodePostgres)

# awesomenodepositgres

è¿™æ˜¯ä¸€ä¸ªé¡¹ç›®ï¼Œæ—¨åœ¨æ•™æˆå¦‚ä½•åœ¨ä½¿ç”¨ NodeJs åˆ›å»º API çš„åŒæ—¶ä½¿ç”¨ PostgreSQL æŒä¹…åŒ–æ•°æ®ã€‚æˆ‘ä»¬å°†è‡´åŠ›äºåˆ›å»ºä¸€ä¸ªè¯¾å ‚åº”ç”¨ç¨‹åºï¼Œä¸€ä¸ªç”¨äºå¤„ç†æŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿã€æ·»åŠ å­¦ç”Ÿã€ç¼–è¾‘å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯ã€åˆ é™¤å­¦ç”Ÿç­‰çš„ APIã€‚æ‚¨ä¹Ÿå¯ä»¥éšæ„æ·»åŠ å…¶ä»–åŠŸèƒ½ï¼Œä¸ºè¿™ä¸ªé¡¹ç›®åšè´¡çŒ®ï¼Œå¹¶åœ¨ README.md æ–‡ä»¶ä¸­ç•™ä¸‹å¦‚ä½•ä½¿ç”¨å®ƒçš„æŒ‡å¯¼

</article>

[View on GitHub](https://github.com/ogwurujohnson/AwesomeNodePostgres)