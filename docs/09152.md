# Python æœ‰å¯åŠ¨æ–‡ä»¶ï¼

> åŸæ–‡:[https://dev.to/rpalo/python-has-a-startup-file-b7c](https://dev.to/rpalo/python-has-a-startup-file-b7c)

*ä¹Œåˆ—å°”Â·ç´¢ä¼¯å…°æ–¯åœ¨ Unsplash ä¸Šæ‹æ‘„çš„å°é¢ç…§ç‰‡*

æ‰€ä»¥ï¼Œæˆ‘æƒ³è¯´æ¸…æ¥šã€‚åœ¨æˆ‘ä½¿ç”¨ Python çš„è¿™æ®µæ—¶é—´é‡Œï¼Œæˆ‘çŸ¥é“ Python æœ‰ä¸€ä¸ªå¯åŠ¨å®šåˆ¶æ–‡ä»¶ã€‚*æˆ‘ä¸æ˜¯è¿™ä¸ªæ˜ŸæœŸæ‰çŸ¥é“çš„ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼Œå½“ç„¶*Python æœ‰ä¸€ä¸ªå¯åŠ¨æ–‡ä»¶ã€‚ä¸€åˆ‡éƒ½æœ‰ä¸€ä¸ªå¯åŠ¨æ–‡ä»¶ï¼æˆ‘åªæ˜¯æƒ³ç¡®å®šä½ çŸ¥é“è¿™ä»¶äº‹ã€‚å¼€ä¸ªç©ç¬‘ï¼Œæˆ‘ä¸çŸ¥é“è¿™æ˜¯ä¸ªä¸œè¥¿ã€‚)**

> åœ¨ä½ æåˆ°å®ƒä¹‹å‰ï¼Œæˆ‘å·²ç»çŸ¥é“äº† [bPython](https://bpython-interpreter.org/screenshots.html) ï¼Œå®ƒæ˜¯å–ä»£å¸¸è§„ Python è§£é‡Šå™¨çš„ä»¤äººæ•¬ç•çš„ã€è¯­æ³•çªå‡ºçš„ã€åˆ¶è¡¨ç¬¦å®Œæ•´çš„ã€è‡ªåŠ¨ç¼©è¿›çš„ã€å‡ºè‰²çš„å·¥å…·ã€‚æˆ‘ä¸€ç›´åœ¨ç”¨å®ƒã€‚ä½†è¿™ä¸æ˜¯è¿™ç¯‡åšæ–‡çš„å†…å®¹ã€‚P.S .å¦‚æœä½ ä¸çŸ¥é“ bPythonï¼Œæˆ‘å¼ºçƒˆæ¨èå®ƒ(Windows ç”¨æˆ·çš„é‡Œç¨‹å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒ)ã€‚

## $PYTHONSTARTUP

å¦‚æœæ‚¨å°†ç¯å¢ƒå˜é‡`$PYTHONSTARTUP`è®¾ç½®ä¸ºæœ‰æ•ˆçš„ Python æ–‡ä»¶ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶å°†åœ¨å¯åŠ¨ Python è§£é‡Šå™¨æ—¶è¿è¡Œã€‚

```
$ export PYTHONSTARTUP="~/.config/pythonrc.py" 
```

Enter fullscreen mode Exit fullscreen mode

ä¸è¦æ‹…å¿ƒæ–‡ä»¶åã€‚éšä¾¿ä½ æ€ä¹ˆå‘½åï¼`python_startup.py`ï¼Œæˆ–è€…åªæ˜¯`pythonrc`ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒæ”¾åœ¨ä»»ä½•ä½ æƒ³è¦çš„ç›®å½•é‡Œã€‚åªè¦ç¡®ä¿æ‚¨çš„`$PYTHONSTARTUP`ç¯å¢ƒå˜é‡åŒ¹é…ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥å°†ä»»ä½•å†…å®¹æ”¾å…¥è¯¥æ–‡ä»¶ã€‚

```
# ~/.config/pythonrc.py a = "Wahoo!"
print("Soup")
try:
    import numpy as np
except ImportError:
    print("Could not import numpy.") 
```

Enter fullscreen mode Exit fullscreen mode

å°è¯•è¿è¡Œæ‚¨çš„ Python è§£é‡Šå™¨ã€‚

```
$ python  # or python3 
```

Enter fullscreen mode Exit fullscreen mode

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹:

```
Python 3.7.0 (default, Jun 29 2018, 20:14:27)
[Clang 9.0.0 (clang-900.0.39.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
Soup
>>> np
<module 'numpy' from '/usr/local/lib/python3.7/site-packages/numpy/__init__.py'>
>>> np.zeros((3, 2))
array([[0., 0.],
       [0., 0.],
       [0., 0.]])
>>> a
'Wahoo!' 
```

Enter fullscreen mode Exit fullscreen mode

æ‚¨å¯ä»¥å¯¼å…¥å¸¸ç”¨çš„åº“ï¼Œä¸ºè‡ªå·±åˆ›å»ºå˜é‡ï¼Œç­‰ç­‰ã€‚

## sys.ps1 å’Œ sys.ps2

ä¸€ä»¶ç®€å•çš„äº‹æƒ…æ˜¯è®¾ç½®`sys.ps1`å’Œ`sys.ps2`å˜é‡ï¼Œå®ƒä»¬æ§åˆ¶æ‚¨çš„ Python æç¤ºã€‚

```
# ~/.config/pythonrc.py 
import sys

sys.ps1 = "ğŸŒ®"
sys.ps2 = "ğŸ’©"

# ... 
```

Enter fullscreen mode Exit fullscreen mode

è¿˜æœ‰ï¼Œå›åˆ°äº’åŠ¨ REPL:

```
ğŸŒ® for i in range(10):
ğŸ’©     print("I am a mature adult.")
ğŸ’©
I am a mature adult.
I am a mature adult.
... 
```

Enter fullscreen mode Exit fullscreen mode

äº‹å®ä¸Šï¼Œæ‚¨ç”šè‡³å¯ä»¥å°†`sys.ps1`å’Œ`sys.ps2`è®¾ç½®ä¸ºç”šè‡³ä¸æ˜¯å­—ç¬¦ä¸²çš„å¯¹è±¡ï¼å¦‚æœå®ƒä»¬ä¸æ˜¯å­—ç¬¦ä¸²ï¼ŒPython ä¼šå¯¹å®ƒä»¬è°ƒç”¨`str(obj)`ã€‚

```
# ~/.config/pythonrc.py 
import sys
from datetime import datetime

class CustomPS1:
    def __init__(self):
        self.count = 0

    def __str__(self):
        self.count += 1
        return f"({self.count}) {datetime.now().strftime('%H:%m %p')} > "

sys.ps1 = CustomPS1() 
```

Enter fullscreen mode Exit fullscreen mode

å¹¶ä¸”åœ¨è§£é‡Šå™¨ä¸­:

```
(1) 10:06 AM > for i in range(10):
...     print("Am I cool now?")
...
Am I cool now?
Am I cool now?
# ... (2) 11:06 AM > 
```

Enter fullscreen mode Exit fullscreen mode

## -I æ ‡å¿—

é™¤äº†è¿™äº›æ–°çš„è¶…èƒ½åŠ›ä¹‹å¤–ï¼Œä½ å¯ä»¥æš‚æ—¶å°†ä»»ä½•ä¸€ä¸ª Python è„šæœ¬ä½œä¸ºä½ çš„å¯åŠ¨è„šæœ¬ã€‚è¿™å¯¹äºä¸€äº›äº¤äº’å¼è°ƒè¯•æ¥è¯´éå¸¸æ–¹ä¾¿ã€‚å‡è®¾ä½ æ­£åœ¨åšä¸€ä¸ªé¡¹ç›®ï¼Œä½ æœ‰ä¸€ä¸ªå®šä¹‰äº†ä¸€äº›å‡½æ•°çš„è„šæœ¬:

```
# cool_script.py 
def what_time_is_it():
    return "Party Time" 
```

Enter fullscreen mode Exit fullscreen mode

å½“æ‚¨è¿è¡Œ Python è§£é‡Šå™¨æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`-i`æ ‡å¿—æ¥ä½¿ç”¨`cool_script.py`ä½œä¸ºæ‚¨çš„å¯åŠ¨æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æ‚¨é€šå¸¸ä½¿ç”¨çš„æ–‡ä»¶ã€‚

```
$ python -i cool_script.py
>>> what_time_is_it()
'Party Time' 
```

Enter fullscreen mode Exit fullscreen mode

å¦‚æœä½ ç”¨ä½ çš„å¯åŠ¨æ–‡ä»¶åšäº†ä¸€äº›å¾ˆé…·çš„äº‹æƒ…ï¼Œåˆ†äº«ç»™æˆ‘å§ï¼æˆ‘æƒ³äº†è§£ä¸€ä¸‹ï¼ç¼–ç å¿«ä¹ï¼

*åŸå¸– [`assert_not magic?`](https://assertnotmagic.com/2018/06/30/python-startup-file/)*