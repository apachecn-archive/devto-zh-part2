# MojiScript å¢å¼ºåœ°å›¾ç®€ä»‹

> åŸæ–‡:[https://dev . to/Joel net/an-introduction-to-moji scripts-enhanced-map-3d PP](https://dev.to/joelnet/an-introduction-to-mojiscripts-enhanced-map-3dpp)

[![World map](../Images/d7ac09895557ea4389c2fa788fbcbcea.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--muenqqfd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/h38jlrfkzqo771qvee7y.jpg)

MojiScript åœ¨è®¸å¤šæ–¹é¢æ‰©å±•å’Œå¢å¼ºäº†`map`,æ¯”å¦‚æ”¯æŒå¯è¿­ä»£å’Œå¼‚æ­¥ä»£ç ã€‚è¿™æ˜¯å¯¹ MojiScript çš„`map`æä¾›çš„ç‰¹æ€§ä»¥åŠä¸ä¼ ç»Ÿçš„`map`çš„åŒºåˆ«çš„ä»‹ç»ã€‚

è¿™ç¯‡æ–‡ç« çš„çµæ„Ÿæ¥è‡ª Twitter ä¸Šçš„ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜:

> ![ğ•”ğ•› profile image](../Images/5840636d40c1afe2b030a77427c30387.png)ğ•”ğ•›@ dually 888![twitter logo](../Images/4c8a2313941dda016bf4d78d103264aa.png)[@ thepractical dev](https://twitter.com/ThePracticalDev)[@ Joel net](https://twitter.com/joelnet)ä½†æ˜¯é¦™è‰ js å·²ç»åšäº†ä½ æƒ³è¦åšçš„ä¸ºä»€ä¹ˆè¿˜è¦å¸¦ä¸€ä¸ª lib æ¥å‘¢ï¼ŸğŸ˜©2018 å¹´ 10 æœˆ 17 æ—¥ä¸‹åˆ 15:06[![Twitter reply action](../Images/44d8b042100e231770330321e5b63d65.png)](https://twitter.com/intent/tweet?in_reply_to=1052576566750916608)[![Twitter retweet action](../Images/93d9c70ccc54851d2e8e881b53c21dae.png)](https://twitter.com/intent/retweet?tweet_id=1052576566750916608)[![Twitter like action](../Images/2e93f7775eadefab8bcd34a4542cc5a7.png)](https://twitter.com/intent/like?tweet_id=1052576566750916608)

> ![ğ•”ğ•› profile image](../Images/5840636d40c1afe2b030a77427c30387.png)ğ•”ğ•›@ dual ly 888![twitter logo](../Images/4c8a2313941dda016bf4d78d103264aa.png)[@ thepractical dev](https://twitter.com/ThePracticalDev)[@ Joel net](https://twitter.com/joelnet)å­—é¢ä¸Šåªæ˜¯
> const evens = values . filter(x =>x % 2 = = = 0)ï¼›2018 å¹´ 10 æœˆ 17 æ—¥ä¸‹åˆ 15:08[![Twitter reply action](../Images/44d8b042100e231770330321e5b63d65.png)](https://twitter.com/intent/tweet?in_reply_to=1052577088543297536)[![Twitter retweet action](../Images/93d9c70ccc54851d2e8e881b53c21dae.png)](https://twitter.com/intent/retweet?tweet_id=1052577088543297536)[![Twitter like action](../Images/2e93f7775eadefab8bcd34a4542cc5a7.png)](https://twitter.com/intent/like?tweet_id=1052577088543297536)

# [](#traditional-map)ä¼ ç»Ÿåœ°å›¾

è®©æˆ‘ä»¬ä»ä½ åº”è¯¥å·²ç»ç†Ÿæ‚‰çš„ä¸œè¥¿å¼€å§‹ã€‚è¿™æ˜¯æœ€ç®€å•çš„å½¢å¼ã€‚

```
const values = [1, 2, 3]
values.map(x => x * 2) //=> [2, 4, 6] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œåœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ—…ç¨‹ä¹‹å‰ï¼Œæˆ‘å»ºè®®å°†å‡½æ•°`x => x * 2`ä»`map()`è°ƒç”¨ä¸­åˆ†ç¦»å‡ºæ¥ã€‚

```
const double = x => x * 2
const values = [1, 2, 3]
values.map(double) //=> [2, 4, 6] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘çŸ¥é“æˆ‘ä¼¼ä¹åœ¨è¯´ä¸€äº›çç¢è€Œæ˜æ˜¾çš„äº‹æƒ…ï¼Œä½†è¿™æ˜¯æˆ‘åœ¨é˜…è¯»ä»£ç æ—¶å¾ˆå°‘çœ‹åˆ°çš„ã€‚

è¿™æ˜¯ä½ å¯ä»¥ç”¨`map`ã€`filter`ã€`reduce`ã€`Promise.then`å‘¼å«ç­‰ç­‰æ¥åšçš„äº‹æƒ…ã€‚

# [](#syntax)è¯­æ³•

MojiScript çš„`map`æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚ä½ ä»ç„¶æœ‰ç›¸åŒçš„`values`ã€`map`å’Œ`func`ã€‚ä½†ä½ ç§°å‘¼å®ƒçš„æ–¹å¼åªæ˜¯æœ‰ä¸€ç‚¹ç‚¹ä¸åŒ(ä½†ä¸ä¼šå¤ªå¤š)ã€‚

```
// JavaScript
values.map(func)

// MojiScript
map (func) (values) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åšå‡ºè¿™ç§æ”¹å˜ä¸ºè½»æ¾æ„å»ºæ–°åŠŸèƒ½æä¾›äº†å¯èƒ½æ€§ã€‚

```
const newFunc = map (func) // a new function is born!
newFunc (values) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#mapping-iterators)æ˜ å°„è¿­ä»£å™¨

å› ä¸º JavaScript çš„ map æ˜¯é™„åŠ åœ¨`Array`ä¸Šçš„æ–¹æ³•ï¼Œæ‰€ä»¥ä¸å®¹æ˜“å’Œå…¶ä»–ç±»å‹ä¸€èµ·ä½¿ç”¨ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ­£åœ¨å¯¼å…¥`range`ï¼Œå®ƒæ˜¯ä¸€ä¸ª`Iterator`ã€‚

```
import range from 'mojiscript/list/range'
console.log(...range (1) (4)) //=> 1 2 3 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯æƒœ JavaScript çš„`map`ä¸æ”¯æŒ`Iterators`ã€‚

```
range (1) (4)
  .map (double) //=> Error: map is not a functionâ€‹â€‹ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å³ä½¿æˆ‘ä»¬æ–½äº†é­”æ³•ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½è®©å®ƒèµ·ä½œç”¨...

```
Array.prototype.map.call(range (1) (4), double) //=> [] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨ JavaScript-land ä¸­ï¼Œ`Iterator`åœ¨è¢«æ˜ å°„ä¹‹å‰å¿…é¡»å…ˆè¢«è½¬æ¢ä¸º`Array`ã€‚

```
Array.prototype.map.call([...range (1) (4)], double) // [2, 4, 6]
//                        ----------------
//                      /
//     cast to an Array

[...range (1) (4)].map(double) //=> [2, 4, 6]
//---------------
//                 \
//                   cast to an Array 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯ä½¿ç”¨ MojiScriptï¼Œ`map`ä¸`Iterators`æ²¡æœ‰é—®é¢˜ï¼Œè¯­æ³•ä¸æ˜ å°„ä¸€ä¸ª`Array`ç›¸åŒã€‚

```
map (double) (range (1) (4)) //=> [2, 4, 6] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#mapping-strings)æ˜ å°„å­—ç¬¦ä¸²

ç›¸åŒçš„è¯­æ³•ç”¨äºæ˜ å°„å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ã€‚

```
const charCode = x => x.charCodeAt(0)

// JavaScript
Array.prototype.map.call('abc', charCode) //=> [97, 98, 99]

// MojiScript
map (charCode) ('abc') //=> [97, 98, 99] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#nodelists)èŠ‚ç‚¹åˆ—è¡¨

ä¹Ÿæ”¯æŒèŠ‚ç‚¹åˆ—è¡¨ï¼

```
// JavaScript
document.querySelectorAll('div[id]').map()
//=> Error: document.querySelectorAll(...).map is not a function

// MojiScript
const getId = element => element.getAttribute('id')
const divs = document.querySelectorAll('div[id]')

const ids = map (divs) (getIds)
//=> ['id1', 'id2', 'id3'] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#maybe)ä¹Ÿè®¸å§

å¯¹äºå¯ç©ºç±»å‹æ¥è¯´ï¼Œ`Maybe`ç±»å‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ª`Maybe`ç±»å‹æ¥ä»£æ›¿ä½¿ç”¨ null å¹¶æ‰§è¡Œ null æ£€æŸ¥ã€‚

**JavaScript:**

```
const upper = string =>
  string == null ? string : string.toUpperCase()

upper(null) //=> null
upper('abc') //=> 'ABC' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**MojiScript:**

`Maybe`å¯ä»¥æ¶ˆé™¤å¤§å¤šæ•°æ— æ•ˆæ£€æŸ¥çš„éœ€è¦ã€‚åŒæ ·ï¼Œè¯­æ³•ä¸ä»»ä½•å…¶ä»–å¯¹`map`çš„è°ƒç”¨ç›¸åŒã€‚

```
import map from 'mojiscript/list/map'
import Just from 'mojiscript/type/Just'
import Nothing from 'mojiscript/type/Nothing'

const upper = map (string => string.toUpperCase())

upper (Nothing) //=> Nothing
upper (Just ('abc')) //=> Just ('ABC') 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€äº›å¸®åŠ©æ–¹æ³•å¯ä»¥è®©ä½ è½»æ¾è¿›å‡º`Maybes` :

```
import Just from 'mojiscript/type/Just'
import { fromMaybe, fromNullable } from 'mojiscript/type/Maybe'
import Nothing from 'mojiscript/type/Nothing'

fromNullable (null) //=> Nothing
fromNullable ('abc') //=> Just ('abc')

fromMaybe ('') (Nothing) //=> ''
fromMaybe ('') (Just ('abc')) //=> 'abc' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªä¸»é¢˜å¤ªå¤§äº†ï¼Œæ— æ³•åœ¨è¿™é‡Œè®¨è®ºã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘åœ¨è¿™é‡Œå†™äº†ä¸€æ•´ç¯‡å…³äºè¿™ä¸ªä¸»é¢˜çš„æ–‡ç« : [NULLï¼Œâ€œåäº¿ç¾å…ƒçš„é”™è¯¯â€ï¼Œä¹Ÿè®¸ä»€ä¹ˆéƒ½æ²¡æœ‰](https://dev.to/joelnet/null-the-billion-dollar-mistake-maybe-just-nothing-1cak)

# [](#asynchronous-map)å¼‚æ­¥æ˜ å°„

MojiScript çš„`map`ä¹Ÿæ”¯æŒå¼‚æ­¥æ˜ å°„ï¼

```
const double = x => x * 2

const asyncDouble = num => new Promise(resolve => {
  setTimeout(() => {
    console.log({ num })
    resolve(double(num))
  }, 1000)
})

map (asyncDouble) (range (1) (5))
//=> [2, 4, 6, 8, 10] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#mapping-async-iterables)æ˜ å°„å¼‚æ­¥è¿­ä»£è¡¨

MojiScript çš„`map`ä¹Ÿæ”¯æŒå¼‚æ­¥è¿­ä»£å™¨ï¼

```
const timeout = seconds =>
  new Promise(resolve => setTimeout(resolve, seconds))

async function* asyncGen() {
  await timeout (1000)
  yield 1
  await timeout (1000)
  yield 2
  await timeout (1000)
  yield 3
}

const double = x => x * 2

const iter = asyncGen();

map (double) (iter)
//=> Promise([ 2, 4, 6 ]) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#summary)æ€»ç»“

é­”å’’å¯ä»¥`map` : `Array`ã€`Iterators`ã€`Async Iterators`ã€`Functors`ã€`Strings`ã€‚

MojiScript çš„`map`ä¹Ÿæ”¯æŒå¼‚æ­¥ä»£ç ï¼Œè¿™éå¸¸æ£’ã€‚

æŸ¥çœ‹ [MojiScript](https://github.com/joelnet/MojiScript) ã€‚æŒºç‰›é€¼çš„ï¼[è·³ä¸Š MojiScript Discord èŠå¤©å®¤ï¼Œæ‰“ä¸ªæ‹›å‘¼å§ï¼](https://discord.gg/Gg7ptD5)

æˆ‘çš„æ–‡ç« æ˜¯éå¸¸å®ç”¨çš„ JavaScriptï¼Œå¦‚æœä½ éœ€è¦æ›´å¤šçš„ FPï¼Œåœ¨è¿™é‡Œå…³æ³¨æˆ‘ï¼Œæˆ–è€…åœ¨ Twitter [@joelnet](https://twitter.com/joelnet) ï¼

[![Cheers!](../Images/661c03d25961a6e3b1ecbe00d148b35a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PqqJmrxK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/6jsy3a866frzp3u5oda0.jpg)