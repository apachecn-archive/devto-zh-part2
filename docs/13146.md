# 基本身份验证、SAML、密钥、OAuth、JWT 和令牌快速

> 原文:[https://dev.to/tomerbendavid/my-security-notes-37fh](https://dev.to/tomerbendavid/my-security-notes-37fh)

这是我上周学到的安全知识。

如果有人在半夜叫醒我，告诉我休斯顿我们有一个关于`SAML`的问题，并且我认为 SAML 就像我最近的梦里的 kreons 的飞船一样，我会打开这张纸条，发现**实际上是一个认证和授权机制，而不是 kreon 飞船。或许是吧？；))**。下面就让我们一起来挖掘一下吧！

安全是其中一个话题，你会有太多的术语出现，以至于你感觉需要一本 T2 安全词典。下面是安全性方面的一些主要术语和概念。

**注意！你已经知道什么是安全，你只需要把那些吓人的术语和你在现实生活中已经知道的安全联系起来！**

## [](#wake-up-now-what-is-saml)醒醒！现在什么是 SAML！

安全性主要是关于正确性。您希望确定与您交谈人/服务是谁(**认证**)。并且您希望验证该个人服务只做它被允许做的事情。(**授权**

我们将快速浏览以下术语:

```
1\. Basic Authentication => When mama and papa thought about security.
2\. SAML => When large corporates thought about security.
3\. OAuth 2.0 => The foster child of mama, papa, and large corporates.
4\. JWT => The startup kid buying a coffee paying with json
5\. Tokens => Trading sheep for online services.
6\. Authorization Bearer: <token> => The all mighty header.
7\. Keys and $$$ => Give me the bottom line how do I make $$$ out of security. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#basic-authentication)基本认证

这是最基本的。你向那个用户或者服务要一些只有他自己知道的东西来证明他的身份。我们使用用户名和密码。

## [](#authorization-basic-base64userpass)授权:基本 Base64(用户，通过)

基本认证并没有指定你需要加密的细节，你只需要对它们进行 base64。所以是明文。

### [](#cleartext-use-https-for-encryption)明文！使用 https 进行加密

但由于它是明文，你需要加密，否则任何人在网上或任何人访问服务都可以看到你的凭证。所以你用加密，https。

# [收集](#saml)

我们完成了 1 号协议基本认证。2 号协议`SAML`。(安全断言标记语言)。

## [](#authentication-and-authorization)认证和授权

想想看，如果它是另一种身份验证协议(像基本身份验证)，但它也支持授权。也就是说它还会告诉你可以做什么。

## [](#xml)XML

SAML 起源于 XML 为王的时代，所以 SAML 协议使用 XML 传递凭证和授权数据并不奇怪。

## [](#parties)当事人

在 SAML 中，我们有两个政党。

1.  你可以从服务供应商那里买一杯咖啡。
2.  身份提供者，你向身份提供者证明你是谁，这与买一杯咖啡，即使它闻起来真的很好喝，有很大的不同！

### [](#service-provider)服务商

这是一家杂货店，它感兴趣的是向我出售食品，而不是身份管理，因此它将使用身份提供者来识别我，以便对我进行授权和认证。

### [](#identity-provider)身份提供者

身份提供者完全是关于管理身份以及允许他们做什么。

### [](#provides-standard-sso)提供标准的单点登录

SAML 提供了标准的`SingleSignOn`,所以你可以使用相同的身份登录多个网站，这很酷，就像你使用谷歌登录不同的服务一样，只是这次是 SAML 协议。你看，你已经知道 SAML 是什么了。

### [](#authentication-exchanged-with-digitally-signed-xml)用数字签名的 XML 交换认证

通过数字签名，这意味着我们可以证明是谁签署了您的认证数据。

### [](#complex)复杂

最后，SAML 比 OAuth 2.0 等现代 SSO 方法更复杂。那么让我们继续前进到 OAuth 2.0，不是吗？

# [](#oauth-20)OAuth 2.0

**你问的 1.0 呢？**它变得更加复杂，所以我们迁移到了 2.0，在那里我们需要为我们的授权做更少的操作

## [](#not-authentication)未认证

**我重申 oauth2.0 不是一个认证协议**它是关于授权的。然而，这并不意味着我们不使用 OAuth 进行认证， **OpenId** 是 OAuth2.0 之上的一个协议，用于认证。

## [](#authorization)授权

您使用 oauth2.0 来允许服务检查您或服务是否被授权执行操作。

## [](#http)HTTP

OAuth 不在内部加密任何东西，它不要求您这样做，它不强制您使用 https 或其他加密机制，但您可能会发现自己在使用这些机制，但请记住，协议本身没有内置 https 或加密。

## [](#tokens-are-the-new-credentials)令牌是新的凭证

记得凭证吗？用户名/密码？忘了它们吧，我们现在用代币代替。这是一样的，你有一些像你的用户名一样的密钥，你有一些像你的密码一样的秘密密钥，**说令牌不说用户名密码，虽然它是非常相同的**。

## [](#change-from-10-no-need-to-sign-each-call)从 1.0 开始改变无需每次通话签名

在 OAuth1.0 中，你需要签名。oauth 2.0 用提供给你的令牌简化了这个过程——你只需传递这个令牌，不需要签名。

## [](#access-token-andor-refresh-token)访问令牌和“或”刷新令牌

您使用访问令牌和/或刷新令牌来续订您的访问令牌。服务

### [](#getaccesstokenrefreshtoken)getAccessToken(refreshToken)

因此，要获得新的访问令牌，您只需调用 getAccessToken，并输入刷新令牌，以获得新的访问令牌来访问服务。

## [](#authorization-bearer)授权:无记名

在基本身份验证 OAuth 中，无论您走到哪里，都会看到这个头:

`Authorization: Bearer <access token>`

你只需**总是**使用这个头来访问你的服务。

## [](#jwt)JWT

这是镇上新来的小孩，每个人都认为他很可爱！为什么会这样？因为这个伟大的新发明:

你不仅在安全数据中加入认证授权，还加入了一些真实的数据！例如**“我可以得到一杯免费的咖啡！—**一个说法。这是 21 世纪最伟大的发明之一(或者不是:)。

### OAuth 2.0 的扩展

JWT 只是 OAuth 2.0 的扩展，所以它就像一个被收养的孩子。

#### [](#access-token-with-claims)访问令牌与声明

因此，你可以向 JWT 说明，你可以得到一杯免费咖啡，这是“令人兴奋”的索赔部分。

#### [](#authorization-bearer)授权:无记名

是啊，我们又用上了无聊的`Authorization: Bearer <JWT>`

##### [](#header-payload-signature)报头、有效载荷、签名

你在 JWT 有三个角色

1.  标题(元数据)
2.  有效载荷(咖啡)
3.  签名(是我)

#### [](#hmacsha256)HMAC-SHA256

这是用于散列消息的协议。

##### [](#hash-with-the-secret-key-to-compute-the-signature)用密钥散列来计算签名

用秘密密钥产生签名的 HMAC 散列法。

### [](#stateless-data-api-data-repassed-from-client)从客户端重新传递的无状态数据 api 数据

**所以 JWT 是一个无国籍的地方，你可以把数据从这里传到那里，然后再传回来，这些都在 JWT 里**

#### [](#instead-of-the-traditional-session-on-the-server)代替服务器上的传统会话

您在 JWT 中传递数据，因此不需要在服务器中存储数据。

### [](#usage)用法

我们用 JWT 做什么？

#### [](#authentication)认证

我们用它来认证；)

#### [](#secure-information-exchange)安全信息交换

我们用它来传递安全信息！

##### [](#signed-with-publicprivate-keys-verify-content-has-not-tampered)用公钥/私钥签名验证内容未被篡改

这是因为我们签署了数据，所以我们知道它没有被篡改！

# [](#api-keys)API 键

**机器的用户名密码**。比如比特币到美元。

## [](#identify-callerapplication)识别呼叫者/应用程序

您可以识别谁是调用者应用程序，因为您为每个调用者提供了自己的键。

## [](#monetize-api)货币化 API

现在你知道是谁给你打电话了——你可以向他收取使用你的 api 的费用！(他用 API 密匙访问你，他应该为此付出代价)。

# [](#resources)资源

[https://tomer-Ben-David . github . io](https://tomer-ben-david.github.io)