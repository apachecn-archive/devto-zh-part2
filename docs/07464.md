# å®æ–½ä¸šåŠ¡éœ€æ±‚çš„ä¸åŒè¯­æ³•

> åŸæ–‡:[https://dev . to/shal vah/a-different-syntax-for-enforced-business-requirements-28ba](https://dev.to/shalvah/a-different-syntax-for-enforcing-business-requirements-28ba)

æ‚¨æ˜¯å¦æ›¾ç»ä¸å¾—ä¸åœ¨å¤šç§æ¡ä»¶ä¸‹å®ç°ä¸€äº›æ£˜æ‰‹çš„ä¸šåŠ¡éœ€æ±‚ï¼Ÿæœ‰æ—¶å€™ï¼Œéœ€æ±‚å¯èƒ½å¾ˆå®¹æ˜“ç”¨äººç±»è¯­è¨€æ¥è¡¨è¾¾ï¼Œä½†æ˜¯å½“æ¶‰åŠåˆ°ä»£ç æ—¶ï¼Œä½ å°±å¾ˆéš¾ç”¨ä¸€ç§å…¶ä»–äººå®¹æ˜“ç†è§£çš„æ–¹å¼æ¥è¡¨è¾¾ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªè™šæ‹Ÿçš„å­¦æ ¡é—¨æˆ·ç½‘ç«™ï¼Œå­¦ç”Ÿå¯ä»¥åœ¨é‚£é‡Œç”³è¯·ç»æµæ´åŠ©ã€‚ä½ æœ‰ä¸€ä¸ªè¦æ±‚:

> ç»©ç‚¹ä½äº 2.0 çš„å­¦ç”Ÿä¸åº”è¯¥è¢«å…è®¸ç”³è¯·ï¼Œé™¤éä»–ä»¬æ˜¯æœ€åä¸€å¹´æˆ–è€…æœ‰å¥åº·é—®é¢˜ã€‚

ä½ å¯ä»¥è¿™æ ·å†™:

```
if ($student->hasGpaLessThan(2.0)) {
    if (!$student->isInFinalYear() || !$student->hasMedicalCondition()) {
        throw new BadRequestException("We can't provide you with aid right now.")
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹é¢æ˜¯å¦ä¸€ç§æ–¹å¼:

```
if ($student->hasGpaLessThan(2.0) 
    && (!$student->isInFinalYear() || !$student->hasMedicalCondition())
) {
    throw new BadRequestException("We can't provide you with aid right now.");
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ å¯ä»¥è¿™æ ·å†™å‘¢ï¼Ÿ

```
when($student->hasGpaLessThan(2.0))
    ->ensure($student->isInFinalYear() || $student->hasMedicalCondition())
    ->orElseDeny("We can't provide you with aid right now.") 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘æƒ³ä½ ä¼šåŒæ„æˆ‘çš„è§‚ç‚¹ï¼Œç¬¬ä¸‰ä¸ªç‰ˆæœ¬æ˜¯æœ€å®¹æ˜“ç†è§£çš„ï¼Œå¹¶ä¸”æ›´æ¥è¿‘éœ€æ±‚çš„æªè¾ã€‚å®ƒä¹Ÿæ¯”å‰ä¸¤ä¸ªæ›´ä¸å®¹æ˜“å‡ºé”™ã€‚

å†ä¸¾ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ç¬¬äºŒä¸ªéœ€æ±‚:

> å­¦ç”Ÿåªæœ‰åœ¨å­¦ä¹ ä¸€é—¨ç¬¦åˆèµ„åŠ©æ¡ä»¶çš„è¯¾ç¨‹æˆ–è€…ä»–ä»¬æœ‰æ ¡é•¿çš„ä¿¡æ—¶æ‰å¯ä»¥ç”³è¯·èµ„åŠ©ã€‚

*(æ— è§†æˆ‘ä»¬ç–¯ç‹‚çš„è§„åˆ™ï¼›è¿™æ˜¯ä¸€æ‰€è™šæ„çš„å­¦æ ¡ğŸ¤­)*

è¿™èƒ½è¡Œ:

```
if (!$student->isStudyingEligibleCourse() && !$student->hasPresidentsLetter()) {
    throw new BadRequestException("Sorry, no aid for you.");
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½¿ç”¨æˆ‘ä»¬çš„`ensure`è¯­æ³•ï¼Œè¿™å°†æ˜¯:

```
ensure($student->isStudyingEligibleCourse() || $student->hasPresidentsLetter())
    ->orElseDeny("Sorry, no aid for you."); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸¤ç§è¯­æ³•éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œç¬¬äºŒç§æ›´å®¹æ˜“ç†è§£ã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæˆ‘å¹¶ä¸æ‰“ç®—é‡æ–°å‘æ˜æˆ–æ¶ˆé™¤`if` sï¼Œæˆ‘åªæ˜¯ç›¸ä¿¡åœ¨æŸäº›æƒ…å†µä¸‹ä½¿ç”¨`when...ensure...orElseDeny`ä¼šæ›´æœ‰è¡¨ç°åŠ›ã€‚æˆ‘ä¹Ÿæƒ³å¬å¬ä½ çš„æƒ³æ³•ã€‚

å¦‚æœä½ å–œæ¬¢è¿™ä¸ªè¯­æ³•ï¼Œæˆ‘æŠŠå®ƒåšæˆ[ä¸€ä¸ªåŒ…](https://github.com/shalvah/ensure)ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡è¿è¡Œ`composer require shalvah/ensure`åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨å®ƒã€‚å¦‚æœè§‰å¾—æœ‰ç”¨è¯·æ˜æ˜Ÿåˆ†äº«ï¼