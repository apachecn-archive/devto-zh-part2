# å‘è¡Œ umi 2.0 -ä¸€ä¸ªå¯æ’å…¥çš„ä¼ä¸šçº§ react åº”ç”¨ç¨‹åºæ¡†æ¶

> åŸæ–‡:[https://dev.to/sorrycc/release-umi-20-å¯æ’æ‹”-ä¼ä¸šçº§-ååº”-åº”ç”¨-æ¡†æ¶-2dl3](https://dev.to/sorrycc/release-umi-20----a-pluggable-enterprise-level-react-application-framework-2dl3)

[![](../Images/82039c1a1c58e33eb9bc812de6739dee.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--fp9g1X9---/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://gw.alipayobjects.com/zos/rmsportal/CZcJsXOXCqIbglBjTrWs.png)

[https://ä½ç½®. org/](https://umijs.org/)

è·ç¦» [umi 1.0 å‘å¸ƒ](https://github.com/sorrycc/blog/issues/64)å·²ç»è¿‡å»åŠå¹´äº†ã€‚è¿™æ®µæ—¶é—´ umi åšäº†å¾ˆå¤šé‡æ„å’Œæ”¹è¿›ï¼Œ438 æ¬¡æäº¤ï¼Œ20 ä¸ª beta ç‰ˆæœ¬ã€‚è€Œä»Šå¤©ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´åœ°çœ‹åˆ° **it å‘å¸ƒäº† 2.0 ç‰ˆæœ¬**ï¼Œå¹¶é‡æ–°å®šä½ä¸º**ä¸€ä¸ªå¯æ’æ‹”çš„ä¼ä¸šçº§ react åº”ç”¨æ¡†æ¶**ã€‚

## umi æ˜¯ä»€ä¹ˆï¼Ÿ

å®ƒåŸºäºè·¯ç”±ï¼Œæ”¯æŒ [next.js ç±»å¸¸è§„è·¯ç”±](https://umijs.org/guide/router.html)ï¼Œä»¥åŠå„ç§é«˜çº§è·¯ç”±åŠŸèƒ½ï¼Œå¦‚[è·¯ç”±çº§æŒ‰éœ€åŠ è½½](https://umijs.org/en/plugin/umi-plugin-react.html#dynamicimport)ã€‚ç„¶åæœ‰äº†ä¸€ä¸ªå®Œæ•´çš„[æ’ä»¶ç³»ç»Ÿ](https://umijs.org/plugin/)ï¼Œè¦†ç›–äº†ä»æºä»£ç åˆ°æ„å»ºäº§å“çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œumi èƒ½å¤Ÿæ”¯æŒå„ç§åŠŸèƒ½æ‰©å±•å’Œä¸šåŠ¡éœ€æ±‚ï¼Œç›®å‰ umi åœ¨ç¤¾åŒºå’Œå…¬å¸å†…éƒ¨æœ‰å°†è¿‘ 50 å¤šä¸ªæ’ä»¶ã€‚

umi æ˜¯[èš‚èšé‡‘æœ](https://www.antfin.com/)çš„åŸºç¡€å‰ç«¯æ¡†æ¶ï¼Œå·²ç»ç›´æ¥æˆ–é—´æ¥æœåŠ¡äº† 600+ä¸ªåº”ç”¨ï¼ŒåŒ…æ‹¬ javaã€nodeã€ç§»åŠ¨ appã€æ··åˆ appã€çº¯å‰ç«¯èµ„äº§ appã€CMS app ç­‰ç­‰ã€‚umi å·²ç»å¾ˆå¥½åœ°æœåŠ¡äº†æˆ‘ä»¬çš„å†…éƒ¨ç”¨æˆ·ï¼Œå¸Œæœ›ä»–ä¹Ÿèƒ½å¾ˆå¥½åœ°æœåŠ¡å¤–éƒ¨ç”¨æˆ·ã€‚

å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:

*   ğŸ“¦**å¼€ç®±å³ç”¨**ï¼Œå†…ç½® reactã€react-router ç­‰
*   ğŸˆ **Next.js like å’Œ[å…¨åŠŸèƒ½](https://umijs.org/guide/router.html)è·¯ç”±çº¦å®š**ï¼Œä¹Ÿæ”¯æŒé…ç½®è·¯ç”±
*   ğŸ‰**å®Œæ•´çš„æ’ä»¶ç³»ç»Ÿ**ï¼Œè¦†ç›–ä»æºä»£ç åˆ°äº§å“çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸ
*   ğŸš€**é«˜æ€§èƒ½**ï¼Œé€šè¿‡æ’ä»¶æ”¯æŒ PWAã€è·¯ç”±çº§ä»£ç æ‹†åˆ†ç­‰
*   ğŸ’ˆ**æ”¯æŒé™æ€å¯¼å‡º**ï¼Œé€‚åº”å„ç§ç¯å¢ƒï¼Œå¦‚ä¸»æœº appã€æ‰‹æœº appã€[å½©è›‹](https://github.com/eggjs/egg)ã€æ”¯ä»˜å®é’±åŒ…ç­‰
*   ğŸš„**å¿«é€Ÿå¼€å‘å¯åŠ¨**ï¼Œæ”¯æŒå¯ç”¨ [dll](https://umijs.org/plugin/umi-plugin-react.html#dll) å’Œ[hard-source-web pack-plugin](https://umijs.org/plugin/umi-plugin-react.html#hardSource)å¸¦é…ç½®
*   ğŸ **å…¼å®¹ IE9** ï¼ŒåŸºäº [umi-plugin-polyfills](https://umijs.org/plugin/umi-plugin-react.html#polyfills)
*   ğŸ**æ”¯æŒæ‰“å­—ç¨¿**ï¼ŒåŒ…æ‹¬ d.ts å®šä¹‰å’Œ`umi test`
*   ğŸŒ´**ä¸[dva](https://dvajs.com/)T3ã€‘æ·±åº¦é›†æˆï¼Œæ”¯æŒ duck ç›®å½•ã€æ¨¡å‹è‡ªåŠ¨åŠ è½½ã€ä»£ç æ‹†åˆ†ç­‰**

## 2.0 æœ‰ä»€ä¹ˆæ–°åŠŸèƒ½ï¼Ÿ

### [](#light-core-and-beginner-friendly)è½»èŠ¯ï¼Œåˆå­¦è€…å‹å¥½

umi@1 å†…ç½®äº†å¾ˆå¤šä¼˜åŒ–ï¼Œæ¯”å¦‚æŒ‰éœ€ç¼–è¯‘ã€æŒ‰éœ€åŠ è½½ã€eslintã€pwaã€antd ç­‰ã€‚è¿™äº›è§£å†³æ–¹æ¡ˆå¯ä»¥æ”¹å–„å¼€å‘ä½“éªŒå’Œç”Ÿäº§ä»£ç ï¼Œè¿˜å¯ä»¥æé«˜å­¦ä¹  umi çš„æˆæœ¬ã€‚

æ‰€ä»¥ umi@2 é»˜è®¤å…³é—­äº†å¾ˆå¤šä¼˜åŒ–:

*   æŒ‰éœ€ç¼–è¯‘
*   æŒ‰éœ€åŠ è½½
*   æœåŠ¡äººå‘˜
*   antd
*   ...

è¿™äº›ç‰¹æ€§ç”±æ’ä»¶å®ç°ï¼Œæ’ä»¶å¯ä»¥æ ¹æ®éœ€è¦æ‰“å¼€ï¼Œä»¥ç¡®ä¿ umi å†…æ ¸çš„è½»é‡çº§ã€‚åŒæ—¶ï¼Œé»˜è®¤æ„å»ºåªç”Ÿæˆ index.htmlã€umi.js å’Œ umi.cssï¼Œå¯¹åˆå­¦è€…æ›´å‹å¥½ã€‚

### [](#new-plugin-system)æ–°å¢å¤–æŒ‚ç³»ç»Ÿ

umi@1 çš„æ’ä»¶ç³»ç»Ÿæœ‰ç‚¹å¤ªå¼ºå¤§äº†ï¼Œä»€ä¹ˆéƒ½å¯ä»¥åšï¼Œéƒ½å¯ä»¥ä¿®æ”¹ã€‚äºæ˜¯ umi@2 é‡æ„äº†æ’ä»¶æœºåˆ¶ï¼Œ**åšäº†å¾ˆå¤šçº¦æŸï¼Œæ˜ç¡®äº†ä»€ä¹ˆèƒ½åšï¼Œä»€ä¹ˆä¸èƒ½åšï¼Œ**å¹¶æä¾›äº†æ›´å‹å¥½çš„[æ’ä»¶ API](https://umijs.org/plugin/develop.html) ã€‚

åŒæ—¶ï¼Œè¿™ä¸ªæ’ä»¶ç³»ç»Ÿå·²ç»åœ¨æˆ‘ä»¬å…¬å¸å†…éƒ¨å¾—åˆ°äº†éªŒè¯ã€‚ç”± 30 å¤šä¸ªæ’ä»¶ç»„æˆçš„ä¼˜ç§€å†…éƒ¨æ¡†æ¶ Bigfish å¾ˆå¥½åœ°æœåŠ¡äº†èš‚èšé‡‘æœï¼ŒåŒ…æ‹¬ baconã€ç”¨ java/node éƒ¨ç½²ã€æ€§èƒ½ã€æœåŠ¡é›†æˆã€æƒé™ç­‰åŠŸèƒ½ã€‚

### [](#umipluginreact)umi æ’ä»¶è¯•å‰‚

umi@1 çš„æ’ä»¶æœ‰ç‚¹æ¾ã€‚ä½¿ç”¨ umi æ—¶é€šå¸¸éœ€è¦å®‰è£…å¤šä¸ªæ’ä»¶ã€‚å‡çº§ä½¿ç”¨æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬æä¾› umi-plugin-reactã€‚umi-plugin-react æ˜¯ä¸€ä¸ªæ’ä»¶çš„é›†åˆï¼Œç±»ä¼¼äºå·´åˆ«å¡”ä¸­é¢„ç½®çš„æ¦‚å¿µã€‚

ç›®å‰ï¼Œumi-plugin-react ä¸­æœ‰ 13 ä¸ªæ’ä»¶ï¼ŒåŒ…æ‹¬:

*   Dva é›†æˆ
*   Antd é›†æˆ
*   è·¯çº¿ä¿®æ”¹
*   IE(9/10/11)å…¼å®¹æ€§
*   å¸¸è§„ i18n æº¶æ¶²
*   å¼€å…³å¯¹ preact æˆ–å…¶ä»–åº“ä½œå‡ºååº”
*   è·¯ç”±çº§ä»£ç æ‹†åˆ†ï¼Œçº§åˆ«å¯å®šåˆ¶
*   ä½¿ç”¨ dll æå‡å¼€å‘
*   ä½¿ç”¨[hard-source-web pack-plugin](https://github.com/mzgoddard/hard-source-webpack-plugin)å¢å¼ºå¼€å‘
*   å¯ç”¨ PWA
*   å¯ç”¨é«˜æ¸…è§£å†³æ–¹æ¡ˆ
*   å¯ç”¨å¿«é€Ÿç‚¹å‡»
*   æ”¯æŒæ ‡é¢˜ç¡®è®¤

è¯¦æƒ…è¯·æŸ¥çœ‹ https://umijs.org/plugin/umi-plugin-react.htmlã€‚

### [](#webpack4-babel7-)[webpack@4](https://medium.com/webpack/webpack-4-released-today-6cdb994702d4) + [å·´åˆ«å¡”@7](https://babeljs.io/blog/2018/08/27/7.0.0) +...

æˆ‘ä»¬æŠŠä¸»è¦çš„ä¾èµ–é¡¹å‡çº§åˆ°äº†æœ€æ–°çš„ï¼Œæ¯”å¦‚ webpack@4ï¼Œbabel@7ï¼Œless@3ï¼Œpostcss@7ï¼Œtypescript@3 ç­‰ã€‚ï¼Œä»¥åŠç›¸å…³çš„æ„å»ºæ€§èƒ½æ”¹è¿›ã€‚

å¹¶ä¸”ï¼Œæˆ‘ä»¬ä½¿ç”¨ [webpack-chain](https://github.com/mozilla-neutrino/webpack-chain) æ¥æ‰©å±• webpack é…ç½®ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”ä¹‹å‰çš„`webpack.config.js`æ›´ç¨³å®šçš„è§£å†³æ–¹æ¡ˆã€‚

ä¾‹å¦‚

```
export default {
  chainWebpack(config, { webpack }) {
    // Set alias
    config.resolve.alias.set('a', 'path/to/a');

    // Remove the default progress bar
    config.plugins.delete('progress');
  },
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#-raw-umi-generate-endraw-)`umi generate`

umi@2 æ”¯æŒ`umi generate`(åˆ«å`umi g`)å‘½ä»¤å¿«é€Ÿç”Ÿæˆæ–‡ä»¶ã€‚

```
$ umi g page index 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶ä¸”ï¼Œ`umi generate`æ˜¯å¯æ‰©å±•çš„ã€‚ä¾‹å¦‚ï¼Œumi-plugin-dva æ‰©å±•äº†é”®`dva:model`ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨`umi g dva:model global`ç”Ÿæˆ dva çš„æ¨¡å‹ã€‚

### [](#other-improvements)å…¶ä»–æ”¹è¿›

*   é€šè¿‡`.env`å’Œ`.env.local`é…ç½®ç¯å¢ƒå˜é‡
*   æ”¯æŒé€šè¿‡`yaml`æ ¼å¼çš„æ³¨é‡Šæ‰©å±•ä¼ ç»Ÿè·¯ç”±çš„è·¯ç”±ä¿¡æ¯
*   æ”¹è¿›çš„ umi å¼€å‘ 404 é¡µé¢
*   ç”¨ react-loadable é‡æ„`umi/dynamic`
*   æ”¹è¿›`umi test`ï¼Œå…è®¸æ‚¨æŒ‡å®šæµ‹è¯•æ–‡ä»¶ï¼Œå¹¶å°†å‚æ•°ä¼ é€’ç»™ jest-cli
*   æ”¹è¿›`umi test`ï¼Œæ”¯æŒ webpack åˆ«å
*   æ”¹è¿›`umi dev`ï¼Œæ”¯æŒé…ç½® https è¯ä¹¦
*   æ”¹è¿›`umi dev`ï¼Œè¿›è¡Œæ ·å¼æå–ï¼Œç„¶åä½¿ç”¨ css-hot-loader è¿›è¡Œçƒ­æ›´æ–°ï¼Œä¸`umi build`ä¸€è‡´
*   é»˜è®¤å¯ç”¨ [es5ImcompatibleVersions](https://github.com/umijs/es5-imcompatible-versions)
*   åˆ é™¤å¤§æ€§èƒ½æ¶ˆè´¹è€…åŒºåˆ†å¤§å°å†™è·¯å¾„ webpack æ’ä»¶
*   æ·»åŠ æŒ‡å‘`src`ç›®å½•çš„ webpack åˆ«å`@`
*   å¦‚æœæ‰¾åˆ°ï¼Œä½¿ç”¨æœ¬åœ° umi è¿è¡Œ

## [](#getting-started)å…¥é—¨

å…¥é—¨å¾ˆå®¹æ˜“ï¼Œ

```
# Install deps
$ yarn global add umi # OR npm install -g umi

# Create application
$ mkdir myapp && cd myapp

# Create page
$ umi generate page index

# Start dev server
$ umi dev

# Build and deploy
$ umi build 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æŸ¥çœ‹[https://umijs.org/guide/getting-started.html](https://umijs.org/guide/getting-started.html)äº†è§£æ›´å¤šç»†èŠ‚ï¼Œæˆ–è€…è§‚çœ‹ [10 åˆ†é’Ÿå…¥å¢ƒ umi è§†é¢‘ç‰ˆ](https://www.youtube.com/watch?v=vkAUGUlYm24)ã€‚

## [](#migrate-from-umi1)ä» umi@1 è¿ç§»

ç›®å‰ï¼Œ [antd-pro](https://github.com/ant-design/ant-design-pro) å’Œ [antd-admin](https://github.com/zuiidea/antd-admin) å·²ç»å‡çº§ä¸º [umi@2](mailto:umi@2) ã€‚å¦‚æœè¦å‡çº§ï¼Œè¯·æŸ¥çœ‹[æ–‡æ¡£](https://umijs.org/guide/migration.html)æˆ–[è§†é¢‘](https://youtu.be/1mvKzFLLBck)ã€‚

## [](#community)ç¤¾åŒº

### [](#telegram-group)ç”µæŠ¥ç»„

[https://t.me/joinchat/G0DdHw-44FO7Izt4K1lLFQ](https://t.me/joinchat/G0DdHw-44FO7Izt4K1lLFQ)

## [](#at-last)ç»ˆäº

æ„Ÿè°¢æ‰€æœ‰å‚ä¸è´¡çŒ® umi å’Œåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ umi çš„å†…éƒ¨å’Œå¤–éƒ¨äººå‘˜ã€‚umi æ‰åˆšåˆšèµ·æ­¥ï¼Œå¸Œæœ›å¤§å®¶ä¸€èµ·æé«˜ï¼ŒGithub è§ï¼ğŸ‘‹