# è¶…è¶Šç®€å•çš„è®°å¿†

> åŸæ–‡:[https://dev.to/alyson/simple-memorization-beyond-17b7](https://dev.to/alyson/simple-memorization-beyond-17b7)

[æœ¬æ¬¡å›è´­](https://github.com/shtakai/simple-smile)

[æ¥è‡ªä¸Šä¸€ç¯‡](https://dev.to/alyson/simple-memorization-36ic)ï¼Œ
æœ‰é—®é¢˜ã€‚`memorization on falsy case.`

è°¢è°¢ [@jakebman](https://dev.to/jakebman) ã€‚:)

æˆ‘æ”¹äº†ä»£ç ã€‚

```
clas Smile
  SmileError = Class.new(StandardError)

  attr_accessor :smile

  # @smile is false on initialization.
  def initialize
    @smile = false
  end

  def ensmile(cry: false)
    @smile ||= begin
      puts 'memorize start'
      raise SmileError if cry
      puts 'memorize success'
      "SMILE"
    rescue SmileError
      puts 'memorize fail'
      "CRY"
    end
  end
end

(spec file is same) 
```

Enter fullscreen mode Exit fullscreen mode

åˆè·‘äº†`rspec`

```
FF

Failures:

 1) Smile#ensmile returns "SMILE"
 Failure/Error: expect(smile.smile).to be_nil

       expected: nil
            got: false #  ./spec/smile_spec.rb:8:in `block (3 levels) in <top (required)>'   2) Smile#ensmile returns "CRY"
 Failure/Error: expect(smile.smile).to be_nil

       expected: nil
            got: false #  ./spec/smile_spec.rb:14:in `block (3 levels) in <top (required)>'  Finished in 0.04088 seconds (files took 0.48848 seconds to load)
2 examples, 2 failures

Failed examples: rspec ./spec/smile_spec.rb:7 #  Smile#ensmile returns "SMILE"
rspec ./spec/smile_spec.rb:13 #  Smile#ensmile returns "CRY" 
```

Enter fullscreen mode Exit fullscreen mode

è¿˜å¥½æ˜¯å› ä¸ºåˆå§‹åŒ–åçš„`false`ã€‚
åªéœ€ä¿®å¤è§„èŒƒæ–‡ä»¶ã€‚

```
-------- a/spec/smile_spec.rb
+++ b/spec/smile_spec.rb
@@ -5,13 +5,13 @@ RSpec.describe Smile do
   let(:smile) { described_class.new }
   describe '#ensmile' do
     it 'returns "SMILE"' do
-      expect(smile.smile).to be_nil
+      expect(smile.smile).to be_falsy
       expect(smile.ensmile).to eq 'SMILE'
       expect(smile.smile).to eq 'SMILE'
     end

     it 'returns "CRY"' do
-      expect(smile.smile).to be_nil
+      expect(smile.smile).to be_falsy
       expect(smile.ensmile(cry: true)).to eq 'CRY'
       expect(smile.smile).to eq 'CRY'
     end 
```

Enter fullscreen mode Exit fullscreen mode

ç„¶åé‡æ–°è·‘äº†`rspec`ã€‚

```
Finished in 0.00841 seconds (files took 0.4119 seconds to load)
2 examples, 0 failures 
```

Enter fullscreen mode Exit fullscreen mode

å¥½å§ã€‚å»çœ‹çœ‹æ’¬ä¸æ’¬ã€‚

```
1) nil
2.4.0 (main):0 > a=nil
=> nil
2.4.0 (main):0 > a ||= 'cat'
=> "cat"
2.4.0 (main):0 > a
=> "cat"

b) false
2.4.0 (main):0 > b=false
=> false
2.4.0 (main):0 > b ||= 'dog'
=> "dog"
2.4.0 (main):0 > b
=> "dog"

3) already set to Object something
2.4.0 (main):0 > r='roo tiger'
=> "roo tiger"
2.4.0 (main):0 > r ||= 'nwo'
=> "roo tiger"
2.4.0 (main):0 > r
=> "roo tiger" 
```

Enter fullscreen mode Exit fullscreen mode

å¦‚æœæˆ‘æƒ³è®©`false`ä¿æŒåˆå§‹åŒ–ï¼Œå®ƒä¸èµ·ä½œç”¨....ğŸ˜¢

è’‚å°”:ä¸è¦åœ¨è™šå‡çš„æƒ…å†µä¸‹åšï¼Œä¹Ÿä¸è¦åœ¨å®¶é‡Œåšã€‚