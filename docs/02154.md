# å¦‚ä½•ä» React with Twilio å‘é€çŸ­ä¿¡

> åŸæ–‡:[https://dev . to/twilio/how-to-send-an-SMS-from-react-with-twilio-18gn](https://dev.to/twilio/how-to-send-an-sms-from-react-with-twilio-18gn)

æˆ‘ä»¬ç»å¸¸è°ˆè®ºä» web åº”ç”¨ç¨‹åºå‘é€ [SMS æ¶ˆæ¯ï¼Œä½†æ˜¯ä» React åº”ç”¨ç¨‹åºå‘é€ SMS æ¶ˆæ¯å‘¢ï¼Ÿé™¤äº†æœåŠ¡å™¨ç«¯ç‰ˆæœ¬](https://www.twilio.com/docs/sms/send-messages)çš„[ä¹‹å¤–ï¼Œè¿˜æœ‰æ›´å¤šä¸œè¥¿ï¼Œä½†è¿™ä¸ä¼šèŠ±æˆ‘ä»¬å¤ªå¤šæ—¶é—´ã€‚](https://www.twilio.com/blog/2016/04/send-text-in-javascript-node-in-30-seconds.html)

### ä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ REST APIï¼Ÿ

ä»æŠ€æœ¯ä¸Šè®²ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Twilio REST API ç›´æ¥ä» JavaScript å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå‘é€çŸ­ä¿¡ã€‚ä½†æ˜¯(è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„â€œä½†æ˜¯â€)å¦‚æœä½ è¿™æ ·åšï¼Œä½ å°†ä¼šæŠŠä½ çš„ Twilio è¯ä¹¦æš´éœ²ç»™ä»»ä½•ä½¿ç”¨ä½ çš„ç«™ç‚¹çš„äººã€‚ç„¶åï¼Œæ¶æ„ç”¨æˆ·å¯èƒ½ä¼šè·å–è¿™äº›å‡­æ®å¹¶æ»¥ç”¨å®ƒä»¬ï¼Œä»è€Œåœ¨æ‚¨çš„å¸æˆ·ä¸­ç´¯ç§¯å·¨é¢è´¦å•ã€‚

[![An animation showing a fake hacker, with a balaclava and extra hands.](../Images/ebec63a6388cd5d5614586a066e6063d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--VHFNtzkU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/WU8JMLBGyKsTCY1u_Qa7mPji5mpT1SqxmgsO3eCJSN77kn.width-800.gif)

*ä½¿ç”¨æ‚¨çš„å¸æˆ·å‡­è¯å®æ—¶æŸ¥çœ‹é»‘å®¢*

ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåç«¯åº”ç”¨ç¨‹åºæ¥å®ç° Twilio REST APIï¼ŒåŒ…è£…æ‚¨çš„å‡­è¯å¹¶ä¸ºæ‚¨å‘é€ SMS æ¶ˆæ¯ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä» React åº”ç”¨ç¨‹åºè°ƒç”¨åç«¯å¹¶å‘é€ SMS æ¶ˆæ¯ï¼Œè€Œæ— éœ€å°†æ‚¨çš„å‡­è¯åˆ†å‘åˆ°äº’è”ç½‘ã€‚

### [](#our-tools)æˆ‘ä»¬çš„å·¥å…·

å¯¹äºä½¿ç”¨ Twilio REST API å‘é€æ–‡æœ¬æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å†…å®¹:

*   å¯ä»¥å‘é€çŸ­ä¿¡çš„ Twilio å¸æˆ·å’Œç”µè¯å·ç (æ‚¨å¯ä»¥[åœ¨æ­¤](https://www.twilio.com/try-twilio)å…è´¹æ³¨å†Œ Twilio å¸æˆ·)
*   æ„å»ºæˆ‘ä»¬çš„ React åº”ç”¨ç¨‹åºå¹¶è¿è¡Œæˆ‘ä»¬çš„æœåŠ¡å™¨(ä½ å¯ä»¥ç”¨ä»»ä½•è¯­è¨€æ„å»ºæœåŠ¡å™¨ç«¯ç»„ä»¶ï¼Œä½†åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ Node ä¸­è¿™æ ·åšï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å…¨éƒ¨ä½¿ç”¨ JavaScript)
*   [React å¼€å‘å·¥å…·](https://github.com/facebook/react-devtools)ç”¨äºæ‚¨çš„æµè§ˆå™¨(å¯é€‰ï¼Œä½†å¯¹æŸ¥çœ‹åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„äº‹æƒ…éå¸¸æœ‰ç”¨

é¦–å…ˆï¼Œä¸‹è½½æˆ–å…‹éš†æˆ‘åœ¨[ä¸Šä¸€ç¯‡åšæ–‡](https://dev.to/twilio/set-up-a-react-app-with-a-nodejs-server-proxy-2pgc)ä¸­æ„å»ºçš„ [react-express-starter åº”ç”¨ç¨‹åº](https://github.com/philnash/react-express-starter)ã€‚

```
git clone https://github.com/philnash/react-express-starter.git 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è½¬åˆ°ç›®å½•å¹¶å®‰è£…ä¾èµ–é¡¹ã€‚

```
cd react-express-starternpm install 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨é¡¹ç›®ç›®å½•ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º`.env` :
çš„æ–‡ä»¶

```
touch .env 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡è¿è¡Œ`npm run dev`æ¥æµ‹è¯•é¡¹ç›®æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚è¯¥åº”ç”¨ç¨‹åºå°†åŠ è½½åˆ°æ‚¨çš„æµè§ˆå™¨ localhost:3000 ä¸­ã€‚

è¿™ä¸ª starter åº”ç”¨ç¨‹åºè¢«è®¾ç½®ä¸ºåœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€ä¸ª React åº”ç”¨ç¨‹åºå’Œä¸€ä¸ª [Express](http://expressjs.com/) åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥åŒæ—¶è¿è¡Œè¿™ä¸¤ä¸ªåº”ç”¨ç¨‹åºã€‚å¦‚æœä½ æƒ³çŸ¥é“è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œçœ‹çœ‹[è¿™ç¯‡åšæ–‡](https://dev.to/twilio/set-up-a-react-app-with-a-nodejs-server-proxy-2pgc)ã€‚

### [](#building-the-serverside)æ„å»ºæœåŠ¡å™¨ç«¯

å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬éœ€è¦ä»æœåŠ¡å™¨è¿›è¡Œ Twilio API è°ƒç”¨ã€‚æˆ‘ä»¬å°†å‘ Express æœåŠ¡å™¨æ·»åŠ ä¸€ä¸ªç«¯ç‚¹ï¼Œå¯ä»¥ä» React åº”ç”¨ç¨‹åºè°ƒç”¨è¯¥ç«¯ç‚¹ã€‚é¦–å…ˆå®‰è£… [Twilio Node.js æ¨¡å—](https://www.npmjs.com/package/twilio)ã€‚æ³¨æ„:å‡ºäºè¿™ä¸ªåº”ç”¨ç¨‹åºçš„ç›®çš„ï¼Œæˆ‘å°†æœåŠ¡å™¨ä¾èµ–é¡¹ä¿å­˜ä¸ºå¼€å‘ä¾èµ–é¡¹ï¼Œä»¥ä¾¿å°†å®ƒä»¬ä¸å®¢æˆ·ç«¯ä¾èµ–é¡¹åˆ†å¼€ã€‚

```
npm install twilio --save-dev 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æˆ‘ä»¬çš„ Twilio å‡­è¯é…ç½®åº”ç”¨ç¨‹åºã€‚ä» [Twilio æ§åˆ¶å°](https://www.twilio.com/console)æ”¶é›†æ‚¨çš„ Twilio å¸æˆ· Sid å’Œèº«ä»½éªŒè¯ä»¤ç‰Œï¼Œä»¥åŠå¯ä»¥å‘é€çŸ­ä¿¡çš„ [Twilio ç”µè¯å·ç ](https://www.twilio.com/console/phone-numbers/incoming)ã€‚å°†è¿™ä¸‰ä¸ªè¾“å…¥åˆ°æ‚¨ä¹‹å‰åˆ›å»ºçš„`.env`æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
TWILIO_ACCOUNT_SID=YOUR_ACCOUNT_SID
TWILIO_AUTH_TOKEN=YOUR_AUTH_TOKEN
TWILIO_PHONE_NUMBER=YOUR_TWILIO_PHONE_NUMBER 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†[åœ¨ç¯å¢ƒ](https://www.twilio.com/blog/2017/08/working-with-environment-variables-in-node-js.html)ä¸­è®¾ç½®æ‚¨çš„å‡­è¯ã€‚ç°åœ¨ï¼Œæ‰“å¼€`server/index.js`ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç¼–å†™å‘é€æ¶ˆæ¯æ‰€éœ€çš„ä»£ç ã€‚åœ¨æ–‡ä»¶é¡¶éƒ¨çš„â€œå…¶ä»–æ¨¡å—è¦æ±‚â€ä¸‹ï¼Œè¦æ±‚å¹¶ä½¿ç”¨ç¯å¢ƒä¸­çš„å‡­è¯åˆå§‹åŒ– Twilio åº“ã€‚

```
const express = require('express');
const bodyParser = require('body-parser');
const pino = require('express-pino-logger')();
const client = require('twilio')(
  process.env.TWILIO_ACCOUNT_SID,
  process.env.TWILIO_AUTH_TOKEN
); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°†æŠŠæ•°æ®å‘é€åˆ°æˆ‘ä»¬æ„å»ºä¸º JSON çš„ç«¯ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿè§£æ JSON ä¸»ä½“ã€‚ç”¨ body parser çš„ JSON è§£æå™¨é…ç½® Express app:

```
const app = express();
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());app.use(pino); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºä¸€ä¸ª`POST`è¯·æ±‚åˆ›å»ºä¸€ä¸ªè·¯ç”±ã€‚åœ¨`/api/greeting`çš„è·¯çº¿ä¸‹å¢åŠ ä»¥ä¸‹å†…å®¹:

```
app.post('/api/messages', (req, res) => {

}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬ä¹Ÿå°†ä½¿ç”¨ JSON è¿›è¡Œå“åº”ï¼Œæ‰€ä»¥å°†`Content-Type`å¤´è®¾ç½®ä¸º`application/json`ã€‚

```
app.post('/api/messages', (req, res) => {
  res.header('Content-Type', 'application/json');

}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶å[æˆ‘ä»¬å°†ä½¿ç”¨ä¹‹å‰åˆå§‹åŒ–çš„ Twilio å®¢æˆ·ç«¯åˆ›å»ºä¸€æ¡æ¶ˆæ¯](https://www.twilio.com/docs/sms/send-messages?code-sample=code-send-an-sms-message&code-language=Node.js&code-sdk-version=3.x)ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„ Twilio å·ä½œä¸º`from`å·ï¼Œå¹¶ä»ä¼ å…¥çš„è¯·æ±‚ä½“è·å¾—æ¶ˆæ¯çš„`to`å·å’Œ`body`ã€‚è¿™å°†è¿”å›ä¸€ä¸ª[æ‰¿è¯º](https://www.twilio.com/blog/2016/10/guide-to-javascript-promises.html),å½“ API è¯·æ±‚æˆåŠŸæ—¶å®ƒå°†å±¥è¡Œï¼Œå¦‚æœå¤±è´¥åˆ™æ‹’ç»ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œæˆ‘ä»¬éƒ½å°†è¿”å›ä¸€ä¸ª JSON å“åº”æ¥å‘Šè¯‰å®¢æˆ·ç«¯è¯·æ±‚æ˜¯å¦æˆåŠŸã€‚

```
app.post('/api/messages', (req, res) => {
  res.header('Content-Type', 'application/json');
  client.messages
    .create({
      from: process.env.TWILIO_PHONE_NUMBER,
      to: req.body.to,
      body: req.body.body
    })
    .then(() => {
      res.send(JSON.stringify({ success: true }));
    })
    .catch(err => {
      console.log(err);
      res.send(JSON.stringify({ success: false }));
    });
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æœåŠ¡å™¨ä¸Šæ‰€éœ€è¦çš„ï¼Œè®©æˆ‘ä»¬ä» React éƒ¨åˆ†å¼€å§‹ã€‚

### [](#building-the-clientside)æ„å»ºå®¢æˆ·ç«¯

åœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†é€šè¿‡æœåŠ¡å™¨å‘é€ SMS çš„è¡¨å•å®Œå…¨å°è£…åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ã€‚å› æ­¤ï¼Œåœ¨`src`ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`SMSForm.js`çš„æ–°ç»„ä»¶ï¼Œå¹¶ä»ç»„ä»¶çš„æ ·æ¿æ–‡ä»¶å¼€å§‹:

```
import React, { Component } from 'react';

class SMSForm extends Component {

}

export default SMSForm; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç”¨æˆ·å¯ä»¥å¡«å†™ç”µè¯å·ç å’Œæ¶ˆæ¯çš„è¡¨å•ã€‚å½“è¡¨å•æäº¤åï¼Œå®ƒä¼šå°†è¯¦ç»†ä¿¡æ¯å‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ç«¯ç‚¹ï¼Œå¹¶å°†æ¶ˆæ¯ä½œä¸ºçŸ­ä¿¡å‘é€åˆ°è¯¥å·ç ã€‚

è®©æˆ‘ä»¬é¦–å…ˆä¸ºè¿™ä¸ªç»„ä»¶æ„å»º`render`æ–¹æ³•:å®ƒå°†åŒ…æ‹¬ä¸€ä¸ªè¡¨å•ã€ä¸€ä¸ªç”µè¯å·ç è¾“å…¥ã€ä¸€ä¸ªæ¶ˆæ¯æ–‡æœ¬åŒºå’Œä¸€ä¸ªæäº¤æŒ‰é’®:

```
 render() {
    return (
      <form>
        <div>
          <label htmlFor="to">To:</label>
          <input
             type="tel"
             name="to"
             id="to"
          />
        </div>
        <div>
          <label htmlFor="body">Body:</label>
          <textarea name="body" id="body"/>
        </div>
        <button type="submit">
          Send message
        </button>
      </form>
    );
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€äº› CSS æ¥è®¾è®¡è¿™ä¸ªè¡¨å•ã€‚åˆ›å»ºæ–‡ä»¶`src/SMSForm.css`å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹:

```
.sms-form {
  text-align: left;
  padding: 1em;
}
.sms-form label {
  display: block;
}
.sms-form input,
.sms-form textarea {
  font-size: 1em;
  width: 100%;
  box-sizing: border-box;
}
.sms-form div {
  margin-bottom: 0.5em;
}
.sms-form button {
  font-size: 1em;
  width: 100%;
}
.sms-form.error {
  outline: 2px solid #f00;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨ SMSForm ç»„ä»¶çš„é¡¶éƒ¨å¯¼å…¥ CSS:

```
import React, { Component } from 'react';
import './SMSForm.css'; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œå°†ç»„ä»¶å¯¼å…¥åˆ°`src/App.js`ä¸­ï¼Œå¹¶å°†æ¸²æŸ“æ–¹æ³•æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹:

```
import React, { Component } from 'react';
import logo from './logo.svg';
import './App.css';
import SMSForm from './SMSForm';

class App extends Component {
  render() {
    return (
      <div className="App">
        <header className="App-header">
          <img src={logo} className="App-logo" alt="logo" />

          <SMSForm />
        </header>
      </div>
    );
  }
}

export default App; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç”¨`npm run dev`å¯åŠ¨æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨å°†åœ¨é¡µé¢ä¸Šçœ‹åˆ°è¿™ä¸ªè¡¨å•ã€‚

[![](../Images/af57d970ab849cd8008603255df74de0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--6QXncK8x--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/lQ_7J7OP9Wc8uM5lAWxNkavJ2bGd8F_i0ONhZvdHXFysVt.width-500.png)

è¡¨å•è¿˜æ²¡æœ‰åšä»»ä½•äº‹æƒ…ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### [](#making-an-interactive-form-in-react)åœ¨ React ä¸­åˆ¶ä½œäº¤äº’è¡¨å•

ä¸ºäº†å°† HTML è¡¨å•ä¸ç»„ä»¶æŒ‚é’©ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›äº‹æƒ…:

*   åœ¨ç»„ä»¶çš„çŠ¶æ€ä¸­ä¿æŒè¾“å…¥å’Œæ–‡æœ¬åŒºåŸŸçš„çŠ¶æ€æ˜¯æœ€æ–°çš„
*   å¤„ç†æäº¤è¡¨å•å’Œå‘é€æ•°æ®åˆ°æœåŠ¡å™¨
*   å¦‚æœæ¶ˆæ¯å‘é€æˆåŠŸï¼Œå¤„ç†æ¥è‡ªæœåŠ¡å™¨çš„å“åº”å¹¶æ¸…é™¤è¡¨å•ï¼Œå¦åˆ™æ˜¾ç¤ºé”™è¯¯

æˆ‘ä»¬å°†ä»åœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½®ä¸€äº›åˆå§‹çŠ¶æ€å¼€å§‹ã€‚æˆ‘ä»¬éœ€è¦å­˜å‚¨è¡¨å•è¾“å…¥ï¼Œè¡¨å•æ˜¯å¦æ­£åœ¨è¢«æäº¤(è¿™æ ·æˆ‘ä»¬å¯ä»¥ç¦ç”¨æäº¤æŒ‰é’®)ä»¥åŠæ˜¯å¦æœ‰é”™è¯¯ã€‚ä¸ºç»„ä»¶åˆ›å»ºæ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
class SMSForm extends Component {
  constructor(props) {
    super(props);
    this.state = {
      message: {
        to: '',
        body: ''
      },
      submitting: false,
      error: false
    };
  }

  // rest of the component
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†è¡¨å•å­—æ®µçš„å˜åŒ–å¹¶æ›´æ–°çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªç”¨äº inputï¼Œä¸€ä¸ªç”¨äº textareaï¼Œä½†æ˜¯ç”±äºè¡¨å•å…ƒç´ å’ŒçŠ¶æ€é¡¹çš„åç§°åŒ¹é…ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ–¹æ³•æ¥æ¶µç›–è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚

```
 onHandleChange(event) {
    const name = event.target.getAttribute('name');
    this.setState({
      message: { ...this.state.message, [name]: event.target.value }
    });
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨ [ES2015 çš„è®¡ç®—å±æ€§åç§°](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#Computed_property_names)æ¥è®¾ç½®çŠ¶æ€ä¸­çš„æ­£ç¡®å±æ€§ï¼Œå¹¶ä½¿ç”¨[æ‰©å±•æ“ä½œç¬¦](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)æ¥å¡«å……çŠ¶æ€çš„å…¶ä½™éƒ¨åˆ†ã€‚

æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªæ–¹æ³•ç»‘å®šåˆ°å¯¹è±¡ï¼Œä»¥ç¡®ä¿å½“æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥æ¥æ”¶äº‹ä»¶æ—¶`this`æ˜¯æ­£ç¡®çš„ã€‚å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ„é€ å‡½æ•°çš„åº•éƒ¨:

```
 constructor(props) {
    super(props);
    this.state = {
      message: {
        to: '',
        body: ''
      },
      submitting: false,
      error: false
    };
    this.onHandleChange = this.onHandleChange.bind(this);
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬ç°åœ¨å¯ä»¥æ›´æ–°æˆ‘ä»¬çš„æ¸²æŸ“ JSXï¼Œä½¿ç”¨å½“å‰çŠ¶æ€è®¾ç½®è¡¨å•å­—æ®µçš„å€¼ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬çš„`onHandleChange`æ–¹æ³•:
å¤„ç†æ›´æ–°

```
 render() {
    return (
      <form>
        <div>
          <label htmlFor="to">To:</label>
          <input
            type="tel"
            name="to"
            id="to"
            value={this.state.message.to}
            onChange={this.onHandleChange}
          />
        </div>
        <div>
          <label htmlFor="body">Body:</label>
          <textarea
            name="body"
            id="body"
            value={this.state.message.body}
            onChange={this.onHandleChange}
          />
        </div>
        <button type="submit">Send message</button>
      </form>
    );
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é‡æ–°åŠ è½½åº”ç”¨ç¨‹åºï¼Œæ‚¨å°†èƒ½å¤Ÿæ›´æ–°è¡¨å•å­—æ®µã€‚å¦‚æœä½ çš„æµè§ˆå™¨æœ‰ [React å¼€å‘å·¥å…·](https://github.com/facebook/react-devtools)ï¼Œä½ ä¹Ÿèƒ½çœ‹åˆ°çŠ¶æ€æ›´æ–°ã€‚

[![](../Images/7cdd517a9a0ddf1227cb290a0fc44b4f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--QJWi8lxO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/_dzcSo7MrETpFCBo-yhmOkD376ckMEWm3HHhEY8YF4CLbY.width-500.png)

ç°åœ¨æˆ‘ä»¬éœ€è¦å¤„ç†è¡¨å•æäº¤ã€‚æ„å»ºå¦ä¸€ä¸ªå‡½æ•°`onSubmit`ï¼Œé¦–å…ˆå°†`submitting`çŠ¶æ€å±æ€§æ›´æ–°ä¸º trueã€‚ç„¶åä½¿ç”¨ [`fetch` API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚å¦‚æœå“åº”æˆåŠŸï¼Œåˆ™æ¸…é™¤è¡¨æ ¼å¹¶å°†`submitting`è®¾ç½®ä¸ºå‡ã€‚å¦‚æœå“åº”ä¸æˆåŠŸï¼Œåˆ™å°†`submitting`è®¾ç½®ä¸ºå‡ï¼Œä½†å°†`error`è®¾ç½®ä¸ºçœŸã€‚

```
 onSubmit(event) {
    event.preventDefault();
    this.setState({ submitting: true });
    fetch('/api/messages', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(this.state.message)
    })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          this.setState({
            error: false,
            submitting: false,
            message: {
              to: '',
              body: ''
            }
          });
        } else {
          this.setState({
            error: true,
            submitting: false
          });
        }
      });
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åƒä½¿ç”¨`onHandleChange`æ–¹æ³•ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šè¿™ä¸ªæ–¹æ³•:

```
 constructor(props) {
    super(props);
    this.state = {
      message: {
        to: '',
        body: ''
      },
      submitting: false,
      error: false
    };
    this.onHandleChange = this.onHandleChange.bind(this);
    this.onSubmit = this.onSubmit.bind(this);
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œåœ¨ JSX ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†`onSubmit`æ–¹æ³•ä½œä¸ºè¡¨å•ä¸Šçš„æäº¤å¤„ç†ç¨‹åºã€‚å¦‚æœä»è¯·æ±‚ä¸­æ”¶åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬è¿˜å°†è¡¨å•çš„ç±»è®¾ç½®ä¸ºâ€œerrorâ€ã€‚å½“è¡¨å•æäº¤æ—¶ï¼Œæˆ‘ä»¬è®¾ç½®æŒ‰é’®çš„`disabled`å±æ€§ã€‚

```
 render() {
    return (
      <form
        onSubmit={this.onSubmit}
        className={this.state.error ? 'error sms-form' : 'sms-form'}
      >
        <div>
          <label htmlFor="to">To:</label>
          <input
            type="tel"
            name="to"
            id="to"
            value={this.state.message.to}
            onChange={this.onHandleChange}
          />
        </div>
        <div>
          <label htmlFor="body">Body:</label>
          <textarea
            name="body"
            id="body"
            value={this.state.message.body}
            onChange={this.onHandleChange}
          />
        </div>
        <button type="submit" disabled={this.state.submitting}>
          Send message
        </button>
       </form>
    );
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å…¨éƒ¨å†…å®¹ï¼Œå› æ­¤è¯·å†æ¬¡åˆ·æ–°åº”ç”¨ï¼Œå¹¶è¾“å…¥æ‚¨çš„æ‰‹æœºå·ç å’Œè¦å‘é€çš„æ¶ˆæ¯ã€‚æäº¤è¡¨å•ï¼Œå¦‚æœç»†èŠ‚æ­£ç¡®ï¼Œæ‚¨çš„æ¶ˆæ¯å°†è¢«å‘é€ï¼Œå¦‚æœä¸æ­£ç¡®ï¼Œè¡¨å•å°†æ˜¾ç¤ºçŠ¶æ€é”™è¯¯ã€‚

[![Now when entering incorrect values the form shows an error and when you enter the correct values the message is sent.](../Images/c17c2c04b4ce69d36b4d8e51a69c2d04.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--hYCU4EGH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/success.width-500.gif)

### [](#sending-messages-and-keeping-your-credentials-safe)å‘é€æ¶ˆæ¯å¹¶ä¿æŠ¤æ‚¨çš„å‡­è¯å®‰å…¨

ä»ç½‘ç»œåº”ç”¨ç¨‹åºå‘é€çŸ­ä¿¡å¾ˆé…·ã€‚ä»ä½ çš„ React åº”ç”¨å‘é€çŸ­ä¿¡è€Œä¸æš´éœ²ä½ çš„å‡­è¯æ›´é…·ğŸ˜ã€‚

æ‚¨å¯ä»¥åœ¨ [GitHub repo](https://github.com/philnash/send-sms-react-twilio) ä¸­æŸ¥çœ‹è¿™ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ä»£ç ã€‚

ç°åœ¨ä½ å·²ç»æœ‰äº†ä¸€ä¸ªå¯ä»¥å‘é€çŸ­ä¿¡çš„ React åº”ç”¨ç¨‹åºçš„åŸºç¡€ï¼Œä½ å¯ä»¥åšä¸€äº›æ”¹è¿›ã€‚é¦–å…ˆå¯èƒ½æ˜¯æ›´å¥½çš„éªŒè¯å’Œé”™è¯¯æ¶ˆæ¯ã€‚é€šè¿‡ç±»ä¼¼çš„è®¾è®¡ï¼Œä½ å¯ä»¥æ·»åŠ [ç”µè¯å·ç æŸ¥è¯¢](https://www.twilio.com/docs/lookup/api)ã€[ç”Ÿæˆç”µè¯å‘¼å«](https://www.twilio.com/docs/voice/api/call)æˆ–[å®ç°åŒå› ç´ è®¤è¯](https://www.twilio.com/docs/authy/api/one-time-passwords)ä¹Ÿå¯ä»¥ä»ä½ çš„ React åº”ç”¨ç¨‹åºä¸­å®ç°ã€‚

æˆ‘å¾ˆæƒ³å¬å¬ä½ æ­£åœ¨ç”¨ React å¼€å‘çš„åº”ç”¨ã€‚è¯·åœ¨ä¸‹é¢ç»™æˆ‘ç•™è¨€ï¼Œåœ¨ Twitter ä¸Šç»™æˆ‘æ‰“ç”µè¯ [@philnash](https://twitter.com/philnash) ï¼Œæˆ–è€…ç»™æˆ‘å‘é‚®ä»¶åˆ° philnash@twilio.com çš„ã€‚