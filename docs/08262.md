# ç”¨ React-router å’Œ Redux å¾æœå¯¼èˆªçŠ¶æ€

> åŸæ–‡:[https://dev . to/bnevilleoneill/conquer-navigation-state-with-react-router-and-redux-2 IAA](https://dev.to/bnevilleoneill/conquer-navigation-state-with-react-router-and-redux-2iaa)

[![](../Images/07ae39a3d9cca82f5ea6beb7732c7895.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--FKfqOIwE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2ApB345V4AkkJlNIiT_wO76g.png)

ä¼ ç»Ÿåº”ç”¨ç¨‹åºå’Œå•é¡µé¢åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªåŸºæœ¬ç»„æˆéƒ¨åˆ†æ˜¯å¯¼èˆªâ€”â€”èƒ½å¤Ÿä»ä¸€ä¸ªé¡µé¢ç§»åŠ¨åˆ°å¦ä¸€ä¸ªé¡µé¢ã€‚

å¥½å§ï¼Œé‚£åˆæ€æ ·ï¼Ÿ

ç­‰ç­‰æˆ‘ï¼

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¸ä»…å°†å‘æ‚¨å±•ç¤ºåœ¨ React/Redux åº”ç”¨ç¨‹åºä¸­å¯¼èˆªçš„ç»†å¾®å·®åˆ«ï¼Œè¿˜å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä»¥å£°æ˜çš„æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ï¼æ‚¨è¿˜å°†äº†è§£å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºçš„å¯¼èˆªå¼€å…³ä¹‹é—´ç»´æŠ¤çŠ¶æ€ã€‚

å‡†å¤‡å¥½äº†å—ï¼Ÿ

> ğŸ‘‰æ³¨æ„:åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å‡è®¾ä½ å¯¹ Redux çš„å·¥ä½œåŸç†æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†è§£ã€‚å¦‚æœæ²¡æœ‰ï¼Œä½ å¯èƒ½æƒ³çœ‹çœ‹æˆ‘å…³äº[ç†è§£ Redux](https://medium.freecodecamp.org/understanding-redux-the-worlds-easiest-guide-to-beginning-redux-c695f45546f6) çš„æ–‡ç« ğŸ“•ã€‚

[![](../Images/2063f22e152ef36aa267c13ae9842601.png)T2ã€‘](https://logrocket.com/signup/)

### æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„åº”ç”¨ç¨‹åº

ä¸ºäº†å°½å¯èƒ½å®ç”¨ï¼Œæˆ‘ä¸ºæ­¤å»ºç«‹äº†ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºã€‚

ä¸‹é¢è¿™å¼  GIF æ˜¯ *EmojiLand çš„ã€‚*

<figure>[![](../Images/ffc7abef379b75778f714c2694d47535.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--TlNg1oYG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AUorZ-5kajXJZ5yUHnzBepQ.gif) 

<figcaption>ä½ å¥½ï¼ŒEmojiLandï¼</figcaption>

</figure>

EmojiLand æ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œä½†è¶³ä»¥å¸®åŠ©ä½ ç†è§£æˆ‘å°†åœ¨æœ¬æ–‡ä¸­åˆ†äº«çš„éå¸¸é‡è¦çš„æç¤ºã€‚

è¯·æ³¨æ„è¯¥åº”ç”¨ç¨‹åºå¦‚ä½•åœç•™åœ¨å½“å‰è·¯çº¿ä¸Šï¼Œä½†å½“å•å‡»æŒ‰é’®æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œä¸€äº›å‡æ“ä½œï¼Œå¹¶åœ¨å®Œæˆå‡æ“ä½œåé‡å®šå‘åˆ°å¦ä¸€æ¡è·¯çº¿ã€‚

åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œè¿™ä¸ªå‡åŠ¨ä½œå¯èƒ½æ˜¯è·å–æŸäº›èµ„æºçš„ç½‘ç»œè¯·æ±‚ï¼Œæˆ–è€…ä»»ä½•å…¶ä»–å¼‚æ­¥åŠ¨ä½œã€‚

ä¸ºäº†è®©æˆ‘ä»¬è¾¾æˆå…±è¯†ï¼Œè®©æˆ‘åˆ†äº«ä¸€ä¸‹ *EmojiLand* åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•æ„å»ºçš„ã€‚

### å¿«é€Ÿæ¦‚è¿° *EmojiLand* æ˜¯å¦‚ä½•å»ºé€ çš„

è¦ç»§ç»­å·¥ä½œï¼Œä» GitHub è·å–åº”ç”¨ç¨‹åºçš„ [repoã€‚å¦‚æœä½ è§‰å¾—æ‡’ï¼Œå¯ä»¥è·³è¿‡ã€‚](https://github.com/ohansemmanuel/nav-state-react-router)

å…‹éš†å›è´­:`git clone`[https://github.com/ohansemmanuel/nav-state-react-router.git](https://github.com/ohansemmanuel/nav-state-react-router.git)

ç§»åŠ¨åˆ°ç›®å½•:`cd nav-state-react-router`

å®‰è£…ä¾èµ–é¡¹:`yarn install`æˆ–`npm install`

ç„¶åè¿è¡Œåº”ç”¨ç¨‹åº:`yarn start`æˆ–`npm start`

å®Œæˆäº†å—ï¼Ÿ

è¯¥åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªåŸºæœ¬çš„ redux è®¾ç½®ååº”ã€‚è¿˜åŒ…æ‹¬ä¸€ä¸ªéå¸¸ç®€å•çš„ react-router è®¾ç½®ã€‚

åœ¨`containers/App.js`ä¸­ï¼Œæ‚¨å°†æ‰¾åˆ°è¯¥åº”ç”¨ç¨‹åºä¸­åŒ…å«çš„ 6 æ¡è·¯çº¿ã€‚

ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç è¡¨ç¤º:

```
const App = () => (
  <Router>
    <Switch>
      <Route exact path="/" component={AngryDude} />
      <Route path="/quiet" component={KeepQuiet} />
      <Route path="/smile" component={SmileLady} />
      <Route path="/think" component={ThinkHard} />
      <Route path="/thumbs" component={ThumbsUp} />
      <Route path="/excited" component={BeExcited} />
    </Switch>
  </Router>
); 
```

Enter fullscreen mode Exit fullscreen mode

æ¯æ¡è·¯çº¿éƒ½æŒ‡å‘ä¸€ä¸ªè¡¨æƒ…ç¬¦å·ç»„ä»¶ã€‚`/quiet`æ¸²æŸ“`KeepQuiet`ç»„ä»¶ã€‚

ä¸‹é¢æ˜¯`KeepQuiet`ç»„ä»¶çš„æ ·å­:

```
import React from "react";
import EmojiLand from "../components/EmojiLand";
import keepQuietImg from "../Images/keepquiet.png";
import emojiLand from "./emojiLand";
const KeepQuiet = ({ appState, handleEmojiAction }) => (
    <EmojiLand
      EmojiBg="linear-gradient(120deg, #a6c0fe 0%, #f68084 100%)"
      EmojiImg={keepQuietImg}
      EmojiBtnText="Keep Calm and Stay Quiet."
      HandleEmojiAction={handleEmojiAction}
      appState={appState}
    />
  );
export default emojiLand(KeepQuiet); 
```

Enter fullscreen mode Exit fullscreen mode

å‘ˆç° EmojiLand ç»„ä»¶çš„æ˜¯ç®€å•çš„åŠŸèƒ½ç»„ä»¶ã€‚EmojiLand ç»„ä»¶çš„æ„é€ åœ¨`components/EmojiLand.js`ä¸­ã€‚

è¿™æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œä½ å¯ä»¥åœ¨ GitHub ä¸Šçœ‹ä¸€çœ‹ã€‚

é‡è¦çš„æ˜¯ï¼Œå®ƒæ¥å—ä¸€äº›é“å…·ï¼Œå¦‚èƒŒæ™¯æ¸å˜ã€å›¾åƒå’ŒæŒ‰é’®æ–‡æœ¬ã€‚

æ›´ç²¾è‡´çš„æ˜¯å‡ºå£ç»„ä»¶ã€‚

è¯·çœ‹ä¸€ä¸‹ä¸Šé¢ä»£ç å—çš„æœ€åä¸€è¡Œã€‚

```
export default emojiLand(KeepQuiet); 
```

Enter fullscreen mode Exit fullscreen mode

emojiLand å³è¾¹æœ‰ä¸€ä¸ªé«˜é˜¶åˆ†é‡ã€‚å®ƒæ‰€åšçš„åªæ˜¯ç¡®ä¿å½“ä½ ç‚¹å‡»ä»»ä½•è¡¨æƒ…ç»„ä»¶ä¸­çš„ä¸€ä¸ªæŒ‰é’®æ—¶ï¼Œ[å®ƒä¼šæ¨¡æ‹Ÿä¸€ä¸ªè™šå‡çš„åŠ¨ä½œ](https://github.com/ohansemmanuel/nav-state-react-router/blob/master/src/containers/emojiLand.js)å¤§çº¦ 1000 æ¯«ç§’ã€‚è¯·è®°ä½ï¼Œå®é™…ä¸Šè¿™å¯èƒ½æ˜¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚ã€‚

emojiLand é«˜é˜¶ç»„ä»¶é€šè¿‡å°† appState å±æ€§ä¼ é€’åˆ° emoji ç»„ä»¶ä¸­æ¥å®ç°è¿™ä¸€ç‚¹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¿æŒå®‰é™

å½“ç¬¬ä¸€æ¬¡å‘ˆç°ä»»ä½•è¡¨æƒ…ç»„ä»¶æ—¶ï¼ŒappState æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œ`""`ã€‚å¤§çº¦ 1000 æ¯«ç§’åï¼ŒappState æ›´æ”¹ä¸º`DO_SOMETHING_OVER`ã€‚

å…¶ä¸­`DO_SOMETHING_OVER`è¡¨ç¤ºä¸ºå¸¸æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

åœ¨å¸¸é‡/åŠ¨ä½œç±»å‹:

```
export const DO_SOMETHING_OVER = "DO_SOMETHING_OVER"; 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œè¿™å°±æ˜¯è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­æ¯ä¸ªè¡¨æƒ…ç¬¦å·ç»„ä»¶çš„å·¥ä½œæ–¹å¼ï¼

è¿˜è¦è®°ä½ï¼Œåœ¨æ¯æ¡è·¯çº¿ä¸Šï¼Œéƒ½ä¼šå‘ˆç°ä¸€ä¸ªå•ç‹¬çš„ EmojiLand ç»„ä»¶ã€‚

[![](../Images/ebf19eed6b4408088f020013362833a7.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--6PXFG51v--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AN5Ql1tcxFpsbgewbeqGc0Q.png)

[![](../Images/dff9692d84be086393e3f48f03365366.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--T9Ckjfqo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AAFFoi8P_xc-d1tT2wBVZWQ.png)

<figure>[![](../Images/942ab98ba5b2d5cac80f7b5afbe9d890.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--eXJE5VJh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2A2WCdVoU8-UTAVqc8xMqQog.png) 

<figcaption>æ„¤æ€’çš„ï¼Œå…´å¥‹çš„ï¼Œ&å®‰é™çš„</figcaption>

</figure>

[![](../Images/fd3c3b021c49364ac732c27d6c737ee7.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pncafb5w--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AvaLmQVdLDS90uv5ve5IL6Q.png)

[![](../Images/3b9490363302a661a61f301210c1fab1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--VApipZbn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AURBRM8rpWYy8LT0cLDAU2Q.png)

<figure>[![](../Images/89b75320e1f7a1d911ac8e5f56f85532.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--rxcGbjhx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AxIfTgz00ICn0CPS55E8UAw.png) 

<figcaption>SmileLadyï¼ŒThinkHardï¼Œ& ThumbsUp</figcaption>

</figure>

### åƒååº”å† å†›ä¸€æ ·æ”¹å˜æ–¹å‘

å‡æµç¨‹å®Œæˆåï¼Œè®©æˆ‘ä»¬å‡è®¾æ‚¨æƒ³è¦åœ¨ *EmojiLand* åº”ç”¨ç¨‹åºä¸­é‡å®šå‘/ç§»åŠ¨åˆ°å¦ä¸€ä¸ªè·¯ç”±ã€‚

ä½ æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ

é¦–å…ˆï¼Œè®°ä½åœ¨å›å®¶çš„è·¯ä¸Šï¼Œæ¸²æŸ“çš„æ˜¯æ„¤æ€’çš„æˆåˆ†ã€‚

<figure>[![](../Images/ebf19eed6b4408088f020013362833a7.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--6PXFG51v--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AN5Ql1tcxFpsbgewbeqGc0Q.png) 

<figcaption>è¿™ä¸ª AngryDude åˆ†é‡åè¶³ã€‚</figcaption>

</figure>

å¤„ç†é‡å®šå‘çš„æ›´å…·å£°æ˜æ€§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ React-router ä¸­çš„é‡å®šå‘ç»„ä»¶ã€‚

è®©æˆ‘å‘Šè¯‰ä½ æ€ä¹ˆåšã€‚

å› ä¸ºæˆ‘ä»¬æƒ³ä» AngryDude ç»„ä»¶è¿›è¡Œé‡å®šå‘ï¼Œé¦–å…ˆï¼Œåƒè¿™æ ·åœ¨ containers/AngryDude.js ä¸­å¯¼å…¥é‡å®šå‘ç»„ä»¶:

```
import { Redirect } from "react-router-dom"; 
```

Enter fullscreen mode Exit fullscreen mode

ä¸ºäº†ä½¿é‡å®šå‘å·¥ä½œï¼Œå®ƒå¿…é¡»åƒå¸¸è§„ç»„ä»¶ä¸€æ ·å‘ˆç°ã€‚åœ¨æˆ‘ä»¬çš„ç‰¹å®šç¤ºä¾‹ä¸­ï¼Œå½“ appState æŒæœ‰å€¼`DO_SOMETHING_OVER`æ—¶ï¼Œæˆ‘ä»¬å°†è¿›è¡Œé‡å®šå‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‡åŠ¨ä½œå·²ç»å®Œæˆã€‚

ç°åœ¨ï¼Œè¿™æ˜¯ä»£ç :

```
const AngryDude = ({ appState, handleEmojiAction }) => {
    return appState === DO_SOMETHING_OVER ? (
<Redirect to="/thumbs" />
    ) : (
      <EmojiLand
        EmojiBg="linear-gradient(-180deg, #611A51 0%, #10096D 100%)"
        EmojiImg={angryDudeImg}
        EmojiBtnText="I'm so pissed. Click me"
        HandleEmojiAction={this._handleEmojiAction}
        appState={this.props.appState}
 /> 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œå¦‚æœ appState ç­‰äº`DO_SOMETHING_OVER`ï¼Œåˆ™å‘ˆç°é‡å®šå‘ç»„ä»¶ã€‚

```
<Redirect to="/thumbs" /> 
```

Enter fullscreen mode Exit fullscreen mode

è¯·æ³¨æ„ï¼Œrequired to prop è¢«æ·»åŠ åˆ°é‡å®šå‘ç»„ä»¶ä¸­ã€‚è¿™ä¸ªé“å…·éœ€è¦çŸ¥é“**é‡å®šå‘åˆ°å“ªé‡Œã€‚**

æœ‰äº†è¿™äº›ï¼Œä¸‹é¢æ˜¯å®é™…æ“ä½œ:

<figure>[![](../Images/3b3595f728a66aaa4f60742e14566178.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--l07J-1pz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2Ar4G04AQ-qnRx-P4XcRjLDA.gif) 

<figcaption>ä»â€œç”Ÿæ°”â€è½¬å‘â€œç«–èµ·å¤§æ‹‡æŒ‡â€</figcaption>

</figure>

å¦‚æœæˆ‘ä»¬ç»§ç»­å¯¹å…¶ä»–è·¯ç”±ç»„ä»¶è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥æˆåŠŸåœ°é‡å®šå‘æ‰€æœ‰è·¯ç”±ï¼

è¿™å°±æ˜¯å®é™…æƒ…å†µ:

<figure>[![](../Images/ffc7abef379b75778f714c2694d47535.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--TlNg1oYG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AUorZ-5kajXJZ5yUHnzBepQ.gif) 

<figcaption>é€šè¿‡æ‰€æœ‰è·¯çº¿é‡æ–°å®šå‘ï¼</figcaption>

</figure>

å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ

ä½†æ˜¯æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### é¿å…é‡å®šå‘æ›¿æ¢å†å²ä¸­çš„å½“å‰è·¯çº¿

æˆ‘å°†æ‰“å¼€ä¸€ä¸ªæ–°çš„æµè§ˆå™¨å¹¶ç‚¹å‡»åº”ç”¨ç¨‹åºï¼Œä½†åœ¨æŸäº›æ—¶å€™ï¼Œæˆ‘ä¼šå°è¯•è¿”å›ï¼Œå³ä½¿ç”¨åé€€æµè§ˆå™¨æŒ‰é’®ã€‚

è¯·çœ‹ä¸‹é¢:

<figure>[![](../Images/dbf91579f8c202674f7e21b97f57c43f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--6LRMMIY4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AxjX7RqKgK5LdyrZ8_D06DA.gif) 

<figcaption>è¯•å›¾â€œè¿”å›â€å°†æˆ‘å¸¦å›æµè§ˆå™¨ä¸»é¡µ:(</figcaption>

</figure>

è¯·æ³¨æ„ï¼Œå½“æˆ‘å•å‡»åé€€æŒ‰é’®æ—¶ï¼Œå®ƒä¸ä¼šè¿”å›åˆ°ä»¥å‰çš„è·¯çº¿ï¼Œè€Œæ˜¯å°†æˆ‘å¸¦å›æµè§ˆå™¨çš„ä¸»é¡µã€‚

ä¸ºä»€ä¹ˆï¼Ÿ

è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨é‡å®šå‘ç»„ä»¶å°†æ›¿æ¢æµè§ˆå™¨å†å²å †æ ˆä¸­çš„å½“å‰ä½ç½®ã€‚

æ‰€ä»¥ï¼Œå³ä½¿æˆ‘ä»¬å¾ªç¯äº†å¤šæ¡è·¯çº¿ï¼Œè¿™äº›è·¯çº¿ä¹Ÿåœ¨æµè§ˆå™¨çš„â€œè®°å½•â€ä¸­äº’ç›¸æ›¿æ¢ã€‚

å¯¹äºæµè§ˆå™¨ï¼Œæˆ‘ä»¬åªè®¿é—®äº†ä¸€æ¡è·¯çº¿ã€‚å› æ­¤ï¼Œç‚¹å‡»åé€€æŒ‰é’®æŠŠæˆ‘å¸¦å›äº†ä¸»é¡µã€‚

è¿™å°±åƒæœ‰ä¸€ä¸ªæ•°ç»„ï¼Œä½†ä¸æ˜¯æ¨é€åˆ°æ•°ç»„ï¼Œè€Œæ˜¯æ›¿æ¢æ•°ç»„ä¸­çš„å½“å‰å€¼ã€‚

ä¸è¿‡ï¼Œæœ‰ä¸€ä¸ªè§£å†³åŠæ³•ã€‚

é‡å®šå‘ç»„ä»¶å¯ä»¥é‡‡ç”¨å–æ¶ˆè¿™ç§è¡Œä¸ºçš„æ¨é€å±æ€§ã€‚ä½¿ç”¨ push propï¼Œæ¯æ¡è·¯ç”±éƒ½ä¼šè¢«æ¨é€åˆ°æµè§ˆå™¨çš„å†å²å †æ ˆä¸­ï¼Œä¸ä¼šè¢«æ›¿æ¢ã€‚

ä¸‹é¢æ˜¯å®ƒåœ¨ä»£ç ä¸­çš„æ ·å­:

```
return appState === DO_SOMETHING_OVER ? (
    <Redirect push to="/thumbs" />
  ) : (
    <EmojiLand
      EmojiBg="linear-gradient(-180deg, #611A51 0%, #10096D 100%)"
      EmojiImg={angryDudeImg}
      EmojiBtnText="I'm so pissed. Click me"
      HandleEmojiAction={handleEmojiAction}
      appState={appState}
    />
  ); 
```

Enter fullscreen mode Exit fullscreen mode

è¿™æ˜¯ç»“æœã€‚

<figure>[![](../Images/b23916658a750947a605ebb2405f4e7d.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--bRlt5X3h--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AVJucGLA-Dw59KhBIMI1jBA.gif) 

<figcaption>ç°åœ¨ï¼Œç‚¹å‡»è¿”å›æŒ‰é’®å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†:)</figcaption>

</figure>

è¯·æ³¨æ„æˆ‘ä»¬ç°åœ¨å¦‚ä½•å¯¼èˆªå›ä»¥å‰è®¿é—®è¿‡çš„è·¯çº¿ï¼

### ä¿æŒå¯¼èˆªçŠ¶æ€

å½“æ‚¨ä»ä¸€æ¡è·¯çº¿ç§»åŠ¨åˆ°å¦ä¸€æ¡è·¯çº¿æ—¶ï¼Œå‰ä¸€æ¡è·¯çº¿ä¸­çš„å˜é‡ä¸ä¼šè¢«å¸¦åˆ°ä¸‹ä¸€æ¡è·¯çº¿ã€‚ä»–ä»¬èµ°äº†ï¼

æ˜¯çš„ï¼Œèµ°äº†ï¼Œé™¤äº†ä½ åšä¸€äº›å·¥ä½œã€‚

æœ‰è¶£çš„æ˜¯ï¼Œé‡å®šå‘ç»„ä»¶ä½¿è¿™å˜å¾—éå¸¸å®¹æ˜“ã€‚

ä¸å°†å­—ç¬¦ä¸²ä¼ é€’ç»™ prop åˆ° Redirect ç›¸åï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ã€‚

<figure>[![](../Images/424b812c5e2e1daa06886accc616a0bc.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--YCgns7za--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AmXJJnCS65sbv19Z3Ts39Sw.png) 

<figcaption>ä½ ä¹Ÿå¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡ä¼ é€’ç»™é‡å®šå‘ç»„ä»¶</figcaption>

</figure>

æœ‰è¶£çš„æ˜¯ï¼Œæœ‰äº†å¯¹è±¡è¡¨ç¤ºï¼Œè¿˜å¯ä»¥ä¼ å…¥ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ã€‚

åœ¨ state å¯¹è±¡ä¸­ï¼Œæ‚¨ç°åœ¨å¯ä»¥å­˜å‚¨ä»»ä½•æ‚¨å¸Œæœ›å¸¦åˆ°è¢«é‡å®šå‘åˆ°çš„è·¯ç”±çš„é”®å€¼å¯¹ã€‚

<figure>[![](../Images/edc939941234aee620bed00a6f03f266.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--pow5KdZz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AnkFps36oyZXKtI3keaN9bg.png) 

<figcaption>åœ¨â€œè‡³â€é“å…·å†…æ·»åŠ çŠ¶æ€å¯¹è±¡ã€‚</figcaption>

</figure>

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä»£ç ç¤ºä¾‹ã€‚

å½“ä» AngryDude ç»„ä»¶é‡å®šå‘åˆ° ThumbsUp æ—¶ï¼Œè®©æˆ‘ä»¬å°†ä¸€äº›å€¼ä¼ å…¥ state å­—æ®µã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä¹‹å‰æ‹¥æœ‰çš„:

```
<Redirect push to="/thumbs" /> 
```

Enter fullscreen mode Exit fullscreen mode

é‚£è¦æ”¹æˆè¿™æ ·:

```
<Redirect
      push
to={{
        pathname: "/thumbs",
        state: {
          humanType: "Cat Person",
          age: 12,
          sex: "none"
        }
      }}
    /> 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œæˆ‘å·²ç»ä¼ å…¥äº† 3 ä¸ªä¸åŒçš„é”®å€¼å¯¹ï¼äººç±»ç±»å‹ã€å¹´é¾„å’Œæ€§åˆ«ã€‚

ä½†æ˜¯åœ¨é‡å®šå‘åˆ°/thumbs è·¯ç”±æ—¶ï¼Œæˆ‘å¦‚ä½•æ¥æ”¶è¿™äº›å€¼å‘¢ï¼Ÿ

å¯¹äºè·¯ç”±ç»„ä»¶ï¼Œreact-router æä¾›äº†ç‰¹å®šä½ç½®å±æ€§ã€‚åœ¨è¿™ä¸ªä½ç½®å±æ€§ä¸­ï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·è®¿é—®çŠ¶æ€å¯¹è±¡ï¼Œlocation.state æˆ– this.props.location.state

> æ³¨æ„:è·¯ç”±ç»„ä»¶æ˜¯ç”± react-router ç»„ä»¶æ¸²æŸ“çš„ç»„ä»¶ã€‚ä»–ä»¬é€šå¸¸åœ¨ç­¾åä¸­ï¼Œ

è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘è®°å½•äº†åœ¨æ–°çš„ route/thumbs ä¸­æ¥æ”¶åˆ°çš„çŠ¶æ€å¯¹è±¡ï¼Œå³åœ¨æ–°å‘ˆç°çš„ Thumbs ç»„ä»¶ä¸­ã€‚

```
const ThumbsUp = ({ appState, handleEmojiAction, location }) => {
console.log(location.state);
  return appState === DO_SOMETHING_OVER ? (
    <Redirect push to="/quiet" />
  ) : (
    <EmojiLand
      EmojiBg="linear-gradient(-225deg, #DFFFCD 0%, #90F9C4 48%, #39F3BB 100%)"
      EmojiImg={thumbsUpImg}
      EmojiBtnText="You rock. Thumbs up!"
      HandleEmojiAction={handleEmojiAction}
      appState={appState}
    />
  );
}; 
```

Enter fullscreen mode Exit fullscreen mode

æ³¨æ„ location prop æ˜¯å¦‚ä½•è¢«è§£æ„çš„ï¼Œç„¶åæ˜¯ console.log(location.state)ã€‚

ç»è¿‡é‡å®šå‘å’Œå¼€å‘æ§åˆ¶å°æ£€æŸ¥åï¼ŒçŠ¶æ€å¯¹è±¡ç¡®å®å°±åœ¨é‚£é‡Œï¼

<figure>[![](../Images/7c1674d2cb4a75904765b956413d61d8.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--teETcfKq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2Ayv5aTY_Qerf1wAhSvSdMyw.png) 

<figcaption>çŠ¶æ€å¯¹è±¡æ¥æ”¶å¹¶ç™»å½•åˆ°æ–°çš„`/thumbs`è·¯çº¿ï¼</figcaption>

</figure>

æ‚¨ç”šè‡³å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼ŒåŸºäºä¼ å…¥çš„çŠ¶æ€å®é™…å‘ˆç°ä¸€äº› UI ç»„ä»¶ã€‚

æˆ‘æ˜¯è¿™æ ·åšçš„:

<figure>[![](../Images/550ab6b162e52d067bc06314d75d529c.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--9CkMI5mb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2ASF0KSkH449j_nTisYceWpQ.png) 

<figcaption>çœ‹çœ‹æŒ‰é’®ä¸‹é¢çš„æ–‡å­—ã€‚è¿™äº›å€¼æ˜¯ä»ä½ç½®çŠ¶æ€å¯¹è±¡ä¸­è·å–çš„ï¼</figcaption>

</figure>

é€šè¿‡è·å–ä¼ é€’ç»™ ThumbsUp çš„çŠ¶æ€ï¼Œæˆ‘å¯¹å…¶è¿›è¡Œäº†æ˜ å°„ï¼Œå¹¶å‘ˆç°äº†æŒ‰é’®ä¸‹æ–¹çš„å€¼ã€‚å¦‚æœä½ å…³å¿ƒæˆ‘æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œçœ‹çœ‹ [components/EmojiLand.js](https://github.com/ohansemmanuel/nav-state-react-router/blob/master/src/components/EmojiLand.js) ä¸­çš„æºä»£ç 

ç°åœ¨æˆ‘ä»¬å·²ç»å–å¾—äº†ä¸€äº›ä¸é”™çš„è¿›å±•ï¼

### ä»»ä½•çœŸå®ä¸–ç•Œå€¼ï¼Ÿ

ä½ å¯èƒ½ä¸€ç›´åœ¨æƒ³ï¼Œâ€œæ˜¯çš„ï¼Œè¿™å¾ˆé…·ï¼Œä½†æ˜¯åœ¨ç°å®ä¸–ç•Œä¸­æˆ‘åœ¨å“ªé‡Œä½¿ç”¨å®ƒå‘¢ï¼Ÿâ€

æœ‰è®¸å¤šç”¨ä¾‹ï¼Œä½†ä¸€ä¸ªéå¸¸å¸¸è§çš„æ˜¯åœ¨è¡¨æ ¼ä¸­å‘ˆç°ç»“æœåˆ—è¡¨ã€‚

ä½†æ˜¯ï¼Œè¯¥è¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½æ˜¯å¯å•å‡»çš„ï¼Œå•å‡»æŸä¸€è¡Œæ—¶ï¼Œæ‚¨ä¼šå¸Œæœ›æ˜¾ç¤ºæœ‰å…³æ‰€å•å‡»å€¼çš„æ›´å¤šä¿¡æ¯ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨è¿™é‡Œçš„æ¦‚å¿µé‡å®šå‘åˆ°æ–°è·¯ç”±ï¼Œè¿˜å¯ä»¥å°†ä¸€äº›å€¼ä»è¡¨è¡Œä¼ é€’åˆ°æ–°è·¯ç”±ï¼æ‰€æœ‰è¿™äº›éƒ½æ˜¯é€šè¿‡åˆ©ç”¨ to prop ä¸­é‡å®šå‘çš„çŠ¶æ€å¯¹è±¡æ¥å®ç°çš„ï¼

### ä½†æ˜¯ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§è§£å†³æ–¹æ³•ï¼

åœ¨å¼€å‘é¢†åŸŸï¼Œé€šå¸¸æœ‰å¤šç§æ–¹æ³•æ¥è§£å†³ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å°½å¯èƒ½å®ç”¨ï¼Œæ‰€ä»¥æˆ‘å°†å‘æ‚¨å±•ç¤ºåœ¨è·¯çº¿ä¹‹é—´å¯¼èˆªçš„å¦ä¸€ç§å¯èƒ½çš„æ–¹æ³•ã€‚

å‡è®¾æˆ‘ä»¬æƒ³åœ¨æ‰§è¡ŒæŸä¸ªæ“ä½œåä»/thumbs è·¯ç”±é‡å®šå‘åˆ°å®‰é™è·¯ç”±ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸ä½¿ç”¨é‡å®šå‘ç»„ä»¶çš„æƒ…å†µä¸‹å®Œæˆ**ã€‚**

ä½ ä¼šæ€ä¹ˆåšï¼Ÿ

ä¸æˆ‘ä»¬å‘ˆç°é‡å®šå‘ç»„ä»¶çš„å‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆä¸åŒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢æ˜¾ç¤ºçš„ç¨å¾®æ›´å¼ºåˆ¶æ€§çš„æ–¹æ³•:

`history.push("/quiet)`æˆ–`this.props.history.push("/quiet")`

å¥½å§ï¼Œä½†æ˜¯è¿™ä¸ªå†å²ç‰©ä½“æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿ

å°±åƒä¸Šä¸€ä¸ªä¾‹å­ä¸­çš„ä½ç½®ä¸€æ ·ï¼Œreact-router ä¹Ÿå°†å†å²å±æ€§ä¼ é€’ç»™è·¯ç”±ç»„ä»¶ã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨ containers/Thumbs.js ä¸­çš„å†…å®¹:

```
const ThumbsUp = ({ appState, handleEmojiAction, location }) => {
  return appState === DO_SOMETHING_OVER ? (
    <Redirect push to="/quiet" />
  ) : (
    <EmojiLand
      EmojiBg="linear-gradient(-225deg, #DFFFCD 0%, #90F9C4 48%, #39F3BB 100%)"
      EmojiImg={thumbsUpImg}
      EmojiBtnText="You rock. Thumbs up!"
      HandleEmojiAction={handleEmojiAction}
      appState={appState}
      locationState={location.state}
    />
  );
}; 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å†å²å¯¹è±¡:

```
const ThumbsUp = ({ appState, handleEmojiAction, location, history }) => {
  if (appState === DO_SOMETHING_OVER) {
history.push("/quiet");
  }
  return (
    <EmojiLand
      EmojiBg="linear-gradient(-225deg, #DFFFCD 0%, #90F9C4 48%, #39F3BB 100%)"
      EmojiImg={thumbsUpImg}
      EmojiBtnText="You rock. Thumbs up!"
      HandleEmojiAction={handleEmojiAction}
      appState={appState}
      locationState={location.state}
    />
  );
}; 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œç»“æœæ˜¯ä¸€æ ·çš„:

<figure>[![](../Images/79978be1458402fe3b1eaa8b768527c9.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--SSogwNga--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2ApaoJyMt2u4F3dfvYXeTdPQ.gif) 

<figcaption>ä½¿ç”¨å†å²é“å…·ä¸€æ ·å¥½ç”¨ï¼</figcaption>

</figure>

æ­£å¦‚æ‰€æ–™ï¼Œæˆ‘ä»¬ä»ç„¶æœ‰å¯èƒ½é‡å®šå‘ï¼

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‚¨è¿˜å¯ä»¥åƒè¿™æ ·ä¼ å…¥ä¸€äº›çŠ¶æ€å€¼:

```
history.push("/quiet", {
 hello: "state value"
}) 
```

Enter fullscreen mode Exit fullscreen mode

åªéœ€å°†ç¬¬äºŒä¸ªå¯¹è±¡å‚æ•°ä¼ å…¥ history.push å‡½æ•°ã€‚

### æˆ‘ä»¬å·²ç»å¼€ç®±å³ç”¨äº†

ä½ æœ‰æ²¡æœ‰æ„è¯†åˆ°æˆ‘ä»¬ä¸éœ€è¦åšä»»ä½•å¤šä½™çš„å·¥ä½œï¼Ÿ

æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯å­¦ä¹  react-router æä¾›çš„ APIã€‚è¿™å¾ˆå¥½ï¼Œå®ƒè§£é‡Šäº† react-router å’Œ redux å¼€ç®±å³å¯æ­£å¸¸å·¥ä½œçš„äº‹å®ã€‚

è¿™ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨ reduxï¼Œä½†è¿™ä¸æ˜¯é—®é¢˜ã€‚

æ˜ç™½äº†å—ï¼Ÿ

### æˆ‘ä»¬çš„æ–¹æ³•æœ‰é—®é¢˜

å®é™…ä¸Šï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ–¹æ³•æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ä»–ä»¬å·¥ä½œå¾—å¾ˆå¥½ï¼

ç„¶è€Œï¼Œæœ‰ä¸€äº›è­¦å‘Šï¼Œå–å†³äºä½ å–œæ¬¢å·¥ä½œçš„æ–¹å¼ï¼Œæˆ–è€…ä½ æ­£åœ¨åšçš„é¡¹ç›®ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å®ƒä»¬éš¾ä»¥å¿å—ã€‚

è¯·æ³¨æ„ï¼Œæˆ‘åœ¨å¤§å‹é¡¹ç›®ä¸­ä½¿ç”¨è¿‡ä»¥å‰çš„æ¨¡å¼ï¼Œå®ƒä»¬å·¥ä½œå¾—å¾ˆå¥½ã€‚

ç„¶è€Œï¼Œè®¸å¤š Redux *çº¯ç²¹ä¸»ä¹‰è€…*æ›´å–œæ¬¢èƒ½å¤Ÿé€šè¿‡è°ƒåº¦åŠ¨ä½œæ¥å¯¼èˆªè·¯çº¿ã€‚å› ä¸ºè¿™æ˜¯å¼•å‘çŠ¶æ€å˜åŒ–çš„ä¸»è¦æ–¹å¼ã€‚

æ­¤å¤–ï¼Œè®¸å¤šäººä¹Ÿå–œæ¬¢å°†è·¯çº¿æ•°æ®ä¸ Redux å­˜å‚¨åŒæ­¥ï¼Œå³ï¼Œå°†è·¯çº¿æ•°æ®ä¿å­˜åœ¨ Redux å­˜å‚¨ä¸­ã€‚

æœ€åï¼Œä»–ä»¬ä¹Ÿæ¸´æœ›èƒ½å¤Ÿåœ¨ä»–ä»¬çš„ Redux devtools ä¸­äº«å—å¯¹æ—¶é—´æ—…è¡Œè°ƒè¯•çš„æ”¯æŒï¼Œå› ä¸ºæ‚¨å¯ä»¥åœ¨ä¸åŒçš„è·¯çº¿ä¸Šå¯¼èˆªã€‚

ç°åœ¨ï¼Œå¦‚æœ react-router å’Œ redux ä¹‹é—´æ²¡æœ‰æŸç§æ›´æ·±å±‚æ¬¡çš„é›†æˆï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯ä¸å¯èƒ½çš„ã€‚

é‚£ä¹ˆï¼Œå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ

### è€ƒè™‘ React-Router å’Œ Redux ä¹‹é—´æ›´æ·±å±‚æ¬¡çš„æ•´åˆ

åœ¨è¿‡å»ï¼Œreact-router ä¸ºæ­¤æä¾›äº†åº“ï¼Œ [react-router-redux](https://github.com/reacttraining/react-router/tree/master/packages/react-router-redux) ã€‚ç„¶è€Œï¼Œåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œè¯¥é¡¹ç›®å·²è¢«å¦å†³ï¼Œä¸å†ç»´æŠ¤ã€‚

<figure>[![](../Images/4dab89adafc30ac500535380b23c7ba1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--c1SszdzG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AqRThtmohC5_iNek6ISM9zA.png) 

<figcaption>é¡¹ç›®å¼ƒç”¨ï¼Œè¯¦è§[react-router-redux github repo](https://github.com/reacttraining/react-router/tree/master/packages/react-router-redux)ã€‚</figcaption>

</figure>

æˆ‘çŒœå®ƒä»ç„¶å¯ä»¥è¢«ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ä¸€ä¸ªåºŸå¼ƒçš„åº“ä½ å¯èƒ½ä¼šæœ‰äº›æ‹…å¿ƒã€‚

ä»ç„¶æœ‰å¥½æ¶ˆæ¯ï¼Œå› ä¸º react-router-redux çš„ç»´æŠ¤è€…å»ºè®®æ‚¨ä½¿ç”¨åº“ connected-react-router

å®ƒç¡®å®æœ‰ä¸€äº›è®¾ç½®è¦ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦å®ƒæä¾›çš„å¥½å¤„ï¼Œè¿™å¹¶ä¸å¤šã€‚

è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠæˆ‘ä»¬å¯ä»¥ä»æ•´åˆåˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­å¾—åˆ°ä»€ä¹ˆã€‚

### å°† Connected-React-Router é›†æˆåˆ° EmojiLand ä¸­

é¦–å…ˆè¦åšçš„æ˜¯ Redux å•†åº—ã€‚

**1ã€‚åˆ›å»ºä¸€ä¸ªå†å²å¯¹è±¡**

ä»æŠ€æœ¯ä¸Šè®²ï¼Œæœ‰ä¸€ä¸ª DOM history å¯¹è±¡ç”¨äºæ“çºµæµè§ˆå™¨çš„å†å²ä¼šè¯ã€‚

è®©æˆ‘ä»¬ä»¥ç¼–ç¨‹æ–¹å¼è‡ªå·±åˆ›å»ºä¸€ä¸ªã€‚

ä¸ºæ­¤ï¼Œä»å†å²ä¸­å¯¼å…¥ createBrowserHistory

åœ¨ store/index.js:

```
...
import { createBrowserHistory } from 'history' 
... 
```

Enter fullscreen mode Exit fullscreen mode

å†å²æ˜¯ react-router-dom åŒ…çš„ä¸€ä¸ªä¾èµ–é¡¹ï¼Œå½“æ‚¨åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ react-router æ—¶ï¼Œå®ƒå¯èƒ½å·²ç»å®‰è£…å¥½äº†ã€‚

å¯¼å…¥ createBrowserHistory åï¼Œåˆ›å»ºå¦‚ä¸‹çš„å†å²å¯¹è±¡:

```
..
const history = createBrowserHistory() 
```

Enter fullscreen mode Exit fullscreen mode

ä»ç„¶åœ¨ store/index.js æ–‡ä»¶ä¸­ã€‚

åœ¨æ­¤ä¹‹å‰ï¼Œå•†åº—çš„åˆ›å»ºéå¸¸ç®€å•ï¼Œå°±åƒè¿™æ ·:

```
const store = createStore(reducer); 
```

Enter fullscreen mode Exit fullscreen mode

å…¶ä¸­ reducer å¼•ç”¨ reducers/index.js ä¸­çš„ä¸€ä¸ª reducer å‡½æ•°ï¼Œä½†è¿™ç§æƒ…å†µä¸ä¼šå¾ˆå¿«å‡ºç°ã€‚

**2ã€‚ç¼ ç»•æ ¹éƒ¨å‡é€Ÿå™¨**

ä» connected-react-router åº“ä¸­å¯¼å…¥ä»¥ä¸‹è¾…åŠ©å‡½æ•°

```
import { connectRouter } from 'connected-react-router' 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨å¿…é¡»å¦‚ä¸‹å›¾æ‰€ç¤ºåŒ…è£¹æ ¹å˜å¾„ç®¡:

```
const store = createStore(connectRouter(history)(reducer)); 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œç¼©å‡å™¨å°†è·Ÿè¸ªè·¯ç”±å™¨çš„çŠ¶æ€ã€‚åˆ«æ‹…å¿ƒï¼Œä½ é©¬ä¸Šå°±ä¼šæ˜ç™½è¿™æ„å‘³ç€ä»€ä¹ˆã€‚

ä¸ºäº†æŸ¥çœ‹åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ‰€åšçš„æ•ˆæœï¼Œåœ¨ index.js ä¸­ï¼Œæˆ‘å·²ç»å…¨å±€å¯¼å‡ºäº† redux å­˜å‚¨ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
window.store = store; 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ store.getState()æ£€æŸ¥ redux çŠ¶æ€å¯¹è±¡ä¸­çš„å†…å®¹

è¿™å°±æ˜¯å®é™…æƒ…å†µ:

<figure>[![](../Images/a04e3dc1f3a80404a066e6fd5820a9e8.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--yhGOPrag--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AN3A-toE_cdLRRtwxlzzN5w.gif) 

<figcaption>åœ¨å¼€å‘æ§åˆ¶å°ä¸­æŸ¥æ‰¾ç°åœ¨å¤„äºå†—ä½™çŠ¶æ€</figcaption>

</figure>

çš„`router`å­—æ®µ

å¦‚æ‚¨æ‰€è§ï¼Œredux å•†åº—ä¸­ç°åœ¨æœ‰ä¸€ä¸ªè·¯ç”±å™¨å­—æ®µï¼è¯¥è·¯ç”±å™¨å­—æ®µå°†å§‹ç»ˆé€šè¿‡ä½ç½®å¯¹è±¡ä¿å­˜å…³äºå½“å‰è·¯ç”±çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è·¯å¾„åã€çŠ¶æ€ç­‰ã€‚

æˆ‘ä»¬è¿˜æ²¡å®Œã€‚

ä¸ºäº†åˆ†æ´¾è·¯ç”±æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦åº”ç”¨ connected-react-router åº“ä¸­çš„å®šåˆ¶ä¸­é—´ä»¶ã€‚

è¿™å°†åœ¨ä¸‹é¢è§£é‡Š

**3ã€‚åŒ…æ‹¬ä¸€ä¸ªå®šåˆ¶ä¸­é—´ä»¶**

è¦åŒ…å«ç”¨äºå¤„ç†è°ƒåº¦åŠ¨ä½œçš„å®šåˆ¶ä¸­é—´ä»¶ï¼Œä»åº“ä¸­å¯¼å…¥æ‰€éœ€çš„ routerMiddleware ä¸­é—´ä»¶:

```
...
import { connectRouter, routerMiddleware } from 'connected-react-router' 
```

Enter fullscreen mode Exit fullscreen mode

ç„¶åä½¿ç”¨ redux:
ä¸­çš„ applyMiddleware å‡½æ•°

```
... 
import { createStore, applyMiddleware } from "redux";
... 
```

Enter fullscreen mode Exit fullscreen mode

```
const store = createStore(
  connectRouter(history)(reducer),
applyMiddleware(routerMiddleware(history))
); 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œæˆ‘ä»¬å·®ä¸å¤šå®Œæˆäº†ã€‚åªå·®ä¸€æ­¥äº†ã€‚

**4ã€‚ä½¿ç”¨è¿æ¥çš„è·¯ç”±å™¨ï¼**

è®°ä½ï¼Œreact-redux ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè·¯ç”±ç»„ä»¶ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›è·¯ç”±ç»„ä»¶åŒ…è£…åœ¨ connected-react-router åº“ä¸­çš„ ConnectedRouter ç»„ä»¶ä¸­ã€‚

æ–¹æ³•å¦‚ä¸‹:

é¦–å…ˆï¼Œåœ¨ index.js ä¸­å¯¼å…¥ ConnectedRouter ç»„ä»¶ã€‚

```
import { ConnectedRouter } from 'connected-react-router' 
... 
```

Enter fullscreen mode Exit fullscreen mode

ä¸‹é¢æ˜¯ index.js æ–‡ä»¶çš„æ¸²æŸ“å‡½æ•°:

```
render(
  <Provider store={store}>
    <App />
  </Provider>,
  document.getElementById("root")
); 
```

Enter fullscreen mode Exit fullscreen mode

è¯·è®°ä½ï¼Œåº”ç”¨ç¨‹åºåœ¨åº”ç”¨ç¨‹åºä¸­æ¸²æŸ“ä¸åŒçš„è·¯çº¿ã€‚

```
const App = () => (
  <Router>
    <Switch>
      <Route exact path="/" component={AngryDude} />
      <Route path="/quiet" component={KeepQuiet} />
      <Route path="/smile" component={SmileLady} />
      <Route path="/think" component={ThinkHard} />
      <Route path="/thumbs" component={ThumbsUp} />
      <Route path="/excited" component={BeExcited} />
    </Switch>
  </Router>
); 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œåœ¨ index.js ä¸­ï¼Œç”¨ ConnectedRouter ç»„ä»¶åŒ…è£… App ç»„ä»¶ã€‚ConnectedRouter ç»„ä»¶åº”è¯¥ä»…æ¬¡äº react-router ä¸­çš„ Provider ç»„ä»¶

æˆ‘çš„æ„æ€æ˜¯:

```
render(
  <Provider store={store}>
 <ConnectedRouter>
      <App />
</ConnectedRouter>
  </Provider>,
  document.getElementById("root")
); 
```

Enter fullscreen mode Exit fullscreen mode

è¿˜æœ‰ä¸€ä»¶äº‹ï¼

ç°åœ¨ï¼Œè¯¥åº”ç”¨ç¨‹åºä¸ä¼šåƒé¢„æœŸçš„é‚£æ ·å·¥ä½œï¼Œå› ä¸º ConnectedRouter éœ€è¦ä¸€ä¸ªå†å²å±æ€§ï¼Œå³æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„å†å²å¯¹è±¡ã€‚

<figure>[![](../Images/109097ce9fea10ae6c41df2f56c6a7cb.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--ueox7Zun--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AQmvirFH074vD-3ByXIBGbw.png)

<figcaption>app ç°åœ¨æŠ›å‡ºè¿™ä¸ªé”™è¯¯:(</figcaption>

</figure>

å› ä¸ºæˆ‘ä»¬åœ¨å¤šä¸ªåœ°æ–¹éœ€è¦åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®ƒä½œä¸ºä¸€ä¸ªå¯¼å‡ºæ¨¡å—ã€‚

ä¸€ä¸ªå¿«é€Ÿçš„è§£å†³æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ store/history.js

```
import { createBrowserHistory } from "history";
const history = createBrowserHistory(); 
```

Enter fullscreen mode Exit fullscreen mode

```
export default history; 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ï¼Œè¿™ä¸ªå¯¼å‡ºçš„å†å²å¯¹è±¡å°†åœ¨ä¸¤ä¸ªéœ€è¦å®ƒçš„åœ°æ–¹ä½¿ç”¨ã€‚

åœ¨ index.js ä¸­æ˜¯è¿™æ ·å¯¼å…¥çš„:

```
import history from "./store/history"; 
```

Enter fullscreen mode Exit fullscreen mode

ç„¶åä¼ é€’ç»™å¦‚ä¸‹æ‰€ç¤ºçš„ ConnectedRouter ç»„ä»¶:

```
render(
  <Provider store={store}>
    <ConnectedRouter history={history}>
      <App />
    </ConnectedRouter>
  </Provider>,
  document.getElementById("root")
); 
```

Enter fullscreen mode Exit fullscreen mode

è¿™æ ·ï¼Œè®¾ç½®å°±å®Œæˆäº†ï¼Œåº”ç”¨ç¨‹åºè¿è¡Œäº†â€”â€”æ²¡æœ‰æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„è®¨åŒçš„é”™è¯¯ï¼

è¯·è®°ä½ï¼Œæˆ‘åªè®¾ç½®äº† connected-react-routerï¼Œä½†æ˜¯æˆ‘é¼“åŠ±æ‚¨æŸ¥çœ‹è¿™ä¸ªåº“çš„æ›´é«˜çº§çš„ç”¨æ³•ã€‚

ä½ å¯ä»¥ç”¨ connected-react-router åº“åšæ›´å¤šçš„äº‹æƒ…ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éƒ½è®°å½•åœ¨å®˜æ–¹ FAQ çš„[ä¸­ã€‚æ­¤å¤–ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªæ›´å¥å£®çš„ Redux devtools è®¾ç½®å’Œä¸€ä¸ªæ—¥å¿—è®°å½•ä¸­é—´ä»¶ï¼Œä¸€å®šè¦åˆ©ç”¨æ—¶é—´æ—…è¡Œå’ŒåŠ¨ä½œæ—¥å¿—è®°å½•ï¼](https://github.com/supasate/connected-react-router/blob/master/FAQ.md#how-to-navigate-with-redux-action)

### ç»“è®º

æˆ‘å¸Œæœ›è¿™å’Œæˆ‘ä¸€æ ·æœ‰è¶£ï¼

å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œä¸€å®šè¦åœ¨è¯„è®ºåŒºæå‡ºæ¥ï¼Œæˆ‘å¾ˆä¹æ„å¸®å¿™ã€‚

å»é€ äº›ç‰›é€¼çš„ä¸œè¥¿ï¼Œæˆ‘ä¸€ä¼šå„¿æ¥æ‰¾ä½ ï¼

* * *

### Plug: [LogRocket](https://logrocket.com/signup/) ï¼Œä¸€æ¬¾é€‚ç”¨äºç½‘ç»œåº”ç”¨çš„ DVR

<figure>[![](../Images/d56be9e9e36d8fa98c6959f7097b7787.png)](https://logrocket.com/signup/)

<figcaption></figcaption>

</figure>

LogRocket æ˜¯ä¸€ä¸ªå‰ç«¯æ—¥å¿—å·¥å…·ï¼Œå¯ä»¥è®©ä½ å›æ”¾é—®é¢˜ï¼Œå°±åƒå®ƒä»¬å‘ç”Ÿåœ¨ä½ è‡ªå·±çš„æµè§ˆå™¨ä¸­ä¸€æ ·ã€‚LogRocket ä¸éœ€è¦çŒœæµ‹é”™è¯¯å‘ç”Ÿçš„åŸå› ï¼Œä¹Ÿä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®æˆªå›¾å’Œæ—¥å¿—è½¬å‚¨ï¼Œè€Œæ˜¯è®©æ‚¨é‡æ”¾ä¼šè¯ä»¥å¿«é€Ÿäº†è§£å“ªé‡Œå‡ºé”™äº†ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºå®Œç¾é…åˆï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œå¹¶ä¸”æœ‰æ’ä»¶å¯ä»¥è®°å½•æ¥è‡ª Reduxã€Vuex å’Œ@ngrx/store çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚

é™¤äº†è®°å½• Redux æ“ä½œå’ŒçŠ¶æ€ï¼ŒLogRocket è¿˜è®°å½•æ§åˆ¶å°æ—¥å¿—ã€JavaScript é”™è¯¯ã€å †æ ˆè·Ÿè¸ªã€å¸¦æœ‰å¤´+æ­£æ–‡çš„ç½‘ç»œè¯·æ±‚/å“åº”ã€æµè§ˆå™¨å…ƒæ•°æ®å’Œè‡ªå®šä¹‰æ—¥å¿—ã€‚å®ƒè¿˜ä½¿ç”¨ DOM æ¥è®°å½•é¡µé¢ä¸Šçš„ HTML å’Œ CSSï¼Œç”šè‡³ä¸ºæœ€å¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºé‡æ–°åˆ›å»ºåƒç´ çº§å®Œç¾è§†é¢‘ã€‚

å…è´¹è¯•ç”¨ã€‚

* * *

å¸–å­[ç”¨ React-router å’Œ Redux](https://blog.logrocket.com/conquer-navigation-state-with-react-router-and-redux-f1beb9b8ea7c/) å¾æœå¯¼èˆªçŠ¶æ€æœ€æ—©å‡ºç°åœ¨ [LogRocket åšå®¢](https://blog.logrocket.com)ä¸Šã€‚