# Firestore Export API å‘å¸ƒå‰å¦‚ä½•ä½¿ç”¨

> åŸæ–‡:[https://dev . to/christianalexander/how-to-use-the-firestore-export-API-before-that-is-released-2 ikd](https://dev.to/christianalexander/how-to-use-the-firestore-export-api-before-it-is-released-2ikd)

## TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

æŸ¥çœ‹ [FirestoreRestore](https://github.com/christianalexander/FirestoreRestore) ã€‚
å®ƒä½¿ç”¨ä¸€ç§å…¨æ–°çš„ API æ¥å¤‡ä»½å’Œæ¢å¤ä½ çš„ Firestore æ•°æ®åº“ï¼

## èƒŒæ™¯

å·²ç»æœ‰å¾ˆå¤šäººè¦æ±‚ Google åœ¨ä»–ä»¬çš„äº‘ Firestore äº§å“ä¸­å¢åŠ å¤‡ä»½å’Œæ¢å¤åŠŸèƒ½ã€‚ç›´åˆ°æœ¬å‘¨ï¼Œå¤‡ä»½ Firestore æ•°æ®åº“çš„å”¯ä¸€æ–¹æ³•æ˜¯ä½œä¸ºç®¡ç†å®¢æˆ·ç«¯è¿è¡Œéå†æ ‘çš„å®ç”¨ç¨‹åºï¼Œå°†æ¯ä¸ªæ–‡æ¡£çš„ JSON è¡¨ç¤ºä¿å­˜åœ¨ç£ç›˜ä¸Šã€‚

## å‘ç°

ä»Šå¤©æ—©ä¸Šï¼Œæˆ‘æ‰“å¼€äº†[è°·æ­Œ API æµè§ˆå™¨](https://developers.google.com/apis-explorer/#s/firestore/v1beta1/)ï¼Œå‘ç° Firestore `v1beta1` : `exportDocuments`å’Œ`importDocuments`ä¸‹é¢åˆ—å‡ºäº†ä¸¤ä¸ªæ–°æ–¹æ³•ã€‚

[![APIs Explorer Screenshot](../Images/6277286a29dc78e8c5b20f29ab9ca024.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--OVajWMhp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/mypdp1zzzof9nv0cl0l0.png)

## æ¢ç´¢

æ­£å¦‚ API æ–‡æ¡£æ‰€è¿°ï¼Œ`firestore.projects.databases.exportDocuments`èƒ½å¤Ÿå°† Firestore æ•°æ®å¯¼å‡ºåˆ° Google äº‘å­˜å‚¨ä¸­ã€‚

ä¸ºäº†æµ‹è¯•è¿™ä¸€ç‚¹ï¼Œæˆ‘æ‰“å¼€äº† [Firebase æ§åˆ¶å°](https://console.firebase.google.com)å¹¶åˆ›å»ºäº†ä¸€ä¸ªæ–°é¡¹ç›®ã€‚ä¸ºäº†å¤‡ä»½æ•°æ®ï¼Œæˆ‘ä»æ§åˆ¶å°åˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·æ–‡æ¡£ã€‚

[![Creating a document](../Images/74a9b7125d13d18655e1efccfdb310f9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--40mUHeY2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/cxrb8v1lyzh7zrzpv4ty.png)

åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘æ‰“å¼€äº† [Google äº‘å­˜å‚¨æ§åˆ¶å°](https://console.cloud.google.com/storage/)ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªå­˜å‚¨æˆ‘çš„å¤‡ä»½çš„æ¡¶ã€‚

ä» [Google APIs Explorer çš„`exportDocuments`é¡µé¢](https://developers.google.com/apis-explorer/#s/firestore/v1beta1/firestore.projects.databases.exportDocuments)ï¼Œæˆ‘è¾“å…¥äº† Firebase é¡¹ç›®åç§°ï¼Œä»¥åŠå­˜å‚¨æ¡¶çš„è·¯å¾„ï¼Œç„¶åç‚¹å‡»**æ‰§è¡Œ**ã€‚

[![Execute!](../Images/7013b67fe59984be5f0a5d8d0e5efca5.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--_XMNJ1dM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/oy92jzhev0sspj14dtoq.png)

ä»¥ä¸‹æ˜¯ API çš„å›åº”:

```
{  "name":  "projects/firestore-restore/databases/(default)/operations/<REDACTED>",  "metadata":  {  "@type":  "type.googleapis.com/google.firestore.admin.v1beta1.ExportDocumentsMetadata",  "startTime":  "2018-07-18T23:20:26.535130Z",  "operationState":  "PROCESSING",  "outputUriPrefix":  "gs://firestore-restore/backups/2018-07-18"  }  } 
```

Enter fullscreen mode Exit fullscreen mode

è¿‡äº†ä¸€ä¼šå„¿ï¼Œæˆ‘æ‰“å¼€äº†æ°´æ¡¶ã€‚æœç„¶ï¼Œæ•°æ®å‡ºç°äº†ï¼

[![Backup in the bucket](../Images/697a5a52aac66642e659d1bf5216f818.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--rsVq9jzt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/icikz8lm449v1ytzhy3d.png)

## æ¢å¤

ç°åœ¨ï¼Œä¸ºäº†æµ‹è¯•æ¢å¤åŠŸèƒ½ã€‚æˆ‘åˆ é™¤äº† Firestore æ•°æ®åº“çš„å†…å®¹ï¼Œ[ç”¨å’Œå¯¼å‡ºè¯·æ±‚ç›¸åŒçš„å‚æ•°è¿è¡Œ`importDocuments`](https://developers.google.com/apis-explorer/#s/firestore/v1beta1/firestore.projects.databases.importDocuments) ï¼Œæœç„¶æ•°æ®å›æ¥äº†ï¼

## å¤‡ä»½æ˜¯å¦å®Œæˆï¼Ÿ

ä¸å¹¸çš„æ˜¯ï¼Œç›®å‰æ²¡æœ‰â€œè®°å½•â€çš„æ–¹æ³•æ¥æ£€æŸ¥æ­£åœ¨è¿›è¡Œçš„ Firestore å¯¼å‡ºçš„çŠ¶æ€ã€‚å¹¸è¿çš„æ˜¯ï¼Œé€šè¿‡ä¸€äº› URL çŒœæµ‹ï¼Œæˆ‘èƒ½å¤Ÿæ‰¾åˆ°æ“ä½œèµ„æºçš„ç«¯ç‚¹ã€‚å®ƒä¸€ç›´éƒ½åœ¨é‚£é‡Œã€‚å¯¼å‡ºå“åº”ä¸­çš„`name`å­—æ®µæ˜¯çŠ¶æ€è·¯å¾„ï¼

## ä¸´æ—¶å·¥å…·:[ç«åº—](https://github.com/christianalexander/FirestoreRestore)

ç”±äºæˆ‘ä¸çŸ¥é“ Google ä½•æ—¶ä¼šæ­£å¼æ”¯æŒå’Œæ„å»ºç”¨äºå¤‡ä»½å’Œæ¢å¤äº‘ Firestore æ•°æ®åº“çš„å·¥å…·ï¼Œæ‰€ä»¥æˆ‘å¼€å‘äº†ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå®ç”¨ç¨‹åºæ¥ä¸è¯¥æœåŠ¡è¿›è¡Œäº¤äº’ã€‚

å®ƒéœ€è¦åˆ›å»ºä¸€ä¸ªå…·æœ‰â€œäº‘æ•°æ®å­˜å‚¨å¯¼å…¥å¯¼å‡ºç®¡ç†å‘˜â€è§’è‰²çš„[æœåŠ¡å¸æˆ·](https://console.cloud.google.com/iam-admin/serviceaccounts/project)ã€‚ä½¿ç”¨æœåŠ¡å¸æˆ·çš„`JSON`å¯†é’¥ï¼Œè¯¥å·¥å…·èƒ½å¤Ÿæ‰§è¡Œå¤‡ä»½å’Œæ¢å¤ã€‚

æŸ¥çœ‹è‡ªè¿°æ–‡ä»¶äº†è§£æ›´å¤šä¿¡æ¯ğŸ˜€

## çŒœæµ‹

è°·æ­Œå¯èƒ½ä¼šåœ¨ Firebase UI ä¸­æ¨å‡ºå¤‡ä»½å’Œæ¢å¤åŠŸèƒ½ã€‚å®ƒå¯èƒ½ä¼šå…¬å¼€ API ä¸­å­˜åœ¨çš„æ¯ä¸ªé›†åˆçš„å¤‡ä»½åŠŸèƒ½ã€‚å®ƒå¯èƒ½æ¯”ä½ åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„å‘½ä»¤è¡Œç¨‹åºæ›´å®¹æ˜“ä½¿ç”¨ã€‚

åœ¨é‚£ä¹‹å‰ï¼Œå¥½å¥½äº«å— CLI å§ï¼