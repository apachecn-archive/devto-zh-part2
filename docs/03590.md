# 微服务的帮助

> 原文:[https://dev.to/ndjuric93/help-with-microservices-2b04](https://dev.to/ndjuric93/help-with-microservices-2b04)

你好，这是我在这里的第一个帖子。

我正在为自己的目的构建一个小型的 deezer/spotify 克隆。我收集了大量的 CD，分成各种不同的音乐格式。在这样做的同时，我将尝试实现一个微服务架构。我已经看到网飞基本上外包了我想要的大部分工具，但我想自己做，我想知道是否有人对此有意见。

我选择的技术是 Python Flask 和 Apache Kafka。
我将以下所有东西实现为一个单独的 Flask 应用程序
因此，正如任何微服务架构所需要的那样

#### [](#service-registry)服务注册表

这是一个应用程序，它会将自己的位置发布到 kafka 主题，因此所有的服务都可以到达它。它有一个用于注册和获取服务的 REST api。

#### [](#api-gateway)API 网关

这是一个应用程序，有一个 REST api，它将接受来自前端的请求，检查服务是否启动和存在，并将其转发给适当的服务。有一点肯定是缺少的，那就是负载均衡器，但是我们暂时先不考虑它。

现在是服务。我在想，例如，如何正确地将它们解耦。

#### [](#users)用户

这肯定是一个独立的微服务，它有登录和注册 API，并在自己的数据库中跟踪用户。

现在来看看棘手的问题。现在，我想这种东西是非常固执己见的，但我想听听其他人对它的看法。

#### [](#records)记录

唱片服务基本上是 3 个 GET API，你可以从中获取艺术家/专辑/曲目列表。这很好，但对于我的平台，我需要保留每首歌的路径。我会把它放在另一个表中，用外键连接这两个表，这样我就可以保留我“每个服务模式的数据库”。实际上，记录微服务不应该使用带有路径的表！现在我的问题是，我希望有一个服务可以偶尔更新这些数据库，我的想法是，这个服务应该在哪里运行？

#### [](#playlist)Playlist

播放列表服务负责已经提到的路径数据库，它会向 Kafka broker 发布包含歌曲路径的消息。

#### [](#player)玩家

播放器消耗卡夫卡信息，一首接一首播放歌曲。

#### [](#analytics)分析学

这是我最关心的服务。当基本上它应该分析所有服务中发生的所有事情时，我如何将它与其他部分分离？实际上是所有的服务都有一个日志 Kafka 主题来发布他们的内容的解决方案吗？并且分析不断地在它们自己的表中消耗这些消息？

关于这个，我想听听更多的意见。我是不是过度使用了卡夫卡，还是完全按照它的本意使用了它？

非常感谢！