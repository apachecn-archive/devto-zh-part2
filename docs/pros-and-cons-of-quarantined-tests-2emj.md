# 隔离测试的利弊

> 原文：<https://dev.to/mlapierre/pros-and-cons-of-quarantined-tests-2emj>

古怪的测试，也就是那些只是偶尔失败的测试，是任何端到端自动化测试套件的祸根。

另一种类型的问题测试是每次都失败的测试，但它测试的东西被认为不重要，不足以立即修复。如果你不得不忽略一些失败的测试，迟早你会忽略一个你应该注意的测试。或者更糟的是，你可能会决定忽略它们，因为显然没有人在修复这些错误。

如果一个测试被破坏了，如果可能的话，修复它应该是第一步行动。但是如果其他任务有更高的优先级呢？如果你确信问题在于测试而不是被测试的软件，那么允许测试继续失败，至少是暂时的，可能是合理的。

当您经常忽略一些失败的测试时，整个套件就有被视为不可靠的风险。防止这种情况的常见方法是隔离不可靠/失败的测试。在这个上下文中，隔离指的是将麻烦的测试与测试套件的其余部分隔离开来。不是因为害怕传染，除了它们可能对其余测试的感知产生负面影响。

我想我第一次接触到这个概念是在马丁·福勒的一篇文章中。这是一本关于易剥落测试以及如何识别和解决其剥落原因的好书。这篇文章不是关于如何修复它们，所以如果你想知道这方面的信息，可以看看那篇文章。

最近，[Google 测试博客](https://testing.googleblog.com/2016/05/flaky-tests-at-google-and-how-we.html)上的一篇文章提到了处理相同类型棘手测试的相同技术。

尽管隔离测试可能是一个很好的临时解决方案，但是如果您不修复测试(或错误),您可能会陷入我之前提到的情况；一些失败的测试会给人留下整个套件都不可靠的印象，这足以让你认为它们是死刑判决。

我的团队试图用几种方法来避免死刑判决:

1.  将隔离的测试结果与测试套件的其余部分分开报告。

    这样，每个人都可以看到可靠测试的结果，并知道应该立即处理失败。我们不需要试图在那些古怪的失败中找出“真正的”失败。

2.  用隔离原因标记隔离测试。

    所以古怪的测试会被贴上标签。暂时无法修复的失败测试会得到报告，并标上问题编号。如果标签不够，可以添加注释。这不足以挽救被隔离的测试不被遗忘，但是它可以帮助避免失去跟踪测试为什么被隔离的潜在问题。

3.  安排对隔离测试的定期审查。

    如果没有预定，就不可能发生。如果优先级改变，失败的测试可以分配给某人来修复，如果我们认为它比我们最初认为的更重要，可以投入时间来修复一个不可靠的测试。

4.  删除测试

    如果任何测试被隔离了很长时间，那么重新考虑该测试提供的价值是值得的。也许事实证明单元测试，甚至探索性测试，提供了足够的覆盖率。或者测试可能覆盖了软件中很少改变的部分，或者没有多少用处的部分。在这种情况下，如果出现倒退，也没什么大不了的。如果有人可能决定重新编写测试，我们可能会`@Ignore`测试并留下注释解释原因——而不是删除它。

你如何处理不稳定的或者失败的测试，这些测试不能很快得到解决？