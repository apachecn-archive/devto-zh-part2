# ç”¨å¸¦æœ‰ ES6 ç‰¹æ€§çš„ JavaScript ä¸­çš„é€’å½’ç»™é¢è¯•å®˜ç•™ä¸‹æ·±åˆ»å°è±¡

> åŸæ–‡:[https://dev . to/Hugo _ _ df/impress-interviewers-with-recursion-in-JavaScript-with-es6-features-486d](https://dev.to/hugo__df/impress-interviewers-with-recursion-in-javascript-with-es6-features-486d)

> å¯¹äº JavaScript é¢è¯•æ¥è¯´ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”é€’å½’æ›´ç‚«æ›´æœ‰ç”¨çš„äº†ã€‚

å¦‚æœä½ åªæ˜¯æƒ³å¯¹ JavaScript ä¸­çš„é€’å½’å°è±¡æ·±åˆ»ï¼Œè¿™é‡Œæœ‰ä¸€äº›åŠçœŸå®ä¸–ç•Œ(æŠ€æœ¯æµ‹è¯•ç±»å‹)çš„ä¾‹å­ã€‚

é€’å½’è§£å†³é—®é¢˜çš„ç®€çŸ­å®šä¹‰(åœ¨è®¡ç®—æœºç§‘å­¦ä¸­)æ˜¯:ä¸è¦ä½¿ç”¨è¿­ä»£ã€‚è¿™é€šå¸¸æ„å‘³ç€ä¸€ä¸ªå‡½æ•°å¿…é¡»ç”¨åŒä¸€ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ›´å°çš„å®ä¾‹æ¥è°ƒç”¨è‡ªå·±ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªæ— å…³ç´§è¦çš„æƒ…å†µ(é€šå¸¸åœ¨é—®é¢˜ä¸­å®šä¹‰)ã€‚

å› æ­¤ï¼Œé€’å½’ç”±å‡ ä¸ªæ­¥éª¤ç»„æˆ:

1.  åŸºæœ¬æˆ–ç»ˆæ­¢æƒ…å†µï¼Œè¿™æ˜¯æˆ‘ä»¬æƒ³è¦ç»“æŸçš„æƒ…å†µâ€œä¸€ä¸ªé€’å½’å‡½æ•°å®šä¹‰æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª*åŸºæœ¬æƒ…å†µ*ï¼Œæ„å‘³ç€è¾“å…¥å‡½æ•°äº§ç”Ÿä¸€ä¸ªç»“æœ(æ— é€’å½’)â€”â€”[ç»´åŸºç™¾ç§‘ï¼Œé€’å½’(è®¡ç®—æœºç§‘å­¦)](https://en.wikipedia.org/wiki/Recursion_(computer_science)#Recursive_functions_and_algorithms)
2.  é€’å½’çš„æƒ…å†µä¸‹ï¼Œç¨‹åºé€’å½’(å†æ¬¡[ç»´åŸºç™¾ç§‘ï¼Œé€’å½’(è®¡ç®—æœºç§‘å­¦)](http://one%20or%20more%20recursive%20cases,%20meaning%20input(s)%20for%20which%20the%20program%20recurs%20(calls%20itself)))

åœ¨è¿™ç¯‡æ–‡ç« ä¸­:

*   [ğŸ›°é€’å½’åŒ…è£…é¡ºåº HTTP è¯·æ±‚](#recursion-to-wrap-sequential-http-requests)
*   [ğŸ“ƒè®¡ç®—å­—ç¬¦æ•°](#count-number-of-characters)

è¿™ç¯‡æ–‡ç« çš„ä¾‹å­åœ¨ [ObervableHQ](http://beta.observablehq.com) ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªè¶…çº§é…·çš„å·¥å…·ï¼Œå…è®¸ä½ æ„å»º JavaScript ç¬”è®°æœ¬:

*   [é€’å½’åŒ…è£…é¡ºåº HTTP è¯·æ±‚](https://beta.observablehq.com/@hugodf/recursion-to-wrap-http-requests)
*   [è®¡ç®—å­—ç¬¦æ•°](https://beta.observablehq.com/@hugodf/count-something-in-something-else)

## [](#%F0%9F%9B%B0-recursion-to-wrap-sequential-http-requests)ğŸ›°é€’å½’åŒ…è£…é¡ºåº HTTP è¯·æ±‚

å‡è®¾æ‚¨éœ€è¦ä» REST API è·å–å¤šä¸ªé¡µé¢ï¼Œå¹¶ä¸”æ‚¨è¢«è¿«ä½¿ç”¨æœ¬åœ° HTTPS æ¨¡å—(ObservableHQ ä¸Šçš„[ç¤ºä¾‹)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä» Reddit API è·å–æ³¨é‡Šã€‚](https://beta.observablehq.com/@hugodf/recursion-to-wrap-http-requests)

ä½¿ç”¨æ­¤ API:

*   å¦‚æœæœ‰è¶…è¿‡ä¸€ä¸ªå“åº”æ‰€èƒ½å®¹çº³çš„è¯„è®ºï¼Œå®ƒå°†åœ¨æ•°æ®ä¸­è¿”å›ä¸€ä¸ª`after`å­—æ®µï¼Œè¯¥å­—æ®µå¯ä»¥åœ¨è·å–ä¸‹ä¸€ä¸ªè¯„è®ºå—çš„è¯·æ±‚ä¸­ç”¨ä½œæŸ¥è¯¢å‚æ•°
*   å¦‚æœæ²¡æœ‰æ›´å¤šçš„è¯„è®ºï¼Œ`after`å°†æ˜¯å‡çš„

è¿™å®šä¹‰äº†æˆ‘ä»¬çš„ç»ˆæ­¢å’Œé€’å½’æƒ…å†µï¼Œæˆ‘ä»¬ä» Reddit API è·å–æ•°æ®ï¼Œç„¶å:

*   `after`æ˜¯ falsy â†’ **ç»ˆæ­¢æ¡ˆä¾‹**ï¼Œè¿”å›æ•°æ®
*   `after`è¢«å®šä¹‰â†’ **é€’å½’æƒ…å†µ**ï¼Œé€šè¿‡å®ƒè·å–ä¸‹ä¸€é¡µä»¥åŠå½“å‰è°ƒç”¨è¿”å›çš„æ•°æ®

è¿™é‡Œä½¿ç”¨çš„æŠ€å·§ä¹‹ä¸€æ˜¯ä»ç¬¬ä¸€æ¬¡ä¼ é€’å¼€å§‹å°†ä¸€ä¸ªç©ºçš„`data`æ•°ç»„ä¼ é€’ç»™`recursiveCommentFetch`å‡½æ•°ã€‚è¿™å…è®¸æˆ‘ä»¬åœ¨éå†æ¯ä¸ªé€’å½’è°ƒç”¨æ—¶ä¸æ–­æ³¨å…¥è¶Šæ¥è¶Šå¤šçš„å€¼ï¼Œå› æ­¤èƒ½å¤Ÿåœ¨ç»ˆæ­¢çš„æƒ…å†µä¸‹è§£æå‡ºå®Œæ•´çš„é›†åˆã€‚

```
const fetch = require('node-fetch');
const user = 'hugo__df';

function makeRedditCommentUrl(user, queryParams) {
  return `https://www.reddit.com/user/${user}/comments.json?${
    Object.entries(queryParams)
      .filter(([k, v]) => Boolean(v))
      .map(
        ([k, v]) => `${k}=${v}`
      ).join('&')
  }`;
}

function recursiveCommentFetch(user, data = [], { after, limit = 100 } = {}) {
  const url = makeRedditCommentUrl(user, { after, limit });
  return fetch(url)
    .then(res => res.json())
    .then(res => {
      const { after, children } = res.data;
      const newData = [...data, ...children];
      if (after) {
        // recursive case, there's a way to fetch more comments
        return recurseCommentFetch(user, newData, { after });
      }
      // base or terminating case
      return newData;
    });
}

recursiveCommentFetch(user)
  .then(comments => console.log(comments)); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ç†Ÿæ‚‰äº†è¿™ä¸ª APIï¼Œä¸º Reddit è´¡çŒ®åˆ›å»ºäº†ä»¥ä¸‹å¯è§†åŒ–æ•ˆæœ(GitHub çš„è´¡çŒ®å›¾é£æ ¼)ï¼Œ[åœ¨ ObservableHQ ä¸Šçœ‹åˆ°](https://beta.observablehq.com/@hugodf/reddit-contributions-per-week-graph),[åšå®¢ç‰ˆæœ¬ä¹Ÿæ˜¯å®æ—¶çš„](https://accountableblogging.com/post-frequency):

[![GitHub-style contribution graph for Reddit](../Images/41f7fd6a9105278f0a1205d45daf6224.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--AfZyJ79s--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://d2mxuefqeaa7sj.cloudfront.net/s_55FB281D4CEA97DF7A863A43508C5F8A03ED2CBE43CBD0A7C2D8693AF9B9134C_1538222014400_image.png)

## [](#count-number-of-characters)ğŸ“ƒè®¡ç®—å­—ç¬¦æ•°

å½“é—®é¢˜æ˜¯è¿™æ ·çš„:â€œç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«æ¯ä¸ªå­—ç¬¦åœ¨è¾“å…¥ä¸­å‡ºç°å¤šå°‘æ¬¡çš„å¯¹è±¡â€ã€‚

ObservableHQ ä¸Šæœ‰ä¸€ä¸ª[ç°åœºæ¼”ç¤ºã€‚](https://beta.observablehq.com/@hugodf/count-something-in-something-else)

ç»ˆæ­¢å’Œé€’å½’çš„æƒ…å†µå¹¶ä¸æ˜æ˜¾ï¼Œæ‰€ä»¥è¿™é‡Œæœ‰ä¸€äº›è·³è·ƒ:

1.  ç†è§£ä¸€ä¸ªè¾“å…¥å¯ä»¥è¢«è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥è¢«`.split`æˆä¸€ä¸ªæ•°ç»„(å³ã€‚å¤§å¤šæ•°ä»»æ„è¾“å…¥éƒ½å¯ä»¥è½¬æ¢æˆæ•°ç»„)ã€‚
2.  çŸ¥é“å¦‚ä½•é€’å½’éå†ä¸€ä¸ªæ•°ç»„ï¼Œè¿™å¯èƒ½æ˜¯é€’å½’éå†æœ€å®¹æ˜“/æœ€å¸¸è§çš„äº‹æƒ…ä¹‹ä¸€ï¼Œä½†æ˜¯éœ€è¦çœ‹å‡ æ¬¡æ‰èƒ½æ„Ÿè§‰èˆ’æœ

å¯¹äºé€’å½’å‡½æ•°ï¼Œè¿™ç»™äº†æˆ‘ä»¬ä»¥ä¸‹æƒ…å†µ:

*   å­—ç¬¦åˆ—è¡¨/æ•°ç»„ä¸ºç©ºâ†’ **ç»ˆæ­¢æƒ…å†µ**ï¼Œè¿”å›`characterToCount`å›¾
*   å­—ç¬¦åˆ—è¡¨/æ•°ç»„ä¸ä¸ºç©ºâ†’ **é€’å½’æƒ…å†µ**,é€šè¿‡å¢åŠ /åˆå§‹åŒ–å½“å‰å­—ç¬¦çš„æ¡ç›®æ¥æ›´æ–°`characterToCountMap`ã€‚ç”¨æ›´æ–°çš„æ˜ å°„å’Œåˆ—è¡¨/æ•°ç»„çš„å‰©ä½™éƒ¨åˆ†è°ƒç”¨é€’å½’å‡½æ•°ã€‚

æˆ‘å†™äº†ä¸€ä¸ªæ›´å®Œæ•´çš„å¸–å­: [**ç”¨ ES6 åœ¨ JavaScript ä¸­é€’å½’ï¼Œææ„å’Œ rest/spread**](https://dev.to/hugo__df/recursion-in-javascript-with-es6-destructuring-and-restspread-4fln) ï¼Œå®ƒæ›´è¯¦ç»†åœ°è®²è¿°äº†æˆ‘ä»¬å¦‚ä½•åœ¨ ES6 JavaScript ä¸­é€’å½’éå†åˆ—è¡¨(æ•°ç»„)ã€‚å®ƒè§£é‡Šäº†åƒ`[firstCharacter, ...rest]`ç¬¦å·è¿™æ ·çš„ä¸œè¥¿ã€‚

```
function recurseCountCharacters(
  [firstCharacter, ...rest],
  characterToCountMap = {}
) {
  const currentCharacterCount = characterToCountMap[firstCharacter] || 0;
  const newCharacterToCountMap = {
    ...characterToCountMap,
    [firstCharacter]: currentCharacterCount + 1
  };

  if (rest.length === 0) {
    // base/terminating case
    // -> nothing characters left in the string
    return newCharacterToCountMap;
  }
  // recursive case
  return recurseCountCharacters(rest, newCharacterToCountMap);
}

function countCharacters(input) {
  return recurseCountCharacters(String(input).split(''));  
}

console.log(countCharacters(1000000));
// { "0":6, "1": 1 }
console.log(countCharacters('some sentence'));
// { "s":2,"o":1,"m":1,"e":4," ":1,"n":2,"t":1,"c":1} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯ä½ å¦‚ä½•ä½¿ç”¨é€’å½’è½»æ¾é€šè¿‡é¢è¯•ğŸ™‚ï¼Œç»•ç€é‚£äº›ç©å…·é—®é¢˜è·‘åœˆã€‚

é¢è¯•é—®é¢˜çš„é€’å½’è§£å†³æ–¹æ¡ˆçœ‹èµ·æ¥æ¯”è¿­ä»£è§£å†³æ–¹æ¡ˆæ›´é…·ã€æ›´ç®€æ´ï¼Œæ›´å¸å¼•é¢è¯•å®˜çš„çœ¼çƒã€‚

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œæ‚¨å¯ä»¥é€šè¿‡ Twitter [@hugo__df](https://twitter.com/hugo__df) è”ç³»æˆ‘ã€‚

[Andre Mouton](https://unsplash.com/@andremouton?utm_medium=referral&utm_campaign=photographer-credit&utm_content=creditBadge)