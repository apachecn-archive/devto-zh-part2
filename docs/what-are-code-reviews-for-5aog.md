# 代码评审是为了什么？

> 原文：<https://dev.to/brightdevs/what-are-code-reviews-for-5aog>

人们常说代码审查是识别软件缺陷最有效的方法。然而，很容易注意到“代码评审”这个术语有点超载，它可能对不同的人有不同的含义。在[光明发明](https://brightinventions.pl)，我们仍在学习如何最大限度地利用这一实践(就像我们行业的每个人一样，对吗？)并且我们已经经历了代码审查方法的几个阶段。让我分享一些关于它的想法。

## 代码评审是关于分号的吗？

与代码审查最简单的联系是，它都是关于一致的代码风格——为了确保代码格式良好，所有的空格都被替换为制表符或者所有的制表符都被替换为空格，到处都有分号或者到处都没有分号，等等。虽然这是审查人员可能会看到的最简单的事情，但这些事情太容易浪费我们的时间了，应该由自动化工具来处理，如共享 IDE 格式设置([例如在 JetBrains IDE](https://www.jetbrains.com/help/idea/sharing-your-ide-settings.html)中可用)或静态代码分析器，如插入到我们持续集成环境中的 [ESLint](https://eslint.org/) 或 [TSLint](https://palantir.github.io/tslint/) 。

显然存在自动化工具无法识别的情况，因此我们应该在代码评审中寻找这些情况，但是拥有统一且一致的代码风格绝对不是我们从代码评审中获益的唯一方式。我们绝对应该深入调查。

[![What are Code Reviews for?](../Images/ccb08f83a2a0b5e8f48b4de21303d069.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--g7Q_Pyt7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/k8pd2qz07xcs0hmllims.jpg)

代码审查是一个理想的机会:

*   分享语言或平台级别的习惯用法和实践——每种技术都有自己的偏好和最适合的条件；让我们确保我们正在正确地使用我们的工具，充分受益于它的特性并避免它的陷阱，
*   分享通用的编程模式——有太多的设计模式，很难知道所有的模式，而且没有一个是万能的，所以寻找那些应该使用但没有使用的模式是值得的，反之亦然。
*   确保可读性和可维护性——如果评审者不能像阅读散文一样阅读代码，那么还有改进的空间，
*   讨论命名和抽象——让我们确保团队就我们代码库中的这些东西达成一致，并确保它们实际上正确地代表了领域世界中的想法和概念。
*   考虑所提议的改变对向后兼容性、性能、可访问性、稳定性、资源消耗和运行软件的许多其他方面的影响。

## 也是关于长寿的

所有这些方面都有助于整个项目的质量，很明显，通常质量更高的项目更容易(也更便宜)维护。但是还有更多。

我们容易纠结的一个问题是关于[代码所有权](https://martinfowler.com/bliki/CodeOwnership.html)。当每个团队成员在明确隔离的任务上工作时，不同人编写的代码之间很少有交集，并且会产生一些代码所有权孤岛。这意味着在必要的情况下，很难让另一个人来接手这项任务。这种必要性一直在发生——人们可能会生病，他们可能会去度假，或者他们只是去做其他任务、项目或工作，所以在一个健康的项目中不应该出现所有权孤岛。

代码审查与这个问题有什么关系？通过将持续的代码审查作为开发过程中不可或缺的一部分，我们可以确保没有一行代码没有被其他团队成员看到。代码评审可能是集体代码所有权的推动者。它可能支持代码重用，并帮助团队建立关于代码库的一般共享知识。然后，团队还能够识别重叠、冲突或缺失功能等情况，或者只是确保董事会中的每个人都以相同的方式理解问题领域和手头的任务。这让我们直接想到了下一个问题:

## 也许不仅仅是关于代码？

如果我们更进一步，将更多的重点放在代码审查的“审查”部分，而不是“代码”部分，会怎么样呢？考虑到我们已经花了时间一起讨论并审视我们所做的事情，也许思考我们刚刚编写的代码片段是否是我们一开始就应该做的事情也是有意义的。也许为了功能的一致性，它应该写得不同？也许根本不需要，因为任务可能已经在我们正在构建的产品的其他地方完成了？也许我们错过了一个重要的需求更新？或者可能需求不够明确，我们只是基于它假设了太多，所以我们需要后退一步，首先弄清楚给定任务的目标和期望是什么？

更进一步，让我提出一个问题——通常归属于软件开发过程的 QA 部分(可能归属于敬业的 SQA 人)的工作有多少可以在(代码)评审中完成？有多少 bug 和不足可以更早的识别出来？以及——结果——定期的代码审查如何影响开发成本？尽管我们需要投入时间，但它真的能降低成本吗？我无法量化的直觉是，这是值得的。

## 代码评审应该是什么样子？

我在 [SmartBear 博客文章](https://blog.smartbear.com/development/creating-your-code-review-checklist/)中找到了对代码审查的最佳总结，这符合我对这一过程的广泛理解。我在这里引用一下:

> 我的代码在快乐路径条件下编译时没有错误，运行时没有异常吗？
> 
> 我是否检查过这段代码，看它是否会触发编译器或静态分析警告？
> 
> 我是否用适当的测试覆盖了这段代码，那些测试目前是绿色的吗？
> 
> 我是否运行了我们的性能/负载/冒烟测试，以确保我引入的任何东西都不是性能杀手？
> 
> 我是否运行了我们的安全测试/检查套件，以确保我没有打开漏洞？
> 
> 这段代码读起来像散文吗？
> 
> 这些方法真的像方法名所声称的那样做吗？上课也一样？
> 
> 仅仅通过快速浏览单元和验收测试，我能理解期望的行为吗？
> 
> 对期望行为的理解是否符合这项工作的要求/故事？
> 
> 这段代码是否在类/组件/模块之间引入了新的依赖关系，如果是，是否有必要这样做？
> 
> 这段代码是否符合习惯，充分利用了我们使用的语言、框架和工具？
> 
> 这里有没有开发人员可能没有意识到的现有功能的重新实现？

当试图使代码评审成为我们过程中不可或缺的一部分时，不可避免的是，我们应该期望每个团队成员都参与进来。这种参与应该具有平等的地位——代码评审不是让更资深的开发人员充当初级代码的看门人。也是关于学弟学妹用同样的认真感去复习学姐的代码。如果一个低年级学生在被要求对高年级学生的代码发表评论时感到害怕——想一想:还有比阅读好的代码更好的进步方式吗？而且前辈们也不是不会犯错的——当经验不足的人需要提问来理解分析过的代码时，也许根本就没那么好？

最后但同样重要的是，一个成功完成的代码评审应该成为我们对 done 的[定义的一部分——除非代码被另一个团队成员评审并接受，否则我们不能将它标记为已完成或视为已完成。它应该与编写单元测试享有同等的权利——不是我们时常喜欢的可选的附加功能，而是一种东西——当缺失时——会引起一个警告标志。](https://www.scrum.org/resources/scrum-glossary)

最初发布于 [brightinventions.pl](https://brightinventions.pl/blog/)

由亚当吧、网络佬@光明发明
[个人博客](https://whatwebcando.today/) [推特](https://twitter.com/NOtherDev) [邮箱](//adam.bar@brightinventions.pl) [Github](https://github.com/NOtherDev)