# JavaScript 错误报告最佳实践

> 原文：<https://dev.to/jackhiston/javascript-error-reporting-best-practices-20mi>

[![JavaScript Logo](img/26d21f9be88c161652e464342b0bb316.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--ImgNlvEA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/93p01zkqtra52lj255mi.jpg)

# 简介

任何用现代编程语言编写的应用程序都容易出现软件错误。当一个应用程序是用 JavaScript 编写的时候，由于人为的错误，有可能会出现意想不到的行为。一个开发者是不完美的。他有时会犯一些会导致错误的错误。当系统出错时，您需要某种方式来记录发生了什么。要实现这一点，需要有目的地记录和报告应用程序中出现的错误。

当代码在客户端浏览器上执行时，很难在他们的机器上整理和报告错误。如果您有客户端代码，那么我们如何将远程客户端信息收集到内部系统上呢？我们如何组织这些信息？我们如何在不被假阳性淹没的情况下获得显著的结果？

在本文中，我将为您提供实现错误报告系统的最佳实践，帮助您解决这些问题。我将提供可以帮助您处理 JavaScript 错误报告的最佳实践。

# 向服务器记录错误

我可能在介绍中暗示过，JavaScript 错误报告的关键是能够从客户机的浏览器中检索数据，并将其存储在我们自己的内部服务器中。可以帮助你检索这些信息的工具是软件，如[哨兵](https://sentry.io/welcome/)、 [Bugsnag](https://www.bugsnag.com/platforms/javascript/) 和 [TrackJS](https://trackjs.com/) 。本文不会深入讨论如何使用这些工具，但是它们是能够处理客户端错误的基础，而不需要推出自己的解决方案。

谈到 JavaScript 错误报告，最重要的事情是能够将所有错误记录到您控制的中央服务器中。这将允许您对此类数据采取进一步的行动，使您能够报告并从中学习。

# 信号与噪声

使用错误报告工具时，正确校准它们很重要。您必须考虑要记录的级别，调试、信息或错误级别。如果您决定在调试级别进行日志记录，那么这将为您提供关于 JavaScript 应用程序的最大量的信息。拥有更多信息听起来是个不错的主意，因为这不就意味着你可以对问题领域做出更明智的决定吗？对于下一个特性迭代，你的关注点应该是什么？

将日志调整到调试级别的问题是，您可能会遭受信息过载。透过树来看木头变得更加困难，也就是说，你不知道你的客户在日常使用你的应用程序时所面临的真正问题是什么。如果您减少了从客户端浏览器接收到的噪音量，那么它将允许您快速诊断真正的错误。

# 使用上下文数据

当记录来自客户端浏览器或服务器端运行的 JavaScript 的错误时，您需要理解错误发生的上下文。当前的 CPU 使用率是多少？这个盒子是不是内存不足了？网络延迟高吗？

当进行初步诊断时，这些是你应该问自己的基本问题。如果报告的错误没有堆栈跟踪或环境数据，那么就很难理解如何重现错误并修复它。还可以有特定的指标，比如当前的内存堆是什么样的？代码中当前上下文中变量的当前值是什么？

当试图理解如何修复 bug，而不是修复错误的问题时，所有这些问题都很重要。

# 用于误差跟踪的源图

当在开发环境中本地工作时，以及当代码在生产环境中运行时，JavaScript 看起来完全不同。如果将 JavaScript 部署到生产场景中，那么缩小和捆绑是通过减少 JavaScript 代码占用来提高应用程序性能的后续步骤。不幸的是，这些过程丑化了 JavaScript，这意味着代码不再是人类可读的。

如果您想要收集关于可用资源的数据，或者保存在已部署环境中运行的当前代码版本，那么您必须使这些代码可读。这就是[源地图](https://blog.rapid7.com/2017/05/24/what-are-javascript-source-maps/)有用的地方。源地图可以将丑化的 JavaScript 转换成人类可读的 JavaScript；这是理解错误背景时非常重要的一步。

# 结论

客户端浏览器有点像一个黑匣子。很难理解用户如何与你的应用程序交互，以及你如何改进你的应用程序，使之对他们来说更容易。在您的应用程序中引入 JavaScript 错误报告可以在缩小这种知识差距方面创造奇迹。当你可以自动化这个过程时，为什么要依赖用户手动报告错误呢？