# ä»‹ç» nanostyled:æ²¡æœ‰ CSS-in-JS çš„ CSS-in-JS

> åŸæ–‡:[https://dev.to/chrisfrank/introducing-nanostyled-2p6k](https://dev.to/chrisfrank/introducing-nanostyled-2p6k)

Nanostyled æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé£æ ¼åŒ– React ç»„ä»¶çš„å°å‹åº“(< 1 Kb æœªæ··åˆ)ã€‚å®ƒè¯•å›¾å°† CSS-in-JS åº“çš„çµæ´»çš„ã€åŸºäºç»„ä»¶çš„ API ä¸æ™®é€š CSS çš„æä½å¼€é”€ç»“åˆèµ·æ¥:

|  | ä½å¼€é”€ | çµæ´»çš„åŸºäºç»„ä»¶çš„ API |
| --- | --- | --- |
| æ™®é€š CSS | 981 å·æˆ¿ | -å¥½çš„ |
| CSS-in-JS | -å¥½çš„ | 981 å·æˆ¿ |
| çº³ç±³é£æ ¼ | 981 å·æˆ¿ | 981 å·æˆ¿ |

æ¯”å¦‚å¯å‘å®ƒçš„ CSS-in-JS åº“ğŸ’•to[styled-components](https://www.styled-components.com)-nano styled å…è®¸ä½ æ„å»ºå…·æœ‰å¤æ‚é»˜è®¤æ ·å¼çš„ UI å…ƒç´ ï¼Œç„¶åé€šè¿‡ props åœ¨æ•´ä¸ªåº”ç”¨ä¸­è°ƒæ•´è¿™äº›æ ·å¼:

```
<Button>A nice-looking button</Button>
<Button color="blue">A nice-looking button that is blue.</Button> 
```

ä¸ CSS-in-JS åº“ä¸åŒï¼Œnanostyled ä¸ä½¿ç”¨ä»»ä½• CSS-in-JSã€‚ç›¸åï¼Œå®ƒè¢«è®¾è®¡æˆä¼´éšä¸€ä¸ª**åŠŸèƒ½ CSS æ¡†æ¶**ï¼Œåƒ[è¶…å…‰é€Ÿç²’å­](http://tachyons.io/)æˆ–[é¡ºé£](https://tailwindcss.com/)ã€‚Nanostyled ä½¿åŠŸèƒ½æ€§ CSS ä¸é‚£ä¹ˆå†—é•¿ï¼Œå¹¶ä¸”æ›´å®¹æ˜“æå–åˆ° props æ§åˆ¶çš„ç»„ä»¶ä¸­ã€‚

æŸ¥çœ‹ npm ä¸Šçš„ [nanostyledï¼Œäº†è§£å®‰è£…å’Œä½¿ç”¨è¯´æ˜ï¼Œæˆ–è€…ç»§ç»­é˜…è¯»äº†è§£æ›´å¤šå†…å®¹ã€‚](https://www.npmjs.com/package/nanostyled)

* * *

## [](#functional-css)åŠŸèƒ½ CSSï¼Ÿ

åŠŸèƒ½æ€§ CSS æ¡†æ¶çš„åŸºæœ¬å‰ææ˜¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç¼–å†™å¾®å°çš„ CSS å®ç”¨ç¨‹åºç±»æ¥æ„å»ºå¤æ‚çš„æ ·å¼ã€‚

ç”¨è¶…å…‰é€Ÿç²’å­è®¾è®¡çš„æŒ‰é’®åœ¨æ ‡è®°ä¸­å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·:

```
<button class="bg-blue white br2 pa2">Button</button> 
```

è¿™æ˜¯ä¸€ä¸ªè“è‰²èƒŒæ™¯ã€ç™½è‰²æ–‡æœ¬ã€åœ†è§’(`br2`)å’Œæ‰€æœ‰è¾¹éƒ½æœ‰ä¸€äº›å¡«å……(`pa2`)çš„æŒ‰é’®ã€‚

> ç¥åœ£çš„åœ°ç‹±è¿™æ˜¯æˆ‘è§è¿‡çš„æœ€ç³Ÿç³•çš„äº‹æƒ…
> â€”â€”ã€Šé¡ºé£. css çš„ä½œè€…äºšå½“Â·ç“¦æ£®

æ˜¯çœŸçš„ã€‚å‡½æ•°å¼ CSS æ˜¯ä¸‘é™‹çš„ï¼Œè¿èƒŒäº†å‡ åå¹´æ¥çš„æœ€ä½³å®è·µ:å°†å†…å®¹ä¸æ ·å¼åˆ†ç¦»ã€‚

å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨å‡½æ•°å¼ CSS è¿›è¡Œæ ·å¼è®¾è®¡å¯ä»¥å¾ˆå¥½åœ°é€‚åº”å¤§å‹é¡¹ç›®ï¼Œå¢å¼ºè§†è§‰ä¸€è‡´æ€§ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°æ„å»ºæ–°çš„ UI å…ƒç´ ï¼Œè€Œæ— éœ€ç¼–å†™ä»»ä½•æ–°çš„ CSSã€‚ã€Šé¡ºé£ã€‹çš„åˆ›ä½œè€…äºšå½“Â·ç“¦æ£®åœ¨è¿™é‡Œä¼˜é›…åœ°ä¸ºè¿™ç§æ–¹å¼è¾©æŠ¤ã€‚

Nanostyled ä½¿åŠŸèƒ½æ€§ CSS æ›´å®¹æ˜“æŠ½è±¡æˆç»„ä»¶ï¼Œè€Œä¸ä¼šå¤±å»å®ƒçš„ä»»ä½•ä¼˜åŠ¿ã€‚

## [](#why-building-flexible-components-with-functional-css-in-react-is-hard)ä¸ºä»€ä¹ˆåœ¨ React ä¸­ç”¨åŠŸèƒ½ CSS æ„å»ºçµæ´»çš„ç»„ä»¶å¾ˆéš¾

ä¸ºäº†å‡å°‘ä½¿ç”¨å‡½æ•°å¼ CSS çš„éº»çƒ¦ï¼Œæ‚¨å¯ä»¥å°†é•¿ç±»å­—ç¬¦ä¸²æå–åˆ°è‡ªåŒ…å«çš„ React ç»„ä»¶ä¸­:

```
const Button = ({ className = '', ...rest }) => (
  <button className={`bg-blue white br3 pa2 fw7 ${className}`} {...rest} />
) 
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé—®é¢˜æ˜¯æ²¡æœ‰å¥½çš„æ–¹æ³•ç”¨ä¸åŒçš„èƒŒæ™¯é¢œè‰²æ¥å‘ˆç°æˆ‘ä»¬çš„`<Button>`ã€‚å³ä½¿å®ƒæ¥å—ä¸€ä¸ª`className`é“å…·ï¼Œå†™`<Button className="bg-red" />` *ä¹Ÿä¸ä¸€å®šä¼šæ¸²æŸ“ä¸€ä¸ªçº¢è‰²æŒ‰é’®ã€‚*

é©¬å…‹æ–¯Â·æ–¯æ‰˜ä¼Šä¼¯æœ€è¿‘çš„æ¨ç‰¹æŠ•ç¥¨å¾ˆå¥½åœ°è¯´æ˜äº†ä¸ºä»€ä¹ˆ:

> ä½ å¯¹ CSS äº†è§£å¤šå°‘ï¼Ÿç»™å®šè¿™äº›ç±»:
> `.red { color: red; }`
> `.blue { color: blue; }`
> è¿™äº› div ä¼šæ˜¯ä»€ä¹ˆé¢œè‰²ï¼Ÿ
> `<div class="red blue">`
> `<div class="blue red">`

æ­£ç¡®ç­”æ¡ˆæ˜¯ä¸¤ä¸ª div éƒ½æ˜¯è“è‰²çš„ï¼Œ57%çš„å—è®¿è€…å›ç­”é”™è¯¯ã€‚

å…‰çœ‹ HTML æ˜¯æ— æ³•çŸ¥é“ç­”æ¡ˆçš„ã€‚æ‚¨éœ€è¦æŸ¥çœ‹ CSSï¼Œå› ä¸ºå½“ä¸¤ä¸ªå†²çªçš„ CSS ç±»å…·æœ‰ç›¸åŒçš„ç‰¹æ€§æ—¶ï¼Œå®ƒä»¬åœ¨æ ‡è®°ä¸­çš„é¡ºåº*æ˜¯ä¸ç›¸å…³çš„ã€‚å“ªä¸ªç±»èƒœå‡ºå–å†³äºæ ·å¼è¡¨*ä¸­æœ€åå®šä¹‰çš„*æ˜¯å“ªä¸ªã€‚*

æ‰€ä»¥è¦ç”¨åŠŸèƒ½æ€§ CSS æ„å»ºä¸€ä¸ªå¥å£®çš„`<Button>`,æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿ

1.  å£°æ˜ä¸€äº›æ ·å¼åŒ–å®ƒçš„æ™®é€š CSS ç±»
2.  å…¬å¼€ä¸€ä¸ªæ–¹ä¾¿çš„ APIï¼Œç”¨äºç”¨æ›¿ä»£å“æ›¿æ¢ä¸€äº›è‚¡ç¥¨ç±»

è¿™ç¬¬äºŒä¸ªè¦æ±‚å¯¹äºé¿å…åƒ Max çš„æŠ•ç¥¨ä¸­é‚£æ ·è¿åç›´è§‰çš„ç±»å†²çªæ˜¯å…³é”®çš„ï¼Œè¿™æ˜¯ nanostyled ä½¿ä¹‹å˜å¾—å®¹æ˜“çš„äº‹æƒ…ã€‚

## [](#building-flexible-components-with-nanostyled-and-style-props)ç”¨çº³ç±³é£æ ¼å’Œé£æ ¼é“å…·æ„å»ºæŸ”æ€§ç»„ä»¶

Nanostyled çš„å·¥ä½œåŸç†æ˜¯å°†**æ ·å¼å±æ€§**æ˜ å°„åˆ°æ‚¨é€‰æ‹©çš„åŠŸèƒ½æ€§ CSS æ¡†æ¶çš„ç±»åä¸Šã€‚

**Style props** å¯ä»¥éšæ„å‘½åï¼Œæ¯ä¸ªå¯ä»¥å®¹çº³ä»»æ„æ•°é‡çš„ CSS ç±»:

### [](#a-nanostyled-button)ä¸€ä¸ªçº³ç±³æ ·å¼çš„æŒ‰é’®

```
import nanostyled from 'nanostyled';
// This example uses CSS classes from Tachyons
import 'tachyons/css/tachyons.css';

// A Button with three style props:
const Button = nanostyled('button', {
  color: 'white',
  bg: 'bg-blue',
  base: 'fw7 br3 pa2 sans-serif f4 bn input-reset'
});

const App = () => (
  <div>
    <Button>Base Button</Button>
    <Button bg="bg-yellow">Yellow Button</Button>
  </div>
);

/* rendering <App /> produces this markup:
<div>
  <button class="white bg-blue fw7 br3 pa2 sans-serif f4 bn input-reset">Base Button</button>
  <button class="white bg-yellow fw7 br3 pa2 sans-serif f4 bn input-reset">Yellow Button</button>
</div>
*/ 
```

å½“ä¸€ä¸ª`nanostyled(element)`æ¸²æŸ“æ—¶ï¼Œå®ƒä½¿ç”¨å®ƒçš„æ ·å¼å±æ€§å¹¶å°†å®ƒä»¬åˆå¹¶æˆä¸€ä¸ª HTML ç±»å­—ç¬¦ä¸²ï¼Œå¦‚ä¸Šæ‰€è¿°ã€‚

ä½¿ç”¨å“ªç§é£æ ¼çš„é“å…·å®Œå…¨ç”±ä½ å†³å®šã€‚ä¸Šé¢çš„`<Button>`æœ‰ä¸€ä¸ª APIï¼Œé€šè¿‡`color`å’Œ`bg`é“å…·å¯ä»¥å¾ˆå®¹æ˜“åœ°æ”¹å˜é¢œè‰²æˆ–èƒŒæ™¯è‰²çš„æ ·å¼ï¼Œä½†æ˜¯å¦‚æœä¸å®Œå…¨é‡å†™`base`é“å…·å°±å¾ˆéš¾æ”¹å˜å…¶ä»–çš„æ ·å¼ã€‚

### [](#a-more-flexible-nanostyled-button)æ›´çµæ´»çš„çº³ç±³æŒ‰é’®

é€šè¿‡ä½¿ç”¨æ›´å¤šçš„æ ·å¼é“å…·ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œå‡ºæ›´çµæ´»çš„æŒ‰é’®:

```
import nanostyled from 'nanostyled';
import 'tachyons/css/tachyons.css';

const FlexibleButton = nanostyled('button', {
  color: 'white', // white text
  bg: 'bg-blue', // blue background
  weight: 'fw7', // bold font
  radius: 'br3', // round corners
  padding: 'pa2', // some padding
  typeface: 'sans-serif', // sans-serif font
  fontSize: 'f4', // font size #4 in the Tachyons font scale
  base: 'bn input-reset', // remove border and appearance artifacts
}); 
```

æ¸²æŸ“ä¸€ä¸ªè‚¡ç¥¨`<FlexibleButton />`å°†ä¼šäº§ç”Ÿä¸å…¶ç›¸å¯¹ç®€å•çš„è‚¡ç¥¨ç›¸åŒçš„æ ‡è®°ã€‚ä½†æ˜¯å‘ˆç°æ›¿ä»£æ ·å¼è¦å®¹æ˜“å¾—å¤š:

```
<FlexibleButton
  bg="bg-light-green"
  color="black"
  weight="fw9"
  radius="br4"
>
  Button with a green background, black text, heavier font, and rounder corners
</FlexibleButton> 
```

å½“ä½ éœ€è¦åœ¨ä½ çš„é£æ ¼é“å…·ä¸­æ²¡æœ‰è®¡åˆ’çš„å˜åŒ–æ—¶ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨`className`é“å…·:

```
<FlexibleButton className="dim pointer">
  A button that dims on hover and sets the cursor to 'pointer'
</FlexibleButton> 
```

## [](#sharing-style-props-across-multiple-components)è·¨å¤šä¸ªç»„ä»¶å…±äº«é£æ ¼é“å…·

å¦‚æœä½ æ­£åœ¨ç”¨ nanostyled æ„å»ºå¤šç»„ä»¶ UI åŒ…ï¼Œæˆ‘å»ºè®®åœ¨ä½ çš„æ‰€æœ‰ç»„ä»¶ä¸­è‡³å°‘å…±äº«ä¸€äº›åŸºæœ¬çš„é£æ ¼é“å…·ã€‚å¦åˆ™å¾ˆéš¾è®°ä½å“ªäº›ç»„ä»¶æ”¯æŒï¼Œæ¯”å¦‚è¯´ä¸€ä¸ª`color`é“å…·ï¼Œå“ªäº›ä¸æ”¯æŒã€‚

æˆ‘é€šå¸¸ä»è¿™é‡Œå¼€å§‹:

```
import React from "react";
import ReactDOM from "react-dom";
import nanostyled from "nanostyled";
import "tachyons/css/tachyons.css";

// The keys in this styleProps will determine which style props
// our nanostyled elements will accept:
const styleProps = {
  bg: null,
  color: null,
  margin: null,
  padding: null,
  font: null,
  css: null
};

/* 
Why choose those keys, in particular? For everything except `css`, 
it's because the elements in the UI kit probably will have some default 
bg, color, margin, padding, or font we'll want to be able to easily override via props.

The `css` prop is an exception. I just like being able to use it instead of `className`.
*/

// Box will support all styleProps, but only use them when we explicitly pass values
const Box = nanostyled("div", styleProps);
/*
<Box>Hi!</Box>
renders <div>Hi!</div>

<Box color="red">Hi!</Box>
renders <div class="red">Hi!</div>
*/

// Button will also support all styleProps, and will use some of them by default
const Button = nanostyled("button", {
  ...styleProps,
  bg: "bg-blue",
  color: "white",
  padding: "pa2",
  font: "fw7",
  // I use a 'base' prop to declare essential component styles that I'm unlikely to override
  base: "input-reset br3 dim pointer bn"
});
/*
<Button>Hi!</Button>
renders
<button class="bg-blue white pa2 dim pointer bn input-reset>Hi!</button>
*/

// Heading uses styleProps, plus some extra props for fine-grained control over typography
const Heading = nanostyled("h1", {
  ...styleProps,
  size: "f1",
  weight: "fw7",
  tracking: "tracked-tight",
  leading: "lh-title"
});

// Putting them all together....
const App = () => (
  <Box padding="pa3" font="sans-serif">
    <Heading>Styling with Nanostyled</Heading>
    <Heading tracking={null} tag="h2" size="f3" weight="fw6">
      A brief overview
    </Heading>
    <Heading tag="h3" weight="fw4" size="f5" tracking={null} css="bt pv3 b--light-gray">
      Here are some buttons:
    </Heading>
    <Button>Base Button</Button>
    <Button css="w-100 mv3" padding="pa3" bg="bg-green">
      Wide Green Padded Button
    </Button>
    <Box css="flex">
      <Button css="w-50" margin="mr2" bg="bg-gold">
        50% Wide, Gold
      </Button>
      <Button css="w-50" margin="ml2" bg="bg-red">
        50% wide, Red
      </Button>
    </Box>
  </Box>
);

const rootElement = document.getElementById("root");
ReactDOM.render(<App />, rootElement); 
```

è¿™ä¸ªå®Œæ•´çš„ä¾‹å­åœ¨ CodeSandbox ä¸Šæœ‰[ä¾›ä½ è¯•éªŒã€‚](https://codesandbox.io/s/3r8l4rr8p1)

Nanostyled åœ¨ npm ä¸Š[å¯ç”¨ï¼Œä½ å¯ä»¥åœ¨](https://www.npmjs.com/package/nanostyled) [GitHub](https://www.github.com/chrisfrank/nanostyled) ä¸Šè´¡çŒ®ç»™åº“ã€‚