# VueRouter 鲜为人知的神奇功能

> 原文:[https://dev . to/Napoleon 039/the-lesser-known-amazing-things-vuerouter-can-do-25di](https://dev.to/napoleon039/the-lesser-known-amazing-things-vuerouter-can-do-25di)

## [](#introduction)简介

本文不是关于 VueRouter 的介绍性文章。它是关于一些鲜为人知的 VueRouter 可以做的事情。本文假设您了解 VueRouter，使用过几次或更多次，并且知道如何使用它。

现在有可能你可能永远都不需要用到这里提到的东西。但是，如果你发现自己处于需要它们的情况下，记住它们仍然是有用的。

## [](#query-parameters)查询参数

如果您知道什么是查询参数，可以跳过下面的解释。

你可能以前见过这些。它们并不是在所有的网站上都可以看到，但是你可以在谷歌搜索时很容易地看到它们。当你执行一个简单的搜索时，你会注意到 URL 在网站名称之后有一些东西- `https://duckduckgo.com/?q=hey&t=h&atb=v115-6`。这是我在 [DuckDuckGo](https://duckduckgo.com/) (像谷歌一样的搜索引擎)上对单词*嘿*做的简单搜索。如果你仔细看那个链接，你可以看到字母 **q** 和它后面的一些附加的东西。在那个 *q* 之前还有一个问号。问号后面的一切(？)被称为查询。它用于以`key-value`对的形式提供附加信息。

* * *

VueRouter 允许我们非常容易地传递一个查询参数。*查询*的一个`<router-link>`属性用于此:

```
<router-link 
    :to="{ name: 'pathName', 
           params: { id: $route.params.id }, 
           query: { locale: 'en' } }"
>

</router-link> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

这里我们的参数是使用 params 属性传递的，下一个属性是 query。它还接受一个对象，各种查询被表示为`key-value`对。

在这种情况下，URL 应该是这样的:`https://something.com/user/456?locale=en`

## [](#redirecting-all-paths)重定向所有路径

您已经在一个单独的`routes.js`文件中准备好了所有的路径，已经正确地将它们包含在 VueRouter 实例中，并使用本地 dev 服务器检查了它们。看起来一切正常。你不可能错过一条路径，路径名也很准确。

你让一个朋友试一试并给出反馈。你满面春风，不会出什么差错的。但是突然，你的朋友给你看了屏幕。上面有一页空白！但是你覆盖了你网站的所有路径。那么是哪里出了问题呢？！

你肯定涵盖了你的网站需要的所有途径。但这并不能阻止你的朋友或任何其他用户在 URL 中输入他们想要的任何内容。由于 VueRouter 显然不会识别路径，因此它会显示一个空白页。如果用户第一次访问你的网站时不小心走错了路，这种情况也会发生。

我知道我很难理解为什么 GMail 不在`https://google.gmail.com`上，而是在`https://mail.google.com`上。很奇怪吧😜。

与其给用户显示一个空白页面，不如把他们重定向到你选择的页面。将以下路径添加到您的`routes.js`文件:

```
{
    path: '*',
    redirect: '/'
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

这样做的目的是，您在文件中没有处理的所有路由都将重定向到主页。因此，下次有人输入错误的路线时，他们将被重定向回主页。

## [](#adding-hash-fragment)添加哈希片段

访问过维基百科页面吗？我打赌你有。许多页面(几乎所有页面)都有目录索引。当你点击它们时，页面向下滚动，你就神奇地跳到了那个内容。

您的网站可能有一个页面，其中的主要内容在下面，您需要在访问该页面后立即向下滚动到该页面。这种行为可以通过使用锚标签`<a>`并将内容的 id 放入 *href* 属性中来实现。然而，这只适用于同一个页面，不适用于你必须访问另一个页面并立即跳转到该内容的时候。为此，您可以使用一个名为*散列*的`<router-link>`属性。它需要像锚标签一样的内容 id。

```
<router-link :to="{ name: pathName, hash: '#text' }">
    Jump to content
</router-link> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

然而，这只是将文本的 id 附加到 URL 上。类似这样的东西——`https://something.com/user#text`。它不会向下滚动到内容。这是因为我们只告诉我们的 VueRouter 添加一个*散列*到它的 URL。我们还没有告诉它如何滚动页面。散列片段必须与如下所示的滚动行为相结合。

## [](#scroll-behavior)滚动行为

我们现在将为我们的路线设置滚动行为。这样，我们就可以使用追加到 URL 的散列自动滚动到我们的内容，甚至让 VueRouter 记住滚动前的最后位置。这就像在维基百科中，你可以点击索引中的内容标题，点击后退按钮，而不是回到上一页，页面会向上滚动到索引位置。

将以下函数添加到 VueRouter 实例:

```
import { routes } from './routes.js'
const router = new VueRouter({
    routes,
    scrollBehavior(to, from, savedPosition) {
        if (savedPosition) {
            return savedPosition;
        }
        if (to.hash) {
            return { selector: to.hash };
        }
        return { x: 0, y: 0 };
    }
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

在这里，**路线**是我们所有的路线保存在一个单独的文件中。`scrollBehavior()`功能负责管理我们路线的滚动。它有 3 个参数:

1.  *到* -这代表了我们将要游览的新路线
2.  *来自*——这是我们之前来的路线。因此，如果我们点击主页上的`<router-link>`来访问“关于”页面，那么*到*将是我们的“关于”页面，而中的*是主页。*
3.  *保存的位置* -这是重要的参数。它代表滚动前的位置。在我解释了上面的函数是做什么的之后就变得很清楚了。

当我们简单地向下滚动一页时，按下后退按钮将使我们返回到页面的顶部。这是因为在滚动之前，我们的“前一个位置”是页面的顶部。这就是`scrollBehavior()`函数中第一个条件检查的作用。它检查保存在`savedPosition`参数中的位置。

第二个条件检查是针对散列片段的。您可能还记得，在上一节中，我们在 URL 后面附加了一个散列。但是，这个散列并不应用于当前页面。当我们点击链接时，它将被应用。

当下一页被访问时，它的路径中会有一个散列。第二个条件检查将注意到这个散列。它返回一个对象。**选择器**的值表示我们想要跳转到的内容的 id。

> 因此，当我们点击该链接时，会有一个散列片段添加到 URL，页面会自动向下滚动到我们的内容。

该函数的最后一行返回一个对象，该对象具有页面顶部的 x 和 y 坐标。当我们刚刚访问了一个页面，并且没有散列片段时，这是必要的。当没有要滚动的内容，并且我们也没有手动向下滚动时，我们需要显示页面的顶部。

* * *

这就是这篇文章的内容。我希望你学到了一些关于 VueRouter 的新东西。如果你想参考 VueRouter 的可靠来源，最好的地方是官方文档，因为它们写得非常好。

如果你知道更多人们通常不知道的 VueRouter 可以做的事情，欢迎在下面的评论中提出来。