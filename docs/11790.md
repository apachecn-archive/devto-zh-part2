# çº¢è‰²

> åŸæ–‡:[https://dev . to/citizen 428/ruby feasy-access-to-ruby-documentation-2c 39](https://dev.to/citizen428/rubyrefeasy-access-to-ruby-documentation-2c39)

æˆ‘ä¸çŸ¥é“ä½ ï¼Œä½†æˆ‘çœŸçš„ä¸è®°å¾—ä¸Šæ¬¡æˆ‘åœ¨æµè§ˆå™¨ä¸Šæ·»åŠ ä¹¦ç­¾æ˜¯ä»€ä¹ˆæ—¶å€™äº†(è‡³å°‘ä¸æ˜¯æ•…æ„çš„ï¼Œæ¯•ç«Ÿï£¿-D å°±åœ¨ï£¿-F æ—è¾¹)ã€‚æ‰€ä»¥å½“æˆ‘çœ‹åˆ° rustref.com çš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æˆ‘æƒ³ä¸º Ruby ç¤¾åŒºåšä¸€ä¸ªè¿™æ ·çš„ä¸œè¥¿ï¼Œè¿™ä¸ªç¤¾åŒºç°åœ¨å«åš rubyref.net çš„ T2ã€‚

## TLï¼›åšå£«ï¼›åŒ»ç”Ÿ

RubyRef å®šä¹‰äº†ä¸€ä¸ªå½¢å¼ä¸º`*.rubyref.net`çš„ CNAME è®°å½•åˆ—è¡¨ï¼Œå®ƒé‡å®šå‘åˆ°ä¸åŒçš„ Ruby ç›¸å…³æ–‡æ¡£ç«™ç‚¹ã€‚ä¾‹å¦‚ï¼Œ`ruby.rubyref.net`ä¼šå¸¦ä½ åˆ°æ ¸å¿ƒæ–‡æ¡£ï¼Œè€Œ`api.ruby.net`ä¼šé‡å®šå‘åˆ° C API æ–‡æ¡£ï¼Œè€Œ`awesome.rubyref.net`ä¼šå¸¦ä½ åˆ° GitHub ä¸Šçš„ awesome-ruby åº“ã€‚

## [](#architecture)å»ºç­‘

*æ›´æ–°:å®ƒç°åœ¨æ˜¯ä¸€ä¸ªé™æ€ç½‘ç«™ï¼Œç”±[ä¸­é—´äºº](http://middlemanapp.com)ç”Ÿæˆï¼Œæ‰˜ç®¡åœ¨ [Netlify](https://www.netlify.com) ä¸Šï¼Œä½†æ˜¯ä»ç„¶ä½¿ç”¨ CloudFlare é¡µé¢è§„åˆ™ï¼Œå°±åƒ Rake ä»»åŠ¡ä¸€æ ·ã€‚*

æ‰‹åŠ¨å®šä¹‰ä¸€å † CNAMEs ä¸æ˜¯æˆ‘æ‰€è¯´çš„æœ‰è¶£çš„ä¸‹åˆæ´»åŠ¨ï¼Œä½†ç¼–å†™ä»£ç æ˜¯ã€‚å› æ­¤ RubyRef ä½¿ç”¨ä¸€æ¬¾æ´›è¾¾åº”ç”¨ç»“åˆ [Cloudflare é¡µé¢è§„åˆ™](https://www.cloudflare.com/features-page-rules/)æ¥å®ç°å…¶ç›®æ ‡ã€‚å…ˆæ¥çœ‹çœ‹ app([å½“å‰ä»£å·](https://github.com/citizen428/rubyref) / [ç½—è¾¾ç§‘](https://github.com/citizen428/rubyref/tree/roda) ):

```
# frozen_string_literal: true

require 'roda'
require 'json'

class RubyRef < Roda
  REDIRECTS = JSON.parse(File.read('redirects.json'))

  plugin :assets, css: 'style.css'
  plugin :render

  route do |r|
    r.assets

    r.root do
      render :index
    end

    r.on 'redirect', String do |subdomain|
      r.redirect REDIRECTS.fetch(subdomain) { '/' }
    end

    r.redirect '/'
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®ƒä»ä¸€ä¸ªåä¸º`redirects.json`çš„æ–‡ä»¶ä¸­è¯»å–é‡å®šå‘åˆ—è¡¨ï¼Œå…¶ä¸­å„ç§ CNAMEs è¢«æ˜ å°„åˆ°å®ƒä»¬å„è‡ªçš„ç›®æ ‡ URLã€‚å®é™…çš„é‡å®šå‘æ˜¯é€šè¿‡å½¢å¼ä¸º`GET https://rubyref.net/<CNAME>`çš„è¯·æ±‚å‘ç”Ÿçš„ï¼Œå®ç°è¿™ä¸€ç‚¹æ‰€éœ€çš„ä»£ç å†ç®€å•ä¸è¿‡äº†ã€‚

ä½†æ˜¯ï¼Œä¸ºäº†å‡å°‘è¾“å…¥å’ŒåŠ å¿«è‡ªåŠ¨å®Œæˆï¼Œé‡å®šå‘åº”è¯¥é‡‡ç”¨ h `ttps://<CNAME>.rubyref.net`çš„å½¢å¼ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹ Cloudflare é¡µé¢è§„åˆ™:

[![Cloudflare page rule](../Images/86e4cf87059e6daa7e974196426fa6da.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--NBB3_Cnr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zlaedfonnqtb579s09cg.png)

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿˜å­˜åœ¨æœ€åä¸€ä¸ªé—®é¢˜:Cloudflare åœ¨å…¶å…è´¹å±‚ä¸­ä¸æä¾›é€šé…ç¬¦ cname çš„ä»£ç†ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨ [Cloudflare gem](https://github.com/ioquatix/cloudflare) ç¼–å†™äº†ä¸€ä¸ªå°çš„ Rake ä»»åŠ¡ï¼Œé€šè¿‡ [Cloudflare API](https://api.cloudflare.com/) :
è‡ªåŠ¨æ·»åŠ æŒ‡å‘â€œrubyref.netâ€çš„â€œè™šæ‹Ÿâ€cname

```
namespace :cloudflare do
  desc 'Update Cloudflare CNAMEs'
  task :update_cnames do
    redirects = JSON.parse(File.read('redirects.json'))

    email = ENV.fetch('CLOUDFLARE_EMAIL')
    key = ENV.fetch('CLOUDFLARE_KEY')
    zone_id = ENV.fetch('CLOUDFLARE_ZONE')

    connection = Cloudflare.connect(key: key, email: email)
    zone = connection.zones.find_by_id(zone_id)
    cnames = zone.dns_records.all.select { |dns| dns.record[:type] == 'CNAME' }
    cnames.map! { |cname| cname.record[:name] }

    redirects.each_key do |cname|
      name = "#{cname}.rubyref.net"
      next if cnames.include?(name)

      puts "Setting CNAME: #{name}"
      zone.dns_records.post(
        {
          type: 'CNAME',
          name: name,
          content: 'rubyref.net',
          proxied: true
        }.to_json,
        content_type: 'application/json'
      )
    end
  end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰€æœ‰çš„åå­—éƒ½å®šä¹‰å¥½äº†ï¼Œé¡µé¢è§„åˆ™ç°åœ¨èµ·ä½œç”¨äº†ï¼Œå‰©ä¸‹çš„å°±äº¤ç»™æ´›è¾¾åº”ç”¨ç¨‹åºäº†ğŸ‰

## [](#contributing)æŠ•ç¨¿

å¦‚æœä½ æƒ³åœ¨ RubyRef ä¸­çœ‹åˆ°æ–°çš„ç«™ç‚¹ï¼Œåªéœ€[æ‰“å¼€ä¸€ä¸ª PR](https://github.com/citizen428/rubyref/pulls) å¹¶åœ¨`redirects.json`ä¸­æ·»åŠ é¢å¤–çš„è¡Œï¼Œå‰©ä¸‹çš„æˆ‘ä¼šå¤„ç†ã€‚