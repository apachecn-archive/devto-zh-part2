# 如何复习自己不懂的代码

> 原文:[https://dev . to/raquelxmoss/how-to-review-code-you-don-understand-pc7](https://dev.to/raquelxmoss/how-to-review-code-you-dont-understand-pc7)

我最近读了 Max Bittker 的一篇文章，名为[“如何审查你不理解的代码”](https://maxbittker.com/code-review/)，它让我想到了我被赋予这样做的任务的时候。

我在代码审查中遇到的一个问题是理解一个变化的背景。给定一个 diff，我可以一行一行地处理它，并且理解那里发生的大部分事情。至少，我能理解它的*机制*。但是，这与理解代码试图实现的目标是一样的吗？在我看来，没有。

自从成为一名开发人员以来，我在阅读代码时遇到的一个难题是，无论我在看什么，我看到的都是解决方案，而不是问题。事实上，我只看到了一个特定的解决方案，我负责审查的那个。

当审查代码时，我想给出深思熟虑的建议，学习新的东西，并找出我能看到的错误。(在 Ruby 中，90%的时间我都在问(“嘿，你想在这里做一个零检查吗？”).

那么，当我只看到(通常)一个开发人员的理解、解决问题的过程和个人风格的输出时，我该如何做呢？这很难——可以说是我工作中最难的部分之一。当我阅读代码时，如果缺乏丰富的代码注释，或者某种叙述(想象一下，就像导演对代码的评论)，所有重要的上下文都会丢失。

假设我们不打算彻底检查我们团队的过程，或者从头开始构建更好的代码审查工具，那么我们明天在工作中可以做些什么来改善我们的代码审查体验呢？

### [](#ask-the-submitter-to-review-the-code)要求提交者审查代码

如果您的同事还没有自我评估他们的差异并留下在线评论，请他们这样做。这将提供一些有价值的见解——为什么他们做出了一个特殊的选择，他们为什么挣扎，为什么有些事情看起来过于复杂。他们可能会指出他们希望评审者关注的特定领域，或者指出他们可能对自己的决策不确定的领域。这将有助于捕捉开发人员编写代码时的思维过程。

### [](#seek-to-understand-what-the-developer-was-trying-to-achieve)寻求理解开发者想要达到的目标

如果你的工作场所和我的一样，你可以从一个拉取请求、一个用户故事、一些模型和一个围绕工作的大环境的总体想法开始一个代码评审。

然而，我们并不是生活在一个完美的世界里。也许用户故事会很模糊(我还没有找到一个团队能写出无懈可击的故事)。也许没有模型，也许你不太熟悉周围的环境。

因此，在继续之前，请寻求理解。

这里的问题是，你已经有了正确的理解。有时，一个故事或公关的描述可能过于宽泛。

例如，您可能知道首要目标是**在用户的发票 PDF** 上显示用户的地址。很好，这就是这段代码要做的，对吗？

你可能不知道的是，一个用户的地址属于另一个服务，你正在看的应用程序必须请求这些信息。因此，开发人员不得不考虑分布式事务、数据完整性和优雅地处理 HTTP 请求失败。也许他们已经考虑过代码应该放在哪里，并选择了几个选项中的一个。

你需要问一些问题来获得足够的背景。

你采取了什么样的方法？这个问题很适合问你的同事。**你有没有探索过其他方法并决定放弃它们？**又是一个好的。

后续问题可能会探究他们做出的取舍。如果你是一名开发新手，这听起来可能有点吓人，但事实并非如此。**为什么？**是很好的后续问题。做一个 [5 个为什么](https://en.wikipedia.org/wiki/5_Whys)的练习也许是个好主意。

无论你做什么，在回顾拉动请求之前，养成提问的习惯。

### [](#go-through-the-code-on-your-own)自己浏览代码*

有了提交者的自我审查，以及你对他们所采取的方法的理解，通读代码，并留下在线评论。它们可能是问题，或者是给你自己的注释，或者是给提交者的反馈。

我特别喜欢 Github 的这个功能，你可以“准备”所有的评论笔记，然后一次性提交。这让我可以自由地给自己写笔记，删除任何进一步回答的问题( [RAFO](https://coppermind.net/wiki/RAFO) )！)，并编辑我的笔记，而不用向提交者发送大量的电子邮件。

### [](#go-through-the-code-with-them-if-possible)如果可能的话，和他们一起检查代码

最好是亲自去。获得您的问题的答案，并讨论工作的任何变化。

这也是一个谈论替代方法的机会，这实际上将我带回到我之前的代码审查难题。

当您阅读提交审查的代码时，您看到的是手边问题的一个解决方案。**一个**方案。当你考虑解决方案时，很难考虑其他可能的解决方案。

我发现经验越多越容易，但是对于新开发人员，或者对于审查与他们通常的工作非常不同的代码的开发人员来说，在已经呈现给你的内容之外进行思考是非常棘手的。这就像是[爱因斯坦效应](https://en.wikipedia.org/wiki/Einstellung_effect)。

如果您正在审查一个拉取请求，并且您发现很难考虑其他方法，请与提交者交谈。问他们:**你有没有考虑过其他方法来做这件事？它们是什么？**

如果结果是他们没有考虑过其他解决问题的方法，而你也没有，那也没关系。反正养成问那些问题的习惯就好了。

### 跟进任何讨论过的变化，然后打勾！

希望通过这种方法，你们都能学到一些东西。也许你已经对你的领域和代码库有了更多的了解。您和提交者可能已经讨论了解决问题的不同方法，或者至少花了两分钟时间试图想出一个不同的方法。卡派😄。

我不会对每个拉取请求都采用这种方法。幸运的是，有些人比其他人更直率！但是，如果你发现自己的任务是回顾一些相当厚重的东西，考虑采纳其中的一些想法，并尝试一下。

* *如果这是一个很大的变更集，询问提交者他们是否可以为你进一步分解它——不一定要分解成单独的 PRs(尽管如果可行的话这可能是可取的),但是也许他们可以以任何有意义的方式带你完成一部分工作。我们真正需要的是一个更好的工具来推理代码差异，但这是另一天的博客文章。*