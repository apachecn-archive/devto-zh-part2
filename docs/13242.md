# ä½¿ç”¨ ShouldKO è·å¾—æ›´å¥½çš„æ–­è¨€æ¶ˆæ¯

> åŸæ–‡:[https://dev . to/bright devs/use-shouldko-for-better-assertion-messages-2l1l](https://dev.to/brightdevs/use-shouldko-for-better-assertion-messages-2l1l)

å¦‚ä»Šï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººéƒ½åœ¨å†™æµ‹è¯•ã€‚æ— è®ºæ˜¯å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•è¿˜æ˜¯æ€§èƒ½æµ‹è¯•ï¼Œä¸€æ—¦å†™å¥½ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šå›å¤´å»çœ‹ï¼Œç›´åˆ°å®ƒä»¬å¤±è´¥ã€‚å› æ­¤ï¼Œå½“æµ‹è¯•å¤±è´¥æ—¶ï¼Œæœ‰ä¸€ä¸ªæ˜ç¡®çš„æ–­è¨€æ¶ˆæ¯æ˜¯è‡³å…³é‡è¦çš„ã€‚

# [](#hamcrest)æ±‰å…‹é›·æ–¯ç‰¹

æˆ‘è®¤ä¸º [Hamcrest](http://hamcrest.org/) æ˜¯ Java å’Œ Kotlin ç”Ÿæ€ç³»ç»Ÿä¸­æœ€æµè¡Œçš„æ–­è¨€åº“ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ª [`Money`](https://martinfowler.com/bliki/ValueObject.html) ç±»çš„è¿‡äºç®€åŒ–çš„ä¾‹å­:

```
import java.math.BigDecimal
import java.util.*

data class Money(val amount: BigDecimal, val currency: Currency) {
    operator fun plus(other: Money): Money {
        if (currency != other.currency) {
            throw IllegalArgumentException("Cannot add $this to $other. Currencies must match.")
        }

        // an accidentally introduced bug ğŸ˜ˆ
        val newAmount = amount + other.amount + 10.0.toBigDecimal()
        return copy(amount = newAmount)
    }
} 
```

å‡è®¾æˆ‘ä»¬ä½¿ç”¨ [JUnit](http://junit.org/junit5/) å’Œ [Hamcrest](http://hamcrest.org/) :
ä¸º [`plus`](https://kotlinlang.org/docs/reference/operator-overloading.html) æ“ä½œç¬¦ç¼–å†™ä¸€ä¸ªæµ‹è¯•

```
class MoneyTests {
    val usd = Currency.getInstance("USD")

    @Test
    fun can_add() {
        val usd100 = Money(100.toBigDecimal(), usd)
        val usd50 = Money(50.toBigDecimal(), usd)

        assertThat((usd100 + usd50).amount, equalTo(150.toBigDecimal()))
    }
} 
```

æµ‹è¯•å°†å¤±è´¥ï¼Œå¹¶æ˜¾ç¤ºä»¥ä¸‹æ¶ˆæ¯:

```
java.lang.AssertionError: 
Expected: <150>
     but: was <160> 
```

è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•èƒ½æ”¹è¿›å®ƒã€‚

# should ko:kot Lin æ›´å¥½çš„æ–­è¨€æ¶ˆæ¯

ShouldKO æ˜¯æˆ‘å¼€å‘çš„ä¸€ä¸ªç®€å•çš„åº“ï¼Œå®ƒæ”¹è¿›äº†æ–­è¨€æ¶ˆæ¯ã€‚å®ƒçš„æ€æƒ³åŸºäºã€‚å‡€å¦‚[å®œ](https://github.com/shouldly/shouldly)ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨ [ShouldKO](https://github.com/miensol/shouldko) :
çš„æµ‹è¯•æ˜¯ä»€ä¹ˆæ ·çš„

```
class MoneyTests {
    val usd = Currency.getInstance("USD")

    @Test
    fun can_add() {
        val usd100 = Money(100.toBigDecimal(), usd)
        val usd50 = Money(50.toBigDecimal(), usd)

        (usd100 + usd50).amount.shouldEqual(150.toBigDecimal())
    }
} 
```

åœ¨æˆ‘çœ‹æ¥ [ShouldKO çš„](https://github.com/miensol/shouldko)æ–­è¨€è¯­æ³•æé«˜äº†å¯è¯»æ€§ã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸æ˜¯ [ShouldKO](https://github.com/miensol/shouldko) ä¸»è¦æ”¹è¿›çš„åœ°æ–¹ã€‚éµå¾ªæ”¹è¿›çš„æ–­è¨€æ¶ˆæ¯:

```
java.lang.AssertionError: (usd100 + usd50).amount 
Expected: <150>
     but: was <160> 
```

[ShouldKO](https://github.com/miensol/shouldko) å°†å¸¦æœ‰æ–­è¨€çš„æºä»£ç è¡Œåˆå¹¶åˆ°æ–­è¨€æ¶ˆæ¯æœ¬èº«ä¸­ã€‚å½“æˆ‘ä»¬æœ‰å¤šè¡Œæ–­è¨€å½¢æˆä¸€ä¸ªé€»è¾‘æ¡ä»¶æ—¶ï¼Œè¿™éå¸¸æ–¹ä¾¿ã€‚è¿™æ˜¯ä¸€ä»¶å°äº‹ï¼Œä½†æ˜¯å¯ä»¥æå¤§åœ°æ”¹å–„è°ƒè¯•æµ‹è¯•é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬åªæœ‰ä¸€ä¸ªæµ‹è¯•è¿è¡Œäº§ç”Ÿçš„æ—¥å¿—æ–‡ä»¶æ—¶ã€‚

## should ko çš„å®‰è£…

[ShouldKO](https://github.com/miensol/shouldko) ç›®å‰åœ¨ [Jitpack](https://jitpack.io/) ä¸Šæœ‰å”®ã€‚æ‚¨éœ€è¦é¦–å…ˆå°† Jitpack æ·»åŠ åˆ°æ‚¨çš„åº“:

```
repositories {
    maven { url 'https://jitpack.io' }
    mavenCentral()
} 
```

å¹¶åœ¨æµ‹è¯•ä¸­åŒ…å«è¯¥åº“ï¼Œä¾‹å¦‚:

```
testImplementation 'com.github.miensol.shouldko:hamcrest:v0.1.0' 
```

ShouldKO çš„ Hamcrest åº“å…è®¸ä½¿ç”¨ä»»ä½• Hamcrest åŒ¹é…å™¨ã€‚

æœ€åˆå‘å¸ƒäº [brightinventions.pl](https://brightinventions.pl/blog/)

ä½œè€… Piotr Mionskowskiï¼Œè½¯ä»¶å·¥ç¨‹å¸ˆ@å…‰æ˜å‘æ˜
[é‚®ç®±](piotr.mionskowski@brightinventions.pl) [Stackoverflow](https://stackoverflow.com/users/155213/miensol) [ä¸ªäººåšå®¢](https://miensol.pl/)