# è®©æˆ‘ä»¬æ„å»º Web ç»„ä»¶ï¼ç¬¬ 2 éƒ¨åˆ†:èšåˆå¡«æ–™

> åŸæ–‡:[https://dev . to/benny powers/let-build-we B- components-part-2-the-poly fills-dkh](https://dev.to/bennypowers/lets-build-web-components-part-2-the-polyfills-dkh)

åŸºäºç»„ä»¶çš„ç”¨æˆ·ç•Œé¢ç°åœ¨éå¸¸æµè¡Œã€‚æ‚¨çŸ¥é“ web æœ‰è‡ªå·±çš„æœ¬åœ°ç»„ä»¶æ¨¡å—ï¼Œä¸éœ€è¦ä½¿ç”¨ä»»ä½•åº“å—ï¼ŸçœŸå®æ•…äº‹ï¼ä½ å¯ä»¥ç¼–å†™ã€å‘å¸ƒå’Œé‡ç”¨å•æ–‡ä»¶ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥åœ¨ä»»ä½•å¥½çš„æµè§ˆå™¨å’Œæ¡†æ¶ä¸­å·¥ä½œã€‚

åœ¨æˆ‘ä»¬çš„[ä¸Šä¸€ç¯‡æ–‡ç« ](https://dev.to/bennypowers/lets-build-web-components-part-1-the-standards-3e85)ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†è®©æˆ‘ä»¬ç¼–å†™ web ç»„ä»¶çš„å››ä¸ª web æ ‡å‡†:`<template>`ã€å®šåˆ¶å…ƒç´ ã€å½±å­ DOM å’Œ JavaScript æ¨¡å—ã€‚

[![bennypowers](../Images/57370d6f6dab8d6651a3f138a1aaaa40.png)](/bennypowers) [## è®©æˆ‘ä»¬æ„å»º Web ç»„ä»¶ï¼ç¬¬ 1 éƒ¨åˆ†:æ ‡å‡†

### æœ¬å°¼ä¸ºğŸ‡®ğŸ‡±ğŸ‡¨ğŸ‡¦ä¾›ç”µ 9 æœˆ 18 æ—¥ 1810 åˆ†é’Ÿé˜…è¯»

#webcomponents #customelements #javascript #html](/bennypowers/lets-build-web-components-part-1-the-standards-3e85)

ä»Šå¤©ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä¸€äº›å…³äº webcomponentsjs polyfills çš„çŸ¥è¯†ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç¼–å†™åŸºäº web ç»„ä»¶çš„åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸æ”¯æŒè¿™äº›è§„èŒƒçš„æµè§ˆå™¨ä¸Šè¿è¡Œã€‚

*   [æ¦‚è¿°](#overview)
*   [è£…è½½èšåˆå¡«æ–™](#loading-the-polyfills)
    *   [é«˜çº§è£…è½½åœºæ™¯](#advanced-loading-scenarios)
    *   [å¼‚æ­¥åŠ è½½](#asynchronous-loading)
*   [ç¼–å†™ä½¿ç”¨ ShadyCSS èšåˆå¡«å……çš„è‡ªå®šä¹‰å…ƒç´ ](#writing-custom-elements-that-work-with-the-polyfills)
    *   [shady CSS TLï¼›åšå£«](#shadycss-tl-dr)
*   [è‡ªå®šä¹‰å…ƒç´ èšåˆå¡«å……](#custom-elements-polyfill)
    *   [æ”¯æŒ IE11](#supporting-ie11)

## [](#overview)æ¦‚è¿°

Web ç»„ä»¶çœŸçš„å¾ˆæ£’ã€‚å¦‚æœä½ æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä¹¦å‘†å­ï¼Œè·¨æµè§ˆå™¨ã€å¯é‡ç”¨ã€å¯äº’æ“ä½œç»„ä»¶çš„æ‰¿è¯ºæ˜¯ä»¤äººå…´å¥‹çš„ã€‚æ¯«æ— ç–‘é—®ï¼ŒåŸºäº web ç»„ä»¶çš„åº“å’Œåº”ç”¨ç¨‹åºå°†è¿…é€Ÿæ™®åŠï¼Œå› ä¸ºæˆªè‡³ 2018 å¹´ 10 æœˆä¸‹æ—¬ï¼Œæœ€æ–°ç‰ˆæœ¬çš„ Chromeã€Firefox å’Œ Safari å°†åŸç”Ÿæ”¯æŒ web ç»„ä»¶ã€‚ç”šè‡³å¾®è½¯ä¹Ÿå·²ç»å¼€å§‹åœ¨ Edge ä¸­å®ç°å®ƒä»¬ã€‚å¤ªæ£’äº†ã€‚

ä½†æ˜¯å·²ç»åœ¨è¿™ä¸ªåœ°æ–¹å‘†äº†ä¸€åˆ†é’Ÿä»¥ä¸Šçš„ web å¼€å‘äººå‘˜çŸ¥é“äº‹æƒ…å¹¶ä¸æ€»æ˜¯é‚£ä¹ˆç®€å•ã€‚æœ‰æ—¶å€™æ„Ÿè§‰ç½‘ç»œå¹³å°åŠŸèƒ½è¶Šé…·(æˆ‘åœ¨çœ‹ç€ä½ ï¼Œ [scroll-snap](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Scroll_Snap) ï¼)ï¼Œå°±è¶Šä¸å¯èƒ½å¾—åˆ°å¹¿æ³›æ”¯æŒã€‚

ä½†æ˜¯ä¸è¦å®³æ€•ï¼Œæœ‹å‹ä»¬ï¼ä»Šå¤©ï¼Œæ‚¨å¯ä»¥ä¸€å¤´æ‰è¿› web ç»„ä»¶çš„ä¸–ç•Œï¼Œè€Œä¸ç”¨æ‹…å¿ƒä¼šæŠŠä½¿ç”¨æ—§æµè§ˆå™¨çš„ç”¨æˆ·ç”©åœ¨åé¢ã€‚è°·æ­Œ [web components å›¢é˜Ÿ](https://www.webcomponents.org/)çš„ä¼˜ç§€äººå‘˜åœ¨åˆ›å»º [webcomponentsjs polyfills](https://github.com/webcomponents/webcomponentsjs) æ—¶å°±æƒ³åˆ°äº†ä½ ï¼Œè¿™è®©ä½ å¯ä»¥å°†ä½ çš„åº”ç”¨å®šä½åˆ° IE11ï¼Œæˆ‘æ•¢è‚¯å®šè¿™å°±æ˜¯ä½ æ—©ä¸Šé†’æ¥çš„åŸå› ã€‚polyfills ä¹Ÿå¯ä»¥åœ¨ Chrome å’Œ Firefox çš„æ—§ç‰ˆæœ¬ä¸Šå·¥ä½œï¼Œä¹Ÿå¯ä»¥åœ¨å¾®è½¯ Edge ä¸Šå·¥ä½œï¼Œç›´åˆ°ä»–ä»¬~~é†’æ¥ï¼Œåœ¨ä»–ä»¬çš„ç”¨æˆ·è¯­éŸ³æ¿~~ ä¸Šå®ç°ä¸¤ä¸ª[æœ€æµè¡Œçš„æ ‡ç­¾ï¼Œå®Œæˆå®ƒä»¬çš„å®ç°ã€‚](https://wpdev.uservoice.com/forums/257854-microsoft-edge-developer/filters/top)

æ‰€ä»¥ä¸è¦åªæ˜¯ååœ¨é‚£é‡Œï¼Œç»§ç»­è¯»ä¸‹å»ï¼æˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹ å¦‚ä½•åŠ è½½èšåˆå¡«å……ï¼Œå¦‚ä½•ç¼–å†™æ­£ç¡®åˆ©ç”¨å®ƒä»¬çš„è‡ªå®šä¹‰å…ƒç´ ï¼Œä»¥åŠå¦‚ä½•é¿å…èšåˆå¡«å……çš„å·²çŸ¥é—®é¢˜å’Œç¼ºé™·ã€‚

## [](#loading-the-polyfills)åŠ è½½èšåˆå¡«å……

å¯¹äºå¤§å¤šæ•°ç”¨æˆ·æ¥è¯´ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨åŠ è½½ä»»ä½•ç»„ä»¶æ–‡ä»¶ä¹‹å‰ï¼Œå¼¹å‡ºä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼Œå°†`webcomponents-loader.js`è„šæœ¬æ”¾å…¥é¡µé¢çš„`head`ä¸­ã€‚è¯¥è„šæœ¬æ£€æŸ¥ç”¨æˆ·æµè§ˆå™¨çš„ <abbr title="user agent">UA</abbr> å­—ç¬¦ä¸²ï¼Œå¹¶ä»…åŠ è½½æ‰€éœ€çš„èšåˆå¡«å……æˆ–èšåˆå¡«å……é›†ã€‚

```
<head>
  <!-- Load the polyfills first -->
  <script src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
  <!-- Then afterwards, load components -->
  <script type="module" src="./superlative-input.js"></script>
</head> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ å¯ä»¥åƒæˆ‘ä»¬ä¸Šé¢åšçš„é‚£æ ·é€šè¿‡ CDN åŠ è½½è„šæœ¬ï¼Œæˆ–è€…ä½ å¯ä»¥é€šè¿‡å®‰è£…åˆ°ä½ çš„é¡¹ç›®å°†å®ƒä»¬ä¸ä½ çš„åº”ç”¨ç¨‹åºä»£ç æ†ç»‘åœ¨ä¸€èµ·:

```
npm install --save @webcomponents/webcomponentsjs 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
<head>
  <!-- ... -->
  <script src="/node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>;
</head>

<body>
  <script type="module">
    import './superlative-input.js'
    const template = html`<superlative-input label="ğŸ¥™"></superlative-input>`;
    // ...
  </script>
</body> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>By the way, I just discovered that there's a falafel emoji ğŸ¥™, which I think technically brings the world one step closer to perfection.

### [](#advanced-loading-scenarios)é«˜çº§åŠ è½½åœºæ™¯

å¦‚æœæ‚¨ç¡®åˆ‡çŸ¥é“æ‚¨éœ€è¦ä»€ä¹ˆï¼Œæ‚¨ä¹Ÿå¯ä»¥å•ç‹¬åŠ è½½ç‰¹å®šçš„èšåˆå¡«å……:

```
<!-- Load all polyfills, including template, Promise, etc. -->
<!-- Useful when supporting IE11 -->
<script src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>

<!-- Load only the Shadow-DOM and Custom Elements polyfills -->
<!-- Useful to support Firefox <63 -->
<script src="https://unpkg.com/@webcomponents/webcomponentsjs/entrypoints/webcomponents-sd-ce-index.js"></script>

<!-- Load only the Shadow-DOM polyfills -->
<script src="https://unpkg.com/@webcomponents/webcomponentsjs/entrypoints/webcomponents-sd-index.js"></script>

<!-- Load only the Custom Elements polyfills -->
<script src="https://unpkg.com/@webcomponents/webcomponentsjs/entrypoints/webcomponents-ce-index.js"></script> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œæ‚¨éƒ½å¯ä»¥é€‰æ‹©ç¡¬ç€å¤´çš®åŠ è½½ bundle æˆ–`sd-ce` polyfillsï¼Œè¿™å°†ä¸ºæ‚¨çš„ç”¨æˆ·èŠ‚çœå¾€è¿”æœåŠ¡å™¨çš„æ—¶é—´ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå‡å°‘è¯·æ±‚æ•°é‡éå¸¸é‡è¦ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªå—æ¬¢è¿çš„é€‰æ‹©ã€‚åœ¨å¤§å¤šæ•°ç®€å•çš„æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½åªæƒ³ä½¿ç”¨`webcomponents-loader.js`è„šæœ¬ã€‚

å…¨åŒ…ç»™ä½ çš„å…³é”®è£…è½½è·¯å¾„å¢åŠ äº† **94kb** ï¼Œè€Œè£…è½½å™¨åªå¢åŠ äº† **5kb** ã€‚æ‚¨åº”è¯¥å¹³è¡¡æ—§æµè§ˆå™¨ä¸Šå¯èƒ½çš„å°‘æ•°ç”¨æˆ·çš„éœ€æ±‚å’Œ evergreen æµè§ˆå™¨ä¸Šå¯èƒ½çš„å¤§å¤šæ•°ç”¨æˆ·çš„ä¾¿åˆ©ã€‚

### [](#asynchronous-loading)å¼‚æ­¥åŠ è½½

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä¼šå¸Œæœ›åœ¨`head`çš„é¡¶éƒ¨åŒæ­¥åŠ è½½`webcomponents-loader.js`è„šæœ¬ã€‚ä½†æ˜¯æœ‰æ—¶æ‚¨ä¼šå¸Œæœ›å¼‚æ­¥åŠ è½½å®ƒã€‚ä¾‹å¦‚:å¦‚æœä½ çš„åº”ç”¨ç¨‹åºå®ç°äº†ä¸€ä¸ª[é™æ€åº”ç”¨ç¨‹åºå¤–å£³](https://google-developer-training.gitbooks.io/progressive-web-apps-ilt-concepts/content/docs/introduction-to-progressive-web-app-architectures.html#instant)æ¥ç»™ç”¨æˆ·ä¸€ç§æ€§èƒ½é”™è§‰ï¼Œä½ ä¼šå¸Œæœ›é™æ€ HTML å’Œ CSS å°½å¯èƒ½å¿«åœ°åŠ è½½ï¼Œè¿™æ„å‘³ç€æ¶ˆé™¤æ¸²æŸ“é˜»å¡èµ„æºã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦ä½¿ç”¨`window.WebComponents.waitFor`æ–¹æ³•æ¥ç¡®ä¿æ‚¨çš„ç»„ä»¶åœ¨ polyfills ä¹‹ååŠ è½½ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª~~ä»`webcomponentsjs`è‡ªè¿°æ–‡ä»¶ä¸­æ— å¿å¼•ç”¨~~ç•¥åŠ ä¿®æ”¹çš„ä¾‹å­:

```
<!-- Note that because of the "defer" attr, "loader" will load these async -->
<script defer src="node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>

<!-- Load a custom element definitions in `waitFor` and return a promise -->
<!-- Note that all modules are deferred -->
<script type="module">
  WebComponents.waitFor(() =>
    // At this point we are guaranteed that all required polyfills have
    // loaded, and can use web components API's.
    // The standard pattern is to load element definitions that call
    // `customElements.define` here.
    // Note: returning the import's promise causes the custom elements
    // polyfill to wait until all definitions are loaded and then upgrade
    // the document in one batch, for better performance.
    Promise.all([
      import('./my-element.js'),
      import('/node_modules/bob-elements/bobs-input.js'),
      import('https://unpkg.com/@power-elements/lazy-image/lazy-image.js?module'),
    ])
  );
</script>

<!-- Use the custom elements -->
<my-element>
  <bobs-input label="Paste image url" onchange="e => lazy.src = e.target.value"></bobs-input>
  <lazy-image id="lazy"></lazy-image>
</my-element> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ–è€…ä¸€ä¸ªæ›´å…¸å‹çš„é™æ€åº”ç”¨å¤–å£³æ¨¡å¼çš„ä¾‹å­:

```
<head>
  <script defer src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
  <style>
    /* critical static-app-shell styles here */
  </style>
</head>
<body>
  <script type="module">
    // app-shell.js in turn imports its own dependencies
    WebComponents.waitFor(() => import('./app-shell.js'))
  </script>
  <app-shell loading>
    <header id="static-header">
      <span id="static-hamburger"></span>
      <span id="static-user"></span>
    </header>
    <main>
      <div id="static-spinner"></div>
    </main>
    <footer id="static-footer"></footer>
  </app-shell>
</body> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#writing-custom-elements-that-work-with-the-polyfills)ç¼–å†™ä½¿ç”¨èšåˆå¡«å……çš„è‡ªå®šä¹‰å…ƒç´ 

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ª web ç»„ä»¶åº“ï¼Œæ¯”å¦‚ [Polymer](https://github.com/polymer/polymer) ã€ [LitElement](https://github.com/polymer/lit-element) æˆ– [hybrids](https://github.com/hybridsjs/hybrids) (è¿˜æœ‰å…¶ä»–çš„)æ¥ç¼–å†™ä½ çš„ç»„ä»¶(æˆ‘ä»¬å°†åœ¨åé¢çš„å¸–å­ä¸­ä»‹ç»)ï¼Œä½ çš„ç»„ä»¶å°†å¯ä»¥å¼€ç®±å³ç”¨åœ°ä½¿ç”¨ polyfillsã€‚é‚£äº›åº“æ˜¯[ä¸“é—¨](https://github.com/Polymer/polymer/search?q=shady+extension%3Ajs&unscoped_q=shady+extension%3Ajs) [ç¼–å†™](https://github.com/Polymer/lit-element/blob/eb481ecc925bc4535e4101112c65b71ff7f7d450/src/lib/updating-element.ts#L387)åˆ°[ä½¿ç”¨](https://github.com/hybridsjs/hybrids/search?q=shady&unscoped_q=shady)çš„ polyfillsã€‚ä½ çš„ä»»åŠ¡å®Œæˆäº†ã€‚å–æ¯å•¤é…’å§ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæ‚¨åœ¨ç¼–å†™ç»„ä»¶æ—¶æ²¡æœ‰ä½¿ç”¨åº“(é¦–å…ˆï¼Œè¿™å¯¹æ‚¨æœ‰å¥½å¤„)ï¼Œæ‚¨å°†éœ€è¦ç»å†ä¸€äº›å›°éš¾ï¼Œä»¥ç¡®ä¿æ‚¨çš„ç»„ä»¶èƒ½å¤Ÿæ­£ç¡®åœ°å‘ˆç°ç»™å°½å¯èƒ½å¤šçš„ç”¨æˆ·ã€‚

çœ¼å°–çš„è¯»è€…å¯èƒ½å·²ç»æ³¨æ„åˆ°æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä½¿ç”¨çš„ä¸€ä¸ªä¾‹å­ä¸­å¤¹æ‚äº†å‡ è¡Œå¤æ‚çš„ JavaScript ä»£ç :

```
const template = document.createElement('template')
template.innerHTML = /*...*/

// Let's give the polyfill a leg-up
window.ShadyCSS &&
window.ShadyCSS.prepareTemplate(template, 'awesome-button')

customElements.define('awesome-button', class AwesomeButton extends HTMLElement {
  constructor() {
    super()
    this.onclick = () => report('Clicked on Shadow DOM')
  }

  connectedCallback() {
    // Let's give the polyfill a leg-up
    window.ShadyCSS && window.ShadyCSS.styleElement(this)
    if (!this.shadowRoot) {
      this.attachShadow({mode: 'open'});
      this.shadowRoot.appendChild(template.content.cloneNode(true))
    }
  }
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

çœ‹åˆ°é‚£ä¸ª`ShadyCSS`å‚è€ƒäº†å—ï¼Ÿè¿™æ˜¯ polyfills çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ä¸æ”¯æŒå®ƒçš„æµè§ˆå™¨ä¸­æ¨¡æ‹Ÿå½±å­ DOM çš„æ ·å¼èŒƒå›´ã€‚ä¸ºäº†æ­£ç¡®ç¡®å®šæ ·å¼çš„èŒƒå›´ï¼Œéœ€è¦éµå¾ªä¸€äº›è§„åˆ™:

### [](#shadycss-rules)ShadyCSS è§„åˆ™:

1.  æ ·å¼åº”è¯¥åœ¨`<style>`å…ƒç´ ä¸­å®šä¹‰ï¼Œè¯¥å…ƒç´ æ˜¯`<template>`å…ƒç´ çš„ç›´æ¥å­å…ƒç´ ã€‚
2.  é‚£ä¸ª`<style>`æ ‡ç­¾åº”è¯¥æ˜¯æ¨¡æ¿ä¸­å”¯ä¸€çš„ä¸€ä¸ªã€‚
3.  åœ¨ä½ çš„å…ƒç´ é™„åŠ ä¹‹å‰ï¼Œç”¨`ShadyCSS.prepareTemplate(templateElement, tagName)`æŠŠå®ƒçš„æ¨¡æ¿å’Œå®ƒçš„æ ‡ç­¾åå…³è”èµ·æ¥
4.  åœ¨æ‚¨çš„å®šåˆ¶å…ƒç´ é™„åŠ åˆ°æ–‡æ¡£ä¹‹åï¼Œä½†æ˜¯åœ¨åˆ›å»ºé˜´å½±æ ¹ä¹‹å‰ï¼Œåœ¨æ‚¨çš„å®šåˆ¶å…ƒç´ ä¸Šè°ƒç”¨`ShadyCSS.styleElement`æ¥è®¡ç®—å®ƒçš„æ ·å¼ã€‚

å°†æ ·å¼æ ‡ç­¾ä¸­çš„è§„åˆ™è§£ææˆä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åå°†ç”Ÿæˆçš„çˆ¶é€‰æ‹©å™¨æ·»åŠ åˆ°å®ƒä»¬å‰é¢ä»¥æ¨¡æ‹Ÿä½œç”¨åŸŸã€‚

```
button {/*...*/} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆä¸º...

```
.style-scope .awesome-button button {/*..*/} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å°†ä½œç”¨åŸŸç±»åº”ç”¨äºä½ çš„å…ƒç´ åŠå…¶â€œå¯ç–‘â€å­å…ƒç´ ã€‚

```
<awesome-button>
  #shadow-root
  <button></button>
</awesome-button> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆä¸º...

```
<awesome-button>
  <button class="style-scope awesome-button"></button>
</awesome-button> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒï¼ŒShadyCSS ä¹Ÿä¼šå¡«å…… CSS è‡ªå®šä¹‰å±æ€§(`var(--foo)`)ã€‚

### [](#dynamic-styles)åŠ¨æ€æ ·å¼

ç”±äº ShadyCSS èšåˆå¡«å……çš„å·¥ä½œæ–¹å¼ï¼Œå»ºè®®éœ€è¦æ”¯æŒæ—§ç‰ˆæœ¬æµè§ˆå™¨çš„ web ç»„ä»¶ä½œè€…ä¸è¦ä½¿ç”¨åŠ¨æ€ç”Ÿæˆçš„ CSSï¼Œä¾‹å¦‚:

```
const getTemplate = ({disabled}) => `
  <style>
    button {
      background-color: ${disabled ? 'grey' : 'white'};
    }
  </style>
`

class AwesomeButton extends HTMLElement {
  set disabled(disabled) {
    this.render()
  }

  connectedCallback() {
    this.attachShadow({mode: 'open'})
    this.render()
  }

  render() {
    this.shadowRoot.innerHTML = getTemplate(this.disabled)
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸è¦ç”¨é‚£ä¸ªä¾‹å­(å› ä¸ºè®¸å¤šä¸åŒçš„åŸå› ï¼Œè€Œä¸ä»…ä»…æ˜¯ ShadyCSS å…¼å®¹æ€§çš„åŸå› ï¼Œè¿™ä¸ªä¾‹å­è€ƒè™‘å¾—å¾ˆç³Ÿç³•)ï¼Œè€Œæ˜¯ä½¿ç”¨ CSS è‡ªå®šä¹‰å±æ€§ï¼Œæ¯å½“å‘ç”ŸåŠ¨æ€æ›´æ–°æ—¶ï¼Œå°±ä½¿ç”¨`ShadyCSS.styleSubTree`æˆ–`ShadyCSS.styleDocument` :

```
const template = document.createElement('template')
template.innerHTML = `
  <style>
    button {
      background-color: var(--awesome-button-background, white);
    }
  </style>
  <button></button>
`;

class AwesomeButton extends HTMLElement {
  static get observedAttributes() {
    return ['disabled']
  }

  connectedCallback() {
    if (!this.shadowRoot) {
      this.attachShadow({mode: 'open'})
      this.shadowRoot.appendChild(template.content.cloneNode(true))
    }
  }

  attributesChangedCallback(name, oldVal, newVal) {
    name === 'disabled' &&
    ShadyCSS &&
    ShadyCSS.styleDocument({
      '--awesome-button-background' : newVal ? 'grey' : 'white',
    });
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å‡ºäºå¥½å¥‡ï¼Œæœ¬åœ°å®ç°è¿™ä¸€ç‚¹çš„æ–¹æ³•ï¼Œå³å¦‚æœä¸æ¶‰åŠ polyfillsï¼Œåªéœ€å¯¹æ–‡æ¡£è¿›è¡Œæ ·å¼åŒ–:

```
// No Polyfill
document.documentElement.style
  .setProperty('--awesome-button-background', newVal ? 'grey' : 'white'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™äº›éƒ½æ˜¯äººä¸ºçš„ä¾‹å­ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œä½ æ›´æœ‰å¯èƒ½å®Œå…¨ç”¨ CSS æ¥è§£å†³é—®é¢˜ï¼Œæ¯”å¦‚:

```
:host { background: white; }
:host([disabled]) { background: grey; } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯å¦‚æœä½ æƒ³ï¼Œæ¯”å¦‚è¯´ï¼ŒåŸºäºè§¦æ‘¸äº‹ä»¶æ—‹è½¬è‰²è°ƒæˆ–è€…åŸºäº websocket æ›´æ–°å˜æ¢å…ƒç´ ï¼ŒCSS è‡ªå®šä¹‰å±æ€§æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

ShadyCSS æä¾›äº†ä¸€äº›å…¶ä»–çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ç°åœ¨å·²ç»åºŸå¼ƒçš„`@apply` CSS è¯­æ³•çš„å«ç‰‡ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æ‰“ç®—è®¨è®ºå®ƒä»¬ï¼Œå› ä¸ºè¿™ä¸ªè§„èŒƒå·²ç»è¿‡æ—¶äº†ã€‚

é˜´å½±å¡«å……èšåˆå¡«å……ä¹Ÿæœ‰ä¸€äº›[å·²çŸ¥çš„é™åˆ¶ã€‚å‰§é€:](https://github.com/webcomponents/shadycss#limitations)

*   ç”±äº ShadyCSS ç§»é™¤äº†æ‰€æœ‰çš„`<slot>`å…ƒç´ ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ç›´æ¥é€‰æ‹©å®ƒä»¬ï¼Œæ‰€ä»¥ä½ å¿…é¡»ä½¿ç”¨ä¸€äº›ç±»ä¼¼`.context ::slotted(*)`çš„ä¸Šä¸‹æ–‡åŒ…è£…å™¨ã€‚
*   æ–‡æ¡£æ ·å¼å¯èƒ½ä¼šæ¸—é€åˆ°æ‚¨çš„æ ‘è«ä¸‹ï¼Œå› ä¸º polyfill ä»…æ¨¡æ‹Ÿå°è£…ã€‚

å…³äºå·²çŸ¥é™åˆ¶çš„å†…å¹•ï¼Œè¯·å‚è§[è‡ªè¿°æ–‡ä»¶](https://github.com/webcomponents/shadycss#limitations)ã€‚

### shady CSS TLï¼›åšå£«:

æ‰€ä»¥åŸºæœ¬ä¸Šï¼Œåªè¦ä½ æ„¿æ„ï¼Œä½ çš„å…ƒç´ ç”šè‡³å¯ä»¥åœ¨æ—§çš„æµè§ˆå™¨å’Œ Edge ä¸Šæ­£å¸¸å·¥ä½œ

*   åœ¨å…ƒç´ çš„`<template>`å…ƒç´ ä¸­å®šä¹‰å…ƒç´ çš„æ ·å¼ï¼›
*   è€ƒè™‘ä½ çš„å…ƒç´ çš„é˜´å½±æ§½ä¸èšåˆå¡«å……ï¼›åœ¨ä½ çš„å…ƒç´ çš„`connectedCallback`ä¸­åˆ¶ä½œåˆé€‚çš„å’’è¯­ï¼›å’Œ
*   ä½¿ç”¨`ShadyCSS.styleDocument`æˆ–`ShadyCSS.styleSubTree`åŠ¨æ€æ›´æ–° CSS è‡ªå®šä¹‰å±æ€§ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŸºäº CSS çš„è§£å†³æ–¹æ¡ˆæ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚

## [](#custom-elements-polyfill)è‡ªå®šä¹‰å…ƒç´ èšåˆå¡«å……

[è‡ªå®šä¹‰å…ƒç´  polyfill](https://github.com/webcomponents/custom-elements) ç”¨è‡ªå®šä¹‰å…ƒç´ è§„èŒƒä¸­çš„ API ä¿®è¡¥äº†å‡ ä¸ª DOM æ„é€ å‡½æ•°:

*   `HTMLElement`è·å¾—è‡ªå®šä¹‰å…ƒç´ å›è°ƒï¼Œå¦‚`connectedCallback`å’Œ`attributeChangedCallback`(æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è¯¦ç»†è®¨è®º)ã€‚å®ƒçš„åŸå‹ã€‚
*   `Element`è·å–`attachShadow`ï¼Œå¹¶ä¸”åƒ`setAttribute`å’Œ`innerHTML`è®¾ç½®å™¨è¿™æ ·çš„æ–¹æ³•è¢«æ‰“è¡¥ä¸ä»¥å¤„ç†å¤šå¡«å……çš„å®šåˆ¶å…ƒç´ å›è°ƒã€‚
*   ç±»ä¼¼äº`appendChild`çš„`Node`ä¸Šçš„ DOM APIs ä¹Ÿæ‰“äº†ç±»ä¼¼çš„è¡¥ä¸
*   `Document#createElement` *ç­‰äºº*å¾—åˆ°ç±»ä¼¼çš„å¾…é‡ã€‚

å®ƒè¿˜åœ¨`window`ä¸Šå…¬å¼€äº†`customElements`å¯¹è±¡ï¼Œå› æ­¤æ‚¨å¯ä»¥æ³¨å†Œæ‚¨çš„ç»„ä»¶ã€‚

polyfill åœ¨`DOMContentLoaded`ä¹‹åå‡çº§å®šåˆ¶å…ƒç´ ï¼Œç„¶ååˆå§‹åŒ–ä¸€ä¸ª`MutationObserver`æ¥å‡çº§ä»»ä½•éšåé™„åŠ äº† JavaScript çš„å®šåˆ¶å…ƒç´ ã€‚

### [](#supporting-ie11)æ”¯æŒ IE11

<figure>[https://www.youtube.com/embed/EWX0ib9onRA](https://www.youtube.com/embed/EWX0ib9onRA)

<figcaption>How I feel when someone tells me they need to support IE11.</figcaption>

</figure>

`<rant>`

polyfills æ”¯æŒ IE11ï¼Œä½†ä¸å…¨æ˜¯é˜³å…‰å’Œå½©è™¹ã€‚IE11 ä¸å†ç”± MS å¼€å‘ï¼Œè¿™æ„å‘³ç€å®ƒ*ä¸åº”è¯¥*è¢«ä½¿ç”¨ã€‚å†³å®šæ”¯æŒ IE11 æ„å‘³ç€å¢åŠ äº†å¼€å‘æ—¶é—´ï¼Œå¢åŠ äº†å¤æ‚æ€§ï¼Œå¢åŠ äº† bug çš„è¡¨é¢ç§¯ï¼Œå¹¶å°†ç”¨æˆ·æš´éœ²åœ¨ä¸€ä¸ªæœ‰ç¼ºé™·çš„ã€è¿‡æ—¶çš„æµè§ˆå™¨é¢å‰ã€‚ä»»ä½•æ—¶å€™ IE11 æ”¯æŒä½œä¸ºä¸€ä¸ªéœ€æ±‚è¢«æå‡ºï¼Œå®ƒéƒ½å¿…é¡»è¢«ä»”ç»†è¯„ä¼°ã€‚ä¸è¦ä»…ä»…æŠŠå®ƒå½’ä¸ºâ€œå€¼å¾—æ‹¥æœ‰çš„ä¸œè¥¿â€ã€‚è¿™æ˜¯*è€Œä¸æ˜¯*ç¾å¥½çš„æ‹¥æœ‰ã€‚å¦‚æœè¿™ä¸æ˜¯åŸºäºä¸å¯é¿å…çš„æƒ…å†µçš„ç»å¯¹éœ€æ±‚ï¼Œæœ€å¥½æ ¹æœ¬ä¸è¦æ”¯æŒå®ƒã€‚

`</rant>`

*phew* ã€‚å¥½äº†ï¼Œç»§ç»­è¡¨æ¼”ã€‚

æ ¹æ®è§„èŒƒï¼Œå®šåˆ¶å…ƒç´ å¿…é¡»ç”¨ JavaScript `class` es å®šä¹‰ï¼Œä½†æ˜¯ IE11 æ°¸è¿œä¸ä¼šæ”¯æŒ ES6 çš„è¿™ä¸ªç‰¹æ€§ã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç”¨å·´åˆ«å¡”æˆ–è€…ç±»ä¼¼çš„å·¥å…·æŠŠæˆ‘ä»¬çš„ç±»ç§»æ¤åˆ° ES5ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯[èšåˆç‰©å®¢æˆ·ç«¯](https://www.polymer-project.org/3.0/docs/tools/polymer-cli)ï¼Œæœ‰ä¸€ä¸ªå°† JS è½¬æ¢æˆ ES5 çš„é€‰é¡¹ã€‚

åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥æ„å»ºä¸¤ä¸ªæˆ–æ›´å¤šç‰ˆæœ¬çš„ç«™ç‚¹:

1.  ä½¿ç”¨`class`å…³é”®å­—å’Œ es2015+åŠŸèƒ½ä¸º evergreen/modern æµè§ˆå™¨ç¼–å†™
2.  ä½¿ç”¨`function`å…³é”®å­—ç±»ä¼ è¾“åˆ° ES5
3.  ä»¥åŠä»»ä½•ä»‹äºä¸¤è€…ä¹‹é—´çš„è‰²è°ƒã€‚

ç„¶å[ä¸ºä½ çš„åº”ç”¨](https://github.com/Polymer/prpl-server)æä¾›å·®å¼‚åŒ–æœåŠ¡ï¼Œå‘æœ‰èƒ½åŠ›çš„ç”¨æˆ·ä»£ç†å‘é€å¿«é€Ÿã€è½»ä¾¿ã€ç°ä»£çš„ä»£ç ï¼Œå‘æ—§æµè§ˆå™¨å‘é€ç¼“æ…¢ã€é€æ˜ã€é—ç•™çš„ä»£ç ã€‚

ä½†è¿™å¹¶ä¸æ€»æ˜¯ä¸€ç§é€‰æ‹©ã€‚å¦‚æœä½ æœ‰ç®€å•çš„é™æ€ä¸»æœºï¼Œéœ€è¦ä¸ºæ‰€æœ‰æµè§ˆå™¨æ„å»ºä¸€ä¸ªåŒ…ï¼Œä½ å°†è¢«è¿«è½¬æ¢åˆ° ES5ï¼Œè¿™ä¸åŸç”Ÿçš„`customElements`å®ç°ä¸å…¼å®¹ã€‚

å¯¹äºè¿™ç§æƒ…å†µï¼Œpolyfill ä¸ºæ”¯æŒ ES5 é£æ ¼çš„`function`å…³é”®å­—å…ƒç´ çš„åŸç”Ÿ customElements å®ç°æä¾›äº†ä¸€ä¸ª[å«ç‰‡ï¼Œç¡®ä¿å°†å®ƒåŒ…å«åœ¨æ‚¨çš„æ„å»ºä¸­(ä¸è¦ä¼ è¾“è¿™ä¸ªæ–‡ä»¶ï¼)å¦‚æœä½ çš„ç›®æ ‡æ˜¯ä½¿ç”¨ç›¸åŒçš„æ†ç»‘åŒ…çš„æ–°æ—§æµè§ˆå™¨ã€‚](https://github.com/webcomponents/custom-elements/blob/master/src/native-shim.js) 

```
<script src="/node_modules/@webcomponents/webcomponentsjs/entrypoints/custom-elements-es5-adapter-index.js"></script>
<script src="/node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ´»è·ƒçš„ web ç»„ä»¶ç¤¾åŒºæˆå‘˜ [@ruphin](https://github.com/ruphin) æå‡ºäº†ä¸€ä¸ª[å·§å¦™çš„æŠ€å·§](https://github.com/ruphin/gluonjs/blob/master/examples/index.html)ä½ å¯ä»¥ç”¨å®ƒæ¥æä¾›ä¸€ç§ç”šè‡³åœ¨é™æ€ä¸»æœºä¸Šçš„å·®åˆ«æœåŠ¡ï¼Œé‚£å°±æ˜¯åˆ©ç”¨æµè§ˆå™¨çš„`nomodule`ç‰¹æ€§:

```
<!-- This loads the app as a module on Chrome, Edge, Firefox, and Safari -->
<!-- Modules are always nonblocking, and they load after regular scripts, so we can put them first -->
<script type="module" src="/index.js"></script>

<!-- This loads the app on IE11 -->
<script nomodule src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.min.js"></script>
<!-- Take a look at rollup.config.js to see how to build this guy -->
<script nomodule src="./index.nomodule.js"></script> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

çœ‹çœ‹ä»–çš„è½»é‡çº§ web ç»„ä»¶æ¡†æ¶ gluonjs

## ![GitHub logo](../Images/75095a8afc1e0f207cda715962e75c8d.png) [é²èŠ¬](https://github.com/ruphin) / [æ ¼éš†å‰æ–¯](https://github.com/ruphin/gluonjs)

### è½»é‡çº§ Web ç»„ä»¶åº“

<article class="markdown-body entry-content container-lg" itemprop="text">

# [æ ¸]èƒ¶å­ï¼ˆä¸€ç§ç†è®ºä¸Šå‡è®¾çš„æ— è´¨é‡çš„ç²’å­ï¼‰

[![Build Status](../Images/92a2881644a5afc2c7ae83c9e3190c9b.png)](https://travis-ci.org/ruphin/gluonjs)[![NPM Latest version](../Images/b170d02255a38160d182f20b8896a833.png)](https://www.npmjs.com/package/@gluon/gluon)[![Code Style: prettier](../Images/76245b01cc15290741bd336634799095.png)](https://github.com/prettier/prettier)

ç”¨äºæ„å»º web ç»„ä»¶å’Œåº”ç”¨çš„è½»é‡çº§åº“

* * *

*   **åŸºäºå¹³å°:** GluonJS æ—¨åœ¨åˆ©ç”¨æœ€æ–°çš„ç½‘ç»œå¹³å°åŠŸèƒ½ï¼Œä½¿å…¶å°ºå¯¸æå°ï¼Œå¹¶åœ¨ç°ä»£æµè§ˆå™¨ä¸Šå…·æœ‰å¾ˆé«˜çš„æ€§èƒ½ã€‚æ­¤å¤–ï¼Œè¿™æ„å‘³ç€**æ„å»º/ç¼–è¯‘æ­¥éª¤æ˜¯å¯é€‰çš„**ï¼›GluonJS ç»„ä»¶å¯ä»¥åœ¨ç°ä»£æµè§ˆå™¨ä¸Šå·¥ä½œï¼Œä¸éœ€è¦ä»»ä½•é¢„å¤„ç†ã€‚
*   **ç»„ä»¶æ¨¡å‹:**ç”¨å°è£…çš„é€»è¾‘å’Œæ ·å¼æ„å»ºç»„ä»¶ï¼Œç„¶åç»„åˆå®ƒä»¬ï¼Œåˆ¶ä½œå¤æ‚çš„æ¥å£ã€‚ä½¿ç”¨ Web ç»„ä»¶æ ‡å‡†ï¼Œå¼€å‘äººå‘˜å¯ä»¥ç›´æ¥ä½¿ç”¨æ‰€æœ‰ç›¸å…³çš„ APIã€‚
*   **é«˜åº¦å¯é‡ç”¨:**å› ä¸º GluonJS åˆ›å»ºäº†ç¬¦åˆæ ‡å‡†çš„ Web ç»„ä»¶ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥åœ¨å‡ ä¹ä»»ä½•ç°æœ‰çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ GluonJS åˆ›å»ºçš„ç»„ä»¶ã€‚æ£€æŸ¥å„å¤„çš„[å®šåˆ¶å…ƒç´ ](https://custom-elements-everywhere.com/)ä»¥è·å¾—ä¸ç°æœ‰æ¡†æ¶çš„æœ€æ–°å…¼å®¹æ€§è¡¨ã€‚
*   **å¼ºå¤§çš„æ¨¡æ¿åŒ–:** GluonJS ä½¿ç”¨ [lit-html](https://github.com/PolymerLabs/lit-html) è¿›è¡Œæ¨¡æ¿åŒ–ï¼Œå…·æœ‰å¾ˆå¼ºçš„è¡¨ç°åŠ›å’Œçµæ´»æ€§ã€‚

## æ¦‚å¿µ

```
import { GluonElement } from '/node_modules/@gluon/gluon/gluon.js';
class MyElement extends GluonElement {
  // ...
}

customElements.define(MyElement.is, MyElement
```

â€¦<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg></article>

[View on GitHub](https://github.com/ruphin/gluonjs)

## [](#conclusion)ç»“è®º

webcomponentsjs èšåˆå¡«å……å…è®¸æ‚¨åœ¨è¾ƒæ—§çš„æµè§ˆå™¨ä¸­è¿è¡Œ web ç»„ä»¶ã€‚æ²¡é”™ï¼Œè¦ä½¿å®ƒå·¥ä½œï¼Œæ‚¨å¿…é¡»è·¨è¶Šä¸€äº›éšœç¢ï¼Œä½†æ˜¯å¦‚æœæ‚¨ä½¿ç”¨ web ç»„ä»¶åŠ©æ‰‹åº“æ¥å®šä¹‰æ‚¨çš„å…ƒç´ ï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†å·¥ä½œéƒ½ä¼šç”±æ‚¨æ¥å®Œæˆã€‚

åœ¨æˆ‘ä»¬çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œä¸Šå¸ä¿ä½‘ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ç”¨æ™®é€šçš„æµè§ˆå™¨ API ç¼–å†™ web ç»„ä»¶ä»¥è·å¾—æœ€å¤§çš„æ§åˆ¶å’Œäº’æ“ä½œæ€§ã€‚

### [](#errata)å‹˜è¯¯è¡¨

*   æœ¬æ–‡çš„å‰ä¸€ç‰ˆæœ¬å»ºè®®åœ¨æ¨¡å—ä¸­å¯¼å…¥èšåˆå¡«å……ï¼Œå¦‚ä¸‹æ‰€ç¤º:`import '@webcomponents/webcomponentsjs/webcomponents-loader.js';`ä¸è¦è¿™æ ·åšã€‚ç›¸åï¼Œåº”åœ¨åŠ è½½ä»»ä½•å…¶ä»–æ¨¡å—ä¹‹å‰ï¼Œå°†èšåˆå¡«å……åŠ è½½åˆ°æ–‡ä»¶`head`ä¸­ã€‚è¿™ç¯‡æ–‡ç« å·²ç»ç”¨ä¸€ä¸ªæ›´æ–°çš„ä¾‹å­æ”¹æ­£äº†ã€‚
*   æœ¬æ–‡çš„å‰ä¸€ç‰ˆæœ¬å»ºè®®ä¸è¦åŠ è½½ç‰¹å®šçš„èšåˆå¡«å……ã€‚å½“å‰ç‰ˆæœ¬æ›´æ·±å…¥åœ°è¯´æ˜äº†ä¸ºä»€ä¹ˆä»¥åŠä½•æ—¶é€‰æ‹©è¿™æ ·åšã€‚
*   æœ¬æ–‡çš„å‰ä¸€ä¸ªç‰ˆæœ¬ä½¿ç”¨äº†`this.shadowRoot.append`ï¼Œå®ƒå¯ä»¥åœ¨æ”¯æŒçš„æµè§ˆå™¨ä¸Šå·¥ä½œã€‚æœ€å¥½ä½¿ç”¨`this.shadowRoot.appendChild`ï¼Œå®ƒä¹Ÿé€‚ç”¨äºèšåˆå¡«å……ã€‚
*   æœ¬æ–‡çš„å‰ä¸€ç‰ˆæœ¬å±•ç¤ºäº†åœ¨`connectedCallback`ä¸­é™„åŠ ä¸€ä¸ªå½±å­æ ¹çš„ä¾‹å­ï¼Œè€Œæ²¡æœ‰é¦–å…ˆæ£€æŸ¥ä¸€ä¸ªå½±å­æ ¹æ˜¯å¦å·²ç»å­˜åœ¨ã€‚ç¤ºä¾‹å·²æ›´æ–°ã€‚
*   è‡ªä»è¿™ç¯‡æ–‡ç« å‘è¡¨ä»¥æ¥ï¼Œ[å¾®è½¯å·²ç»å¼€å§‹åœ¨ Edge](https://developer.microsoft.com/en-us/microsoft-edge/platform/status/customelements/) ä¸­å¼€å‘ web ç»„ä»¶æ ‡å‡†ã€‚æ´¾å¯¹æ—¶é—´ï¼

æŸ¥çœ‹æœ¬ç³»åˆ—çš„ä¸‹ä¸€ç¯‡æ–‡ç« 

[![bennypowers](../Images/57370d6f6dab8d6651a3f138a1aaaa40.png)](/bennypowers) [## è®©æˆ‘ä»¬æ„å»º Web ç»„ä»¶ï¼ç¬¬ 3 éƒ¨åˆ†:æ™®é€šç»„ä»¶

### æœ¬å°¼Â·é²å°”æ–¯ğŸ‡®ğŸ‡±ğŸ‡¨ğŸ‡¦10 æœˆ 5 æ—¥ 1818 åˆ†é’Ÿé˜…è¯»

#webcomponents #customelements #javascript #html](/bennypowers/lets-build-web-components-part-3-vanilla-components-4on3)

æ‚¨æƒ³å°±æ­¤å¤„æ¶‰åŠçš„ä»»ä½•ä¸»é¢˜è¿›è¡Œä¸€å¯¹ä¸€çš„è¾…å¯¼å—ï¼Ÿ[![Contact me on Codementor](../Images/97f0e0737ce864c47f2412396b01e737.png)T2ã€‘](https://www.codementor.io/bennyp?utm_source=github&utm_medium=button&utm_term=bennyp&utm_campaign=github)