# é€šè¿‡ NativeScript ä½¿ç”¨ Azure è®¤çŸ¥æœåŠ¡

> åŸæ–‡:[https://dev . to/rdlauer/using-azure-cognitive-services-with-native script-3 iao](https://dev.to/rdlauer/using-azure-cognitive-services-with-nativescript-3iao)

è®©æˆ‘ä»¬é¢å¯¹äº‹å®:ç”µè„‘èµ¢äº†ï¼æœªæ¥å®é™…ä¸ŠæŒæ¡åœ¨æˆ‘ä»¬æœ€é«˜æœºå™¨äººé¢†å¯¼äººçš„æ‰‹ä¸­ã€‚

[![i for one welcome our robot overlords](../Images/48acef46958f0173192d124b0bae915f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--piy8wZk8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/robot-overlords.png)

è™½ç„¶ä»Šå¤©å¹¶ä¸å®Œå…¨æ˜¯â€œç»ˆç»“è€…â€å¼çš„ç°å®ğŸ¤–ï¼Œäº‹å®æ˜¯â€œè®¤çŸ¥æœåŠ¡â€æ­£åœ¨çˆ†ç‚¸ã€‚ä»æœºå™¨å­¦ä¹ åˆ°äººå·¥æ™ºèƒ½ï¼Œå†åˆ°å…¶ä»–è®¤çŸ¥ APIï¼Œè¿™äº›â€œæ€è€ƒâ€æœåŠ¡æ­£åœ¨å°†éš¾ä»¥ç½®ä¿¡çš„èƒ½åŠ›å¸è½½åˆ°äº‘ä¸Šã€‚

> é˜…è¯»æ›´å¤šå…³äº Progress å¦‚ä½•åŠ é€Ÿè®¤çŸ¥åº”ç”¨å¼€å‘çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥é˜…è¯»ä¸€æœ¬å…³äº T2 ç§»åŠ¨å¼€å‘æ–°å‰æ™¯çš„å…è´¹ç”µå­ä¹¦ã€‚

[å¾®è½¯ Azure](https://azure.microsoft.com/) æ˜¯ä¸“é—¨çš„è®¤çŸ¥ API çš„å¯é é€‰æ‹©ï¼Œå¦‚[è§†è§‰](https://azure.microsoft.com/en-us/services/cognitive-services/directory/vision/)ã€[çŸ¥è¯†](https://azure.microsoft.com/en-us/services/cognitive-services/directory/know/)ã€[è¯­è¨€](https://azure.microsoft.com/en-us/services/cognitive-services/directory/lang/)ã€[è¯­éŸ³](https://azure.microsoft.com/en-us/services/cognitive-services/directory/speech/)å’Œ[æœç´¢](https://azure.microsoft.com/en-us/services/cognitive-services/directory/search/)ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ç”¨ NativeScript æ„å»ºçš„åŸç”Ÿ iOS/Android åº”ç”¨ç¨‹åºä¸­åˆ©ç”¨è¿™äº› API ä¹‹ä¸€ã€‚

## Azure Face API

å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒå¥½ç©çš„ API æ˜¯ Azure çš„ [Face API](https://azure.microsoft.com/en-us/services/cognitive-services/face/) ã€‚ä½¿ç”¨ Face APIï¼Œä½ å¯ä»¥å‘ Azure å‘é€ä¸€å¼ å¸¦æœ‰äººè„¸çš„å›¾åƒï¼Œå®ƒå°†è¿”å›å„ç§è§£é‡Šçš„å±æ€§:

```
{
    "faceId": "da450841-201c-40a4-b330-2e43ba7f509f",
    "faceRectangle": {
        "top": 87,
        "left": 61,
        "width": 107,
        "height": 107
    },
    "faceAttributes": {
    "gender": "male",
    "age": 21,
        "emotion": {
            "anger": 0,
            "contempt": 0.001,
            "disgust": 0,
            "fear": 0,
            "happiness": 0.762,
            "neutral": 0.237,
            "sadness": 0,
            "surprise": 0
        }
    }
} 
```

Enter fullscreen mode Exit fullscreen mode

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å¼€å§‹ä½¿ç”¨ Face APIã€‚

## è®¾ç½® Azure å¸æˆ·

Azure æä¾›å®Œå…¨å…è´¹çš„ 7 å¤©è¯•ç”¨ï¼Œä»¥ä½¿ç”¨å…¶è®¤çŸ¥æœåŠ¡(ä»¥åŠæ›´å¤š)ã€‚ä¹‹åï¼Œä½ å¿…é¡»ä½¿ç”¨ä¿¡ç”¨å¡æ‰èƒ½ç»§ç»­è®¿é—®ã€‚

[![azure sign up](../Images/b40edcf795ff4631d54c927ece84943b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--h29p3mC9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/azure-signup.png)

ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œå› ä¸º Azure è¿˜æä¾›å‰ 30 å¤© 200 ç¾å…ƒçš„ä¿¡ç”¨ï¼Œå¹¶ä¼šåœ¨ä½ å¼€å§‹æ”¶å–ä»»ä½•è´¹ç”¨ä¹‹å‰è­¦å‘Šä½ ã€‚

åˆ›å»ºå¥½ Azure è´¦æˆ·åï¼Œæ‰“å¼€ [Azure é—¨æˆ·](https://portal.azure.com/)ï¼Œå¯¼èˆªåˆ°**åˆ›å»ºèµ„æº**ï¼Œæœç´¢â€œfaceâ€å¹¶å¯ç”¨ Face API:

[![search for azure face api](../Images/68fdb20e0aab395345f95dc5d4575a1b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--cfFZZB4M--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/azure-face.png)

ç‚¹å‡» **Create** æŒ‰é’®åï¼Œæ‚¨å°†å¡«å†™ä¸€ä¸ªç®€çŸ­çš„è¡¨æ ¼ï¼Œä¸Šé¢æœ‰æœåŠ¡çš„*åç§°*ã€*è®¢é˜…*ç±»å‹(é¢„å¡«)ã€*ä½ç½®*(é€‰æ‹©ç¦»æ‚¨æœ€è¿‘çš„ä¸€ä¸ªï¼)ã€*å®šä»·å±‚*(é€‰å…è´¹çš„ï¼)ï¼Œå¹¶è¾“å…¥ä¸€ä¸ª*èµ„æºç»„*åç§°:

[![azure face api details](../Images/93aa53830e6184a6da55ba06b93e4905.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--UXk89Ain--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/azure-details.png)

æ­¤æ—¶ï¼Œè¯·æ³¨æ„ä¸¤ä»¶äº‹(åœ¨æ‚¨çš„ NativeScript åº”ç”¨ç¨‹åºä¸­éœ€è¦è¿™ä¸¤ä»¶äº‹):

1.  æ‚¨çš„ API å¯†é’¥ã€‚
2.  æ‚¨çš„ Azure ç«¯ç‚¹çš„ URLã€‚

å®Œæˆäº†å—ï¼Ÿ**å¤ªå¥½äº†ï¼**è¿™å°±æ˜¯æˆ‘ä»¬å¯¹ Azure æ§åˆ¶å°çš„æ‰€æœ‰éœ€æ±‚ã€‚

## ç®€ä»‹ NativeScript

å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦ [NativeScript](https://www.nativescript.org/) ï¼Œä¸è¦å®³ç¾ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå®¹æ˜“ç†è§£çš„æ¡†æ¶ï¼

NativeScript æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºæ¡†æ¶ï¼Œç”¨äºä»å•ä¸ªä»£ç åº“ä¸º iOS å’Œ Android ( [å’Œ Web](https://blog.angular.io/apps-that-work-natively-on-the-web-and-mobile-9b26852495e7) )åˆ›å»ºçœŸæ­£åŸç”Ÿçš„*åº”ç”¨ã€‚*

NativeScript å…è®¸ä½ ä½¿ç”¨ä½ çš„ç½‘ç»œæŠ€èƒ½(æ¯”å¦‚ JavaScript/TypeScript å’Œ CSS)å’Œæµè¡Œçš„ JavaScript æ¡†æ¶(æ¯”å¦‚ [Angular](https://www.nativescript.org/nativescript-is-how-you-build-native-mobile-apps-with-angular) å’Œ [Vue.js](https://www.nativescript.org/vue) )æ¥åˆ›å»ºç§»åŠ¨åº”ç”¨ã€‚å®ƒåœ¨è®¸å¤šæ–¹é¢ä¸ Ionic ç›¸ä¼¼ï¼Œä½†æ²¡æœ‰ä¸ºæ‚¨çš„ UI å±‚ä½¿ç”¨ webviewsã€‚

[![nativescript web skills](../Images/3d66393928dd68d6bd24b2ebac673772.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--80tY74K5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/nativescript.png)

> **æç¤º:**å¼€å§‹ä½¿ç”¨ NativeScript çš„æœ€ä½³æ–¹å¼æ˜¯æµè§ˆ [NativeScript æ¸¸ä¹åœº](https://play.nativescript.org/?template=play-ng&tutorial=getting-started-ng)ä¸Šçš„å¿«é€Ÿæ•™ç¨‹ã€‚ä½ è¿˜å¯ä»¥åœ¨[å­¦ä¹  NativeScript Layouts](https://www.nslayouts.com/) äº†è§£ UI å¸ƒå±€ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼

## æ„å»º NativeScript åº”ç”¨

è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªæœ‰ä¸¤ä¸ªé¡µé¢/è§†å›¾çš„ç®€å•åº”ç”¨ç¨‹åºã€‚ä¸€ä¸ªè§†å›¾åˆ—å‡ºäººç‰©ï¼Œå¦ä¸€ä¸ªè§†å›¾æ˜¾ç¤ºä¸ªäººç…§ç‰‡ä»¥åŠä» Azure è¿”å›çš„é¢éƒ¨å±æ€§ã€‚

> **æ³¨:**è¿™æ¬¾åº”ç”¨çš„çµæ„Ÿæ¥è‡ªäº [Ignacio Fuentes](https://twitter.com/ignacioafuentes) åœ¨ JavaScript NYC meetup ä¸Šä¸¾åŠçš„ meetup ä¼šè®®ã€‚[ç‚¹å‡»æ­¤å¤„](https://livestream.com/internetsociety/js-nyc-feb18?t=1519343631)æŸ¥çœ‹å®Œæ•´è¯¾ç¨‹ã€‚

ç”±äº [Meetup API](https://www.meetup.com/meetup_api/) å¦‚æ­¤æ…·æ…¨åœ°è¿”å›ç…§ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨å®ƒä½œä¸ºæˆ‘ä»¬ç¬¬ä¸€ä¸ªè§†å›¾çš„æ•°æ®æºã€‚

```
https://api.meetup.com/JS-NYC/events/246938509/rsvps?response=yes&only=member 
```

Enter fullscreen mode Exit fullscreen mode

...ä¸ºæ‰€é€‰çš„ [JavaScript NYC](https://www.meetup.com/JS-NYC/) meetup è¿”å›ä»¥ä¸‹ JSON:

```
{
    "member": {
        "id": 207291595,
        "name": "Adam Chen W.",
        "photo": {
            "id": 271369722,
            "highres_link": "https://secure.meetupstatic.com/photos/member/c/2/3/a/highres_271369722.jpeg",
            "photo_link": "https://secure.meetupstatic.com/photos/member/c/2/3/a/member_271369722.jpeg",
            "thumb_link": "https://secure.meetupstatic.com/photos/member/c/2/3/a/thumb_271369722.jpeg",
            "type": "member",
            "base_url": "https://secure.meetupstatic.com"
        },
        "event_context": {
            "host": false
        }
    }
}, 
```

Enter fullscreen mode Exit fullscreen mode

åœ¨ NativeScript ä¸­ä½¿ç”¨å®ƒéå¸¸å®¹æ˜“ï¼Œåªéœ€ä¸€ä¸ªç®€å•çš„`http`è°ƒç”¨:

```
function fetchAllPeople() {
  http
    .getJSON(
      'https://api.meetup.com/JS-NYC/events/246938509/rsvps?response=yes&only=member'
    )
    .then(
      function(u: any) {
        vm.set('items', u);
      },
      function(e) {
        console.log(e);
      }
    );
} 
```

Enter fullscreen mode Exit fullscreen mode

### äººå‘˜åˆ—è¡¨

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ª [NativeScript ListView](https://docs.nativescript.org/ui/list-view) (è¿™æ˜¯å¯¹åŸç”Ÿ iOS å’Œ Android listview æ§ä»¶çš„è·¨å¹³å°æŠ½è±¡)ä¸­æ˜¾ç¤ºè¿™äº›æ•°æ®:

```
 <ListView items="{{ items }}" itemTap="fetchPerson" class="list-group">
        <ListView.itemTemplate>
            <GridLayout class="list-group-item" rows="auto" columns="auto, *">
                <Image row="0" col="0" src="{{ member.photo.thumb_link }}" class="thumb img-rounded" />
                <StackLayout row="0" col="1" >
                    <Label text="{{ member.name }}" class="list-group-item-heading" />
                    <Label text="{{ member.photo.type }}" class="list-group-item-text" />
                </StackLayout>
            </GridLayout>
        </ListView.itemTemplate>
    </ListView> 
```

Enter fullscreen mode Exit fullscreen mode

è®©æˆ‘ä»¬åŠ å…¥ä¸€äº› CSS æ¥æ¸…ç†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„å¤–è§‚:

```
.btn {
    font-size: 22;
    background-color: royalblue;
}

.action-bar {
    background-color: royalblue;
    color: white;
}

.lbl-bold {
    font-size: 20;
    font-weight: bold;
}

.lbl {
    font-size: 20;
} 
```

Enter fullscreen mode Exit fullscreen mode

> æ˜¯çš„ï¼Œä½ åœ¨ç½‘ç»œä¸Šä½¿ç”¨çš„ CSS åŒæ ·è¢«ç”¨æ¥è®¾è®¡ä½ çš„æœ¬åœ°ç§»åŠ¨åº”ç”¨ï¼Œè·¨å¹³å°ï¼äº†è§£æ›´å¤šå…³äºä½¿ç”¨ CSS å’Œ NativeScript çš„ä¿¡æ¯ã€‚

è¿™åº”è¯¥ä¼šåœ¨ iOS å’Œ Android ä¸Šç¥å¥‡åœ°è¿”å›ä»¥ä¸‹å±å¹•:

[![list of meetup folks](../Images/d6a4d08c88926b43ad39c6650ded161c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--EIXnEZ3V--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/meetup-list.png)

> ç°åœ¨æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ—¶æœºæ¥æ³¨æ„è¿™ä¸ªåº”ç”¨ç¨‹åºçš„å®Œæ•´æºä»£ç (ç”¨ TypeScript æ„å»º)å¯ä»¥åœ¨[è¿™ä¸ª GitHub åº“](https://github.com/rdlauer/meetupfaces)ä¸­è·å¾—ã€‚å¦‚æœä½ æ­£åœ¨å¯»æ‰¾ Angular çš„ç±»ä¼¼ç‰ˆæœ¬ï¼Œ[çœ‹çœ‹è¿™é‡Œ](https://github.com/ignaciofuentes/meetupfaces)ã€‚

### å¸¦æœ‰é¢éƒ¨å±æ€§çš„ç…§ç‰‡ç»†èŠ‚

å½“æˆ‘ç‚¹å‡»`ListView`ä¸­çš„ä¸€ä¸ªäººæ—¶ï¼Œæˆ‘å¯ä»¥å°†å›¾åƒçš„ URI å‘é€åˆ° Azure å’Œ Face API:

```
http.request({
  url:
    'https://westcentralus.api.cognitive.microsoft.com/face/v1.0/detect?returnFaceId=true&returnFaceLandmarks=false&returnFaceAttributes=age,gender,emotion&subscription-key=YOURAPIKEY',
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  content: JSON.stringify({
    url: vm.get('photo') // a reference to your photo
  })
}) 
```

Enter fullscreen mode Exit fullscreen mode

...æ­¤æ—¶ï¼ŒAzure å¥‡è¿¹å‘ç”Ÿäº†ï¼Œå¹¶è¿”å›ä»¥ä¸‹å†…å®¹:

```
{
  "faceId": "1cd4bd2e-c88c-491d-b6f0-7f20d75ae579",
  "faceRectangle": {
    "top": 87,
    "left": 61,
    "width": 107,
    "height": 107
  },
  "faceAttributes": {
    "gender": "male",
    "age": 21,
    "emotion": {
      "anger": 0,
      "contempt": 0.001,
      "disgust": 0,
      "fear": 0,
      "happiness": 0.762,
      "neutral": 0.237,
      "sadness": 0,
      "surprise": 0
    }
  }
} 
```

Enter fullscreen mode Exit fullscreen mode

ä½ ä¼šçœ‹åˆ°æˆ‘ä»¬å¯ä»¥æ£€ç´¢ Azure åœ¨`age`ã€`gender`å’Œ`mood`(æƒ…ç»ªæ˜¯æ‰€æœ‰å¯èƒ½æƒ…ç»ªä¸­**æœ€é«˜çš„**æ•°å€¼)çš„æœ€ä½³çŒœæµ‹ã€‚

å‡è®¾æˆ‘ä»¬æ²¡æœ‰é”™è¿‡ä»»ä½•ä¸œè¥¿(å˜¿ï¼Œæˆ‘æœ‰æ—¶å€™æ˜¯ä¸ªç³Ÿç³•çš„ç¨‹åºå‘˜ï¼Œä½ æ°¸è¿œä¸çŸ¥é“ï¼)æˆ‘ä»¬åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å±å¹•:

[![meetup detail page](../Images/6f041ad3cd94c6677d7e63526e210011.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Bg1wDI2I--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/rdlauer/articles/master/nativescript/azure-face/meetup-detail.png)

æˆ‘ä»¬å®Œæˆäº†ï¼ğŸ˜€

## ç»“è®º

è™½ç„¶è¿™æ˜¯ä¸€ä¸ªç›¸å½“ç®€å•çš„ä¾‹å­ï¼Œä½†å®ƒç¡®å®è®©æ‚¨å¯¹è®¤çŸ¥æœåŠ¡çš„å¨åŠ›æœ‰äº†ä¸€ä¸ªç®€è¦çš„äº†è§£ã€‚æ— è®ºä½ ä½¿ç”¨çš„æ˜¯ Azureã€AWS è¿˜æ˜¯ [Progress](https://www.progress.com/cognitive-business-apps) ï¼Œè¯·æ”¾å¿ƒï¼Œè®¤çŸ¥ä¼˜å…ˆæ˜¯è·¨æ‰€æœ‰è®¾å¤‡å’Œä½“éªŒå‚ä¸åº”ç”¨å¼€å‘çš„æœªæ¥ã€‚