# “您可能有新消息”——解释！

> 原文：<https://dev.to/aniketsmk/you-may-have-new-messages--explained-a8k>

<figure>[![](../Images/74eda7daf2c2429ecff2a59772a66028.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--rWJ2PzL9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2Ap9mu7QGSVpHHgsSOGNAyQA.jpeg) 

<figcaption>经典通知解释。</figcaption>

</figure>

TLDR？通知您有新消息是通过比实际下载消息更可靠、更即时的网络渠道完成的。

请继续阅读这意味着什么的更多细节。

我曾经为一份工作做过两个不同的聊天系统。

一种是自动化的，即你向服务器请求一些东西，然后得到一个脚本化的聊天。

一种是人类，一个人发送信息，另一个人可以看到并回复。

我用 [Firebase](http://firebase.google.com/) 实时数据库构建了人类。它也可以通过[领域](https://realm.io/)来完成，这是另一个为你管理同步不同数据源的服务。

虽然这可以由我们自己开发，但作为一家初创公司，你不会想浪费时间去开发那些不是核心知识产权的东西。

你可以从两件简单的事情开始，实际上是给人们发消息，当他们收到新消息时通知他们。

使用 Firebase，我们可以将这些消息添加到数据库中，编写规则以确保只有正确的用户才能访问它们，并简单地设置[保持同步](https://firebase.google.com/docs/database/android/offline-capabilities)打开。

保持同步会为我们做两件大事。

1.  信息现在可以脱机使用，你甚至可以尝试在脱机时发送它们，它们会在你联机时被发送。
2.  当你收到新邮件时，它们会被存储起来，如果你离线了，你还可以访问它们。

同步分布式数据库有点像科幻小说中的时间旅行情节。他们到处都有很多奇怪的案例，如果你以前从未见过，你需要一段时间来适应它。

现在你可能会想。为什么还要麻烦单独的移动应用程序通知呢？当其他人发送数据时，数据会被同步，对吗？我们不应该只需要 Firebase 实时数据库吗？

如果移动操作系统开发者做了一件非常糟糕的事情，这没什么，但他们没有。也就是说，如果允许应用程序一直在后台运行。

你的应用将被关闭。无论是为了内存压力，还是为了节省电池，或者只是为了避免在不经常使用时进行无意义的检查。

可能会有一条新消息，人们会收到，如果这个应用程序曾经启动过的话。

这可以很简单的解决，通过发送推送通知！

如果标记为高优先级，推送通知可以“唤醒”正在打盹的设备。Android 可能会以这样的方式对它们进行优先排序，即推送通知可以通过*发送，但此时不允许其他网络连接。*这意味着如果你尝试一个后续的网络调用，它可能会彻底失败。

这就是两者的合作方式。你可能有足够的网络来获得推送通知，提醒你可能有一条消息，甚至可能是一个标题。但是你支持聊天的实际数据库还没有更新，因为它必须通过不同的网络渠道运行。

因此“您可能有新消息”。

下次你看到 Whatsapp 给你看那个通知，你就知道幕后发生了什么:)

网络对于移动设备来说既复杂又有趣，而且非常独特。当我意识到我在自己的聊天系统中重现了让 Whatsapp 告诉你这一点的情景时，我高兴得直跳。

如有任何问题，请在下面评论或在 [@AniketSMK](https://twitter.com/AniketSMK/) 的 [Twitter](https://twitter.com/AniketSMK/) 上给我发消息！