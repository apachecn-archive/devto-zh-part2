# React ä¸­è®¾ç½®çŠ¶æ€çš„å¿…è¦æŒ‡å—

> åŸæ–‡:[https://dev . to/bnevilleoneill/an-impressive-guide-to-set state-in-react-3j6a](https://dev.to/bnevilleoneill/an-imperative-guide-to-setstate-in-react-3j6a)

[![](../Images/545c17e207af529f0b4f59c6f327777c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qTokiiBF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AJLfnJyOTlxwknAB9oQ4FFg.png)

ä¸é“å…·ä¸€æ ·ï¼ŒReact ä¸­çš„çŠ¶æ€æ˜¯ç”¨äºå­˜å‚¨æ•°æ®å¹¶å½±å“ç»„ä»¶å‘ˆç°æˆ–è¡Œä¸ºæ–¹å¼çš„å¯¹è±¡ã€‚ä¸ props ä¸åŒï¼ŒçŠ¶æ€å®Œå…¨åœ¨ç»„ä»¶ä¸­ç®¡ç†ï¼Œå¹¶ä¸”å¯ä»¥éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ã€‚

React ç»„ä»¶çš„çŠ¶æ€å˜åŒ–å¯ä»¥æ˜¯æ¥è‡ªç”¨æˆ·åŠ¨ä½œã€ç½‘ç»œæ´»åŠ¨ã€API è¯·æ±‚æˆ–ç‰¹å®šåº”ç”¨è¡Œä¸ºçš„è§¦å‘çš„ç»“æœã€‚

æœ‰çŠ¶æ€çš„ç»„ä»¶è¢«ç§°ä¸º**æœ‰çŠ¶æ€ç»„ä»¶**ï¼Œè€Œæ²¡æœ‰çŠ¶æ€çš„ç»„ä»¶è¢«ç§°ä¸º**æ— çŠ¶æ€ç»„ä»¶**ã€‚

ä¸€ä¸ªç»„ä»¶å¯ä»¥æœ‰ä¸€ä¸ªåˆå§‹çŠ¶æ€é›†ï¼Œè®¿é—®å®ƒå¹¶æ›´æ–°å®ƒ:

```
import React, { Component } from 'react';

class Food extends Component {
  constructor(props) {
    super(props)

    this.state = {
      fruits: ['apple', 'orange'],
      count: 0
    }
  }
} 
```

åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†ç»„ä»¶çš„åˆå§‹çŠ¶æ€ã€‚è¿™æ˜¯é€šè¿‡æ„é€ å‡½æ•°æ–¹æ³•å®Œæˆçš„ã€‚

å¦‚å‰æ‰€è¿°ï¼ŒçŠ¶æ€æ˜¯æ™®é€šçš„ Javascript å¯¹è±¡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ ***this.state*** åº”è¯¥ç­‰äºä¸€ä¸ªå¯¹è±¡:

```
this.state = {
  fruits: ['apple', 'orange'],
  count: 0
} 
```

[![](../Images/2063f22e152ef36aa267c13ae9842601.png)T2ã€‘](https://logrocket.com/signup/)

#### è®¿é—®ç»„ä»¶çŠ¶æ€

**ç»„ä»¶çŠ¶æ€**å¯ä»¥åƒå…¶ä»–å¯¹è±¡ä¸€æ ·ä½¿ç”¨ this.state.property_name è¿›è¡Œè®¿é—®ã€‚

è¦è®¿é—®ä¸Šé¢ç¤ºä¾‹ä¸­çš„è®¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ this.state.count :
æ¥å®Œæˆ

```
render() {
  return (
    <div className = "container">
      <h2> Hello!!!</h2>
      <p> I have {this.state.count} fruit(s)</p>
    </div>
  );
} 
```

#### æ›´æ–°ç»„ä»¶çŠ¶æ€

å°½ç®¡ä»ä»£ç ä¸­çš„ä»»ä½•åœ°æ–¹å†™å…¥ this.state åœ¨æŠ€æœ¯ä¸Šæ˜¯å¯èƒ½çš„ï¼Œä½†å®ƒä¸ä¼šæç¤ºé‡æ–°å‘ˆç°ï¼Œå¹¶ä¸”å½“æ‚¨è¯•å›¾é€šè¿‡ this.state è®¿é—®å€¼æ—¶ï¼Œè¿™å°†å¯¼è‡´ä¸ç¨³å®šå’Œä¸æ­£ç¡®çš„çŠ¶æ€å€¼ã€‚

æ‚¨åº”è¯¥ç›´æ¥å†™å…¥ this.state çš„å”¯ä¸€ä½ç½®æ˜¯ç»„ä»¶çš„æ„é€ å‡½æ•°æ–¹æ³•ã€‚

åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ thesetState()æ–¹æ³•ï¼Œè¿™æ ·åšå°†æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æœ€ç»ˆå°†åˆå¹¶åˆ°ç»„ä»¶çš„ç°æœ‰çŠ¶æ€ä¸­ã€‚

ä¾‹å¦‚ï¼Œè¿™ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶:

```
// Wrong
this.state.name = 'Obaseki Nosa'; 
```

è¯·æ”¹ç”¨ setState()ã€‚

#### å¼•å…¥ setState()

setState()è°ƒåº¦å¯¹ç»„ä»¶çŠ¶æ€å¯¹è±¡çš„æ›´æ”¹ï¼Œå¹¶å‘Šè¯‰ React è¯¥ç»„ä»¶åŠå…¶å­ç»„ä»¶éœ€è¦ç”¨æ›´æ–°åçš„çŠ¶æ€é‡æ–°å‘ˆç°:

```
// Correct
this.setState({name: 'Obaseki Nosa'}); 
```

React æœ‰æ„â€œç­‰å¾…â€ç›´åˆ°æ‰€æœ‰ç»„ä»¶åœ¨å®ƒä»¬çš„äº‹ä»¶å¤„ç†ç¨‹åºä¸­è°ƒç”¨ setState()ï¼Œç„¶åæ‰å¼€å§‹é‡æ–°å‘ˆç°ã€‚è¿™é€šè¿‡é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“æ¥æé«˜æ€§èƒ½ã€‚

è¦çŸ¥é“ setState()å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ›´æ–°ç»„ä»¶çš„è¯·æ±‚ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç«‹å³çš„å‘½ä»¤ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯•å›¾åœ¨ setState()ä¹‹åç«‹å³ä½¿ç”¨ this.state ä¼šå¯¼è‡´ä¸æ­£ç¡®çš„è¡Œä¸º:

```
// Trying to change the value of this.state.count from previous example
this.setState({
  count: 4
});

console.log(this.state.count); // 0 
```

this.state.count è¿”å› 0ï¼Œå› ä¸ºå³ä½¿å·²ç»ç”¨ setState()è®¾ç½®äº†è¯¥å€¼ï¼Œå®ƒä¹Ÿåªæ˜¯åœ¨å°è¯•ä½¿ç”¨ this.state çš„å€¼ä¹‹å‰è¢«è°ƒåº¦å’Œé‡æ–°å‘ˆç°ã€‚

setState()å°†å§‹ç»ˆå¯¼è‡´é‡æ–°å‘ˆç°ï¼Œé™¤é shouldComponentUpdate()è¿”å› falseã€‚

#### åœ¨ React ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ä½¿ç”¨ setState()

åœ¨ React çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­è°ƒç”¨ setState()éœ€è¦ä¸€å®šç¨‹åº¦çš„è°¨æ…ã€‚æœ‰ä¸€äº›æ–¹æ³•è°ƒç”¨ setState()ä¼šå¯¼è‡´ä¸å¸Œæœ›çš„ç»“æœï¼Œè¿˜æœ‰ä¸€äº›æ–¹æ³•åº”è¯¥å®Œå…¨é¿å…ã€‚

#### æ¸²æŸ“()

åœ¨è¿™é‡Œè°ƒç”¨ setState()ä½¿æ‚¨çš„ç»„ä»¶æˆä¸ºäº§ç”Ÿæ— é™å¾ªç¯çš„ç«äº‰è€…ã€‚

render()å‡½æ•°åº”è¯¥æ˜¯çº¯çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸ä¿®æ”¹ç»„ä»¶çŠ¶æ€ï¼Œæ¯æ¬¡è°ƒç”¨å®ƒéƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œå¹¶ä¸”å®ƒä¸ç›´æ¥ä¸æµè§ˆå™¨äº¤äº’ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·é¿å…åœ¨è¿™é‡Œä½¿ç”¨ setState()ã€‚

#### æ„é€ å‡½æ•°()

ä¸åº”åœ¨æ„é€ å‡½æ•°()ä¸­è°ƒç”¨ setState()ã€‚ç›¸åï¼Œå¦‚æœæ‚¨çš„ç»„ä»¶éœ€è¦ä½¿ç”¨æœ¬åœ°çŠ¶æ€ï¼Œè¯·åœ¨æ„é€ å‡½æ•°ä¸­å°†åˆå§‹çŠ¶æ€ç›´æ¥åˆ†é…ç»™ this.stateã€‚

#### componentidmount()

ç»„ä»¶æŒ‚è½½åä¼šç«‹å³è°ƒç”¨ componentDidMount()ã€‚æ‚¨å¯ä»¥åœ¨ componentDidMount()ä¸­ç«‹å³è°ƒç”¨ setState()ã€‚å®ƒå°†è§¦å‘ä¸€æ¬¡é¢å¤–çš„æ¸²æŸ“ï¼Œä½†è¿™å°†å‘ç”Ÿåœ¨æµè§ˆå™¨æ›´æ–°å±å¹•ä¹‹å‰ï¼Œå› æ­¤ render()å°†è¢«è°ƒç”¨ä¸¤æ¬¡ã€‚

#### componentDidUpdate()

componentDidUpdate()åœ¨æ›´æ–°å‘ç”Ÿåç«‹å³è¢«è°ƒç”¨ã€‚ä½ **å¯ä»¥åœ¨è¿™é‡Œç«‹å³è°ƒç”¨****setState()**ï¼Œä½†æ˜¯è¦çŸ¥é“**å¿…é¡»ç”¨æ¡ä»¶**åŒ…è£…ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ï¼Œå¦åˆ™ä½ ä¼šå¯¼è‡´ä¸€ä¸ªæ— é™å¾ªç¯:

```
componentDidUpdate(prevProps, prevState) {
  let newName = 'Obaseki Nosa'
  // Don't forget to compare states
  if (prevState && prevState.name !== newName) {
    this.setState({name: newName});
  }
} 
```

#### componentWillUnmount()

ä½ **ä¸åº”è¯¥åœ¨è¿™é‡Œè°ƒç”¨** **setState()** ï¼Œå› ä¸ºç»„ä»¶æ°¸è¿œä¸ä¼šè¢«é‡æ–°æ¸²æŸ“ã€‚ä¸€æ—¦ç»„ä»¶å®ä¾‹è¢«å¸è½½ï¼Œå®ƒå°†æ°¸è¿œä¸ä¼šè¢«å†æ¬¡è£…è½½ã€‚

#### ç»“è®º

1.  setState()æ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¯•å›¾ç«‹å³è®¿é—®è¯¥å€¼ï¼Œå°±ä¸èƒ½ä¿è¯çŠ¶æ€å·²ç»è¢«æ›´æ–°
2.  ä½ åªèƒ½ç”¨ setState æ”¹å˜çŠ¶æ€ï¼Œè€Œ **React å°†å¯¹è¿™ä¸ªæ”¹å˜åšå‡ºååº”**ğŸ˜‰
3.  é¿å…å°†çŠ¶æ€å¯¹è±¡ä¸å…¶ä»–å®ä¾‹å±æ€§æ··æ·†ã€‚å¾ˆå®¹æ˜“å‡è®¾æ‚¨å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°è¯•åƒä½¿ç”¨ state ä¸€æ ·ä½¿ç”¨å®ƒï¼Œä½†æ˜¯ state å®ä¾‹æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å®ä¾‹ï¼Œå› ä¸º React å°†ç®¡ç†å®ƒ:

```
...
//constructor function above

this.state = {
  fruits: ['apple', 'orange'],
  count: 0
}

this.user = {
  name: 'Obaseki Nosa'
}

... 
```

è™½ç„¶ this.state å’Œ this.user éƒ½æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„å¯¹è±¡ï¼Œä½†æ˜¯åªæœ‰ this.state ä¸ setState()ååº”ï¼Œå¹¶ç”± React ç®¡ç†ã€‚

å¹²æ¯ï¼ï¼ï¼

* * *

### Plug: [LogRocket](https://logrocket.com/signup/) ï¼Œä¸€æ¬¾é€‚ç”¨äºç½‘ç»œåº”ç”¨çš„ DVR

[![](../Images/d56be9e9e36d8fa98c6959f7097b7787.png)](https://logrocket.com/signup/)

<figcaption>[https://logrocket.com/signup/](https://logrocket.com/signup/)</figcaption>

LogRocket æ˜¯ä¸€ä¸ªå‰ç«¯æ—¥å¿—å·¥å…·ï¼Œå¯ä»¥è®©ä½ å›æ”¾é—®é¢˜ï¼Œå°±åƒå®ƒä»¬å‘ç”Ÿåœ¨ä½ è‡ªå·±çš„æµè§ˆå™¨ä¸­ä¸€æ ·ã€‚LogRocket ä¸éœ€è¦çŒœæµ‹é”™è¯¯å‘ç”Ÿçš„åŸå› ï¼Œä¹Ÿä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®æˆªå›¾å’Œæ—¥å¿—è½¬å‚¨ï¼Œè€Œæ˜¯è®©æ‚¨é‡æ”¾ä¼šè¯ä»¥å¿«é€Ÿäº†è§£å“ªé‡Œå‡ºé”™äº†ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºå®Œç¾é…åˆï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œå¹¶ä¸”æœ‰æ’ä»¶å¯ä»¥è®°å½•æ¥è‡ª Reduxã€Vuex å’Œ@ngrx/store çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚

é™¤äº†è®°å½• Redux æ“ä½œå’ŒçŠ¶æ€ï¼ŒLogRocket è¿˜è®°å½•æ§åˆ¶å°æ—¥å¿—ã€JavaScript é”™è¯¯ã€å †æ ˆè·Ÿè¸ªã€å¸¦æœ‰å¤´+æ­£æ–‡çš„ç½‘ç»œè¯·æ±‚/å“åº”ã€æµè§ˆå™¨å…ƒæ•°æ®å’Œè‡ªå®šä¹‰æ—¥å¿—ã€‚å®ƒè¿˜ä½¿ç”¨ DOM æ¥è®°å½•é¡µé¢ä¸Šçš„ HTML å’Œ CSSï¼Œç”šè‡³ä¸ºæœ€å¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºé‡æ–°åˆ›å»ºåƒç´ çº§å®Œç¾è§†é¢‘ã€‚

å…è´¹è¯•ç”¨ã€‚

* * *

React ä¸­ setState å‘½ä»¤å¼æŒ‡å—çš„å¸–å­[æœ€å…ˆå‡ºç°åœ¨](https://blog.logrocket.com/an-imperative-guide-to-setstate-in-react-b837ceaf8304/)[æ—¥å¿—åšå®¢](https://blog.logrocket.com)ä¸Šã€‚