# 使用和不使用 Docker 设置 Python 开发环境

> 原文:[https://dev . to/nickjj/setting-up-a-python-development-environment-with-and-without-docker-213 c](https://dev.to/nickjj/setting-up-a-python-development-environment-with-and-without-docker-213c)

**本文最初发布于 2018 年 2 月 20 日:[https://nickjanetakis . com/blog/setting-up-a-python-development-environment-with-and-with-with-with-with-with-with-not-docker](https://nickjanetakis.com/blog/setting-up-a-python-development-environment-with-and-without-docker)**

* * *

你可能想知道“设置你的电脑”到底是什么意思。对我来说，这意味着制定一个计划来解决以下问题:

1.  我应该使用什么代码编辑器？
2.  我如何安装 Python？
3.  如何安装我的应用程序的依赖项？
4.  如何安装所需的外部服务？
5.  如何运行我的应用程序？

从技术上讲，这些问题对于任何语言/框架来说都是一样的，但是在本文中，让我们继续使用 Python。特别是使用 Python 的 web 开发。

## [](#what-code-editor-should-i-use)应该用什么代码编辑器？

这个问题很简单，因为不管你是否使用 Docker，答案都是一样的。只需安装您喜欢的任何代码编辑器。

就我个人而言，我是使用 VSCode 的粉丝，但是在过去，我已经使用 Sublime Text 很多年了。

## [](#getting-your-python-app-running-without-docker)让您的 Python 应用无需 Docker 即可运行

**你需要做的第一件事**是在你选择的操作系统上安装 Python。你用的是 Windows，MacOS 还是 Linux？如果是 Linux，你用的是什么发行版？

我不会告诉你如何为每一个操作系统选择这样做，因为我对自我诱导的痛苦有很低的容忍度，但请谷歌一下“如何在 Windows 10 上安装 Python”这样的问题，你会找到各种各样的答案。

顺便说一下，您还应该考虑是否要使用 Python 2.7 或更现代的版本，如 Python 3.6。两者各有利弊。你可能最终想要安装这两个版本，因为它们可以共存。

**接下来，你需要处理你的应用的依赖关系**。这里有几种不同类型的依赖关系。有您的应用程序需要运行的安装包(如果您正在构建一个 web 应用程序，比如 Flask，或者如果您更喜欢 Django)，但是也有外部服务，比如您的数据库(我们将很快介绍)。

让我们先关注一下你的应用包。从技术上来说，你可以只安装[pip](https://pip.pypa.io/en/stable/installing/)(Python 的包管理器)，然后直接在你的主操作系统上安装所有东西，但是这是一条危险的道路。

如果你直接把你的包安装到你系统的 Python 版本上，那么你就失去了你在一个以上的项目上工作的权利，这个项目需要同一个包的两个不同版本。

这在 web 开发中经常出现。你今天可能正在做一个项目，但是 6 个月后你开始了一个新项目，你想使用 6 个月前开始使用的软件包的全新版本。

嗯，你不能只是在你的新应用程序中使用新版本而不关心，因为如果你升级它，它可能会由于向后兼容问题而中断你 6 个月前的旧项目。

这确实是一个大问题，但幸运的是聪明人已经解决了这个问题。

可以安装一个叫 [Virtualenv](https://virtualenv.pypa.io/en/stable/) 的工具。Virtualenv 是一个 Python 工具，可以让您创建这些小的虚拟环境(顺便说一下，不要与虚拟机混淆)。

现在，当你开始一个新项目时，你也为它创建了一个虚拟环境。当你安装你的应用程序所需的所有软件包时，它们都存储在自己单独的 Virtualenv 中。

你甚至可以告诉它使用特定版本的 Python。真是太贴心了。

这个问题现在完全解决了。你所有的项目都有自己的包版本，你系统的 Python 版本没有被任何东西污染。它可以简单地作为你的虚拟包装应用的运行时。

**接下来，我们安装外部服务**。现实世界中的 web 应用程序通常至少包含一个数据库，并且很容易需要更多的服务，如 Redis 等..

在开发中使用 SQLite 是一个非常糟糕的想法，因为当您最终在服务器上“真正”运行您的应用程序时，您很可能会使用 Postgres 或 MySQL 而不是 SQLite。此外，您的一些代码可能依赖于使用 SQLite 中根本不存在的特性。你别无选择。

所以你能做的最好的事情就是在你的电脑上安装 Postgres。这将会有很大的不同，取决于你使用什么样的操作系统。您还需要确保以后在您的服务器上“真正”运行的版本是相同的。

从技术上讲，它永远不会相同，因为 MacOS 或 Windows 版本的 Postgres 不是运行在 Linux 服务器上的相同二进制文件，但它可能“足够接近”。

对于 Redis，您可能也必须做同样的事情，因为大多数真实世界的 web 应用程序都有一个后台工作器(比如 Celery ), Redis 非常适合用作代理和缓存，但是现在我们在一个枝节问题上陷入了困境，所以让我们回到服务。

顺便说一下，Redis 甚至没有正式在 Windows 上运行。你将不得不满足于运行来自微软的自定义端口，或者，你将需要钻研虚拟机的奇妙世界，并可能使用像[vagger](https://www.vagrantup.com/)这样的工具。

*警告:*如果你是软件开发新手，你将进入一个充满痛苦和困惑的世界。当你沉浸在如何设置所有这些东西的时候，写你的应用程序也会延迟很长时间。预计许多不眠之夜。

**你成功了，现在该运行你的应用程序了**。如果你做到了这一步，你肯定对 web 开发是认真的。糟糕的是，在你开始写申请之前，门槛太高了。

我的意思是，我们还没有到那一步，因为现在我们必须弄清楚如何运行我们的应用程序。

我们有几个选择，但有一点需要注意。为了让您的应用程序工作，您需要首先确保 Postgres，也许 Redis 正在运行。

您可能会一直运行它们，但这意味着即使您没有开发，它们也会消耗您系统的内存和 CPU 周期。当然，您可以在开发会话之间手动启动和停止它们，但这并不有趣。

哦，对了，还有同时安装多个版本的 Postgres 和 Redis 的问题，因为当新版本出来时，你肯定会想使用新版本，但由于兼容性相关的变化，你的旧应用程序可能需要旧版本。

一旦你想好如何运行 Postgres 和 Redis，你还需要担心如何启动你的 Python 应用程序。我是 Flask for web development 的忠实粉丝，这是一个用于 Python 的微型 web 框架。我非常喜欢它，以至于我在它上面创建了一整个课程。

无论如何，你需要启动你的 web 应用服务器和你的后台工作人员，这意味着你将会在多个终端之间周旋。随着时间的推移，随着你在应用中引入更多的服务，情况也会变得更糟。

但是，和 Virtualenv 一样，这是一个已经解决的问题。有一个非常好的工具叫做 [Honcho](https://github.com/nickstenning/honcho) 。它让你创建一个叫做`Procfile`的东西，然后定义当你运行它时你想要什么服务。它通过一个终端窗口运行一切。

你可以把你的网络服务器，后台工作人员，甚至 Postres / Redis 添加到这个文件中，这样就可以了。现在，如果你想启动一切，你只需运行`honcho start`就万事大吉了。它甚至对所有服务的终端输出进行颜色编码。

#### [](#to-recap-before-you-could-even-start-writing-your-app-you-had-to)概括一下，在你开始编写应用程序之前，你必须:

寻找如何安装 Python，安装 pip，安装 virtualenv，现在要经常使用 virtualenv，否则你将进入依赖地狱。

然后，您必须学习如何安装和配置 Postgres、Redis 和您的应用程序可能使用的任何其他服务。最后，在那之后，你必须弄清楚如何以一种愉快的方式与 Honcho 一起管理一切。

这是一条漫长的道路，如果你在前进的过程中发现了一些东西，可能需要几周或几个月才能到达。

不幸的是，如果您计划在生产中的真实服务器上运行您的应用程序，您将不得不从头开始，并学习如何在 Linux 上做上述所有事情，但是，嘿，让我们现在只关注开发问题！

## [](#getting-your-python-app-running-with-docker)使用 Docker 运行您的 Python 应用

如果你希望我说“但是有了 Docker，它是如此简单，你所要做的就是运行 1 个命令，你就完成了”，那么你就错了！

然而，这是真的，一旦你设置好并理解了 Docker，它真的会很容易，你可以用一个命令设置任何真实世界的 Python web 应用程序，并且它在 Windows、MacOS 和 Linux 上也一样工作。

您也不需要担心项目隔离，因为 Docker 会为您处理这个问题。使用 Python 2.x 或 3.x 运行应用程序，并且每个应用程序都有自己的依赖项，这没有问题。Virtualenv 都不会用。

安装外部服务也很容易。你不会把它们直接安装在你的主操作系统上。它们将在您的计算机上本地运行，但将通过 Docker 运行。例如，启动和运行 Postgres 或 Redis 需要运行 1 个命令，不需要高级配置。

最后，你不需要像 Honcho 这样的工具，当你不开发应用程序时，你也不需要担心外部服务的运行，因为 Docker 有自己的工具，只需一个命令就可以在几秒钟内启动和关闭应用程序的所有服务。

你甚至可以运行多个版本的 Postgres 和 Redis 而不会发生冲突。所有这些听起来都很棒，但这确实是以一点点复杂性为代价的。

你首先需要安装 Docker 。这是最简单的部分，只需要大约 7 分钟。

复杂的是弄清楚 Docker 是如何工作的。一旦你掌握了它，它就变得非常简单，但是如果你是 Python 开发或一般的 web 开发的新手，要达到每件事情都点击一下的地步，可能会有很多东西需要理解。

如果你想看的话，我有一整篇关于用 Docker 运行真实世界 Flask 应用程序的教程。它没有深入到每件事情的血淋淋的细节，但是你将在大约 15 分钟内在 Docker 中运行一个真实世界的 Flask 应用程序。

如果你想知道 Docker 如何工作的血淋淋的细节，并想知道如何在你自己的项目中使用它，那么我推荐你查看我的 Docker 课程。这是 5 个小时的优质视频，以及 30 多个指导实验和挑战，让您开始使用 Docker for Python 应用程序(或任何语言)。

我知道，你可能会想“天哪，这整件事都是为了买一个码头课程”，但事实并非如此。你完全可以不用 Docker 使用我上面提到的工具来完成它，或者你可以通过阅读我链接的教程，然后在网上搜索几十篇文章来填补空白，从而自己学习 Docker。

我的课程的价值在于，我已经为你做了所有的研究，并且从 2014 年开始使用 Docker。我已经在开发和生产部门运行它很多年了。一路走来，我想出了一堆最佳实践，都在课程中。

另外，我提供终身更新和支持。如果你有任何问题，我只是一封电子邮件。自 2015 年以来，我已经回答了超过 20，000+人的 3，500 个问题。支持是我非常重视的事情！跳上船，加入我们的[深入码头](https://diveintodocker.com/?utm_source=devto&utm_medium=website&utm_campaign=python-env-with-and-without-docker)课程。