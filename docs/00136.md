# 无服务器，简介

> 原文:[https://dev.to/pgoodjohn/serverless-an-introduction-2n9k](https://dev.to/pgoodjohn/serverless-an-introduction-2n9k)

*免责声明#1:这篇博文最初发表在我的[个人博客](http://bit.ly/serverless-introduction-blogpost)上，请在[推特](https://twitter.com/pietrogoodjohn)上关注我，了解我的新帖何时发布！*

*免责声明#2:本文中的所有内容都是与谷歌的无服务器主张 Google Cloud Functions 合作的结果。本文的发现可能不适用于其他无服务器提供商。*

昨天，在我的待办事项列表中出现了我不愿承认的事情之后，我决定实际尝试一下无服务器计算的新世界，构建一个简单的产品来帮助我的日常生活。互联网上关于无服务器计算的报道是非常积极的，或者至少在我看来是这样，所以我带着积极的心态参加了这个实验，并期待着被吹走。

好吧，也许我误解了我阅读的推文和博客，也许我仍然没有真正“理解”无服务器计算，但我并没有像我预期的那样完全被吹走。不要误解我的意思，这个想法本身就是天才:将函数附加到 HTTP 端点，并在每次向它们发出请求时简单地运行它们的能力，实际上只有两种基础设施选择(内存和位置)将是市场上最好的提议。不幸的是，我觉得工具还不够成熟，不足以让这种技术成为主流。

无服务器技术，让它成为谷歌云功能，AWS Lambda 功能或我们正在谈论的任何其他公司的版本，可能还没有为企业生产部署做好准备，但你知道它的伟大之处吗？个人项目！

这是我对这个堆栈最感兴趣的提议，所以我决定使用 Google Cloud 函数来构建一个小型的个人项目。瞎折腾了一下午，我来过一遍我发现的。

需要声明的是，我绝不是 Node JS 开发人员:我知道一些 Javascript 语法，我基本上能理解一段 Javascript 代码是做什么的，但是有些时候，我绝望地看着一系列括号和等号，却不能理解它们。也就是说，我仍然使用 Node JS 环境开发了我的第一个云函数，因为这是一个稳定的环境，看起来每个人在一生中都会学习一些 Javascript，所以我也可以利用这种情况。所有这些都是为了说明，也许我在测试中遇到的一些问题是由于我缺乏对语言本身的了解。我想如果是这样的话，你必须让我知道！

那么让我们来谈谈云函数。你将与云函数进行的第一次交互将是惊人的:只需几次点击，你将得到你的 HTTP 端点，你可以卷曲它，它将返回“Hello World！”。前提简直是惊人的。你还可以在 Google Cloud 的在线控制台中找到一个小编辑器，它可以让你立即进行修改和测试，它甚至可以解析你的`package.json`，下载和导入你的函数运行可能需要的任何依赖项。一切看起来都很棒。

当您想要将开发转移到本地机器时，一切都变得不那么好了。毕竟它只是一个 Javascript 函数，我想，构建一个模拟服务器来测试它会有多难。事实证明这非常困难，至少对我和我有限的 Javascript 环境知识来说是这样。

在浪费了一些时间尝试不同的可能解决方案并四处搜索之后，我发现的第一个有趣的资源来自[无服务器公司](https://serverless.com/)，他实现了一个看起来非常有趣的[快速启动项目](https://serverless.com/framework/docs/providers/google/guide/quick-start/)。对此我非常兴奋，我下载了 CLI 界面，并使用他们的模板创建了一个项目。然而，这个“模板”项目包含了返回“Hello World！”的相同的`index.js`从谷歌云控制台，和一个额外的文件，称为`serverless.yaml`，其中包含“配方”部署到 GCP，只需在命令行运行`serverless deploy`。所以最终我仍然没有办法在本地运行我的功能进行开发，但是我得到了一个单行部署器，不幸的是，它不允许我选择我的功能的部署区域，最终总是在`us-central1`中，如果你住在欧洲，这是不理想的。也许我只是在文档中忽略了这一点，但是我确实相信，如果如此重要的信息在您的项目文档中不容易找到(例如在您给出的例子中)，那么问题不在用户，而在提供者。

所以我回到谷歌，我发现了谷歌自己的[谷歌云功能模拟器](https://github.com/GoogleCloudPlatform/cloud-functions-emulator)。这激起了我的热情:他们开发平台，如果他们专门为平台开发模拟器，那将会非常棒！事实上，它或多或少隐藏在 GCP 的文档中，然而，从一开始我就对这个软件有点怀疑，相对来说，我是对的。

按照模拟器的文档进行安装和启动非常简单:

```
$ npm install -g @google-cloud/functions-emulator
$ functions start 
```

软件启动时没有任何问题。

从您的项目中部署一个函数也非常容易，只需使用文档中的语法:

```
$ functions deploy helloWorld --trigger-http 
```

然而，随着项目自述文件中列出的其余命令，问题开始出现。在对其进行测试时(HEAD 为 ca 9200 ba E8 fa 707 e 25 cc 025 c 998236 de 26 f 4 FB 89)，以下命令不起作用:

```
$ functions call helloWorld
$ functions logs read
$ functions --help
$ functions status
$ functions config set verbose true
$ functions restart 
```

嗯，你明白了。这件事的好处是我设法获得了一个本地主机 url 来测试我的功能。我没有得到任何日志或任何东西，所以我真的不能做太多的调试，但它足以让它最终工作。

我终于设法克服了所有这些困难，并设法创建了一个我满意的云函数，我可以立即开始使用，而不必考虑太多其他问题。此外，我可以把我今天学到的东西应用到我将来想出的更多想法中，我实际上感觉自己成为了无服务器技术的支持者，尽管在它成为更广泛使用的产品之前还有一些问题需要解决。

决定开发人员的产品是否能在无限发展的“一切即服务”环境中生存下来的因素通常是它的文档:从一个想法到一个可部署的产品有多难？基本上，无服务背后的想法是去除所有部署代码必须经历的中间步骤，但要实现这一壮举还太幼稚。可以在互联网上找到的文档仍然感觉不完整和太年轻，它没有引导用户从“Hello World！”到可部署的代码，而是让用户弄清楚发生了什么。

这给我们的是一项处于起步阶段的技术，这在当今非常罕见，鉴于这项新技术的许多部分都是开源的，这使得我们的开发者不仅可以告诉这些大公司我们想从他们那里得到什么，还可以邀请我们构建我们感兴趣的功能，并在未来实现它们。

从 GitHub 页面可以清楚地看到，谷歌的云功能模拟器正在 alpha 开发中(他们称之为 1.0.0 之前的版本)，但它仍然在 GitHub 上:一个命令不起作用？如果我喜欢，我可以深入源代码并找出原因，也许可以帮助谷歌修复它，从而为下一个踏上新旅程的开发者创造一个更好的世界。

总而言之，我对这个新的计算类别感到非常兴奋。我认为这可以帮助许多人减少对一些科技巨头的依赖，同时增加对 FaaS 供应商的依赖。目前这个市场由亚马逊、微软、IBM、谷歌和 Cloudflare 以及一些较小的公司组成。

在接下来的几周里，我会让你知道我在无服务器世界的最新发现，我们将一起看看这项技术是否会颠覆我们所知道的关于如何编写软件的一切。谁知道呢？