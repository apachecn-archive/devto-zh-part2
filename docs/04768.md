# preact+Typescript+Parcel+Redux Zero:é‡å»ºæ³¨é‡æ€§èƒ½å’Œæç®€ä¸»ä¹‰çš„ QMENTA å‰ç«¯ã€‚

> åŸæ–‡:[https://dev.to/aalises/preact-æ‰“å­—ç¨¿-åŒ…è£¹-è¿˜åŸ-å½’é›¶-é‡å»º-é‡åŒ–-å‰ç«¯-å…³æ³¨æ€§èƒ½å’Œæç®€ä¸»ä¹‰-1lnp](https://dev.to/aalises/preact--typescript--parcel--redux-zero-rebuilding-the-qmenta-front-end-focusing-on-performance-and-minimalism-1lnp)

*At*[**QMENTA**](https://www.qmenta.com/)*æˆ‘ä»¬ä¸€ç›´åœ¨ä»å¤´å¼€å§‹é‡å»ºå‰ç«¯ï¼Œä¸ä»…åœ¨è®¾è®¡ä¸Šï¼Œè€Œä¸”åœ¨ç”¨äºå®ƒçš„æŠ€æœ¯å †æ ˆä¸Šå¯»æ±‚ç®€å•æ€§å’Œæ€§èƒ½ã€‚æœ¬æ–‡å…¨é¢æ¦‚è¿°äº†æ„æˆæ–°å¹³å°çš„ä¸åŒéƒ¨åˆ†ï¼Œæ¯”å¦‚è£…é¥°è€…æ˜¯å¦‚ä½•è¢«å¹¿æ³›ä½¿ç”¨çš„ï¼Œæˆ–è€…æŠ€æœ¯æ ˆçš„é€‰æ‹©ã€‚*

* * *

*æœ¬å¸–æœ€åˆå‘å¸ƒåœ¨[åª’ä½“](https://medium.com/@albert.alises/preact-typescript-parcel-redux-zero-rebuilding-the-qmenta-front-end-focusing-on-performance-a7c879c5b288)T3 ä¸Š*

QMENTA å¹³å°å·²ç»æŒç»­äº†ä¸€æ®µæ—¶é—´äº†ã€‚æ—§çš„å¹³å°å‰ç«¯æ˜¯ä½¿ç”¨æˆç†Ÿçš„æŠ€æœ¯æ„å»ºçš„ï¼Œå¦‚ *JQueryã€Dojo æˆ– D3* ã€‚è™½ç„¶åŠŸèƒ½ä¸°å¯Œï¼Œä½†é—®é¢˜ä¹‹ä¸€æ˜¯å¦‚æ­¤å¤§çš„ä»£ç åº“çš„å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¹¶ä¸”åœ¨ UX/UI æ–¹é¢ç›¸å½“å¤æ‚ã€‚åœ¨åŒ»å­¦æˆåƒå­˜å‚¨å¹³å°ä¸­ï¼Œæ•°æ®å’Œæ“ä½œå¯¹äºç”¨æˆ·æ¥è¯´å·²ç»è¶³å¤Ÿå¤æ‚ï¼Œå› æ­¤åœ¨ç”¨æˆ·ä½“éªŒæˆ–è§†è§‰è®¾è®¡æ–¹é¢å¢åŠ éš¾åº¦æ˜¯ä¸€ä¸ªç¦åŒºã€‚ğŸ™…ğŸ»

ä»Šå¹´é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ä¹‹ä¸€æ˜¯ä»å¤´å¼€å§‹é‡å»ºå‰ç«¯ï¼Œä»¥é€‚åº”ä¸æ–­å¢é•¿çš„ç¥ç»æˆåƒå¤„ç†ä¸­å¿ƒçš„æ–°éœ€æ±‚ï¼Œä½¿å…¶å¹²å‡€ï¼Œæ˜“äºç»´æŠ¤ï¼Œå¯æ‰©å±•ï¼Œå¹¶ä¸å‰ç«¯å¼€å‘çš„æœ€æ–°æŠ€æœ¯ä¿æŒåŒæ­¥ã€‚

[![Register Page](../Images/df400ef5bed5b88c6f19c1a80c71db06.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--z77osAeA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/uxvbwc6nglbswqlm0tcc.png) 

<figure>

<figcaption>å›¾ 1:æ–°å‰ç«¯</figcaption>

</figure>

[![Project List View](../Images/83d2583dd2621ea856a71f0cb55c288f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--uW1LfPeF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/eea9ae1ys3uuheewy3u8.png)

<figure>

<figcaption>å›¾ 2:æ–°å‰ç«¯</figcaption>

</figure>

ä¸Šæ‰€æœ‰é¡¹ç›®çš„é¡¹ç›®åˆ—è¡¨è§†å›¾

ä»¥é€Ÿåº¦ã€æ€§èƒ½å’Œæç®€ä¸»ä¹‰ä¸ºæ——èˆ°ï¼Œç›®æ ‡æ˜¯ä½¿ç”¨`FrameworkOfChoice`æ„å»ºä¸€ä¸ªå•é¡µé¢ web åº”ç”¨ï¼Œå®ƒå¯ä»¥æ˜¯ **VueJSã€AngularJSã€React** æˆ–å…¶ä»–æ¡†æ¶ï¼Œå¦‚[*ã€Hyperapp*](https://github.com/jorgebucaran/hyperapp)ã€‚

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png) [çº¦å°”æ ¼å¸ƒå¡å…°](https://github.com/jorgebucaran) / [ hyperapp](https://github.com/jorgebucaran/hyperapp)

### æ„å»ºè¶…æ–‡æœ¬åº”ç”¨ç¨‹åºçš„å¾®å°æ¡†æ¶ã€‚

<article class="markdown-body entry-content container-lg" itemprop="text">

# è¶… app

> æ„å»ºè¶…æ–‡æœ¬åº”ç”¨ç¨‹åºçš„å¾®å°æ¡†æ¶ã€‚

*   **ç”¨æ›´å°‘çš„èµ„æºåšæ›´å¤šçš„äº‹æƒ…**â€”æˆ‘ä»¬å·²ç»å°½é‡å‡å°‘äº†ä½ éœ€è¦å­¦ä¹ æ¥å®Œæˆå·¥ä½œçš„æ¦‚å¿µã€‚è§†å›¾ã€åŠ¨ä½œã€æ•ˆæœå’Œè®¢é˜…éƒ½éå¸¸å®¹æ˜“æŒæ¡ï¼Œå¹¶ä¸”å¯ä»¥æ— ç¼åœ°ååŒå·¥ä½œã€‚
*   **å†™ä»€ä¹ˆï¼Œè€Œä¸æ˜¯å¦‚ä½•å†™**â€”Hyperapp æ˜¯ä¸€ä¸ªæ˜“äºé˜…è¯»ä¸”ç¼–å†™æœ‰è¶£çš„å£°æ˜å¼ APIï¼Œæ˜¯ä½¿ç”¨æƒ¯ç”¨ JavaScript æ„å»ºçº¯åŠŸèƒ½ã€åŠŸèƒ½ä¸°å¯Œã€åŸºäºæµè§ˆå™¨çš„åº”ç”¨çš„æœ€ä½³æ–¹å¼ã€‚
*   **å°äºä¸€ä¸ª favicon**â€”â€”å¤§çº¦ 1 kBã€‚Hyperapp æ˜¯ä¸€ä¸ªè¶…è½»é‡çº§çš„è™šæ‹Ÿ DOMï¼Œ[é«˜åº¦ä¼˜åŒ–çš„ diff ç®—æ³•](https://javascript.plainenglish.io/javascript-frameworks-performance-comparison-2020-cd881ac21fce)ï¼Œä»¥åŠç—´è¿·äºæç®€ä¸»ä¹‰çš„çŠ¶æ€ç®¡ç†åº“ã€‚

è¿™é‡Œæ˜¯ç¬¬ä¸€ä¸ªè®©ä½ å¼€å§‹çš„ä¾‹å­ã€‚[åœ¨æ­¤å°è¯•](https://codepen.io/jorgebucaran/pen/zNxZLP?editors=1000)â€”æ— éœ€æ„å»ºæ­¥éª¤ï¼

```
<script type="module">
  import { h, text, app } from "https://unpkg.com/hyperapp"
  const AddTodo = (state) => ({
    ...state,
    value: "",
    todos: 
```

â€¦Enter fullscreen mode Exit fullscreen mode</article>

[View on GitHub](https://github.com/jorgebucaran/hyperapp)
Up until there, pretty standard and mainstream definition for a web application project. After pondering the different frameworks and technologies, we chose [*Preact*](https://preactjs.com/) coupled with [*Typescript*](https://www.typescriptlang.org/) as the core libraries of choice for the project.

[![Typescript and Preact logos](../Images/e99a0a45e51bb57566ae3f341976965f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--EG9pUbQL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/3qs6lbnj1c4rvafb885c.jpg) 

<figure>

<figcaption>å›¾ 3:é¢„å†™å¹¶æ‰“å°å¾½æ ‡ã€‚</figcaption>

</figure>

* * *

### ä½†æ˜¯â€¦â€¦ä¸ºä»€ä¹ˆ Preact + Typescriptï¼ŸğŸ¤”

Preactï¼Œæ ¹æ®[å®ƒçš„å®˜æ–¹æ–‡æ¡£](https://preactjs.com/)ï¼Œæ˜¯ä¸€ä¸ª*â€œå¿«é€Ÿ 3kB çš„æ›¿ä»£ååº”ä¸åŒæ ·çš„ç°ä»£ APIâ€*ã€‚å®ƒæä¾›äº†æˆ‘ä»¬å–œæ¬¢å’Œå–œçˆ±çš„å…³äº React çš„ä¸€åˆ‡ï¼Œä¾‹å¦‚[è™šæ‹Ÿ DOM](https://reactjs.org/docs/faq-internals.html) ã€[åŸºäºç»„ä»¶çš„](https://reactjs.org/docs/react-component.html)å¼€å‘ã€ç”Ÿå‘½å‘¨æœŸæŒ‚é’©å’Œç”¨äºç”ŸæˆåŠ¨æ€æ•°æ®é©±åŠ¨ç•Œé¢çš„ [jsx è¯­æ³•](https://reactjs.org/docs/introducing-jsx.html)ã€‚

Preact åšåˆ°è¿™ä¸€åˆ‡çš„åŒæ—¶ä¿æŒ API æ›´ç²¾ç®€( [react 16.2.0 + React DOM æ˜¯ 31.8Kbï¼Œè€Œ Preact åªæœ‰ 4Kbï¼Œä¸¤è€…éƒ½æ˜¯ gzipped](https://gist.github.com/Restuta/cda69e50a853aa64912d) )ï¼Œä½¿å…¶æ›´å¿«ã€æ›´è½»é‡çº§ï¼Œå¹¶å‡å°‘äº† React æ·»åŠ çš„å¤§é‡å™ªå£°ã€‚ä¸ React çš„ä¸»è¦åŒºåˆ«å¯ä»¥åœ¨[è¿™é‡Œ](https://preactjs.com/guide/differences-to-react)çœ‹åˆ°ã€‚å…¶ä¸­ä¸€äº›æ˜¯:

*   `this.props`å’Œ`this.state`ä¼ ç»™`render()`ç»™ä½ ã€‚

*   ä½ å¯ä»¥åªå¯¹ CSS ç±»ä½¿ç”¨ classã€‚

*   å»æ‰äº†è®¸å¤š React / React DOM ç‰¹æœ‰çš„å‡½æ•°ï¼Œå¦‚`React.CreateElement`æˆ–`ReactDOM.render`ï¼Œæˆä¸ºç‹¬ç«‹çš„å¯¼å‡ºï¼Œä»è€Œé¿å…äº†æ··æ·†ï¼Œä½¿ä½ çš„ä»£ç æ›´æ•´æ´ï¼Œå¯è¯»æ€§æ›´å¥½ã€‚

å…³äºæ€§èƒ½ï¼Œåœ¨ä¸€ä¸ªç®€å•çš„ [TODO åº”ç”¨ç¨‹åº](http://todomvc.com/)ä¸Šæµ‹è¯•ï¼Œç»“æœä»¤äººéœ‡æƒŠï¼ŒPreact æ˜¯ Vue.js æ¥è¿‘çš„æœ€å¿«çš„åº”ç”¨ç¨‹åºä¹‹ä¸€ï¼Œæ¯” react å¿«å¤§çº¦ 170 æ¯«ç§’ã€‚å¾ˆç¥å¥‡ï¼Œä¸æ˜¯å—ï¼ŸğŸŒ 

[![Performance Test](../Images/1ec3b4792e12f446cfb6b5e98c080efa.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--gUc_8iAh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/5qa8ppv6r9ptxu4yb773.png) 

<figure>

<figcaption>å›¾ 4:ä¸åŒæ¡†æ¶é—´çš„ TodoMVC æ€§èƒ½å¯¹æ¯”ã€‚çœ‹è¿‡:
</figcaption>

</figure>

> æ‚¨å¯ä»¥é€šè¿‡è¿›å…¥[æ­¤å¤„](https://developit.github.io/preact-perf/)åœ¨æ‚¨çš„è®¾å¤‡ä¸Šæ‰§è¡Œæ€§èƒ½æµ‹è¯•ã€‚

å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä¸œè¥¿éƒ½å¾ˆæ£’ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªç¤¾åŒºæ²¡æœ‰ React é‚£ä¹ˆå¤§ï¼Œå“åº”ä¹Ÿæ²¡æœ‰ React é‚£ä¹ˆå¿«(æ¯•ç«Ÿå®ƒå¹¶æ²¡æœ‰è¢«å¹¿æ³›ä½¿ç”¨)ã€‚ä¸€äº›å¯çˆ±çš„åŠŸèƒ½ä»ç„¶æ²¡æœ‰å‡ºç°ï¼Œæ¯”å¦‚å¯¹[ç‰‡æ®µ](https://reactjs.org/docs/fragments.html)çš„æ”¯æŒ(æ‰€ä»¥ä½ ä»ç„¶å¿…é¡»åˆ›å»ºä¸€äº›å¥½çš„æ—§çš„ div åŒ…è£…å™¨)ã€‚æ­¤å¤–ï¼Œä¸€äº›åº“ä»ç„¶ä¸è¢«æ”¯æŒï¼Œä½†ä¸ç”¨æ‹…å¿ƒï¼Œ [preact-compat](https://github.com/developit/preact-compat) åœ¨ preact ä¹‹ä¸Šåˆ›å»ºäº†ä¸€ä¸ªå±‚ï¼Œä½¿å…¶ä¸ react å®Œå…¨å…¼å®¹ã€‚ç¥å¥‡ï¼âš¡ï¸

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)[ã€preactjsã€‘](https://github.com/preactjs)/[ã€preact-compatã€‘](https://github.com/preactjs/preact-compat)

### ğŸ™Œä¸º Preact ååº”å…¼å®¹å±‚ã€‚

<article class="markdown-body entry-content container-lg" itemprop="text">

# preact-compat

[![NPM](../Images/4d7683fccb2e0b63edcf74e32aa3af78.png)](https://www.npmjs.org/package/preact-compat)[![travis-ci](../Images/24c39096e82acf4eaf234acde88e4654.png)](https://travis-ci.org/developit/preact-compat)[![CDNJS](../Images/5220fe012edc3243fdb0b2520a63db93.png)](https://cdnjs.com/libraries/preact-compat)

> <g-emoji class="g-emoji" alias="rotating_light" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f6a8.png">ğŸš¨</g-emoji> **æ³¨æ„:**æ­¤æ¨¡å—é€‚ç”¨äº Preact 8.xï¼ŒPreact X ä¹‹å‰é»˜è®¤åŒ…å« compat For Preact Xï¼Œè¯·å¸è½½`preact-compat`å¹¶ç”¨`preact/compat`æ›¿æ¢æ‚¨çš„åˆ«åã€‚

è¿™ä¸ªæ¨¡å—æ˜¯ä¸€ä¸ªå…¼å®¹å±‚ï¼Œä½¿å¾—åŸºäº React çš„æ¨¡å—å¯ä»¥ä¸ [Preact](https://github.com/developit/preact) ä¸€èµ·å·¥ä½œï¼Œè€Œæ— éœ€ä»»ä½•ä»£ç æ›´æ”¹ã€‚

å®ƒæä¾›äº†ä¸`react`å’Œ`react-dom`ç›¸åŒçš„å¯¼å‡ºï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥ä½¿ç”¨æ‚¨é€‰æ‹©çš„æ„å»ºå·¥å…·å°†å®ƒæ”¾åˆ°ä¾èµ– React çš„åœ°æ–¹ã€‚

> æ„Ÿå…´è¶£å—ï¼Ÿä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼Œå®ƒä½¿ç”¨`preact-compat`æ¥å¤„ç†ä¸€ä¸ªæœªä¿®æ”¹çš„ç°æœ‰ React åº“ï¼Œå®ç°äº† 95%ä»¥ä¸Šçš„å¤§å°ç¼©å‡:
> 
> **[preact-compat-example](https://github.com/developit/preact-compat-example)**

* * *

## ä¸ºä»€ä¹ˆï¼Ÿ

> *...æˆ–è€…çœŸçš„ï¼Œâ€œä¸ºä»€ä¹ˆ[è¦å®£æ‰¬](https://github.com/developit/preact)â€ï¼Ÿ*

React æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„åº“å’Œä¼Ÿå¤§çš„æ¦‚å¿µï¼Œæ‹¥æœ‰ä¸€ä¸ªåˆ›å»ºé«˜è´¨é‡ç»„ä»¶çš„å¤§å‹æ¨¡å—ä½œè€…ç¤¾åŒºï¼Œç„¶è€Œï¼Œè¿™äº›ç»„ä»¶é€šè¿‡ä½¿ç”¨é€šç”¨åŒ…å¯¼å…¥ *( [ç¤ºä¾‹](https://github.com/developit/preact-toolbox/blob/master/components/app/index.jsx#L1) )* ç´§å¯†è€¦åˆåˆ° Reactã€‚

[é¢„åŠ¨ä½œ](https://github.com/developit/preact)æ˜¯â€¦

</article>

[View on GitHub](https://github.com/preactjs/preact-compat)

[![Analysis List View](../Images/1a6ea7513fd8cb4089ea224aebc63d4e.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--GeARwBi3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/i90qhd5lbcu5mfpjkonp.png) 

<figure>

<figcaption>å›¾ 5:åˆ†æåˆ—è¡¨è§†å›¾</figcaption>

</figure>

æˆ‘ä»¬â¤ï¸ **æ‰“å­—ç¨¿**ã€‚å¾ˆå¤šã€‚å¯¹äºä¸€ä¸ªæ‹¥æœ‰ä¸°å¯Œæ•°æ®å¹¶ç®¡ç†å¤§é‡æ¥è‡ª API çš„ä¸åŒå…ƒæ•°æ®å’Œç»“æœçš„åº”ç”¨ç¨‹åºï¼ŒTypescript ä¸ºæˆ‘ä»¬æä¾›äº†é™æ€ç±»å‹æ£€æŸ¥ï¼Œè¿™åœ¨å®šä¹‰æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¤„ç†çš„ä¸åŒæ•°æ®ç»“æ„ä»¥åŠä¸åŒç»„ä»¶çš„å±æ€§å’ŒçŠ¶æ€æ—¶éå¸¸æ–¹ä¾¿ï¼Œå› æ­¤æˆ‘ä»¬çŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œå°†å…¶è®°å½•ä¸‹æ¥ï¼Œå¹¶ä½¿æ‰€æœ‰æ•°æ®åœ¨æ‰€æœ‰ä¸åŒé˜¶æ®µä¿æŒä¸€è‡´ã€‚

> ä½ å¯ä»¥ç”¨ Typescript åˆ›å»ºæ¥å£æ¥æè¿°ä½ çš„åº”ç”¨ç¨‹åºç®¡ç†çš„è¾“å…¥/è¾“å‡ºæ•°æ®ã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œå®ƒæœ‰åŠ©äºå¯¹æè¿°ä¸€ä¸ªä¸»é¢˜æˆ–ä¸€é¡¹åˆ†ææ‰€å¿…éœ€çš„æ•°æ®è¿›è¡Œå»ºæ¨¡ï¼Œå› æ­¤ä¸€åˆ‡éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨å¤„ç†è¿™äº›ç»“æ„æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

```
export interface AnalysisInput {
  container_id: number,
  date: { $date: number },
  in_out: string,
  filters?: any[][],
  passed: boolean,
  ssid: string,
  subject_name: string
}

export interface AnalysisSettings {
  acpc_alignment: string,
  age_months: number,
  alignment_tool: string,
  input: AnalysisInput
} 
```

Enter fullscreen mode Exit fullscreen mode

ä½¿ç”¨ Typescriptï¼Œæ‚¨è¿˜å¯ä»¥åˆ›å»ºå¦‚ä¸‹æ‰€ç¤ºçš„*å®šåˆ¶ç»„ä»¶*ã€‚è¿™ä½¿å¾—æ‰©å±• ComponentForm çš„ç±»å®ç°äº†å¤„ç†è¡¨å•æ›´æ”¹å’Œè®¾ç½®è¡¨å•æ¨¡å‹çš„æ–¹æ³•(å³å…·æœ‰è¡¨å•æ‰€éœ€çš„æ‰€æœ‰å­—æ®µçš„å¯¹è±¡ï¼Œå¦‚ç”¨æˆ·ã€å¯†ç ç­‰â€¦)ï¼Œç„¶åè¿™ä¸ªæ¨¡å‹ä½œä¸ºç»„ä»¶çš„çŠ¶æ€æ˜¯å¿…éœ€çš„ï¼Œè¿˜å¿…é¡»å®ç°ä¸€ä¸ªæ–¹æ³•`submitForm()`ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæ¡†æ¶æˆ–ç»“æ„ï¼Œæ‰€æœ‰çš„è¡¨å•éƒ½éµå¾ªè¿™ä¸ªæ¡†æ¶æˆ–ç»“æ„ï¼Œæœ‰ä¸€ä¸ªé€šç”¨çš„è¡¨å•ç»„ä»¶ï¼Œå®ƒå¯ä»¥æœ‰ä»»æ„ç»™å®šæ•°é‡çš„å­—æ®µã€‚

```
import { h, Component } from "preact";

interface FormManagement<M> {
  form: M,
  message: string
}

export abstract class ComponentForm<props, model> extends Component<props, FormManagement<model>> {

  protected setFormModel (model: any) {
    this.setState({ form: new model })
  }

  protected handleFormChange(change) {
    this.setState(({ form, ...state }) => ({
      form: { ...form, ...change },
      ...state
    }));
  }

  abstract submitForm(...args): void;
} 
```

Enter fullscreen mode Exit fullscreen mode

æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨çš„ä¸€ä¸ªç®€åŒ–çš„é€šç”¨ Preact ç»„ä»¶çš„ç¤ºä¾‹å¼ºåˆ¶æ‰§è¡Œ Typescriptã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæŒ‚é’©ï¼Œä»¥åŠç»„ä»¶çš„å±æ€§å’ŒçŠ¶æ€å¦‚ä½•è¢«è®¾ç½®ä¸º Typescript æ¥å£ã€‚

```
mport { h, Component } from "preact";

export interface CommonSelectorAttrs {
  options: any[];
  class?: string;
  value?: any;
  printBy?: string;
  onChange?: (any) => void;
}

export interface CommonSelectorState {
  visible: boolean;
  innerValue: string;
}

export default class CommonSelector extends Component<CommonSelectorAttrs, CommonSelectorState> {

  state = { 
    visible: false, 
    innerValue: ""
  };

  getValue = (entry) => String(this.props.printBy ? entry[this.props.printBy] : entry);

  componentDidMount(): void {
    this.props.value && this.setState(() => ({ innerValue: this.getValue(this.props.value) }));
  }

  selectOption(opt: any): void {
    this.props.onChange.call(null, { target: { value: opt }});
  }

  closeTooltip(): void {
    this.setState(() => ({ visible: false }));
    this.checkMatch();
  }

  getMatcher(opt: any): boolean {
    return this.getValue(opt) === this.state.innerValue;
  }

  checkMatch(): void {
    const match = this.props.options.find((opt) => this.getMatcher(opt));
    !!match ? this.selectOption(match) : this.setState(() => ({ innerValue: "" }));
  }

  explicitSelection(opt: any): void {
    const val = this.getValue(opt);
    this.setState(() => ({ innerValue: val }));
    this.closeTooltip();
  }

  setValue(){
    if(this.state.innerValue === 'undefined'){
      return "";
    }else{
      return this.state.innerValue;
    }
  }

  render() {
    return (
      <div>
        <div>
          <p>
            <input placeholder="Select one option" />
          </p>
        </div>
        <div>
          {this.props.options
            .map((opt) => (
              <div onClick={() => this.explicitSelection(opt)}>
                <span>{this.getValue(opt)}</span>
              </div>
          ))}
        </div>
      </div>
    )
  }
} 
```

Enter fullscreen mode Exit fullscreen mode

* * *

### è£…ä¿®å·¥ï¼Œè£…ä¿®å·¥â€¦ğŸ’

å•Šï¼Œ [Javascript decorators](https://www.sitepoint.com/javascript-decorators-what-they-are/) ã€‚ä½œä¸ºä¸€ä¸ªæ¦‚å¿µï¼Œå®ƒä»¬åªæ˜¯ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„åŒ…è£…å™¨ï¼Œæ‰©å±•å…¶åŠŸèƒ½ï¼Œå°±åƒ [**é«˜é˜¶å‡½æ•°**](https://reactjs.org/docs/higher-order-components.html) ã€‚æˆ‘ä»¬å¹¿æ³›ä½¿ç”¨ decorators æ¥ä¿æŒæˆ‘ä»¬çš„ä»£ç æ›´æ•´æ´ï¼Œå¹¶åˆ†ç¦»åç«¯ã€çŠ¶æ€æˆ–åº”ç”¨ç¨‹åºç®¡ç†å…³æ³¨ç‚¹ï¼Œå¹¶æä¾›ä¸€ç§æ›´ç»“æ„åŒ–çš„æ–¹æ³•æ¥å®šä¹‰è·¨ç»„ä»¶çš„å…¬å…±åŠŸèƒ½ï¼Œå¦‚è¿æ¥åˆ° Redux å­˜å‚¨ã€è¿æ¥åˆ° API æˆ–å®šä¹‰ä¸€äº›åœ¨å“åº”å‘é€ä¹‹å‰æˆ–ä¹‹åå‘ç”Ÿçš„å¼‚æ­¥è¡Œä¸º(æœ‰ç‚¹åƒæ–¹æ³•ä»£ç†)ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…é‡å¤ä»£ç ï¼Œå¹¶æä¾›ä¸€ç§ä¼˜é›…ã€æœ€å°çš„æ–¹æ³•æ¥å®šä¹‰è¿™äº›è¡Œä¸ºã€‚æˆ‘ä»¬å°†å®ƒä»¬ç”¨äº:

##### -å¼‚æ­¥æ–¹æ³•æ‹¦æˆªå™¨

ä¸ºäº†ç®¡ç†å¼‚æ­¥è¡Œä¸ºï¼Œæˆ‘ä»¬ä½¿ç”¨ [`kaop-TS`](https://github.com/k1r0s/kaop-ts) ï¼Œè¿™æ˜¯ä¸€ä¸ªè£…é¥°åº“ï¼Œæä¾›äº†ä¸€äº›ç”¨ç±»å‹è„šæœ¬ç¼–å†™çš„æ–¹æ³•æ‹¦æˆªå™¨ã€‚æœ‰äº†å®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¼‚æ­¥æ–¹æ³•çš„è¿æ¥ç‚¹æ’å…¥è¡Œä¸ºï¼Œæ¯”å¦‚åœ¨æ–¹æ³•å¼€å§‹ä¹‹å‰æˆ–æ–¹æ³•ç»“æŸä¹‹åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œæˆ–è€…æ’å…¥ä¸€ä¸ªæ–¹æ³•æ¥æ‹¦æˆªé”™è¯¯å¹¶æ‰§è¡Œä¸€äº›é€»è¾‘ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸‹é¢å®šä¹‰ http è£…é¥°å™¨çš„ä»£ç ç‰‡æ®µä¸­ä½¿ç”¨äº†`beforeMethod`è£…é¥°å™¨ã€‚

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)[k1r0s](https://github.com/k1r0s)/[kaop-ts](https://github.com/k1r0s/kaop-ts)

### ç®€å•è€Œå¼ºå¤§çš„ ES2016 Decorators åº“ï¼Œå…·æœ‰å¼ºç±»å‹æ–¹æ³•æ‹¦æˆªå™¨ï¼Œå¦‚ BeforeMethodã€AfterMethodã€OnException ç­‰

<article class="markdown-body entry-content container-lg" itemprop="text">

[![kaop](../Images/2829297c88cfd52ad0fb23ea27369640.png)T2ã€‘](https://camo.githubusercontent.com/e675ba0ba9ad1a16a4250538a3509ee7e059611b1e76325d572fc7d8c04a9996/687474703a2f2f692e696d6775722e636f6d2f366269457073712e706e67)

[![semantic-release](../Images/a692f1dbafdf53023b8a11ad2a76d9c8.png)](https://github.com/semantic-release/semantic-release)[![Greenkeeper badge](../Images/3a7e1cf95e2d1f8b0c568766a49d9b2f.png)](https://greenkeeper.io/)[![Image travis](../Images/30b420a9a2fa0adb87122b2bfe7c748f.png)](https://travis-ci.org/k1r0s/)[![version](../Images/8fbdeea67258c350924eb973b779cb9e.png)](https://www.npmjs.com/package/kaop-ts/)[![Coverage Status](../Images/e2f0a449c4fc9b5f61776524629bfd6b.png)](https://coveralls.io/github/k1r0s/kaop-ts?branch=master)[![dependencies](../Images/283055506c029d175f7ef1e599bddbe3.png)](https://david-dm.org/k1r0s/kaop-ts/status.svg)[![dev-dependencies](../Images/3bc4b17c86570827d6c9843f256af98f.png)](https://www.npmjs.com/package/kaop-ts)[![downloads](../Images/78d1020af56646de17f1131e47ceee82.png)](https://www.npmjs.com/package/kaop-ts)[T25ã€‘](https://snyk.io/test/npm/kaop-ts)

è½»é‡çº§çš„ã€å¯é çš„ã€ä¸æ¡†æ¶æ— å…³çš„å¹¶ä¸”**æ˜“äºä½¿ç”¨çš„**ç”¨ TypeScript ç¼–å†™çš„åº“æ¥å¤„ç†*æ¨ªåˆ‡å…³æ³¨ç‚¹*å¹¶æé«˜ä»£ç çš„æ¨¡å—åŒ–ã€‚

### ç®€çŸ­æè¿°(æˆ–ä»€ä¹ˆæ˜¯å»ºè®®)

è¿™ä¸ªåº“æä¾›äº†ä¸€ç§åœ¨ä½ çš„åº”ç”¨ä¸­å®ç°**å»ºè®®**çš„ç®€å•æ–¹å¼ã€‚å»ºè®®æ˜¯å¯ä»¥æ’å…¥ OOP èŒƒä¾‹ä¸­å‡ ä¸ªåœ°æ–¹çš„ä»£ç ç‰‡æ®µï¼Œæ¯”å¦‚â€œbeforeMethodâ€ã€â€œafterInstanceâ€..ç­‰ç­‰ã€‚é€šçŸ¥ç”¨äºéä¾µå…¥æ€§åœ°æ”¹å˜ã€æ‰©å±•ã€ä¿®æ”¹æ–¹æ³•å’Œæ„é€ å‡½æ•°çš„è¡Œä¸ºã€‚

å…³äºè¿™é¡¹æŠ€æœ¯çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[èµ„æº](https://raw.githubusercontent.com/k1r0s/kaop-ts/master/#resources)ã€‚

### æ¼”ç¤º

[https://jsbin.com/bogecojuvi/edit?js,console](https://jsbin.com/bogecojuvi/edit?js,console)

### å¼€å§‹

```
npm install kaop-ts --save
```

Enter fullscreen mode Exit fullscreen mode

ä½¿ç”¨ä¸€ä¸ª[è¿æ¥ç‚¹](https://raw.githubusercontent.com/k1r0s/kaop-ts/master//docs/api.md#available-join-points)å°†å…¶æ’å…¥ä»»ä½•æ–¹æ³•/ç±»:

```
import { afterMethod } from 'kaop-ts'
const double = afterMethod(meta => meta.result *= 2)
class DummyExample {
  @double
  static calculateSomething (num, num2) {
    return num * num2
  }
}
DummyExample.calculateSomething(3, 3
```

â€¦Enter fullscreen mode Exit fullscreen mode</article>

[View on GitHub](https://github.com/k1r0s/kaop-ts)

##### -è¿æ¥å’Œç®¡ç† API è°ƒç”¨

ä¸ºäº†ç®¡ç†å¯¹ QMENTA API çš„è°ƒç”¨ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ª`@platformRequest(url,method)` decoratorï¼Œæ‚¨å¯ä»¥ç”¨ç­¾å`function(params,error?,result?)`å°†å®ƒåŒ…è£…åœ¨ä»»ä½•å‡½æ•°ä¸­ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå¯¹ API çš„å¼‚æ­¥è°ƒç”¨ï¼Œä½¿ç”¨æŸäº›å‚æ•°å‘é€è¯·æ±‚ï¼Œå¹¶ä»è°ƒç”¨æˆ–è¯·æ±‚æŠ›å‡ºçš„é”™è¯¯ä¸­æ¥æ”¶ç»“æœ JSON å¯¹è±¡ã€‚è£…é¥°å™¨çš„å®ç°å¯ä»¥åœ¨ä¸‹é¢çœ‹åˆ°ï¼Œè¿˜æœ‰ä¸€ä¸ªè°ƒç”¨å®ƒçš„ç¤ºä¾‹æ–¹æ³•ã€‚

```
const http = options => meta => {
  if(!options.method) options.method = "get";
  const [ params, ...aditional ] = meta.args;
  options[options.method === 'get' ? 'params' : 'data'] = params;
  (request as any)({ ...options })
  .then(res => {
    const data = res.data;
    meta.args = [params, ...aditional, null, res.data];
    meta.commit();
  })
  .catch(err => {
    meta.args = [params, ...aditional, err, null];
    meta.commit();
  })
};

const checkError = meta => {
  const [err, result] = meta.args.slice(-2);
  checkInvalidCredentials(err);
  if(err) return;
  if(typeof result !== "object") {
    meta.args.splice(-2);
    meta.args = [ ...meta.args, new Error("Wrong response format! (not a json obj)"), null ];
  }
}

const stringifyParams = meta => {
  const [ params, ...args ] = meta.args;
  meta.args = [ stringify(params), ...args ];
}

export const platformRequest = (url, method = "get", noop = _ => _) => beforeMethod(
  method === "get" ? noop : stringifyParams,
  http({ method, url }),
  checkError)

/* USAGE EXAMPLE */
interface ChangePasswordRequest {
  old_password: string,
  new_password: string,
  new_password_confirm: string
}

@platformRequest("/change_password", "post")
  RecoverPassword(params : ChangePasswordRequest, err?, result?) {
    if(err) {
      throw err;
      //Cannot change the password
    } else {
      //Password changed succesfully!
    }
 } 
```

Enter fullscreen mode Exit fullscreen mode

> *è£…é¥°è€…ä½¿ç”¨ç½©ä¸‹çš„[è½´](https://github.com/axios/axios)æ¥æ‰§è¡Œè¯·æ±‚* ğŸ•µ.

å®ƒçš„ä¸€ä¸ªå®ç°(ä½œä¸ºä¸€ä¸ªæœ€å°çš„åº“)åŒ…è£…äº†[è·å– API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) å¯ä»¥åœ¨ [`http-fetch-decorator`](https://github.com/aalises/http-fetch-decorator) å›è´­ä¸Šçœ‹åˆ°:

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png) [çˆ±ä¸½ä¸](https://github.com/aalises)/[http-fetch-decorator](https://github.com/aalises/http-fetch-decorator)

### ä¸ºæ‚¨çš„å‡½æ•°æä¾›ç®€å•çš„è·å–æ¥å£ http è£…é¥°åŒ…è£…ã€‚

<article class="markdown-body entry-content container-lg" itemprop="text">

# HTTP è·å–è£…é¥°å™¨

ä¸ºæ‚¨çš„å‡½æ•°æä¾›ç®€å•çš„è·å–æ¥å£è£…é¥°åŒ…è£…ã€‚

`$ npm install http-fetch-decorator`

### ç­¾å

ç„¶åï¼Œæ‚¨å¯ä»¥æ”¾ç½®ä¸ fetch å‡½æ•°å…·æœ‰ç›¸åŒè¾“å…¥ç»“æ„çš„è£…é¥°å™¨ã€‚ä½œä¸ºä¸»ä½“å‘é€çš„è¯·æ±‚æˆ–æ•°æ®çš„å‚æ•°é€šè¿‡å‚æ•°ä¼ é€’ç»™åŒ…è£…çš„å‡½æ•°ï¼Œç»“æœå’Œé”™è¯¯å¯¹è±¡ä¹Ÿå¯ä½œä¸ºå‡½æ•°çš„å‚æ•°:

```
@Fetch(Url: String, initObj?: Object)
static wrappedFunction(params: Object, result? : Response, err? : any){
}
```

Enter fullscreen mode Exit fullscreen mode

### å¦‚ä½•ä½¿ç”¨å®ƒ

```
import Fetch from "http-fetch-decorator"
class AnyES6Class {
  @Fetch("apiexample/getsomething", {method: 'GET',mode:'cors'})
  static parseResponse({id: '1'},result,err) {
    if(err) throw err
    //Result contains the Response object from fetch, then you can parse
```

â€¦Enter fullscreen mode Exit fullscreen mode</article>

[View on GitHub](https://github.com/aalises/http-fetch-decorator)

æ­¤å¤–ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€ç®¡ç†å’Œè·¯ç”±ä½¿ç”¨ decorators æ¥æ‰©å±•ç»„ä»¶çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œå°†ç»„ä»¶è¿æ¥åˆ°å•†åº—æˆ–ä¾¦å¬ç‰¹å®šè·¯ç”±ä¸Šå‘ˆç°çš„å†…å®¹ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹æ­¤è¿›è¡Œæ›´å¤šçš„è®¨è®ºã€‚

[![Subject Detail Viewing](../Images/ef15b31a37ddf7aaf5d6ab620cd5502f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--YiZkIHBc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fnzcy8oszdysa8lznuki.png) 

<figure>

<figcaption>å›¾ 6:ç”¨ç¼–è¾‘æ–‡ä»¶å…ƒæ•°æ®æ¨¡å¼æŸ¥çœ‹ç‰¹å®šä¸»é¢˜æ–‡ä»¶ã€‚
</figcaption>

</figure>

* * *

### çŠ¶æ€ç®¡ç†å’Œè·¯ç”±ğŸš€

çŠ¶æ€ç®¡ç†æ˜¯ä»»ä½•æˆé•¿ä¸­çš„ React åº”ç”¨ç¨‹åºçš„ä¸»è¦å…³æ³¨ç‚¹ä¹‹ä¸€ã€‚å½“å®ä½“å’Œç»„ä»¶çš„æ•°é‡ä¸æ–­å¢é•¿æ—¶ï¼Œå¯¹å…¨å±€çŠ¶æ€ç®¡ç†çš„éœ€æ±‚å°±å‡ºç°äº†ã€‚ [Redux](https://redux.js.org/) å°±æ˜¯æ—¨åœ¨è§£å†³è¿™ä¸€é—®é¢˜çš„ä¸»æµè§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚è¿™ç¯‡æ–‡ç« å‡è®¾è¯»è€…å¯¹ Redux çš„æ“ä½œæœ‰ä¸€å®šçš„äº†è§£ï¼›å¦‚æœæ²¡æœ‰ï¼Œ[åœ¨è¿™é‡Œä½ å¯ä»¥æ‰¾åˆ°å¦‚ä½•å·¥ä½œçš„æŒ‡å—](https://medium.freecodecamp.org/understanding-redux-the-worlds-easiest-guide-to-beginning-redux-c695f45546f6)ã€‚

åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æœ‰ä¸€ä¸ªå¤§çš„å­˜å‚¨ï¼Œæˆ‘ä»¬è¯•å›¾è®©å®ƒå°½å¯èƒ½å°ï¼Œå‡å°‘å…±äº«çŠ¶æ€çš„ä½¿ç”¨ï¼ŒåŠ å¼ºå…³æ³¨ç‚¹çš„å°è£…å’Œåˆ†ç¦»ã€‚é‰´äºæ­¤ï¼Œæˆ‘ä»¬å†³å®šä½¿ç”¨ä¸€ä¸ªåä¸º [`Redux-Zero`](https://github.com/redux-zero/redux-zero) çš„è½»é‡çº§(å°äº 1Kb)ç‰ˆæœ¬ã€‚è™½ç„¶æœ‰ä¸€äº›ä¸åŒï¼Œä½†å®ƒä¹Ÿå‡å°‘äº† Redux çš„è®¸å¤šä¸å¿…è¦çš„å¼€é”€(å¯¹äºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ¥è¯´)ã€‚å®ƒä»ç„¶æœ‰ä¸€ä¸ª**å•†åº—**(å°½ç®¡åªæœ‰ä¸€ä¸ª)ï¼Œå®ƒæä¾›äº†æˆ‘ä»¬æƒ³è¦ç®¡ç†çš„æ‰€æœ‰å…¨å±€çŠ¶æ€ï¼›åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä¼šè¯å’Œé¡¹ç›®ä¿¡æ¯ã€å½“å‰é¡µé¢ã€å½“å‰é¡¹ç›® id çš„é€šçŸ¥ç­‰ç­‰ã€‚å®ƒä¹Ÿæ²¡æœ‰**ç¼©å‡å™¨**ï¼Œè®½åˆºçš„æ˜¯ï¼Œè¿™ç¡®å®å¤§å¤§é™ä½äº†åº“çš„å¤æ‚æ€§ã€‚

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)/[redux-zero](https://github.com/redux-zero/redux-zero)

### åŸºäº Redux çš„è½»é‡çº§çŠ¶æ€å®¹å™¨

<article class="markdown-body entry-content container-lg" itemprop="text">

# [![redux zero logo](../Images/68def7f971803ba242da0e40be93e10c.png "redux zero logo")](https://camo.githubusercontent.com/c88d3fb7980b72edd3f139c81923b987a16473fc2de5bc8db136c47f592962ae/68747470733a2f2f692e696d6775722e636f6d2f53386a6e72384f2e706e67)T3ã€‘

åŸºäº Redux çš„è½»é‡çº§çŠ¶æ€å®¹å™¨

> é˜…è¯»[ä»‹ç»åšå®¢æ–‡ç« ](https://medium.com/@matheusml/introducing-redux-zero-bea42214c7ee)

* * *

[![codacy](../Images/13bdef981bd88cb965913abc33bee641.png)](https://www.codacy.com/app/matheusml/redux-zero?utm_source=github.com&utm_medium=referral&utm_content=redux-zero/redux-zero&utm_campaign=Badge_Grade)[![build](../Images/becbdd0df4afe21b7560a52faf729cdc.png)](https://travis-ci.org/redux-zero/redux-zero)[![npm](../Images/942e15c41e557a3af9861df7e0634621.png)](https://www.npmjs.com/package/redux-zero)[![downloads](../Images/75221816635ec97a23603921c5a08163.png)](https://www.npmjs.com/package/redux-zero)[![license](../Images/169abed00450868f24b692fd8d42391e.png)](https://raw.githubusercontent.com/redux-zero/redux-zero/master/)[![dependencies](../Images/17fde32fa70c2fff63862c4915849675.png)](https://raw.githubusercontent.com/redux-zero/redux-zero/master/)

## ç›®å½•

*   [å®‰è£…](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#installation)
*   [å¦‚ä½•](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#how)
*   [ä¾‹å­](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#example)
*   [åŠ¨ä½œ](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#actions)
*   [å¼‚æ­¥](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#async)
*   [ä¸­é—´ä»¶](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#middleware)
*   [å¼€å‘å·¥å…·](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#devtools)
*   [æ‰“å­—ç¨¿](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#typescript)
*   [çµæ„Ÿ](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#inspiration)
*   [è·¯çº¿å›¾](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#roadmap)
*   [æ–‡æ¡£](https://raw.githubusercontent.com/redux-zero/redux-zero/master/#docs)

## è£…ç½®

è¦å®‰è£…ç¨³å®šç‰ˆæœ¬:

```
npm i redux-zero 
```

è¿™å‡è®¾ä½ ä½¿ç”¨çš„æ˜¯åƒ [webpack](https://webpack.js.org/) è¿™æ ·çš„æ¨¡å—æ†ç»‘å™¨ [npm](https://www.npmjs.com/)

## æ€ä¹ˆ

**ES2015+:**

```
import createStore from "redux-zero";
import { Provider, connect } from "redux-zero/react";
```

Enter fullscreen mode Exit fullscreen mode

**æ‰“å­—ç¨¿:**

```
import * as createStore from "redux-zero";
import { Provider, connect } from "redux-zero/react";
```

Enter fullscreen mode Exit fullscreen mode

**CommonJS:**

```
const createStore = require("redux-zero");
const { Provider, connect } = require("redux-zero/react");
```

Enter fullscreen mode Exit fullscreen mode

**UMD:**

```
<!-- the store -->
<script src="https://unpkg.com/redux-zero/dist/redux-zero.min.js"></script>
<!-- for react -->
<script src="https://unpkg.com/redux-zero/react/index.min.js"></script>
<!-- for preact -->
<script src="https://unpkg.com/redux-zero/preact/index.min.js"></script>
<!-- for vue -->
<script
```

â€¦Enter fullscreen mode Exit fullscreen mode</article>

[View on GitHub](https://github.com/redux-zero/redux-zero)

[![Brain Fibers Visualizer](../Images/6a3dc1aa58398dbfab581ed67c1edc95.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--NECF2918--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/bpxtpl673dhwlbaocglj.png) 

<figure>

<figcaption>å›¾ 7:ä½¿ç”¨ WebGL
</figcaption>

</figure>

åœ¨å‰ç«¯è¿›è¡Œè„‘çº¤ç»´æŸæˆåƒ

è¦è®©å®ƒè¿è¡Œèµ·æ¥ï¼Œåªéœ€ç”¨`<Provider store={store}/>`ç»„ä»¶åŒ…è£…æ ¹ç»„ä»¶ï¼Œå¹¶åœ¨å…¶ä¸Šè®¾ç½®å­˜å‚¨ï¼Œè¿™æ˜¯ä¸€ä¸ªç”±`createStore(state)`æ–¹æ³•åˆ›å»ºçš„å¯¹è±¡ï¼Œå…¶ä¸­çŠ¶æ€æ˜¯åŒ…å«æˆ‘ä»¬å…±äº«çŠ¶æ€çš„å¯¹è±¡ã€‚ä¸ºäº†æ”¹å˜è¿™ç§çŠ¶æ€ï¼Œä½ åˆ›å»ºäº†ä¸€äº›åŠ¨ä½œï¼Œè¿™äº›åŠ¨ä½œä»…ä»…æ˜¯æ›´æ–°å…¨å±€çŠ¶æ€çš„çº¯å‡½æ•°ï¼Œä¾‹å¦‚`setSession = (state,val) => ({sessions: val});`

ä¸ºäº†ä»ä¸€ä¸ªç»„ä»¶è°ƒç”¨è¿™äº›åŠ¨ä½œï¼Œæˆ‘ä»¬å¿…é¡»**å°†é‚£ä¸ªç»„ä»¶**è¿æ¥åˆ°å•†åº—ã€‚å°†ç»™å®šçš„ç»„ä»¶è¿æ¥åˆ°å­˜å‚¨å…è®¸ç»„ä»¶é€šè¿‡ props è®¿é—®ä¸€äº›åŠ¨ä½œå’Œå…¨å±€çŠ¶æ€ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè£…é¥°å™¨æ¥ç®€åŒ–å°†ç»„ä»¶è¿æ¥åˆ°å•†åº—çš„è¿‡ç¨‹ã€‚

```
import { h, Component } from "preact";
import { Connect } from "redux-zero/preact";

export default function(actions = {}): any {
  return Child => props => (
    <Connect mapToProps={state => ({ ...state })} actions={actions}>
      {mappedProps => <Child {...mappedProps} {...props} />}
    </Connect>
  )
} 
```

Enter fullscreen mode Exit fullscreen mode

æœ‰äº†è¿™ä¸ªè£…é¥°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ’åœ¨ä»»ä½•ç»„ä»¶ä¹‹ä¸Šï¼ŒæŒ‡å®šç»„ä»¶å°†è·å¾—çš„åŠ¨ä½œä½œä¸ºé“å…·ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å°†`@connectStore({removeSession, setCurrentPages});`æ”¾åœ¨ç»„ä»¶å£°æ˜çš„é¡¶éƒ¨ï¼Œæ‚¨å¯ä»¥è®¿é—®ç»„ä»¶å†…éƒ¨æ›´æ–°å­˜å‚¨å…¨å±€çŠ¶æ€çš„è¿™äº›æ“ä½œï¼ŒåŒæ—¶è¿˜å¯ä»¥é€šè¿‡ props ( `this.props.removeSession();`)è®¿é—®å…¨å±€çŠ¶æ€æœ¬èº«ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ç§æ›´ç®€æ´ã€æ›´ä¼˜é›…å’Œæ›´ç´§å‡‘çš„æ–¹å¼æ¥å°†ç»„ä»¶è¿æ¥åˆ°å•†åº—ã€‚

ä»»ä½•ç°ä»£åº”ç”¨ç¨‹åºçš„å¦ä¸€ä¸ªä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†æ˜¯æ ¹æ® URL æˆ–å…¶ä»–å‚æ•°åœ¨é¡¹ç›®çš„ä¸åŒè§†å›¾ä¹‹é—´é€‰æ‹©è·¯ç”±ï¼Œèƒ½å¤Ÿå°†å‚æ•°ä¼ é€’ç»™è·¯ç”±ï¼Œç­‰ç­‰ã€‚ä¸€ä¸ªå¸¸è§çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ React è‡ªå¸¦çš„ç¥å¥‡è·¯ç”±å™¨[ã€‚å°½ç®¡æˆ‘ä»¬å¾ˆå–œæ¬¢å®ƒï¼Œä½†å®ƒé™„å¸¦äº†å¾ˆå¤šæˆ‘ä»¬ä¸ä¼šçœŸæ­£ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ¶ä½œäº†è‡ªå·±çš„](https://github.com/ReactTraining/react-router) [preact-routlet](https://github.com/k1r0s/preact-routlet) ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº decorators çš„ Preact/React çš„ç®€å•è·¯ç”±å™¨ã€‚

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)[k1r0s](https://github.com/k1r0s)/[preact-roulet](https://github.com/k1r0s/preact-routlet)

### ä½¿ç”¨ ES7 è£…é¥°å™¨ä¸º Preact/React æä¾›ç®€å•çš„â€œç»„ä»¶é©±åŠ¨â€è·¯ç”±

<article class="markdown-body entry-content container-lg" itemprop="text">

# é¢„åŠ¨ä½œä¾‹è¡Œç¨‹åº

è¿™ä¸ªåŒ…åŒ…å«äº† [Preact](https://github.com/developit/preact) çš„è·¯ç”±åŠŸèƒ½ï¼Œç°åœ¨ä» 1.0.0 `React`å¼€å§‹ä¹ŸåŒ…å«äº†ã€‚å®ƒä¸ä½¿ç”¨ HTML5 å†å² APIï¼Œè€Œæ˜¯ä½¿ç”¨ oldie `/#/what-ever`æ•£åˆ—è·¯ç”±(è¿™åœ¨å°†æ¥ä¼šæ”¹å˜)ã€‚

è¿™ä¸ªé¡¹ç›®æ˜¯é€šè¿‡æ¢ç´¢å®šä¹‰è·¯çº¿çš„ä¸Šä¸‹æ–‡æ–¹æ³•è€Œä¸æ˜¯å°†æ‰€æœ‰è·¯çº¿æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­åˆ›å»ºçš„ã€‚

### ç”¨æ³•:

å¯ç”¨å¯¼å…¥:

```
// if you're using React
import { renderOnRoute, navigate, RouterOutlet, PathLookup, routePool, Link } from "preact-routlet/react"
// if you're using Preact
import { renderOnRoute, navigate, RouterOutlet, PathLookup, routePool, Link } from "preact-routlet/preact"
```

Enter fullscreen mode Exit fullscreen mode

`from "preact-routlet/preact"`æˆ–`from "preact-routlet/react"`

å°†æ‚¨çš„`RouterOutlet`å…ƒç´ æ”¾åœ¨ JSX çš„æŸä¸ªåœ°æ–¹:

```
<div>
  <RouterOutlet /&gt
</div>
```

Enter fullscreen mode Exit fullscreen mode

å°†`renderOnRoute`è£…é¥°å™¨æ’åœ¨æŸä¸ªç»„ä»¶ä¸Š

```
@renderOnRoute("/login")
export default class Login extends Component<any, any> {

```

â€¦Enter fullscreen mode Exit fullscreen mode</article>

[View on GitHub](https://github.com/k1r0s/preact-routlet)

å®ƒçš„å¤æ‚æ€§å¾ˆç®€å•ï¼Œåªè¦ç”¨è·¯ç”±å™¨ç»„ä»¶`<RouterOutlet />`åŒ…è£…ä½ çš„åº”ç”¨ç¨‹åºï¼Œä½ å°±å¯ä»¥å¼€å§‹äº†ã€‚æ‚¨è¿˜å¯ä»¥ç”¨æŒ‡å®šæ¡ä»¶çš„`<PathLookup shouldRender={condition}/>`æ¥åŒ…è£…ä¸€äº›ç»„ä»¶ï¼Œä»¥å‘ˆç°ä¸€äº›è·¯å¾„ï¼Œæˆ–è€…ä½¿ç”¨`<RouterOutlet redirect="/route" shouldRedirect={condition} />`æ¥æŒ‡å®šä¸€ä¸ªæ¡ä»¶ï¼Œåœ¨æ»¡è¶³è¯¥æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨è‡ªåŠ¨é‡å®šå‘åˆ°æŒ‡å®šçš„è·¯ç”±(ä¾‹å¦‚ï¼Œå¦‚æœä¼šè¯æ— æ•ˆæˆ–å·²ç»è¿‡æœŸï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥é‡å®šå‘åˆ°ç™»å½•)ã€‚

è¦å¯¼èˆªåˆ°ä¸€ä¸ªè·¯çº¿ï¼Œä½ åªéœ€è¦è°ƒç”¨`navigate("/route")`å¹¶æŒ‡å®šä¸€ä¸ªç»„ä»¶åœ¨ä¸€ä¸ªç‰¹å®šçš„è·¯çº¿ä¸Šè¢«æ¸²æŸ“ï¼Œä½ åªéœ€è¦åœ¨ç»„ä»¶çš„é¡¶éƒ¨æ’å…¥è£…é¥°å™¨ï¼Œä¾‹å¦‚`@renderOnRoute("forgot-password")`ï¼Œä½¿å¾—ç»„ä»¶åœ¨å“ªä¸ªè·¯çº¿ä¸Šè¢«æ¸²æŸ“å˜å¾—æ¸…æ™°å¯è§ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ç§ç®€æ´çš„æ–¹å¼æ¥è¡¨ç¤ºè·¯ç”±å’ŒçŠ¶æ€ç®¡ç†ï¼Œå¹¶åœ¨ç»„ä»¶çš„é¡¶éƒ¨ç­¾åï¼Œè¿™ä½¿å¾—å®ƒéå¸¸å¯è¯»ã€‚ä¸‹é¢å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¿æ¥åˆ°å•†åº—å¹¶å‘ˆç°åœ¨ç»™å®šè·¯çº¿ä¸Šçš„è™šæ‹Ÿç»„ä»¶ã€‚

```
import { h, Component } from "preact";
import { renderOnRoute, navigate } from "preact-routlet";
import { setLoginMessage } from "../actions";
import connectStore from "../../../connect";
import { platformRequest } from "../../../services/api-decorators";

//With these decorators, we know the route this component is rendered at and which actions does it have access to, in a compact way
@renderOnRoute("/forgot-password") @connectStore({ setLoginMessage })
export default class ForgotPassword extends Component<any, any> {

  //Call the forgot_password API with a POST
  @platformRequest("/forgot_password", "post")
  performLogin(params, err?, result?) { //Params are the parameters of the request e.g {email: "test@gmail.com , user_id: 1234}
    if(err || result.error) {
      this.setState({ message: "There was an error with the request" })
    } else {
      this.props.setLoginMessage(result.message); //Calling the store to set a login warning message
      navigate("/login"); //Navigate back to the login using the router
    }
  }

   render() {
     return (
        <div>
          Just an example component with some decorators...
        </div>
   }
} 
```

Enter fullscreen mode Exit fullscreen mode

* * *

### ç”¨åŒ…è£¹æ†ç»‘ğŸ“¦

[Parcel](https://parceljs.org/) ï¼Œä¸è¦ä¸æ¾³å¤§åˆ©äºšä¹é˜Ÿ [Parcels](https://www.youtube.com/watch?v=PTFK96KNfIE) ç›¸æ··æ·†ï¼Œå®ƒå°†è‡ªå·±å®šä¹‰ä¸º*â€œé€Ÿåº¦æå¿«ï¼Œé›¶é…ç½® web åº”ç”¨æ†ç»‘å™¨â€*ã€‚åœ¨é¡¹ç›®å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸å½“æ ‡å‡†çš„ Webpack æ¥æ†ç»‘æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚å®ƒéœ€è¦ç›¸å½“å¤šçš„æ’ä»¶å’Œé…ç½®ã€‚(`webpack.config.ts`)ã€‚åˆ‡æ¢åˆ° packageï¼Œæˆ‘ä»¬ä¸å†éœ€è¦é…ç½® typescript æˆ– html æ–‡ä»¶ï¼Œåªéœ€æ·»åŠ `npm install --save-dev parcel-bundler parcel-plugin-typescript`å³å¯ã€‚

å”¯ä¸€å‰©ä¸‹çš„äº‹æƒ…å°±æ˜¯æŒ‡å®šä¸€ä¸ªå…¥å£ç‚¹å’Œè¾“å‡ºç›®å½•ï¼Œç§ï¼Œè¿™å°±è¡Œäº†ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä¸ webpack ç›¸æ¯”ï¼Œé€Ÿåº¦å’Œæ€§èƒ½ä¸Šçš„å·®å¼‚å¹¶ä¸æ˜æ˜¾(åœ¨é€Ÿåº¦ä¸ŠåŸºæœ¬ç›¸åŒ)ï¼Œä½†å®ƒçš„é›¶é…ç½®å’Œæœ€å°åŒ–ä½¿å®ƒæˆä¸ºæˆ‘ä»¬é¡¹ç›®çš„é¦–é€‰æ†ç»‘å™¨ã€‚

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)/[åŒ…è£¹](https://github.com/parcel-bundler/parcel)

### ğŸ“¦ğŸš€æå¿«çš„é›¶é…ç½® web åº”ç”¨æ†ç»‘å™¨

<article class="markdown-body entry-content container-lg" itemprop="text">

[![Parcel](../Images/1b13c4e337dd7aea4f456a4b8204583e.png)T2ã€‘](https://parceljs.org/)

[![Backers on Open Collective](../Images/dbe55a49f70b3d5ce3c071c1afd29343.png)](https://raw.githubusercontent.com/parcel-bundler/parcel/v2/#backers)[![Sponsors on Open Collective](../Images/7532f769bbeb551c38e7d3354241bc20.png)](https://raw.githubusercontent.com/parcel-bundler/parcel/v2/#sponsors)[![Build Status](../Images/a4f5b61113aef47a03be4a343d456b5a.png)](https://dev.azure.com/devongovett/devongovett/_build/latest?definitionId=1)[![npm package](../Images/5479202d27c73ad2be6730f32d084f3a.png)](https://www.npmjs.com/package/parcel)[![npm package](../Images/146d3ba0b7a5acded52a1a543583cf15.png)](https://www.npmjs.com/package/parcel)[![Twitter Follow](../Images/753d1e4556446be4159d5454bbb9e51e.png)](https://twitter.com/parceljs)

## ç‰¹å¾

*   <g-emoji class="g-emoji" alias="rocket" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png">ğŸš€</g-emoji> **è¶…å¿«çš„é€Ÿåº¦**æ†ç»‘æ—¶é—´â€”â€”å¤šæ ¸ç¼–è¯‘ï¼Œæ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼Œå³ä½¿é‡å¯åä¹Ÿèƒ½å¿«é€Ÿé‡å»ºã€‚
*   <g-emoji class="g-emoji" alias="package" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4e6.png">ğŸ“¦</g-emoji>å¼€ç®±å³ç”¨æ”¯æŒ JSã€CSSã€HTMLã€æ–‡ä»¶èµ„äº§ç­‰- **æ— éœ€å®‰è£…æ’ä»¶**ã€‚
*   <g-emoji class="g-emoji" alias="tropical_fish" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f420.png">ğŸ </g-emoji> **åœ¨éœ€è¦æ—¶ä½¿ç”¨ Babelã€PostCSS å’Œ PostHTML è‡ªåŠ¨è½¬æ¢æ¨¡å—**â€”â€”ç”šè‡³`node_modules`ã€‚
*   <g-emoji class="g-emoji" alias="scissors" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2702.png">âœ‚ï¸</g-emoji> é›¶é…ç½®**ä»£ç æ‹†åˆ†**ä½¿ç”¨åŠ¨æ€`import()`è¯­å¥ã€‚
*   <g-emoji class="g-emoji" alias="fire" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f525.png">ğŸ”¥</g-emoji>å†…ç½®æ”¯æŒ**çƒ­æ¨¡å—æ›´æ¢**
*   <g-emoji class="g-emoji" alias="rotating_light" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f6a8.png">ğŸš¨</g-emoji>å‹å¥½çš„é”™è¯¯è®°å½•ä½“éªŒâ€”â€”è¯­æ³•é«˜äº®æ˜¾ç¤ºçš„ä»£ç æ¡†æ¶æœ‰åŠ©äºæŸ¥æ˜é—®é¢˜ã€‚

* * *

ä¸‹é¢æ˜¯åœ¨ 2 å·åœ°å—å®æ–½å·¥ä½œå¼€å§‹ä¹‹å‰åˆ›å»ºçš„è®¾è®¡æ–‡ä»¶ï¼Œå…¶ä¸­ä¸€äº›ç« èŠ‚å·²ç»è¿‡æ—¶ã€‚2 å·åœ°å—çš„å®é™…(æœ‰äº›å®Œæ•´)æ–‡ä»¶å¯åœ¨æ­¤å¤„è·å¾—:[https://v2.parceljs.org/](https://v2.parceljs.org/)ã€‚

* * *

## å…¥é—¨æŒ‡å—

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦å®‰è£… Node and Yarn(æˆ– npm)å¹¶ä¸ºæ‚¨çš„é¡¹ç›®åˆ›å»ºä¸€ä¸ª`package.json`(å¦‚æœæ‚¨è¿˜æ²¡æœ‰è¿™æ ·åšçš„è¯)ã€‚

```
yarn init
```

Enter fullscreen mode Exit fullscreen mode

ç„¶åâ€¦

</article>

[View on GitHub](https://github.com/parcel-bundler/parcel)

[![Parcel Performance](../Images/a34920d4b634b579059a6d9202ae13bd.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--U3eEd5vM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/8ujt08n3fk4kzwnlffbw.png) 

<figure>

<figcaption>å›¾ 8:æ•´ä¸ªåº”ç”¨çš„æ„å»ºæˆªå›¾ã€‚åŒ…è£¹çš„é­”åŠ›ğŸ’¥</figcaption>

</figure>

å”¯ä¸€çš„ç¼ºç‚¹æ˜¯ï¼Œä¸ºäº†è®© Preact + Typescript ä¸­çš„[çƒ­é‡è£…](https://parceljs.org/hmr.html)ä¸º dev æœåŠ¡å™¨å·¥ä½œï¼Œæ‚¨å¿…é¡»å°†`module.hot.accept()`æ ‡å¿—æ·»åŠ åˆ°æ‚¨çš„æ ¹ç»„ä»¶ä¸­ï¼Œå¹¶åœ¨ render å‡½æ•°ä¸­æŒ‡å®šä¸€äº›ç±»å‹(ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º`foo.lastChild as Element`ï¼Œä»¥ä¾¿ Typescript ä¸ä¼šæŠ±æ€¨ã€‚å¯ä»¥åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­çœ‹åˆ°è¯¥ä¿®å¤ã€‚

```
import { h, render } from "preact";
import Main from "./components/main"

declare const module: any

const mountNode = document.getElementById('root');

render(<Main />, mountNode, mountNode.lastChild as Element);

// Hot Module Replacement
if (module.hot) {
    module.hot.accept();
} 
```

Enter fullscreen mode Exit fullscreen mode

* * *

### ç”¨ Jest +æœ¨å¶å¸ˆè¿›è¡Œå•å…ƒå’Œ e2e éªŒæ”¶æµ‹è¯•

æµ‹è¯•æ˜¯ä»»ä½•é¡¹ç›®ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸å½“æ ‡å‡†çš„ [Jest](https://jestjs.io/) æ¥[æµ‹è¯•æˆ‘ä»¬çš„ç»„ä»¶](https://jestjs.io/docs/en/tutorial-react)å’Œ[æœ¨å¶å¸ˆ](https://github.com/GoogleChrome/puppeteer)ï¼Œåè€…æ˜¯ä¸€ä¸ªç½‘é¡µæŠ“å–å™¨ï¼Œæˆ–è€…è®©ä½ è‡ªå·±è®­ç»ƒæœ‰ç´ çš„çŒ´å­æ‰§è¡Œä½ åœ¨æµè§ˆå™¨ä¸Šå‘Šè¯‰ä»–/å¥¹çš„æ“ä½œï¼Œæ¯”å¦‚å•å‡»æŸä¸ªæŒ‰é’®æˆ–åœ¨æŸä¸ªå…ƒç´ ä¸Šæ‹–åŠ¨é¼ æ ‡ã€‚ä½¿ç”¨è¿™äº›ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªæ— å¤´çš„ Chrome API åœ¨å‰ç«¯æ‰§è¡Œä¸€äº›æ“ä½œï¼Œç„¶åç”¨ Jest æ£€æŸ¥é¢„æœŸçš„ç»“æœï¼Œæ¯”å¦‚æ£€æŸ¥ç¡®è®¤å…ƒç´ æ˜¯å¦å‡ºç°æˆ–è€…æ˜¾ç¤ºçš„è­¦å‘Šæ¶ˆæ¯æ˜¯å¦æ­£ç¡®ğŸ‘Œã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå¦‚ä½•åœ¨ React ä¸­ä½¿ç”¨ Jest+puppet er è¿›è¡Œæµ‹è¯•çš„ä¿¡æ¯ï¼Œ[æœ‰ä¸€ç¯‡å…³äºå®ƒçš„æ–‡ç« ](https://blog.bitsrc.io/testing-your-react-app-with-puppeteer-and-jest-c72b3dfcde59)ã€‚

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png) [æœ¨å¶å¸ˆ](https://github.com/puppeteer) / [æœ¨å¶å¸ˆ](https://github.com/puppeteer/puppeteer)

### æ— å¤´ Chrome Node.js API

<article class="markdown-body entry-content container-lg" itemprop="text">

# æ“çºµæœ¨å¶çš„äºº

[![Build status](../Images/2adf3b28ac9a6dda27e57c57e0497aa6.png) ](https://github.com/puppeteer/puppeteer/actions?query=workflow%3Arun-checks) [ ![npm puppeteer package](../Images/406efc2eb0d1d17fbacf5b98148bd281.png)](https://npmjs.org/package/puppeteer)

[![](../Images/48ffbae0e7030b5a769ac5d7d281043a.png)T2ã€‘](https://user-images.githubusercontent.com/10379601/29446482-04f7036a-841f-11e7-9872-91d1fc2ea683.png)

###### [API](https://github.com/puppeteer/puppeteer/blob/v8.0.0/docs/api.md) | [FAQ](https://raw.githubusercontent.com/puppeteer/puppeteer/main/#faq) | [æŠ•ç¨¿](https://github.com/puppeteer/puppeteer/blob/main/CONTRIBUTING.md) | [æ•…éšœæ’é™¤](https://github.com/puppeteer/puppeteer/blob/main/docs/troubleshooting.md)

> Puppeteer æ˜¯ä¸€ä¸ªèŠ‚ç‚¹åº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜çº§ API æ¥æ§åˆ¶ Chrome æˆ–é€šè¿‡ [DevTools åè®®](https://chromedevtools.github.io/devtools-protocol/)çš„ Chromeã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ¨å¶å¸ˆè¿è¡Œ[æ— å¤´](https://developers.google.com/web/updates/2017/04/headless-chrome)ï¼Œä½†å¯ä»¥é…ç½®ä¸ºè¿è¡Œå…¨(éæ— å¤´)é“¬æˆ–é“¬ã€‚

###### æˆ‘èƒ½æ€ä¹ˆåšå‘¢ï¼Ÿ

å¤§å¤šæ•°ä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨å®Œæˆçš„äº‹æƒ…éƒ½å¯ä»¥ä½¿ç”¨æœ¨å¶å¸ˆæ¥å®Œæˆï¼è¿™é‡Œæœ‰å‡ ä¸ªä¾‹å­å¯ä»¥å¸®åŠ©ä½ å¼€å§‹:

*   ç”Ÿæˆé¡µé¢çš„æˆªå›¾å’Œ pdfã€‚
*   æŠ“å– SPA(å•é¡µåº”ç”¨ç¨‹åº)å¹¶ç”Ÿæˆé¢„å‘ˆç°å†…å®¹(å³â€œSSRâ€(æœåŠ¡å™¨ç«¯å‘ˆç°))ã€‚
*   è‡ªåŠ¨åŒ–è¡¨å•æäº¤ã€UI æµ‹è¯•ã€é”®ç›˜è¾“å…¥ç­‰ã€‚
*   åˆ›å»ºä¸€ä¸ªæœ€æ–°çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç¯å¢ƒã€‚ä½¿ç”¨æœ€æ–°çš„ JavaScript å’Œæµè§ˆå™¨åŠŸèƒ½ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬çš„ Chrome ä¸­ç›´æ¥è¿è¡Œæµ‹è¯•ã€‚
*   æ•è·ç«™ç‚¹çš„[æ—¶é—´è½´è·Ÿè¸ª](https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference)æ¥å¸®åŠ©è¯Šæ–­æ€§èƒ½é—®é¢˜ã€‚
*   æµ‹è¯• Chrome æ‰©å±•ã€‚

æ—‹è½¬ä¸€ä¸‹:[https://try-puppeteer.appspot.com/](https://try-puppeteer.appspot.com/)

## å…¥é—¨æŒ‡å—

### è£…ç½®

ä½¿ç”¨æœ¨å¶å¸ˆåœ¨ä½ çš„â€¦

</article>

[View on GitHub](https://github.com/puppeteer/puppeteer)

> è¿™åªæ˜¯ä¸€ä¸ªä½¿ç”¨ Jest æµ‹è¯•åˆ†é¡µç»„ä»¶çš„ä¾‹å­ã€‚

```
import { h, render } from 'preact';
import Pagination, {generateMidPageTabValues} from '../../src/components/pagination-component';

const spy = jest.fn()

describe("<Pagination /> e2e tests", () => {

  let scratch = null;
  let component = null;

  beforeEach(done => {
    scratch = document.createElement('div');
    render(<Pagination initialPage={1} ref={ref => component = ref} pageChange={(from, to) => spy(from, to)} totalItems={45}/>, scratch);
    done()
  });

  it("should display proper information about pages", () => {
    expect(scratch.innerHTML).toContain("Showing items 1 to 15 of 45");
  });
  it("shouldn't allow to decrease current page if we're on the first page", () => {
    expect(component.state.prevAllowed).toBe(false);
  });
  it("should properly increase current page", (done) => {
    component.pageForward();
    setTimeout(_ => {
      expect(scratch.innerHTML).toContain("Showing items 16 to 30 of 45");
      expect(spy).toHaveBeenLastCalledWith(15, 30);
      done();
    }, 1000);
  });
  it("Should correctly compute first page indices", () => {
    expect(generateMidPageTabValues(1,5,10)).toEqual([2,3,4,5,6]);
    expect(generateMidPageTabValues(4,5,10)).toEqual([2,3,4,5,6]);
  });
  it("Should correctly compute last page indices", () => {
    expect(generateMidPageTabValues(13,5,15)).toEqual([10,11,12,13,14]);
    expect(generateMidPageTabValues(11,5,15)).toEqual([10,11,12,13,14]);
  });
  it("Should correctly compute middle pages indices", () => {
    expect(generateMidPageTabValues(10,5,15)).toEqual([8,9,10,11,12]);
    expect(generateMidPageTabValues(7,5,15)).toEqual([5,6,7,8,9]);
  });
  it("Should correctly compute indices when few pages", () => {
    expect(generateMidPageTabValues(1,5,5)).toEqual([2,3,4]);
    expect(generateMidPageTabValues(2,5,3)).toEqual([2]);
    expect(generateMidPageTabValues(2,5,2)).toEqual([]);
    expect(generateMidPageTabValues(1,5,1)).toEqual([]);
  });
}); 
```

Enter fullscreen mode Exit fullscreen mode

ä½¿ç”¨ [Jenkins](https://jenkins.io/) è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²è¿‡ç¨‹ï¼Œæµ‹è¯•åœ¨ docker å®¹å™¨ä¸­è¿è¡Œï¼Œä»¥ä¾¿åœ¨å…·æœ‰ puppeteer æ‰€éœ€çš„æ‰€æœ‰å›¾å½¢åº“çš„ç¯å¢ƒä¸­æ‰§è¡Œæµ‹è¯•ã€‚åœ¨å›¾ 9 ä¸­å¯ä»¥çœ‹åˆ°**ç›¸å½“ç®€å•çš„**ç®¡é“:

[![Jenkins Pipeline](../Images/216c296af092bb7962d1e0934a656c68.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--d8T6raC6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jx50xsbtibzd11vgw9b1.png) 

<figure>

<figcaption>å›¾ 9:ç”¨äºéƒ¨ç½²å‰ç«¯çš„è©¹é‡‘æ–¯æµæ°´çº¿
</figcaption>

</figure>

> æˆ‘ä»¬æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰§è¡Œå•å…ƒæµ‹è¯•ï¼Œç„¶åéƒ¨ç½²åˆ°ä¸€ä¸ªæµ‹è¯•é¢†åŸŸï¼Œè¿™ä¸ªé¢†åŸŸæ ¹æ®æˆ‘ä»¬æ‰€åœ¨çš„ git åˆ†æ”¯è€Œå˜åŒ–ã€‚ç„¶åæˆ‘ä»¬åœ¨é‚£ä¸ªé¢†åœ°ä¸Šè¿›è¡Œ e2e æµ‹è¯•ã€‚

ç”¨äº Jenkins è¿è¡Œç®¡é“çš„å®¹å™¨çš„ docker æ˜ åƒæ˜¯[æœ¨å¶å¸ˆ Docker æ˜ åƒ](https://github.com/alekzonder/docker-puppeteer)çš„å®šåˆ¶ç‰ˆæœ¬ï¼ŒåŸºäºå¸¦æœ‰èŠ‚ç‚¹ 8 çš„ ubuntu 16.04 æ˜ åƒã€‚dockerfile æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤º: