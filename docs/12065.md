# 防御 Apache DoS 攻击

> 原文:[https://dev . to/ajar din/defining-against-Apache-dos-attacks-3jj](https://dev.to/ajardin/defending-against-apache-dos-attacks-3jj)

**拒绝服务** (DoS)攻击是一种网络攻击，其中有人试图通过向服务器发送大量请求来使网站或服务对其目标用户/客户不可用。它类似于分布式拒绝服务(DDoS)攻击，但最后一种攻击来自许多不同的来源。这使得攻击更加难以反击。

当我在为一个客户开发 AWS 基础设施时，我记得我们过去遇到过一些问题，因为不同的 SEO 人员并行运行多个爬虫程序来检查网站。他们的配置相当具有侵略性。甚至我们当时的主机提供商都认为这是一次攻击。

为了防止故事重演，我对 Apache 的 DoS 缓解做了一些研究。我最终发现了乔纳森·兹齐亚尔斯基在《T2》中的作品。这正是我所需要的:只需几行配置就可以添加的 Apache 模块。但后来，我意识到该模块与 Apache 2.4 不兼容。这就是为什么我决定[分叉他的作品](https://github.com/ajardin/mod_evasive)以使其兼容并改进一些东西。

## [](#how-it-works)工作原理

一个网络点击请求进来了。发生以下步骤。

*   在临时黑名单中查找请求者的 IP 地址。
*   请求者的 IP 地址和 URI 都被散列成一个“密钥”。在监听程序的内部哈希表中执行查找，以确定在过去 1 秒内同一主机是否多次请求此页面。
*   请求者的 IP 地址被散列成一个“密钥”。在侦听器的内部哈希表中执行查找，以确定同一主机在过去一秒钟内是否请求了超过 50 个对象(来自同一个子节点)。

如果上述任一情况属实，将发送 429 响应。在发生 DoS 攻击时，它可以节省带宽和系统资源。此外，还可以触发系统命令和/或电子邮件通知来阻止 DDoS 攻击的所有发起地址。

一旦单个 429 事件发生，mod _ evangelicate 现在会阻止整个 IP 地址 10 秒钟(可配置)。如果主机在此期间请求页面，它将被迫等待更长时间。由于这是通过每秒多次请求相同的 URL 来触发的，因此这也不会影响合法用户。

## [](#how-to-install)如何安装

1.  提取此档案
2.  运行`$APACHE_ROOT/bin/apxs -cia mod_evasive.c`
3.  该模块将被构建并安装到`$APACHE_ROOT/modules`中，并加载到您的`httpd.conf`中
4.  重启 Apache

## [](#how-to-configure)如何配置

mod _ avoidable 已经配置了默认选项，但是你也可以在你的`httpd.conf`中添加下面的块。