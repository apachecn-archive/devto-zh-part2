# 库柏码头

> 原文:# t0]https://dev . to/justtynte 女士/docker-to-kube-58 KF

如果我告诉你从 Docker 到 Kubernetes 的过渡需要一个下午的时间来无缝迁移容器，那我是在撒谎。

Kubernetes 迫使我放弃对 docker-compose 的热爱。我不得不重新思考我的容器编排。我将放弃我精心调整的 Nginx SSL 代理，采用“无服务器方法”。

### [](#serverless)无服务器

我从来没有真正理解过无服务器架构的好处。无服务器？真的吗？那是给懒人的，我想。我错了。

采用这种方法迫使我更深入地思考我的应用程序将如何与其数据和它所在的网络进行交互。我创建了一个不依赖任何外部数据运行的容器。我被多次告知不要在我的容器中包含 SSL 证书，但是，为了实现适当的伸缩，我现在这样做了。

### [](#scaling)缩放

当我完成创建我的无状态应用程序时，我在一个负载平衡器后面部署了它的三个实例。已经实现了适当的缩放。只需点击几下鼠标，我就可以运行多达一千个应用程序实例。这正是无服务器架构的设计目的。我的应用程序负载保持能力不再仅仅依赖于一台服务器，而是分布在美国各地的许多服务器

### [](#persistent-volumes)持久卷

通常，当使用 Docker 设置持久数据时，需要将持久卷安装到父服务器上。这使得创建和删除容器变得容易，而不用担心意外删除重要数据，这与 Google 云平台提供的功能相似。然而，重要的是要注意持久卷声明，Googles 的永久数据存储方法只能由单个容器一次以读/写权限访问。这意味着卷不能作为所有容器的 SSL 密钥的存储区域。虽然将 SSL 密钥保存在容器映像中通常不是一个好主意，但这是我针对这个问题想到的唯一解决方案。

持久卷与集群相关联。您可以删除工作负荷以及容器、网络和服务。但是，请务必注意，删除群集时，您将删除其所有对应的卷。

### [](#load-balancing-nginx)负载均衡/ Nginx

如前所述，NGINX 负载平衡并不像预期的那样工作。虽然通过一些适当的设置可能是可行的，但最简单的方法是使用 Google 提供的负载平衡器。我希望能够分享一些数据，说明我的应用程序如何能够处理压力测试带来的大量负载，但我不能报告这些数据，因为谷歌将自动流量检测为 DDOS 攻击，并阻止了大多数请求。所以我想这是负载平衡器的胜利

Google 云平台提供了几种方法来访问节点中的容器。可以创建一个直接链接，将节点上的一个端口暴露给外部源，但是，这缺乏 Kubernetes 所追求的可伸缩性和负载平衡。通常，负载平衡器用于处理请求，并将它们转发到正确的节点端口。负载平衡器将考虑资源，以及哪些节点由于健康检查而处于健康状态。

当第一次使用负载平衡器时，我试图在负载平衡器上处理 SSL/TLS。虽然这是可能的，但并不理想。Wordpress 将很难判断连接是否安全。这只是一个 SSL 反向代理背后的 WordPress 问题的例子。似乎更好的解决方案是按比例构建您的映像，在容器中处理安全握手，并让负载平衡器处理它的设计目的，即负载平衡。

### [](#costbenefit-analysis)成本效益分析

总的来说，我在谷歌云平台上的花费与我在专用服务器上的花费相同。如果预算允许的话，最终这可能会超出我的支出。虽然对于小型网络来说，您可能会更多地使用单个服务器，但是如果您希望扩展您的应用程序，那么使用 Kubernetes 引擎无疑是最好的方法。我不知道有任何应用程序支持 Kubernetes 引擎所做的扩展。

### [](#is-it-worth-it)值得吗？

如果你正在运行一个单一的静态网站，并且对 Kubernetes 的工作方式非常感兴趣，那么这是非常值得的。如果您正在运行几个开发项目，并且需要保持它们 24/7 运行并不断更新，那么需要注意的是 Kubernetes 需要时间来学习。即使保持相当简单，你也必须重新学习你用 Docker 做的一切。总的来说，我非常享受学习 Kubernetes 的时间，作为一名在该行业求职的人，如何使用 Kubernetes 这样的引擎扩展应用程序的知识对职业发展至关重要。Kubernetes 并没有真正影响小型项目爱好者，而是专注于如何应对相当大的应用程序的扩展挑战。

阅读更多...[http://nextwavesolutions.io/post/docker-to-kubes/](http://nextwavesolutions.io/post/docker-to-kubes/)