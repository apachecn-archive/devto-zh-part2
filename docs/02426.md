# 和辛纳屈一起建造城堡

> 原文:[https://dev . to/atx renegade/building-castles-with-Sinatra-4323](https://dev.to/atxrenegade/building-castles-with-sinatra-4323)

# [](#building-castles-with-sinatra)用辛纳屈建造城堡

### [](#the-maker)制造者

我本质上是一个创造者，每次我有机会建造一些东西时，我都有一种忘乎所以的倾向。我称之为“在只需要平房的地方建造城堡”综合症。学习构建 MVP(最小可行产品)对这种精细生产的趋势既有启发又有好处。不用说，这个项目是我第一次有机会凭空创造东西，我会从中得到乐趣。即使这意味着多花一两天(一两周)去做一些我引以为豪的事情。

### APP

我的愿景是实现我内心深处的东西，也是一段时间以来我一直大力鼓励身边的人参与的东西。我将我的应用程序称为早晚页面，简称为 AM/PM 页面。创建早晚网页是为了帮助用户记录并养成早晚仪式的习惯，包括意图设定、感恩和反思。

我设计它是为了鼓励和实现有意识的专注和重复的日常实践，以创造新的神经通路，引导有意识的生活，远离潜意识的反应。在我们匆忙的生活方式中，我们的注意力和焦点不断偏离我们的目标和意图，因为我们受到最新媒体驱动的恐惧和持续感知的对我们生存的威胁的轰炸。虽然技术在许多方面改善了我们的生活，但我相信它可以更有益地用于创造和发展对我们世界的正念和更健康的观点。

[![](../Images/7fcbce08a191d25d252a57c410084fd3.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--WX-l2q8F--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://github.com/atxrenegade/AM_PM_pages/blob/master/public/site_design_mockups/Screen%2520Shot%25202018-10-14%2520at%252010.04.56%2520AM.png%3Fraw%3Dtrue)

### [](#the-process)流程

所以更多关于应用程序。这一过程中我最喜欢的部分之一，是完全从零开始。零起点意味着我确切地知道我从哪里开始，并允许我创建一个流畅的系统化的一步一步地从头开始建设的方法(哈，至少在我的脑海中)。这使得我可以创建每个文件，编写每一行代码，除了我为 css 样式定制的一个小框架和 README.md 模板中的几行代码。我能够非常熟悉我的应用程序的每一部分。由于这是一个简单的 Sinatra 应用程序，使用模型视图控制器架构来实现 CRUD(创建读取更新删除)功能，我对这个过程感到相当满意，因为在整个 Sinatra 部分，我们被要求多次完成类似的项目。在经历了几次小的颠簸之后，我开始想当然地认为这个过程很容易，但我遇到了第一个路障/挑战。
下图反映的是 MVC 架构的基本结构。

[![](../Images/6d1bc5419bc3ea4f541de31a73e0e7e2.png)T5】](https://res.cloudinary.com/practicaldev/image/fetch/s--1I4VmaZs--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://smist08.files.wordpress.com/2013/11/mvc3.png)

## [](#speed-bumps-and-roadblocks)减速带和路障

#### [](#pluralization)复数化

我很早就遇到了第一个小问题，它暴露了一个关于活动记录多元化的问题，最终不得不在我的数据库和类名中进行更正。我心中的问题是“活动记录识别语法正确的复数吗？”我倾向于一个不太智能的系统，并创建了我的初始模型和表格，假设它不会。

如果我的数据库表名是 AM ENTRY，ActiveRecord 会识别:

AMEntrys 还是 AMEntries？
PMEntrys 还是 pmentry？由于 ActiveRecord 确实识别语法正确的复数形式，并且由于我过于谨慎，所以我必须更新我所有的类名和表名。很容易解决。总的来说，命名惯例对我来说是一个痛处，所以作为参考，我创建了一个表格来提醒自己，因为我似乎很痛苦地无法保留它们。
T8[T10](https://res.cloudinary.com/practicaldev/image/fetch/s--OnOHvf_H--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://github.com/atxrenegade/AM_PM_pages/blob/master/public/images/ActiveRecordNamingConventions.png%3Fraw%3Dtrue)T12】

#### [](#loading-controllers-in-alphabetical-order)按字母顺序加载控制器

虽然 ActiveRecord 足够智能，可以识别复数，但 Sinatra 不知道如何在所有其他程序之前自动加载 application_controller.rb。相反，它按字母顺序加载每个控制器，因为 A-P-P 通常是第一个加载的文件，在我的例子中，它没有出现在 A-M-E (AMEntriesController)之前。我花了几个小时对这种现象感到困惑，然后向部门领导 Howard DeVeenish 抛出了一条生命线，他通过要求在我的 AM Entries 控制器的顶部使用应用程序控制器来帮助我识别和纠正这个问题。

#### [](#model-architecture)模型架构

当谈到模型架构时，我不完全确定设计我的模型的最有效的方法。我的 am_entry 和 pm_entry 类有几个属性，其中许多属性是倍数。例如，在 AM 和 PM 条目中，我都有一个感恩的属性。有五行来输入和存储五个感恩项目。理想情况下，我会让每个属性本身成为一个模型，包含这些多个变量，以便于检索和交互 attribute - now 对象的每个实例。然而，对于我必须创建的模型/表格的数量来说，这将大大扩展这个项目，超出了练习的范围，我已经在努力将自己限制在足够小的范围内，以便在退休年龄之前毕业。在这种情况下，当只需要一间平房时，我能够限制自己建造一个公寓楼大小的项目，而不是城堡。

当构建我的模型时，我决定，为了超高效，我将在视图页面上按编号列出每个属性，然后将它们作为数组存储在数据库中它们的属性/列标题下。例如，视图页面将收集感恩[感恩 _1]、感恩[感恩 _2]、感恩[感恩 _3、感恩[感恩 _4]、感恩[感恩 _5]，我将压缩这些值，并将它们作为数组存储在数据库中。这导致了奇怪的无法识别的字符串，这些字符串带有额外的转义字符，我在检索数据时无法提取这些字符。这也导致检索和更新这些值的过程变得复杂。我了解到/被提醒说 SQL 不能识别或存储数组，最终我不得不承认每个属性的每次迭代都必须独立存储。例如，我的表没有反映包含五个感恩项目的感恩数组的名为“感恩”的列，而是为每个感恩项目保存一个名为“感恩 _1”、“感恩 _2”、“感恩 _3”、“感恩 _4”、“感恩 _5”的列。虽然感觉不像是最优雅的执行，但它确实创造了我正在寻找的功能。一百次迁移和修改之后，我的模型、视图和修改后的列名反映了我的新格式。

#### [](#recording-storing-and-formatting-date-and-time)记录、存储和格式化日期和时间

时间戳，日期线，时间格式，时间更新。这成了我最头疼的事。我的意图是在每个条目的顶部记录和显示一个简单的时间和日期标题，并根据这些数据组织条目索引。现在在我的表中是一个硬连线的日期，在我的模式中，每个条目都标有相同的日期和时间。此外，如果我编辑/更新了条目，它现在会显示条目更改的正确日期和时间，但分钟将始终显示在小时后 10 分钟。例如，如果是下午 5 点 22 分，它将记录下午 5 点 10 分，如果是凌晨 3 点 56 分，我将得到 3 点 10 分的时间。这是我的另一个生命线问题，在与技术教练和部门领导进行了几次调试后，我们能够纠正它。带有硬连线日期和时间的 created_at 错误已通过删除数据库并更改初始迁移以从 AM 和 PM 条目表的 created_at 列中删除默认值来解决。小时后 10 分钟的错误实际上是一个字母大写的结果，而这个字母应该是小写的。在我的时间和日期格式化方法中，我将分钟变量称为%M 而不是%m，因为%M 实际上代表月份，而不是分钟，并且月份是一年中的第 10 个月，这是我的小时后 10 分钟异常的原因。一个小小的打字错误造成了巨大的破坏！

## [](#the-extras)群众演员

#### [](#the-about-page)关于页面

在这里，我借此机会解释了我申请的用途和目的，同时也借此机会进行了充分的自我推销。我对这个应用程序的意图是让它在服务器上运行，让人们为自己的利益而使用。这是我学习的方式，同时贡献和创造价值…和晋升。

#### [](#styling-and-user-interface)造型和用户界面

我是一个视觉/逻辑型的人，我相信创造的东西看起来既令人愉快，又直观实用。我试图通过在每个页面上包含多个易于导航的按钮，在 CRUD 功能之间进行流畅的转换，来尽可能地反映这一点。关于样式，我找到了一个框架 css 模板，字面意思是“框架模板”。我定制修改了其中的 80%来适应我的设计愿景，把一些不必要的内容删掉了。我从网上公开来源获取图片和字体。

## [](#future-features-and-potential-improvements)未来的功能和潜在的改进

#### [](#improved-stylesheets-css-and-inline-style-elements)改进了样式表 css 和内嵌样式元素

因为这不是本练习的要求，而且我现在对修改样式表还不太适应。我没有在我的 css 样式表和视图页面中花费更多的时间来实现更好的编码实践。为了纠正这一点，我会花时间删除多余的内联样式元素，并使用特定的 css 选择器来定位我试图格式化的页面区域。从概念上讲，这是一个伟大的想法，但当我试图执行它时，我把我的视图页面弄得一团糟，并决定这不是我的 MVP 的一部分，我现在负担不起在它上面花费更多的时间。我可能会在以后纠正这一点。我还希望看到我的视图页面在各种大小的设备上正确显示，并添加适当的查询，以便在所有平台上获得一致的查看体验。

#### [](#live-and-online)直播和在线

我的最终目标是创建一个我感到自豪的投资组合项目，但也创造一些有用的，实时和在线的东西。当我这样做的时候，我会在这里添加实时应用程序地址。

#### [](#password-recovery)密码恢复

我确实找到了为 Rails 应用程序创建密码恢复过程的步骤。我不知道它是否适用于 Sinatra，但我想尝试将它作为一个功能添加到这个应用程序中。我将进一步探索这一点。

#### [](#background-randomizer)背景随机发生器

我确实尝试用两组不同的图像来实现这一点。一组令人惊叹的高清夜间图像作为下午页面的背景随机查看，另一组引人注目的白天场景作为上午页面的随机背景。这是一个有趣的概念，因为当我在我的项目中创建一个分支并测试一个来自堆栈溢出的移植时，我已经在我的脑海中计算出了多种变化，并得出结论，最简单的方法是根据 id 号选择图像，这取决于条目的 id 号。例如，如果创建的条目是 id 号为 22 的 AM 条目，这将导致 AM Images 文件夹中的背景图像号为 2。我确实发现了一个堆栈溢出的替代实现，在我写这篇文章的时候，我无法成功地将它合并到这个项目的一个分支上，但是我会继续努力。

#### [](#desktop-and-mobile-ready)桌面和移动就绪

如上所述，我想添加媒体查询，使这个应用程序移动和桌面准备就绪。

[![](../Images/6fed6609379535c300376c67daf7357d.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--0-2i7tTu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://webizrada.org/wp-content/uploads/2015/11/mobile-ready.jpg)

## [](#and-so-ive-concluded)所以我得出结论…

我很享受在一个应用程序中使用我所有的新技能和知识进行创作的机会。它真正揭示了我还没有完全掌握的领域，我记得不正确的语法，并巩固了我之前可能没有信心的概念。我是一个真正的动手学习者，在这个项目之后，我真的相信，通过创建和完成一个程序员自己的激情项目，一个人将学习和受益最多。

这个应用程序的演示可以在:
[https://youtu.be/K0f1uj3QtrU](https://youtu.be/K0f1uj3QtrU)找到

atx renegade/ha Leigh Abel