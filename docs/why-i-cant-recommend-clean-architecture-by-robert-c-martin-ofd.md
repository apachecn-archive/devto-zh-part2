# 清洁建筑为什么我不能推荐罗伯特·C·马丁的《清洁建筑》

> 原文：<https://dev.to/bosepchuk/why-i-cant-recommend-clean-architecture-by-robert-c-martin-ofd>

*Clean Architecture* 在很多方面都没有达到我的期望。尽管马丁先生对这个话题有着明显的热情，但是*的清洁架构*组织得很差，缺乏实例，并且对现有系统的工作保持沉默。作者错过了一个重要的机会来教导我们何时以及如何将这些经验应用到我们自己的系统中。让我解释一下。

### *干净的建筑*是一本条理不清的书

这本书要花很长时间才能出版。关于设计范例(结构化的、面向对象的和功能性的)的章节似乎特别不合适，也没有必要。

坚实的原则的章节是好的。我喜欢看到这些原则被分解并被很好地解释。我发现思考它们对系统架构的适用性很有趣。但是鲍勃叔叔提出了坚实的原则，就像硬性规定一样，这让我很不爽。事实上，我很确定一个*从不违反坚实原则的系统会是一个巨大的混乱。*

 *然而，第 137 页的这一段很重要:

> 架构的主要目的是支持系统的生命周期。好的架构使得系统易于理解、易于开发、易于维护、易于部署。最终目标是最小化系统的生命周期成本，最大化程序员的生产力。

这是一个伟大的观察。鲍勃叔叔为什么不把它放在第一章？

### 例子不够多

这本书里几乎没有例子。第 33 章包含一个讨论视频销售电子商务应用的例子。没事的。但是我并没有带着如何将这些概念应用到我自己的系统的坚定想法离开它。

附录讲述了 Bob 叔叔如何提出干净建筑的坚实原则和规则的故事。里面有过去项目的例子。我认为这是这本书最有趣的部分。

### 这本书没有提到如何改进现有系统的架构

大多数开发人员将大部分时间花在现有系统上。所以，我期望 *[干净的架构](https://www.amazon.com/Clean-Architecture-Craftsmans-Software-Structure/dp/0134494164/)* 充满了改进现有系统的建议。但是这本书在这个问题上明显保持沉默。

### 如何打造干净的架构？

在本书的前半部分，您将了解到，通过遵循坚实的原则，沿着系统边界将系统分解成组件，您可以创建一个干净的架构(我是在解释)。如果你停止阅读，你可能会有这样的印象，鲍勃叔叔不会赞成你为建筑所做的一切。如果你认为他提出的几个选项是做事的“正确”方式，这也是可以原谅的。然而在书的结尾，你会在 228 页读到:

> 这个例子旨在表明架构边界无处不在。作为架构师，我们必须小心识别何时需要它们。我们还必须意识到，这种界限在完全实施时是昂贵的。
> 
> 与此同时，我们必须认识到，当这样的界限被忽略时，即使存在全面的测试套件和重构规程，以后添加它们也是非常昂贵的。
> 
> 那么我们建筑师该怎么办呢？答案令人不满意。一方面，多年来，一些非常聪明的人告诉我们，我们不应该预见抽象的需要。这是 YAGNI 的哲学:“你不需要它。”这条信息中蕴含着智慧，因为过度设计往往比设计不足糟糕得多。另一方面，当您发现您确实需要一个不存在的架构边界时，添加这样一个边界的成本和风险会非常高。
> 
> 所以你有它。o 软件架构师，你必须看到未来。你必须聪明地猜测。您必须权衡成本并确定架构边界在哪里，哪些应该完全实现，哪些应该部分实现，哪些应该忽略。

所以在这本书的一半以上，他说，这是由我们来决定，我们应该把我们的系统的边界放在哪里。边界可能无处不在。很困惑，对吧？

### 这本书缺少什么

所以，如果软件架构的最终目标是最小化系统的生命周期成本，那么一本关于架构的书不应该帮助架构师做出这些决定吗？

#### 未解答的问题

这本书给我留下了许多未解之谜。各种选择的经济学讨论在哪里？如何为我的系统找到最佳架构？研究在哪里？

[![unanswered questions](../Images/3f92416e4ddf05511bfbef9f27b7d6cb.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--VSoeft3K--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fll25irsu1xbd0268kq2.jpg)

我如何决定水平分层或垂直切片或其他方式是否会最小化我的系统的生命周期成本？或者，如果我没有明确定义的层，我如何决定哪种分层策略(如果有的话)将最小化我的生命周期成本？

我有更多的问题。如果您有有限的时间来改进现有系统的架构，您应该将精力放在哪里？将数据库与业务逻辑分离总是一个好主意吗？你应该永远遵循哪条建议？哪些建议取决于系统？

#### 使*清洁建筑*更有价值的  细节

在 *[Code Complete](https://www.amazon.com/Code-Complete-Practical-Handbook-Construction/dp/0735619670/)* 中，Steve McConnell 谈到了不同非功能性需求之间的权衡，如可靠性、可信性、正确性、可维护性、可读性等。他解释了一些需求如何一起移动，而另一些需求如何冲突。我很想看到这本书里讨论的架构决策也是如此。

在 *Clean Architecture* 中，项目规模、团队规模、项目失败的后果、预期的代码生命周期以及其他重要因素作为架构的驱动因素没有得到足够的重视。例如，Healthcare.gov 需要比你正在开发的个人待办事项清单更多的架构，尽管它们都是由数据库支持的网络应用。

### 这本书真正讲的是什么

这本书的大部分时间我都有点困惑。我有点明白鲍勃叔叔想说什么了。但直到我看了附录才完全明白。所以，让我为你节省一些时间。

#### 举个例子

假设您正在为消费市场构建一台台式计算机(例如办公室计算机)。你要选择硬件，你要为所有的东西编写软件(固件、操作系统、驱动程序、应用程序等等)。

#### 你会写一个独石吗？

你会怎么做？你会写一个巨大的程序(一个庞然大物)让电子表格的代码知道你为你的计算机选择的磁盘种类吗？您能想象更新电子表格代码并到处添加“if”语句，这样，如果您有 SATA 驱动器，它会做一件事，如果您有 SCSI 驱动器，它会做另一件事吗？然后对 VGA vs DVI vs HDMI 视频做同样的事情？PS/2 与 USB 鼠标输入的不同路径呢？然后对文字处理软件和所有其他你想和电脑捆绑在一起的应用程序重复这个过程？

这将是一场噩梦，对不对？那么解决办法是什么呢？建筑！您的电子表格不应该知道您使用的是哪种鼠标。也不知道你有什么样的显示器。它应该完全忘记那些细节。

#### 你电脑中的界限

如果你看看你的电脑，你会发现这一点。你的鼠标里有一个嵌入式软件，可以和你的操作系统进行通信。然而，这些细节对你的应用程序是隐藏的。您的电子表格接受标准化输入，而无需知道或关心您使用的是哪种鼠标。然后，当有人发明了像触摸板这样的新输入设备时，它会自动处理你的电子表格。

那只是你电脑的一个界限。你可能会想出数百个。您可以分配不同的团队来处理系统的不同部分。您可以为不同组件的各种交互方式创建或采用不同的规范。

此时你可能会说“咄”。很明显，您不希望每次硬件发生变化时都要更改和重新编译电子表格。维护将是一场噩梦。我同意。

#### 界限是你的朋友(如果你正确使用它们)

很容易看出硬件界限。但是使硬件边界有价值的逻辑同样适用于软件边界。软件边界只是更难看到。

因此，您可以从在屏幕上显示电子表格的能力开始。但是您可能还想将它保存到磁盘、保存到 PDF、保存为 CSV 或打印出来。所以，也许你的电子表格程序的一个界限是有一个代表每个电子表格的内部数据结构。然后将该结构传递给不同的代码，以所需的格式显示、保存或打印它。

如果您完全不知道数据结构是如何显示、保存或打印的，那么您可以添加一个“保存到 XML”特性，而不必深入研究与电子表格数据结构相关的所有代码。如果电子表格数据结构有几百万行代码，你可以想象那会有多简单。

这就是鲍勃叔叔在这本书里试图告诉我们的一切。**您可以使用可靠的原则在您的系统中创建边界，隐藏您的实施细节，降低复杂性，并帮助您降低系统的总生命周期成本**。

### 一本更好的软件架构书

在很多方面，马丁·福勒的企业应用架构 的 *[模式远远优于*的*。Fowler 描述了他在企业应用程序中反复观察到的模式。他给出了每个模式的简单例子，描述了它是如何工作的，以及在哪里使用它。我发现*企业应用架构*的模式非常易读，并且适用于我的系统。](https://www.amazon.com/Patterns-Enterprise-Application-Architecture-Martin/dp/0321127420/)*

### 外卖

在*干净的架构*中有有价值的信息，但是你必须努力去发现它。

我发现关于嵌入式软件的那一章是最容易理解的一章。直觉上，避免将低级调用分散到整个代码库中是有意义的。在没有硬件的情况下，使您的逻辑可测试也是有意义的(特别是因为嵌入式软件通常是在硬件可用之前开发的)。如果你只能读这本书的两章，我会推荐你把这本书和附录一起读，不管你以写什么样的软件为生。

总的来说, *Clean Architecture* 是一本难读的书，鲍勃叔叔留给我的问题比答案还多。我绝对不会推荐这本书作为你关于软件架构的第一本书(看看马丁·福勒的《企业应用架构的】)。

*同意或不同意。我很想听听你的想法。*

喜欢这篇文章吗？请在下面“点赞”。*