# ğŸš©Vuex æ¨¡å¼:æ™ºèƒ½æ¨¡å—æ³¨å†Œ

> åŸæ–‡:[https://dev . to/nko ik/-vuex-pattern-smart-module-registration-15cc](https://dev.to/nkoik/-vuex-pattern-smart-module-registration-15gc)

Vue ç»å†:âš«ï¸âš«ï¸âš«ï¸âš«ï¸âšªï¸
Vuex ç»å†:âš«ï¸âš«ï¸âš«ï¸âš«ï¸âš«ï¸

æ‚¨æ˜¯å¦å°è¯•è¿‡ç®¡ç†çš„åº”ç”¨ç¨‹åºçŠ¶æ€ï¼Ÿç”±äºåˆ†æ•£åœ¨è®¸å¤šç»„ä»¶ä¸­çš„å¤šç§çŠ¶æ€ä»¥åŠå®ƒä»¬ä¹‹é—´çš„äº¤äº’ï¼Œå¤§å‹åº”ç”¨ç¨‹åºçš„å¤æ‚æ€§é€šå¸¸ä¼šå¢åŠ ã€‚æ‰€ä»¥ï¼ŒVue æä¾›äº† **Vuex** ä½†æ˜¯æ­£å¦‚å®˜æ–¹[æ–‡ä»¶](https://vuex.vuejs.org/guide/modules.html)æ‰€è¯´:

> Vuex ä½¿ç”¨å•ä¸€çš„çŠ¶æ€æ ‘ï¼Œæˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æ‰€æœ‰çŠ¶æ€éƒ½åŒ…å«åœ¨ä¸€ä¸ªå¤§å¯¹è±¡ä¸­ã€‚ç„¶è€Œï¼Œéšç€æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè§„æ¨¡çš„å¢é•¿ï¼Œå•†åº—ä¼šå˜å¾—éå¸¸è‡ƒè‚¿ã€‚

ä¸ºæ­¤ï¼ŒVuex å…è®¸æˆ‘ä»¬å°†å•†åœºåˆ†æˆå¤šä¸ªæ¨¡å—ã€‚æ¯ä¸ªæ¨¡å—å¯ä»¥åŒ…å«è‡ªå·±çš„çŠ¶æ€ã€çªå˜ã€åŠ¨ä½œã€gettersï¼Œç”šè‡³åµŒå¥—æ¨¡å—ã€‚

* * *

æˆ‘æƒ³ä½ å·²ç»è¢«å¼„ç³Šæ¶‚äº†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¿›å…¥ä»£ç ã€‚

```
# This is a classic store structure with modules
â”œâ”€â”€ index.html
â”œâ”€â”€ main.js
â”œâ”€â”€ components
â””â”€â”€ store
    â”œâ”€â”€ index.js    # where we assemble modules and export the store
    â””â”€â”€ modules
        â”œâ”€â”€ auth.js
        â”œâ”€â”€ posts.js
        â””â”€â”€ comments.js 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¸¦æœ‰`index.js`çš„å­˜å‚¨æ–‡ä»¶å¤¹å’Œä¸€ä¸ªåä¸º`modules`çš„å­æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰æ¨¡å—ã€‚ä½†æ˜¯æ¨¡å—æ³¨å†Œä¼šå˜å¾—å¾ˆä¹å‘³ã€‚
`index.js`ä¸­çš„`store/`

```
import Vue from 'vue'
import Vuex from 'vuex'
import auth from './modules/auth'
import posts from './modules/posts'
import comments from './modules/comments'
// ...

Vue.use(Vuex)
export default new Vuex.Store({
    modules: {
        auth,
        posts,
        comments,
        // ...
    }
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Vuex æ¨¡å—è„šæ‰‹æ¶ç¤ºä¾‹ã€‚

```
export default {
  namespaced: true,
  state: {},
  getters: {},
  mutations: {},
  actions: {}
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯æ³¨å†Œæ¨¡å—çš„æ ‡å‡†æ–¹å¼ã€‚å¦‚æœä½ çŸ¥é“ä»€ä¹ˆæ˜¯å‘½åç©ºé—´ï¼Œç»§ç»­ã€‚

> é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…çš„åŠ¨ä½œã€å˜å¼‚å’Œ getters ä»ç„¶æ³¨å†Œåœ¨å…¨å±€åç§°ç©ºé—´ä¸‹â€”â€”è¿™å…è®¸å¤šä¸ªæ¨¡å—å¯¹ç›¸åŒçš„å˜å¼‚/åŠ¨ä½œç±»å‹åšå‡ºååº”ã€‚
> å¦‚æœä½ å¸Œæœ›ä½ çš„æ¨¡å—æ›´åŠ ç‹¬ç«‹æˆ–è€…å¯é‡ç”¨ï¼Œä½ å¯ä»¥ç”¨`namespaced: true`æŠŠå®ƒæ ‡è®°ä¸ºå‘½åç©ºé—´

è®©æˆ‘ä»¬çœ‹çœ‹ Chris Fritz(Vue æ ¸å¿ƒæˆå‘˜)åœ¨ä¸€ç¯‡ VueConf ä¸­æåˆ°çš„æ¨¡å—æ³¨å†Œã€‚

ğŸš©é¦–å…ˆï¼Œè®©æˆ‘ä»¬åœ¨`store/modules/`
ä¸­æ·»åŠ ä¸€ä¸ª`index.js`æ–‡ä»¶

```
# This is our store structure with modules
â”œâ”€â”€ index.html
â”œâ”€â”€ main.js
â”œâ”€â”€ components
â””â”€â”€ store
    â”œâ”€â”€ index.js      # where we assemble modules and export the store
    â””â”€â”€ modules
        â”œâ”€â”€ index.js  # this is the js file that solves the problem
        â”œâ”€â”€ auth.js
        â”œâ”€â”€ posts.js
        â””â”€â”€ comments.js 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸš©é‚£æˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹`store/modules/index.js`
ä¸­çš„è¿™ä¸ª`index.js`

```
import camelCase from 'lodash/camelCase'
// Storing in variable a context with all files in this folder
// ending with `.js`.
const requireModule = require.context('.', false, /\.js$/)
const modules = {}

requireModule.keys().forEach(fileName => {
    if (fileName === './index.js') return
    // filter fullstops and extension 
  // and return a camel-case name for the file
    const moduleName = camelCase(
        fileName.replace(/(\.\/|\.js)/g, '')
    )
  // create a dynamic object with all modules
    modules[moduleName] = {
    // add namespace here
        namespaced: true,
        ...requireModule(fileName).default
    // if you have exported the object with name in the module `js` file
    // e.g., export const name = {};
    // uncomment this line and comment the above
        // ...requireModule(fileName)[moduleName]
    }
})
export default modules 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸš©è®©æˆ‘ä»¬ä»æ¯ä¸ªæ¨¡å— js æ–‡ä»¶ä¸­åˆ é™¤å‘½åç©ºé—´ã€‚

```
// export const name = { if you want to export an object with name
export default {
  // namespaced: true,   delete this line 
    state: {},
    getters: {},
    mutations: {},
    actions: {}
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸš©æœ€åæ˜¯ä¸Šé¢çš„ä»£ç ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æŠŠæ‰€æœ‰è¦å¯¼å…¥çš„æ¨¡å—éƒ½å¯ä»¥æ”¹æˆ:`store/`ä¸­çš„
`index.js`ä¸­çš„

```
import Vue from 'vue'
import Vuex from 'vuex'
import modules from './modules'

Vue.use(Vuex)
export default new Vuex.Store({
    modules
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘è®¤ä¸ºæˆ‘ä»¬å·²ç»åšäº†ä¸€ä¸ªâ€œè‡ªåŠ¨åŒ–â€ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ¨¡å—æ–‡ä»¶å¤¹ä¸­çš„æ¯ä¸ªæ–‡ä»¶ã€‚æ›´æ™ºèƒ½ã€æ›´å¹²å‡€çš„ä»£ç ã€‚

*ç›´åˆ°ä¸‹æ¬¡...ç¼–ç å¿«ä¹ï¼*