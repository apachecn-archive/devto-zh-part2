# 开发人员对单元测试的看法

> 原文：<https://dev.to/kayis/the-devtos-opinion-about-unit-tests-1md2>

大约一个月前，[我开始了一场关于单元测试](https://dev.to/kayis/what-are-the-alternatives-to-unit-tests-2jii)的广受欢迎的讨论。人们对他们的看法，以及他们如何帮助他们设计系统或修复 bug。

## 回应

总的来说，回答是支持 unti-test 或者至少总体上支持自动化测试。一些人甚至提倡将测试驱动开发作为他们软件设计的重要部分。

只有少数人没有编写单元测试，对我来说，他们都像是高级开发人员，没有感觉单元测试会帮助他们解决当前问题的人。

我也有这样的印象，虽然许多人编写单元测试，但是他们以不同的方式使用它们。当然，他们检查他们代码的一小部分，他们检查它以确保某种质量，但是方法似乎不同。

## 两个主要群体

对我来说，似乎有两个主要群体。从测试开始的人和后来添加的人。

### 测试驱动开发

有些人使用 TDD 来设计他们的*单元*，他们考虑如何使用他们代码的一部分，写一堆反映期望行为的测试，然后他们实现被测试的代码部分，直到测试停止失败。

其他人也使用 TDD，但是他们发现编写“好的”测试是错误的方法。他们知道他们的代码需要做什么，以及他们以后想要如何使用它，那么为什么还要为它编写测试呢？相反，他们为边缘情况编写测试，并在得到错误数据时查看他们的代码是否失败。

甚至还有人说，TDD 就是 TDD。比如，如果你以某种方式编写单元测试，那么你就是在进行 TDD。

所有这些方法都有相似之处，它们构成了代码的结构。如果你想进行 TDD，你需要以一种允许从外部访问测试单元的方式编写你的代码。

有了 TDD，你的代码可能会变得更加模块化，比没有它时有更好的封装。

仍然有人可能会争辩说，为测试而不是 had 的真正问题构建代码不应该是目标，另一方面，如果你用可靠的原则编写代码，你也会得到容易测试的代码，所以也许可靠和 TDD 只是一个硬币的两面？

我认为这就是为什么一些高级开发人员看不到 TDD 的价值，他们认为它没有给他们已经编写的代码增加任何东西。

但是有很多高级开发人员从事 TDD，因为这是一种无需思考就能实施坚实原则的更简单的方法。您编写您的测试，然后您的代码，可以很好地保存产生的代码相当好，同时您有足够的精神容量留给项目的其他问题。

### Bug 驱动测试

让我们称下一种开发人员为*错误驱动测试人员* (BDT)。他们在没有任何自动化测试的情况下编写他们的软件，后来，当手工测试人员或生产用户报告一些错误时，他们跟踪错误并编写一个最小的测试用例来重现该错误。后来他们修好了它，所以测试通过了。

有些人说，他们只为讨厌的错误或难以人工复制的错误编写这样的测试。

有些人说他们会永远保留测试，有些人说，如果一年内错误没有出现，就删除测试。因为如果你为每一个 bug 写一个测试，几年后你可能会有成百上千的 bug，这会大大降低 CI/CD 过程的速度。

但是这里的一般思想是，设计你的代码，并在它失败时添加测试。不要把测试作为核心设计实践，而是作为增强你已经设计好的东西的一种方式。

## 变异测试

现有的测试实践也有一些变化。他们可以帮助那些没有编写好的测试的经验，也不想让糟糕的代码混杂在他们的代码库中的人。

### 基于属性的测试

另一种方法来自 FP。这被称为基于属性的测试，并且似乎允许混合上面提到的两种 TDD 方法。

这个想法是，您静态地输入您想要测试的代码单元。然后，您编写一个测试，将一些数据放入您的代码中，但不是像普通测试那样编写，而是使用一个属性测试框架来编写，该框架根据您允许的类型来计算代码的所有可能输入。

代替为几个整数编写测试，你编写“整数测试”,框架为你生成所有的整数。这允许你为代码中好的部分编写单元测试，并动态地为(可能的)*坏的部分*添加测试。

### 突变基础测试

一般来说，独立于 TDD 或 BDT 的测试的主要思想是，如果你的代码出错了，你的测试应该反映出来。

基于突变的测试会破坏你的代码，看看你的测试是否还能通过。

它*改变*你想要测试的代码单元，删除一些返回语句，改变一些变量，等等。过去分词（past participle 的缩写）

如果你的测试没有失败，要么是变化不是关键的*要么是*测试也会让你在以后遇到真正的问题时失败。

## 我的测试实践

我仍然不满意我的测试实践。

在我的上一个小项目中，我尝试了 TDD 方法，感觉它不会增加任何东西，但是在我看来，有些问题通常不会导致单元测试。可悲的是，这些问题是唯一剩下的，使我的发展生活很难。

我试图在 TDD 的帮助下编写一个 API 客户端，但是由于客户端依赖于 API，所以测试没有多大帮助。我嘲笑了 API，在完成所有工作后，我感觉非常好，但是当我稍后使用客户端时，它马上就失败了，因为 API 需要一些没有指定的额外数据。

我知道这不是 TDD 的问题，许多人甚至写道，你不应该仅仅为了运行单元测试而模仿某些东西，但是，集成 API 是我主要关心的一个问题，所以我还是尝试了，:D

可能集成测试是这里的一条路，但是通常你没有不同的 API 阶段，只有*生产* API，你不想让它与你的测试调用混杂在一起，所以模仿看起来是一个不错的方法。

也许我甚至做对了每一件事，问题是糟糕的指定 API，但是正如我所说的，通常你不能在这里选择。

我还经常遇到 React-Native UI 组件在库更新后看起来不一样的问题。不知道 snapshop 测试是否有帮助，或者这只是一个设备问题？我有一种感觉，如果一个库破坏了一个组件，他们只会有所帮助，而不是让它变得丑陋，哈哈。

## 是否进行单元测试？

我想:大概是的？

我真的很想喜欢它，很多人，大多数比我聪明的人都喜欢它，所以我觉得自己像一个无知或愚蠢的人。