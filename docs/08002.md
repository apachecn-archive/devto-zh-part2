# ä½ å¯èƒ½ä¸çŸ¥é“çš„ 3 ä¸ªç§˜è¯€

> åŸæ–‡:[https://dev . to/kev Cui/3-mitmproy-tips-you-may-not-know-about-5d BG](https://dev.to/kevcui/3-mitmproxy-tips-you-might-not-know-about-5dbg)

[![coverimage](../Images/85f157cf0757d694460a6bae64b617f4.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--xacUQW4h--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1000/1%2AaleslIm6g3NqRL1xLQ3w5g.jpeg) <sup>*ç…§ç‰‡ç”±[é˜¿ä»€å·´å…¹](https://unsplash.com/photos/betmVWGYcLY)*</sup> 

mitmproxy æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä»£ç†å·¥å…·ï¼Œç”¨äºè°ƒè¯•ç½‘ç»œè¯·æ±‚å’Œå“åº”ã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä»£ç†å·¥å…·ï¼Œå¹¶æˆä¸ºæˆ‘æ—¥å¸¸å·¥ä½œçš„å¿…å¤‡å·¥å…·ä¹‹ä¸€ã€‚æˆ‘æƒ³å’Œä½ åˆ†äº« 3 ä¸ªä½ å¯èƒ½ä¸çŸ¥é“çš„ç§˜è¯€ã€‚

é¦–å…ˆï¼Œä¸€ä¸ªå°æ¸…å•:

*   ä½ çŸ¥é“ mitmproxy æ˜¯æ€ä¹ˆå·¥ä½œçš„å—ï¼Ÿ
*   ä½ çŸ¥é“å¦‚ä½•å®‰è£… mitmproxy å—ï¼Ÿ
*   ä½ çŸ¥é“å¦‚ä½•åœ¨å®¢æˆ·ç«¯å®‰è£… CA è¯ä¹¦å—ï¼Ÿ

å¦‚æœè¿™äº›é—®é¢˜å¯¹ä½ æ¥è¯´å¤ªç®€å•äº†ï¼Œè€Œä½ çš„ç­”æ¡ˆæ˜¯â€œæ˜¯çš„ï¼æ˜¯å•Šï¼æ˜¯å•Šï¼â€ï¼Œç„¶åç»§ç»­é˜…è¯»ã€‚å¦åˆ™ï¼Œè¯·ç‚¹å‡»å¹¶é˜…è¯»ä¸Šé¢çš„é“¾æ¥ï¼Œç¨åå†è§ã€‚

### æŠ€å·§ 1:è‡ªå®šä¹‰é…ç½®å’ŒæŒ‰é”®ç»‘å®š

mitmproxy çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯é«˜åº¦å¯å®šåˆ¶ã€‚è®¾ç½®ä¸€æ¬¡é…ç½®ï¼Œæ¯æ¬¡ mitmproxy å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½å®ƒä»¬ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„ã€‚æ‰€æœ‰å¯ç”¨çš„ä¾¿åˆ©é€‰é¡¹**éƒ½åœ¨ [mitmproxy æ–‡ä»¶](https://docs.mitmproxy.org/stable/concepts-options/)ä¸­ã€‚è¿™æ˜¯æˆ‘çš„`~/.mitmproxy/config.yaml` :** 

```
console_palette: "dark"
console_palette_transparent: True
console_mouse: False
console_focus_follow: True
ignore_hosts: [] 
```

Enter fullscreen mode Exit fullscreen mode

ç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯ [colemak é”®ç›˜å¸ƒå±€](https://dev.to/kevcui/one-week-with-colemak-482c-temp-slug-2571522)ï¼Œ *j* å’Œ *k* é”®æ˜¯ç›¸åçš„ï¼Œç”¨äºåœ¨ mitmproxy ä¸­ä¸Šä¸‹å¯¼èˆªã€‚æˆ‘å¿…é¡»æ”¹å˜è¿™ä¸¤ä¸ªé”®ï¼Œä½¿å¯¼èˆªé¡ºç•…ã€‚ä»¥å‰ï¼Œè¦æ›´æ”¹æ—§ç‰ˆæœ¬ä¸­çš„é”®ç»‘å®šï¼Œæˆ‘å¿…é¡»ä¿®æ”¹`defaultkeys.py`ä¸­çš„ä»£ç ã€‚ä» [mitmproxy v4.0](https://mitmproxy.org/posts/releases/mitmproxy4/) å¼€å§‹ï¼Œç»ˆäºæ­£å¼æ”¯æŒè‡ªå®šä¹‰é”®ç»‘å®šäº†ï¼ä»¥ä¸‹æ˜¯æˆ‘åœ¨`~/.mitmproxy/keys.yaml` :
ä¸­çš„æŒ‰é”®ç»‘å®š

```
-
  key: j
  ctx: ["global"]
  cmd: console.nav.up
-
  key: k
  ctx: ["global"]
  cmd: console.nav.down
-
  key: l
  ctx: ["flowlist"]
  cmd: console.nav.select 
```

Enter fullscreen mode Exit fullscreen mode

è¦äº†è§£åœ¨ **cmd** å­—æ®µä¸­ä½¿ç”¨å“ªä¸ª**å‘½ä»¤**ï¼Œè¯·åœ¨ mitmproxy ä¸­é”®å…¥`K` (shift + k)ã€‚å°†æ˜¾ç¤ºå½“å‰é”®ç»‘å®šåˆ—è¡¨ã€‚å…³äºå¯†é’¥ç»‘å®šé…ç½®çš„æ›´å¤šä¿¡æ¯åœ¨ [mitmproxy æ–‡æ¡£](https://docs.mitmproxy.org/stable/tools-mitmproxy/)ä¸­ã€‚

### æç¤º 2:åº”ç”¨è¿‡æ»¤å™¨æ—¶äº†è§£å®¢æˆ·ç«¯è¿æ¥çŠ¶æ€

æˆ‘ç»å¸¸é‡åˆ°è¿™ç§æƒ…å†µ:å½“æˆ‘é¢„å…ˆåº”ç”¨äº†æ‰€æœ‰è¿‡æ»¤å™¨ï¼Œç„¶åè¯•å›¾å°†ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ° mitmproxy æ—¶ã€‚ä½†æ˜¯ï¼Œæµåˆ—è¡¨ä¸­æ²¡æœ‰æ˜¾ç¤ºä»»ä½•å†…å®¹ã€‚æˆ‘å¦‚ä½•çŸ¥é“æ˜¯å› ä¸º*å®¢æˆ·ç«¯æ²¡æœ‰æˆåŠŸè¿æ¥åˆ°ä»£ç†*è¿˜æ˜¯*æ²¡æœ‰è¯·æ±‚åŒ¹é…è¿‡æ»¤å™¨*ï¼Ÿ

ä¸€ç§å¸¸è§ä½†ä¸å¤ªå¥½çš„æ–¹æ³•:å—¯ï¼Œæˆ‘å¿…é¡»ç§»é™¤è¿‡æ»¤å™¨æ‰èƒ½çœ‹åˆ°æ‰€æœ‰è¯·æ±‚ã€‚å¦‚æœæˆ‘å¯ä»¥çœ‹åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘å°†å†æ¬¡åº”ç”¨è¿‡æ»¤å™¨â€¦

ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯åœ¨è¿‡æ»¤å™¨ä¸­æ·»åŠ `| .*`ï¼Œè¿™å°†æ˜¾ç¤ºæ‰€æœ‰ä¼ å…¥çš„è¯·æ±‚ã€‚æ˜¯çš„ï¼Œæ­£åˆ™è¡¨è¾¾å¼é­”æœ¯:

[æ‰“å¼€](https://kevcui.github.io/videos/mitmproxy-filter-on.svg)ä¸Šçš„æ»¤è‰²é•œ

å¦ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ç®€å•åœ°è¾“å…¥`E` (shift+e)ï¼Œè¿™å°†æ‰“å¼€äº‹ä»¶æ—¥å¿—ã€‚å®ƒæ˜¾ç¤ºå®¢æˆ·ç«¯è¿æ¥çŠ¶æ€ã€‚ä½¿ç”¨`q`é€€å‡ºäº‹ä»¶è§†å›¾:

[ä¿ƒé”€æ´»åŠ¨è§†å›¾](https://kevcui.github.io/videos/mitmproxy-events-view.svg)

### æŠ€å·§ 3:ä½¿ç”¨ mitmproxy ä½œä¸ºæ¨¡æ‹ŸæœåŠ¡å™¨

mitmproxy çš„æ€æ‰‹çº§ç‰¹æ€§æ˜¯è„šæœ¬ã€‚ä½¿ç”¨ python è„šæœ¬ï¼Œæ‰€æœ‰çš„è¯·æ±‚å’Œå“åº”éƒ½æ˜¯å®Œå…¨å¯æ§çš„ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œmitmproxy éå¸¸å¥å£®ï¼Œå¯ä»¥å¤„ç†åŒæ—¶è¿æ¥åˆ°ä¸€å°ä¸»æœºçš„å¤šä¸ªå®¢æˆ·ç«¯ã€‚è¿™äº›ç‰¹æ€§ä½¿ mitmproxy æˆä¸ºä¸€ä¸ªä¸é”™çš„æ¨¡æ‹ŸæœåŠ¡å™¨ã€‚å› æ­¤ï¼Œæˆ‘å¤§é‡ä½¿ç”¨ mitmproxy ä½œä¸ºæ¨¡æ‹ŸæœåŠ¡å™¨[ã€‚](https://dev.to/kevcui/bad-use-of-a-good-tool-4ja7-temp-slug-6954387)

ä¾‹å¦‚ï¼Œä»¥é‡å†™å’Œå˜²è®½å“åº”ä½“ä¸ºç›®çš„çš„è„šæœ¬ï¼Œ [mitm-rewrite](https://github.com/KevCui/mitm-scripts/tree/master/mitm-rewrite) :

*   åœ°å›¾`http://example.com/pass`åˆ°`test_pass.json` *(å·¦ä¸‹ç»ˆç«¯)*
*   åœ¨`test_pass.json` *(å³ä¸‹ç»ˆç«¯)*ä¸­åˆ›å»ºæ¨¡æ‹Ÿå“åº”æ•°æ®
*   åœ¨å®¢æˆ·ç«¯è®¿é—®`http://example.com/pass`
*   åˆå§‹å“åº”ç°åœ¨è¢«`test_pass.json` *(é¡¶ç«¯ç»ˆç«¯)*ä¸­çš„å“åº”æ‰€å–ä»£

[![mitmproxy mock server picture](../Images/3b7e9d70f6fe09ad704bbeb788002ffe.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Rh3qMV5K--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/KevCui/mitm-scripts/master/screenshot/mitm-rewrite-example.jpg)

å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šæœ‰ç”¨çš„è„šæœ¬ï¼Œæˆ‘æœ‰ä¸€ä¸ª [mitm-scripts é›†åˆ](https://github.com/KevCui/mitm-scripts)å¯ä»¥æŸ¥çœ‹ã€‚å¦‚æœä½ æƒ³åˆ¶ä½œè‡ªå·±çš„è„šæœ¬ï¼Œè¿™é‡Œæœ‰[ä¸€äº›ä¾‹å­](https://github.com/mitmproxy/mitmproxy/tree/master/examples/simple)ã€‚

* * *

è¿˜æ²¡è¯•è¿‡ mitmproxyï¼Ÿè¯•ä¸€è¯•ã€‚ğŸ˜‰
çŸ¥é“å…¶ä»– mitmproxy çš„æ‹›æ•°å—ï¼Ÿå‘Šè¯‰æˆ‘æ›´å¤šã€‚ğŸ˜**