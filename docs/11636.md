# ç«¯åˆ°ç«¯æµ‹è¯•ä½¿ç”¨æœ¨å¶å¸ˆå’Œ Jest å¯¹åº”ç”¨ç¨‹åºåšå‡ºååº”

> åŸæ–‡:[https://dev . to/bnevilleoneill/end-to-end-to-testing-react-apps-with-puppet er-and-jest-4c H3](https://dev.to/bnevilleoneill/end-to-end-testing-react-apps-with-puppeteer-and-jest-4ch3)

[![](../Images/dc81364685d07b4a349ef299a456c9f7.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--IBzV0fOs--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/500/1%2ArV3Wuv-DfvLwvO9u81OOYA.jpeg)

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨ [Jest](https://facebook.github.io/jest/) å’Œ[æœ¨å¶å¸ˆ](https://github.com/GoogleChrome/puppeteer)ä¸º React åº”ç”¨ç¼–å†™æµ‹è¯•ã€‚æµ‹è¯•æ˜¯ç°ä»£ web åº”ç”¨ç¨‹åºå¼€å‘çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå®ƒæœ‰åŠ©äºæ£€æŸ¥æ‚¨ç¼–å†™çš„ä»£ç æ˜¯å¦å¯æ¥å—ï¼Œæ˜¯å¦æŒ‰æ¥å—çš„æ–¹å¼å·¥ä½œã€‚è¿™æ˜¯ä¸€ç§åœ¨â€œä¸Šçº¿â€ä¹‹å‰æ•æ‰ä»£ç ä¸­ bug çš„æ–¹æ³•ã€‚

è°ˆåˆ°æµ‹è¯•ï¼Œæœ‰ä¸åŒçš„æ–¹æ³•ï¼›

**å•å…ƒæµ‹è¯•â€”** å•å…ƒæµ‹è¯•æœ‰åŠ©äºæ£€æŸ¥å•ä¸ªä»£ç å•å…ƒ(ä¸»è¦æ˜¯å‡½æ•°)æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚

**é›†æˆæµ‹è¯•â€”** é›†æˆæµ‹è¯•æ˜¯å°†åº”ç”¨ç¨‹åºçš„å•ä¸ªå•å…ƒ/åŠŸèƒ½ç»„åˆèµ·æ¥ä½œä¸ºä¸€ä¸ªç»„è¿›è¡Œæµ‹è¯•çš„æµ‹è¯•ã€‚

**ç«¯åˆ°ç«¯æµ‹è¯•â€”** è¯¥æµ‹è¯•æœ‰åŠ©äºåœ¨ç”¨æˆ·ä½¿ç”¨å®é™…åº”ç”¨ç¨‹åºæ—¶ï¼Œä»ç”¨æˆ·çš„è§’åº¦ç¡®è®¤æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†è¿›è¡Œç«¯åˆ°ç«¯çš„æµ‹è¯•ï¼Œå¹¶æ£€æŸ¥æŸäº›åŠŸèƒ½æ˜¯å¦çœŸçš„å¦‚é¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Jest å’Œæœ¨å¶å¸ˆ(ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»å…³äºæœ¨å¶å¸ˆ[)ã€‚](https://blog.logrocket.com/introduction-to-headless-browser-testing-44b82310b27c)

### **æ‰“é€  React app**

æˆ‘ä»¬å°†ä¸ºä¸€ä¸ªåŠŸèƒ½æ€§çš„ React åº”ç”¨ç¨‹åºç¼–å†™æµ‹è¯•ï¼Œçœ‹çœ‹æµ‹è¯•é€šè¿‡å’Œå¤±è´¥æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [create-react-app](https://github.com/facebook/create-react-app) åŒ…æ¥å¿«é€Ÿæ­å»º react åº”ç”¨ç¨‹åºã€‚

```
npx create-react-app react-puppeteer 
```

Enter fullscreen mode Exit fullscreen mode

åˆ›å»ºå¹¶å®‰è£…é¡¹ç›®ç›®å½•åï¼Œå¯¼èˆªåˆ°æ–°åˆ›å»ºçš„ç›®å½•ï¼Œå¹¶åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚

```
npm i --save-dev jest jest-cli puppeteer faker 
```

Enter fullscreen mode Exit fullscreen mode

Jestâ€”â€”ç”±è„¸ä¹¦åˆ›å»ºçš„æµ‹è¯•å·¥å…·ï¼Œç”¨äºæµ‹è¯• React åº”ç”¨ç¨‹åºæˆ–åŸºæœ¬ä¸Šä»»ä½• JavaScript åº”ç”¨ç¨‹åº

Jest-cliâ€”Jest çš„ CLI è¿è¡Œç¨‹åº

[æœ¨å¶å¸ˆ](https://github.com/GoogleChrome/puppeteer) â€”ä¸€ä¸ªèŠ‚ç‚¹åº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜çº§ API æ¥æ§åˆ¶[æ— å¤´](https://developers.google.com/web/updates/2017/04/headless-chrome) Chrome æˆ–é€šè¿‡ [DevTools åè®®](https://chromedevtools.github.io/devtools-protocol/)çš„ Chromeã€‚æˆ‘ä»¬å°†ç”¨å®ƒæ¥ä»ç”¨æˆ·çš„è§’åº¦è¿›è¡Œæµ‹è¯•ã€‚

fakerâ€”â€”ä¸€ç§å¸®åŠ©åœ¨æµè§ˆå™¨ä¸­ç”Ÿæˆå¤§é‡è™šå‡æ•°æ®çš„å·¥å…·ã€‚æˆ‘ä»¬å°†ç”¨å®ƒæ¥ä¸ºæœ¨å¶å¸ˆç”Ÿæˆæ•°æ®ã€‚

åœ¨ package.json æ–‡ä»¶ä¸­ï¼Œåœ¨ scripts å¯¹è±¡ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç è¡Œã€‚

```
"test": "jest" 
```

Enter fullscreen mode Exit fullscreen mode

å®‰è£…å®Œæ‰€æœ‰å¿…éœ€çš„åŒ…åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ npm start å‘½ä»¤è¿è¡Œ React åº”ç”¨ç¨‹åºï¼Œå¹¶è®©å®ƒåœ¨åå°è¿è¡Œã€‚

[![](../Images/2063f22e152ef36aa267c13ae9842601.png)T2ã€‘](https://logrocket.com/?cid=banner_a)

### **å†™æµ‹è¯•**

ä»æµ‹è¯•å¼€å§‹ï¼Œæˆ‘ä»¬å°†é¦–å…ˆç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¥æ£€æŸ¥é¡µé¢ä¸Šæ˜¯å¦æœ‰ç‰¹å®šçš„æ–‡æœ¬ï¼Œè¿˜è¦ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¥æŸ¥çœ‹è”ç³»äººè¡¨å•æ˜¯å¦æäº¤æˆåŠŸã€‚è®©æˆ‘ä»¬ä»æ£€æŸ¥é¡µé¢ä¸Šæ˜¯å¦æœ‰ç‰¹å®šçš„æ–‡æœ¬å¼€å§‹ã€‚

App.test.js æ–‡ä»¶æ˜¯æˆ‘ä»¬ç¼–å†™æµ‹è¯•çš„åœ°æ–¹ã€‚Jest è¢«è‡ªåŠ¨é…ç½®ä¸ºåœ¨åŒ…å«å•è¯ test çš„æ–‡ä»¶ä¸Šè¿è¡Œæµ‹è¯•ã€‚æ‰“å¼€ App.test.jsï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç è¿›è¡Œç¼–è¾‘ã€‚

[https://medium . com/media/449540 e7e 273566000 fac 7 db 2e 28068 c/href](https://medium.com/media/449540e7e273566000fac7db2e28068c/href)

åœ¨ä¸Šé¢ä»£ç å—çš„ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œfaker å’Œ puppeteer éƒ½è¢«å¯¼å…¥ï¼Œæˆ‘ä»¬ä» faker ç”Ÿæˆä¸€å †æ•°æ®ï¼Œè¿™äº›æ•°æ®å°†åœ¨ä»¥åä½¿ç”¨ã€‚

describe å‡½æ•°å……å½“ä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªå—ï¼Œå°†ç›¸å…³çš„æµ‹è¯•åˆ†ç»„åˆ°ä¸€ä¸ªæµ‹è¯•å¥—ä»¶ä¸­ã€‚å¦‚æœæ‚¨å¸Œæœ›å°†æµ‹è¯•ç»„ç»‡æˆç»„ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚Jest ç”¨æµ‹è¯•å¥—ä»¶çš„åç§°æ¥å£°æ˜æµ‹è¯•å‡½æ•°ã€‚

åœ¨æµ‹è¯•å‡½æ•°ä¸­ï¼Œä½¿ç”¨ Puppeteer å¯åŠ¨ä¸€ä¸ªæµè§ˆå™¨ï¼Œå¹¶å°† headless mode é€‰é¡¹è®¾ç½®ä¸º falseã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•æ—¶çœ‹åˆ°æµè§ˆå™¨ã€‚browser.newPage()å…è®¸æ‚¨åˆ›å»ºä¸€ä¸ªæ–°é¡µé¢ã€‚

çš„ã€‚emulate()å‡½æ•°ä½¿æ‚¨èƒ½å¤Ÿæ¨¡æ‹ŸæŸäº›è®¾å¤‡æŒ‡æ ‡å’Œç”¨æˆ·ä»£ç†ã€‚åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬å°†å…¶è§†å£è®¾ç½®ä¸º 500x2400ã€‚

æ‰“å¼€é¡µé¢å¹¶å®šä¹‰å…¶è§†çª—åï¼Œæˆ‘ä»¬å‘Šè¯‰å®ƒå¯¼èˆªåˆ°æˆ‘ä»¬å°†ä½¿ç”¨æµ‹è¯•çš„åº”ç”¨ç¨‹åºã€‚goto()å‡½æ•°ã€‚çš„ã€‚waitForSelector()å‡½æ•°å‘Šè¯‰æœ¨å¶å¸ˆä¿æŒä¸åŠ¨ï¼Œç›´åˆ°ç‰¹å®šçš„é€‰æ‹©å™¨åŠ è½½åˆ° DOM ä¸­ã€‚ä¸€æ—¦å®ƒè¢«åŠ è½½ï¼Œé€‰æ‹©å™¨çš„ innerText å°±è¢«å­˜å‚¨åœ¨ä¸€ä¸ªåä¸º html çš„å˜é‡ä¸­ã€‚

ä¸‹ä¸€è¡Œæ˜¯çœŸæ­£çš„æµ‹è¯•ã€‚

```
expect(html).toBe('Welcome to React') 
```

Enter fullscreen mode Exit fullscreen mode

åœ¨ä¸Šé¢çš„ä»£ç è¡Œä¸­ï¼ŒJest expect å‡½æ•°è¢«è®¾ç½®ä¸ºæ£€æŸ¥å˜é‡ html çš„å†…å®¹æ˜¯å¦ä¸ Welcome to React ç›¸åŒã€‚å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬æ­£åœ¨æµ‹è¯•åº”ç”¨ç¨‹åºä¸Šçš„ç‰¹å®šæ–‡æœ¬æ˜¯å¦æ˜¯å®ƒåº”è¯¥æ˜¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æµ‹è¯•ã€‚æµ‹è¯•ç»“æŸæ—¶ï¼Œæµè§ˆå™¨å…³é—­ï¼Œå¹¶æ˜¾ç¤ºã€‚close()å‡½æ•°ã€‚

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œæµ‹è¯•ï¼Œåœ¨æ‚¨çš„ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚

```
npm run test 
```

Enter fullscreen mode Exit fullscreen mode

[![](../Images/bca97166d3397d8ac90d690f535c0877.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--cC-JjxYF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AiLyFSvvF9uvwc_8UtdFbUg.png)

æµ‹è¯•å°†ä¼šé€šè¿‡ï¼Œå› æ­¤æ‚¨çš„å‘½ä»¤è¾“å‡ºåº”è¯¥ä¸ä¸Šé¢çš„ä¸€æ ·ã€‚æ‚¨å®é™…ä¸Šå¯ä»¥æ›´æ”¹ã€‚åº”ç”¨ç¨‹åºæ ‡é¢˜é€‰æ‹©å™¨ï¼Œçœ‹çœ‹å¤±è´¥çš„æµ‹è¯•ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

[![](../Images/6ca73eb3132edb127ca3da1d14eb5a91.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--HMeEQq9O--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AMA5n_y_pCddn1uz5x3LS9A.png)

è¿™é‡Œï¼Œè¾“å‡ºå®é™…ä¸Šè¡¨æ˜äº†æµ‹è¯•å¤±è´¥ä»¥åŠå¤±è´¥çš„åŸå› ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”¶åˆ°çš„å€¼ä¸é¢„æœŸå€¼ä¸åŒã€‚

### **æ›´å¤šæµ‹è¯•ï¼**

åœ¨ä¸‹ä¸€ä¸ªæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å°†æ¨¡æ‹Ÿå’Œæµ‹è¯•åœ¨ React åº”ç”¨ç¨‹åºä¸Šæäº¤è”ç³»è¡¨å•ã€‚

åœ¨ React åº”ç”¨ç¨‹åºä»£ç ä¸­ï¼Œæ‰“å¼€ App.js æ–‡ä»¶å¹¶ä½¿ç”¨ä¸‹é¢çš„ä»£ç è¿›è¡Œç¼–è¾‘ã€‚

[https://medium . com/media/4545 ea 04 bbff 24175 CAAC 629 e 5 E1 a 7 bb/href](https://medium.com/media/4545ea04bbff24175caac629e5e1a7bb/href)

App.js å·²ç»æ›´æ–°ä¸ºä¸€ä¸ªè”ç³»äººè¡¨å•ï¼Œsubmit æŒ‰é’®åªæ˜¯å°†è¡¨å•æ•°æ®è®°å½•åˆ°æ§åˆ¶å°ã€‚

æ¥ä¸‹æ¥ï¼Œå°†ä¸‹é¢çš„ä»£ç å—æ·»åŠ åˆ° App.test.js æ–‡ä»¶ä¸­ã€‚

[https://medium . com/media/3e 02 e 8 a 9 a 5d 3d F2 d 63 ACC 543 b 0 f 878 f 0/href](https://medium.com/media/3e02e8a9a5d3df2d63acc543b0f878f0/href)

è¿™ä¸ªæµ‹è¯•å¥—ä»¶ç±»ä¼¼äºä¸Šé¢çš„æµ‹è¯•å¥—ä»¶ï¼Œpuppeteer.launch()å‡½æ•°å¯åŠ¨ä¸€ä¸ªæ–°çš„æµè§ˆå™¨å’Œä¸€äº›é…ç½®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸¤ä¸ªé¢å¤–çš„é€‰é¡¹ï¼Œdevtools æ˜¾ç¤º Chrome devtoolsï¼ŒslowMo å°†æœ¨å¶è¿›ç¨‹å‡æ…¢æŒ‡å®šçš„æ¯«ç§’æ•°ã€‚è¿™è®©æˆ‘ä»¬çœ‹åˆ°äº†æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚

æœ¨å¶å¸ˆæœ‰ã€‚å•å‡»å’Œã€‚è¾“å…¥åŠ¨ä½œå®é™…ä¸Šæ¨¡æ‹Ÿäº†ç‚¹å‡»è¾“å…¥å­—æ®µå’Œè¾“å…¥å€¼çš„æ•´ä¸ªè¿‡ç¨‹ã€‚è¡¨å•å­—æ®µçš„ç»†èŠ‚æ˜¯ä»æ—©å…ˆåœ¨ person å¯¹è±¡ä¸­è®¾ç½®çš„ faker ä¸­è·å–çš„ã€‚

è¯¥æµ‹è¯•å¥—ä»¶å¡«å……è”ç³»äººè¡¨å•ï¼Œå¹¶æµ‹è¯•ç”¨æˆ·æ˜¯å¦èƒ½å¤ŸæˆåŠŸæäº¤è¯¥è¡¨å•ã€‚

æ‚¨å¯ä»¥åœ¨æ‚¨çš„ç»ˆç«¯ä¸­è¿è¡Œ npm run test å‘½ä»¤ï¼Œæ‚¨åº”è¯¥æ‰“å¼€ä¸€ä¸ª Chrome æµè§ˆå™¨å¹¶è§‚å¯Ÿå®é™…çš„æµ‹è¯•è¿‡ç¨‹ã€‚

å¯¹äºä¸‹ä¸€ç»„æµ‹è¯•ï¼Œæˆ‘ä»¬å°†ç¼–å†™æµ‹è¯•æ¥æ–­è¨€ä»¥ä¸‹å†…å®¹:

â€”ç”¨æˆ·å¯ä»¥ç™»å½•

â€”ç”¨æˆ·å¯ä»¥æ³¨é”€

â€”ç”¨æˆ·è¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢è¿›è¡Œæœªç»æˆæƒçš„æŸ¥çœ‹

â€”ä¸å­˜åœ¨çš„è§†å›¾/è·¯çº¿è¿”å› 404 é¡µé¢

ä¸Šé¢çš„æµ‹è¯•æ˜¯ä»ç”¨æˆ·çš„è§’åº¦è¿›è¡Œçš„ç«¯åˆ°ç«¯æµ‹è¯•ã€‚æˆ‘ä»¬æ­£åœ¨æ£€æŸ¥ç”¨æˆ·æ˜¯å¦èƒ½çœŸæ­£ä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºæ¥å®Œæˆæœ€åŸºæœ¬çš„äº‹æƒ…ã€‚

ä¸ºäº†è¿›è¡Œè¿™äº›æµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª React åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†åœ¨ GitHub ä¸Šä½¿ç”¨ Robin Wieruch çš„ [React Firebase è®¤è¯](https://github.com/rwieruch/react-firebase-authentication)æ ·æ¿ä»£ç ã€‚å®ƒå¸¦æœ‰ä¸€ä¸ªå†…ç½®çš„è®¤è¯ç³»ç»Ÿï¼Œæ‰€æœ‰éœ€è¦åšçš„å°±æ˜¯åˆ›å»ºä¸€ä¸ª Firebase é¡¹ç›®å¹¶æ·»åŠ  [Firebase](https://console.firebase.google.com) å¯†é’¥ã€‚

æˆ‘ä¿®æ”¹äº†ä¸€ç‚¹ä»£ç ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›é€‰æ‹©å™¨å’Œ idï¼Œä½¿åº”ç”¨ç¨‹åºé€‚åˆæµ‹è¯•ã€‚ä½ å¯ä»¥åœ¨ GitHub ä¸Šçœ‹åˆ°ã€‚ç»§ç»­å°† GitHub repo å…‹éš†åˆ°æ‚¨çš„æœ¬åœ°ç³»ç»Ÿï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚

```
npm i

npm start 
```

Enter fullscreen mode Exit fullscreen mode

ä¸è¦å¿˜è®°åˆ›å»ºä¸€ä¸ª [Firebase](https://console.firebase.google.com) å¸æˆ·ï¼Œå¹¶å°†æ‚¨çš„å‡­è¯æ·»åŠ åˆ° src/firebase/firebase.js æ–‡ä»¶ä¸­ã€‚

<figure>[![](../Images/d3ffb88adb1eabbc79c42b87ee8d6a13.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--53D7sSTP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2APokATdZ25TV90MiVw1TCrw.png)

<figcaption>React Firebase è®¤è¯æ ·æ¿ App</figcaption>

</figure>

è®©æˆ‘ä»¬ç»§ç»­ä¸º React åº”ç”¨ç¨‹åºç¼–å†™æµ‹è¯•ã€‚åŒæ ·ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… jest faker å’Œ puppeteerï¼Œè¿˜éœ€è¦ä¸€ä¸ª App.test.js æ–‡ä»¶ã€‚

```
npm i --save-dev jest jest-cli puppeteer faker 
```

Enter fullscreen mode Exit fullscreen mode

å®‰è£…å®Œæˆåï¼Œåˆ›å»ºä¸€ä¸ªåä¸º App.test.js çš„æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬ä»ä¸‹é¢çš„ä»£ç å—å¼€å§‹ç¼–è¾‘ã€‚

```
**const** faker = require('faker');
**const** puppeteer = require('puppeteer');

**const** person = {
 email: faker.internet.email(),
 password: faker.random.word(),
};

**const** appUrlBase = 'http://localhost:3002'
**const** routes = {
**public** : {
 register: `${appUrlBase}/register`,
 login: `${appUrlBase}/login`,
 noMatch: `${appUrlBase}/ineedaview`,
 },
**private** : {
 home: `${appUrlBase}/home`,
 account: `${appUrlBase}/account`,
 },
}; 
```

Enter fullscreen mode Exit fullscreen mode

å°±åƒä¸Šé¢å†™çš„æµ‹è¯•ä¸€æ ·ï¼Œfaker å’Œ puppeteer éƒ½æ˜¯è¿›å£çš„ã€‚åˆ›å»ºäº†ä¸€ä¸ª person å¯¹è±¡ï¼Œå®ƒå­˜å‚¨äº†ä¸€ä¸ªéšæœºçš„ç”µå­é‚®ä»¶å’Œå¯†ç ï¼Œå°†ç”¨äºæµ‹è¯•ã€‚appUrlBase å¸¸é‡æ˜¯ React åº”ç”¨ç¨‹åºçš„é“¾æ¥â€”å¦‚æœæ‚¨å°šæœªå¯åŠ¨ React åº”ç”¨ç¨‹åºï¼Œè¯·åœ¨ç»ˆç«¯ä¸­è¿è¡Œ npm startï¼Œå¹¶å°† appUrlBase æ›´æ”¹ä¸ºé“¾æ¥ã€‚

routes å¯¹è±¡åŒ…å«æˆ‘ä»¬å°†è¦æµ‹è¯•çš„è§†å›¾çš„å„ç§ URLã€‚public å¯¹è±¡åŒ…å« React åº”ç”¨ç¨‹åºä¸­ä»»ä½•äºº(æœªç™»å½•)éƒ½å¯ä»¥æŸ¥çœ‹çš„è·¯çº¿é“¾æ¥ï¼Œè€Œ private å¯¹è±¡åŒ…å«åªæœ‰ç™»å½•åæ‰èƒ½æŸ¥çœ‹çš„è·¯çº¿é“¾æ¥ã€‚

è¯·æ³¨æ„ï¼ŒnoMatch å°†ç”¨äºæµ‹è¯•*ä¸å­˜åœ¨çš„è§†å›¾/route è¿”å› 404 é¡µé¢ï¼Œ*è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ°å½“åœ°å¯¼è‡´/ineedaveviewã€‚

å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬å†™ç¬¬ä¸€ä¸ªæµ‹è¯•ã€‚

### **ç”¨æˆ·å¯ä»¥ç™»å½•**

[https://medium . com/media/0 c 89 A8 bcc 331 a 569d 843 C1 f 7d 4 e 72 a 1 a/href](https://medium.com/media/0c89a8bcc331a569d843c1f7d4e72a1a/href)

ä¸Šé¢çš„ä»£ç å—ä¸åŒäºæˆ‘ä»¬ä¸Šé¢å†™çš„ç¬¬ä¸€ç»„æµ‹è¯•ã€‚é¦–å…ˆï¼Œ [beforeAll](https://facebook.github.io/jest/docs/en/api.html#beforeallfn-timeout) å‡½æ•°ç”¨äºå¯åŠ¨ä¸€ä¸ªå¸¦æœ‰é€‰é¡¹çš„æ–°æµè§ˆå™¨ï¼Œå¹¶åœ¨è¯¥æµè§ˆå™¨ä¸­åˆ›å»ºæ–°é¡µé¢ï¼Œè€Œä¸æ˜¯åƒæˆ‘ä»¬ä¹‹å‰åœ¨æµ‹è¯•ä¸­é‚£æ ·åœ¨æ¯ä¸ªæµ‹è¯•å¥—ä»¶ä¸­åˆ›å»ºæ–°æµè§ˆå™¨ã€‚

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åœ¨è¿™é‡Œæµ‹è¯•å‘¢ï¼Ÿåœ¨æµ‹è¯•å¥—ä»¶ä¸­ï¼Œæµè§ˆå™¨è¢«å®šå‘åˆ°ç™»å½•é¡µé¢ routes.public.loginï¼Œå°±åƒè”ç³»äººè¡¨å•æµ‹è¯•ä¸€æ ·ï¼Œä½¿ç”¨ puppeteer æ¥å¡«å†™è¡¨å•å¹¶æäº¤å®ƒã€‚æäº¤è¡¨å•åï¼Œpuppeteer ç­‰å¾…ä¸€ä¸ªé€‰æ‹©å™¨ data-testid='homepage ',è¿™æ˜¯ä¸€ä¸ªå‡ºç°åœ¨[ä¸»é¡µ](https://github.com/yomete/react-firebase-authentication/blob/master/src/components/Home/index.js#L25)ä¸Šçš„ data-idâ€”â€”React åº”ç”¨ç¨‹åºåœ¨æˆåŠŸç™»å½•åé‡å®šå‘åˆ°çš„é¡µé¢ã€‚

æˆ‘å·²ç»ç”¨ä»£ç å—ä¸­çš„ç”¨æˆ·è¯¦ç»†ä¿¡æ¯åˆ›å»ºäº†ä¸€ä¸ªå¸æˆ·ï¼Œå› æ­¤è¿™ä¸ªæµ‹è¯•åº”è¯¥é€šè¿‡ã€‚

[![](../Images/67dc6726b62a586d335ccc8d3dd33f5f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pZ7KyEnC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AyteBNSwCeDrUT-j3kOkkAg.png)

[afterAll](https://facebook.github.io/jest/docs/en/api.html#afterallfn-timeout) å‡½æ•°åœ¨æµ‹è¯•ç»“æŸåå‘ç”Ÿï¼Œå¹¶å…³é—­æµè§ˆå™¨ã€‚

### **ç”¨æˆ·å¯ä»¥æ³¨é”€**

<figure>[![](../Images/906e8d5ec571b6a7957a43915344e6cf.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--rAVCB19m--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AWoS9teZ7-90ccOkJVV6SCA.png)T4ã€‘ğŸ¤®è¿™ä¸æ˜¯ CSS æ•™ç¨‹</figure>

è¿™æ˜¯æˆåŠŸç™»å½•åæ˜¾ç¤ºçš„è§†å›¾ã€‚ç°åœ¨æˆ‘ä»¬æƒ³æµ‹è¯•å½“ç”¨æˆ·ç‚¹å‡»*é€€å‡º*æŒ‰é’®æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚é¢„æœŸçš„ç»“æœæ˜¯æœ¬åœ°å­˜å‚¨è¢«æ¸…é™¤ã€æ³¨é”€ï¼Œç”¨æˆ·è¢«é‡å®šå‘å›ç™»å½•é¡µé¢ã€‚

åœ¨åŒä¸€ä¸ª App.test.js æ–‡ä»¶ä¸­ï¼Œå°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ° afterAll å‡½æ•°ä¹‹å‰ã€‚

[https://medium . com/media/9036 e 76353 a94c 796 c 7 c 6 ab 23 f 717094/href](https://medium.com/media/9036e76353a94c796c7c6ab23f717094/href)

è¿™ä¸ªæµ‹è¯•ç›¸å½“ç®€å•ã€‚æœ¨å¶å¸ˆç­‰å¾…[ã€‚å¯¼èˆªé“¾æ¥é€‰æ‹©å™¨](https://github.com/yomete/react-firebase-authentication/blob/master/src/components/Navigation/index.js#L17)ç‚¹å‡»æ•°æ®å±æ€§ä¸º [data-testid="signoutBtn"](https://github.com/yomete/react-firebase-authentication/blob/master/src/components/SignOut/index.js#L9) çš„[æŒ‰é’®](https://github.com/yomete/react-firebase-authentication/blob/master/src/components/SignOut/index.js#L9)ï¼Œè¿™å®é™…ä¸Šæ˜¯åœ¨æµ‹è¯•æŒ‰é’®æ˜¯å¦å¯ä»¥è¢«ç‚¹å‡»ã€‚åœ¨ page.click()å‡½æ•°ä¹‹åï¼Œæœ¨å¶å¸ˆç­‰å¾…é€‰æ‹©å™¨ã€‚ç­¾åˆ°è¡¨å¯åœ¨é¡µé¢çš„[ç­¾åˆ°ä¸Šæ‰¾åˆ°ã€‚](https://github.com/yomete/react-firebase-authentication/blob/master/src/components/SignIn/index.js#L68)

æ­å–œä½ ï¼Œåˆä¸€ä¸ªæµ‹è¯•é€šè¿‡äº†ã€‚

[![](../Images/3cac8436339c6e3aa73783f23f0ef4a9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--n_EAc4Zb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2ApykecL8ifFGIIquDVztBVg.png)

### **ç”¨æˆ·è¢«é‡å®šå‘åˆ°æœªæˆæƒæŸ¥çœ‹çš„ç™»å½•é¡µé¢**

æˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·è®¿é—®ä»–ä»¬æ— æƒæŸ¥çœ‹çš„è§†å›¾å’Œè·¯çº¿ã€‚æ‰€ä»¥è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ä»£ç æ˜¯å¦èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚

å°†ä¸‹é¢çš„ä»£ç å—æ·»åŠ åˆ°ç°æœ‰ä»£ç ä¸­ï¼Œå°±åœ¨ afterAll å‡½æ•°ä¹‹å‰

[https://medium . com/media/63a 7606 a 3d 47 f 691 bbacc 7 a 72 c 0 e 46 c 6/href](https://medium.com/media/63a7606a3d47f691bbacc7a72c0e46c6/href)

åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬æµ‹è¯•äº† React ä¸­çš„ç§æœ‰è·¯ç”±ï¼Œç„¶åç­‰å¾… signin-form é€‰æ‹©å™¨ã€‚

è¿™æ„å‘³ç€åœ¨ç”¨æˆ·å¯¼èˆªåˆ°ç§äººè·¯çº¿åï¼Œä»–ä»¬ä¼šè¢«è‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•è¡¨å•ã€‚

[![](../Images/71c0f0b3bf1a273f2ec734703a36cf5a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--dLZPpP2I--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2A82yuhpmSjZZTH54ffnIaaA.png)

### **ä¸å­˜åœ¨çš„è§‚ç‚¹/è·¯çº¿è¿”å› 404 é¡µ**

é‡è¦çš„æ˜¯æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ª 404 é¡µé¢ï¼Œä»¥ä¾¿å‘ç”¨æˆ·è§£é‡Šç‰¹å®šçš„è·¯çº¿å¹¶ä¸å­˜åœ¨ã€‚å®ƒä¹Ÿåœ¨è¿™ä¸ª React åº”ç”¨ç¨‹åºä¸­å®ç°äº†ï¼Œè®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹å®ƒæ˜¯å¦åƒé¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚

å°†ä¸‹é¢çš„ä»£ç å—æ·»åŠ åˆ°ç°æœ‰ä»£ç ä¸­ï¼Œå°±åœ¨ afterAll å‡½æ•°ä¹‹å‰ã€‚

[https://medium . com/media/718d 38 df 549 c 0 CDE 049d 24 fcef 0 da 38 c/href](https://medium.com/media/718d38df549c0cde049d24fcef0da38c/href)

æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ routes.public.noMatch é“¾æ¥æŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯ç”±ã€‚å› æ­¤ï¼Œå½“æœ¨å¶å¸ˆè½¬åˆ°é‚£ä¸ªé“¾æ¥æ—¶ï¼Œå®ƒå¸Œæœ›è‡ªåŠ¨é‡å®šå‘åˆ° 404 é¡µé¢ã€‚çš„ã€‚ä¸åŒ¹é…é€‰æ‹©å™¨ä½äº [404 é¡µé¢](https://github.com/yomete/react-firebase-authentication/blob/master/src/components/NoMatch/index.js#L4)ä¸Šã€‚

[![](../Images/1f6d0cca58271496e2c7021fe059e2a9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ijE73EMQ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2ADualM5SwLrF-TWOEFrAkXA.png)

### **ç»“è®º**

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç›´æ¥çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨ Jest ä½œä¸ºæµ‹è¯•å¥—ä»¶ï¼Œä½¿ç”¨æœ¨å¶å¸ˆè¿›è¡Œæ¨¡æ‹Ÿï¼Œå¦‚è¾“å…¥ã€ç‚¹å‡»ç­‰ï¼Œæ¥ç¼–å†™ React åº”ç”¨ç¨‹åºçš„æµ‹è¯•ã€‚

Jest å’Œ Puppeteer æ˜¯ä¸€ä¸ªç»„åˆï¼Œåœ¨æµ‹è¯• React åº”ç”¨ç¨‹åºæ—¶è‚¯å®šä¸ä¼šå‡ºé”™ã€‚æœ¨å¶å¸ˆä»åœ¨ç§¯æå¼€å‘ä¸­ï¼Œæ‰€ä»¥è¯·ç¡®ä¿æŸ¥çœ‹ API å‚è€ƒä»¥äº†è§£æ›´å¤šåŠŸèƒ½ã€‚

æœ¬æ•™ç¨‹çš„ä»£ç å¯ä»¥åœ¨ GitHub [è¿™é‡Œ](https://github.com/yomete/react-puppeteer)å’Œ[è¿™é‡Œ](https://github.com/yomete/react-firebase-authentication)çœ‹åˆ°ã€‚

### **èµ„æº**

æ˜¯:https://Facebook . github . io/is/

æœ¨å¶å¸ˆ:[https://github.com/GoogleChrome/puppeteer](https://github.com/GoogleChrome/puppeteer)

### Plug: [LogRocket](http://logrocket.com) ï¼Œä¸€æ¬¾é€‚ç”¨äºç½‘ç»œåº”ç”¨çš„ DVR

[![](../Images/d56be9e9e36d8fa98c6959f7097b7787.png)T2ã€‘](http://logrocket.com)

LogRocket æ˜¯ä¸€ä¸ªå‰ç«¯æ—¥å¿—å·¥å…·ï¼Œå¯ä»¥è®©ä½ å›æ”¾é—®é¢˜ï¼Œå°±åƒå®ƒä»¬å‘ç”Ÿåœ¨ä½ è‡ªå·±çš„æµè§ˆå™¨ä¸­ä¸€æ ·ã€‚LogRocket ä¸éœ€è¦çŒœæµ‹é”™è¯¯å‘ç”Ÿçš„åŸå› ï¼Œä¹Ÿä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®æˆªå›¾å’Œæ—¥å¿—è½¬å‚¨ï¼Œè€Œæ˜¯è®©æ‚¨é‡æ”¾ä¼šè¯ä»¥å¿«é€Ÿäº†è§£å“ªé‡Œå‡ºé”™äº†ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºå®Œç¾é…åˆï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œå¹¶ä¸”æœ‰æ’ä»¶å¯ä»¥è®°å½•æ¥è‡ª Reduxã€Vuex å’Œ@ngrx/store çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚

é™¤äº†è®°å½• Redux æ“ä½œå’ŒçŠ¶æ€ï¼ŒLogRocket è¿˜è®°å½•æ§åˆ¶å°æ—¥å¿—ã€JavaScript é”™è¯¯ã€å †æ ˆè·Ÿè¸ªã€å¸¦æœ‰å¤´+æ­£æ–‡çš„ç½‘ç»œè¯·æ±‚/å“åº”ã€æµè§ˆå™¨å…ƒæ•°æ®å’Œè‡ªå®šä¹‰æ—¥å¿—ã€‚å®ƒè¿˜ä½¿ç”¨ DOM æ¥è®°å½•é¡µé¢ä¸Šçš„ HTML å’Œ CSSï¼Œç”šè‡³ä¸ºæœ€å¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºé‡æ–°åˆ›å»ºåƒç´ çº§å®Œç¾è§†é¢‘ã€‚

å…è´¹è¯•ç”¨ã€‚

* * *