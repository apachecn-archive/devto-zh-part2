# 用 Javascript 编译模板

> 原文:[https://dev.to/michaelgv/compiling-templates-in-javascript-20e 1](https://dev.to/michaelgv/compiling-templates-in-javascript--20e1)

我最近很困惑，不知道该去哪里。目前，我们的产品附带了 150 个模板段(或视图/模型对)，我们对定义非常严格，以确保一致性，我们现在遇到的唯一困难是文件大小。

目前，我们生产一个 10kb 的缩小文件，我们很好，但我们有一个新的项目将为整个应用程序产生一个 1mb 的缩小文件，主要是模板引擎膨胀，所以我们正在考虑重写我们的模板系统。

目前它是这样工作的:

1.  定义视图和模型对(模板段)

2.  编写标记

3.  在模型上绑定事件等

4.  模型以 DOM 的克隆表示提交给视图，我们做了一个基本的 diff，并立即触发 DOM 的更改以及其他需要更新的组件

一位开发人员建议我们保留这种方法，但增加两个重要因素:

在编译时，我们应该用节点的表示替换模板 HTML，例如我们把:

"

内容

” ....

到一个数组中，让每个元素都有 ID 类型，将它们映射到一个“数据库”类型对象，根据字母和类型将字符串组合成数字，这样我们就可以用一些 int 来表示我们的标记，而不是庞大的臃肿。他演示了一个概念验证，文件大小下降到 145kb，基本问题是，这值得吗？

另一个开发人员建议简单地发布一个块渲染引擎，并将块作为直接的 HTML 文件进行轮询。我从来不喜欢这种结构，因为我想把所有东西都折叠在一起，所以如果没有网络，我们仍然可以填充和运行，并在恢复在线时同步。

说了这么多，有什么想法吗？我们的目标范围是小于 110kb 的文件大小