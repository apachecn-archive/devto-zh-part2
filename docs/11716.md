# åˆ›å»ºä¸€ä¸ªæ— æœåŠ¡å™¨çš„ Slack é€šçŸ¥æœåŠ¡â€”â€”â€œä¸€ä¸ªå¸–å­è¢«æ›´æ–°äº†â€

> åŸæ–‡:[https://dev . to/sanity-io/someone-created-a-post-in-sanity-make-a-server less-slack-notification-service-373 I](https://dev.to/sanity-io/someone-created-a-post-in-sanity-make-a-serverless-slack-notification-service-373i)

è®¸å¤šäººå·²ç»å°†ä»–ä»¬çš„åŸºç¡€è®¾æ–½åˆ†å‰²æˆå°çš„å•ä¸€ç”¨é€”çš„ç‰‡ï¼Œç§°ä¸ºå¾®æœåŠ¡ã€‚äº‘åŠŸèƒ½ï¼Œæˆ–è€…æ— æœåŠ¡å™¨åŠŸèƒ½ï¼Œå¦‚æœä½ å–œæ¬¢ä½ çš„æµè¡Œè¯­æœåŠ¡çƒ­ï¼Œè®©æˆ‘ä»¬å…¶ä»–äººè½»æ¾åœ°ä½¿ç”¨ç›¸åŒç±»å‹çš„æ¶æ„è¿›è¡Œæ—¥å¸¸ä»»åŠ¡ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ªå¾ˆå°å¾ˆå°çš„æœåŠ¡ï¼Œæ¯å½“æœ‰äººåœ¨ Sanity Content Studio ä¸­åˆ›å»ºã€æ›´æ–°æˆ–åˆ é™¤ä¸€ç¯‡åšå®¢æ–‡ç« æ—¶ï¼Œå®ƒéƒ½ä¼šå‘ [Slack](https://slack.com) è½¬å‘ä¸€æ¡æ¶ˆæ¯ã€‚ [Sanity æ˜¯ä¸€ä¸ªâ€œåç«¯å³æœåŠ¡â€](https://sanity.io/?utm_source=devto&utm_medium=cpc&utm_campaign=serverless)å®ƒå…è®¸ä½ è½»æ¾åœ°æ„å»ºä½ çš„å†…å®¹ï¼Œå¹¶ç«‹å³è·å¾—ä¸€ä¸ªåŸºäºå›¾å½¢çš„å®æ—¶ APIã€‚å®ƒéå¸¸ç®€æ´ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»å…³äºåœ¨å®ƒä¸Šé¢å»ºç«‹ä¸€ä¸ªç®€å•çš„ååº”é©±åŠ¨çš„åšå®¢[ã€‚](https://www.sanity.io/blog/build-your-own-blog-with-sanity-and-next-js?utm_source=devto&utm_medium=cpc&utm_campaign=serverless)

## 1ã€‚è®¾ç½® Webtask åŠŸèƒ½

æœ‰å¤šç§æœåŠ¡æä¾›æ˜“äºè®¾ç½®çš„æ— æœåŠ¡å™¨åŠŸèƒ½ã€‚å¯ä»¥ä½¿ç”¨ [Heroku](https://heroku.com) ä¸Šçš„å…è´¹ dynoï¼Œä»¥åŠ [stdlib](https://stdlib.com/) å’Œ [AWS lambda](https://aws.amazon.com/lambda/) ã€‚ä½†æ˜¯ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [Webtask.io](https://webtask.io) ä½œä¸ºæˆ‘ä»¬çš„æ— æœåŠ¡å™¨å‡½æ•°æä¾›è€…ã€‚ä¸è¿‡ï¼Œå®ƒä»¬çš„å·¥ä½œæ–¹å¼éƒ½å·®ä¸å¤šã€‚æ‚¨å°†è·å¾—ä¸€ä¸ªå¯ä»¥å‘å…¶å‘é€ HTTP è¯·æ±‚çš„ URLï¼Œè¯¥ URL è¿è¡Œä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿™ä¸ªè¯·æ±‚å’Œä¸€ä¸ªå›è°ƒä½œä¸ºå…¶å‚æ•°ã€‚å®ƒæ²¡æœ‰æŒä¹…çŠ¶æ€(é™¤éæ‚¨å°†å®ƒè¿æ¥åˆ°æŸç§æ•°æ®åº“æˆ–ä¼šè¯æä¾›è€…),å¹¶ä¸”åªé€‚åˆåšä¸€ä»¶äº‹ã€‚

å¦‚æœä½ æœ‰ [wt å‘½ä»¤è¡Œç•Œé¢](https://webtask.io/cli) ( `npm i -g wt-cli`)ï¼Œè¿è¡Œéƒ¨ç½²è¿™ä¸ªè„šæœ¬åˆ°ä½ è‡ªå·±çš„ Webtask-account:

```
$ wt create https://raw.githubusercontent.com/kmelve/webtask-sanity-slack-update/master/sanity-slack-update.js --name sanity-slack-update 
```

Enter fullscreen mode Exit fullscreen mode

ä½ ä¹Ÿå¯ä»¥[å°†ä»£ç ](https://raw.githubusercontent.com/kmelve/webtask-sanity-slack-update/master/webtask.js)å¤åˆ¶ç²˜è´´åˆ° webtask.io/make çš„[åœ¨çº¿ç¼–è¾‘å™¨ä¸­ã€‚](https://webtask.io)

ç¡®ä¿å®‰è£…äº†èŠ‚ç‚¹ä¾èµ–é¡¹(axios å’Œ@sanity/client)ã€‚å¦‚æœæ‚¨éœ€è¦æ‰‹åŠ¨æ·»åŠ ï¼Œè¯·å•å‡»æ‰³æ‰‹æŒ‰é’®ğŸ”§å¹¶é€‰æ‹© *npm æ¨¡å—*ã€‚

[![The Webtask online editor](../Images/9911669298530f5035f2c4e678a96930.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pxSSelqz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/b5407e83ly9soqy3qw4v.png)

### 2ã€‚åˆ›å»ºä¸€ä¸ªæ¾å¼›çš„ä¼ å…¥ Webhook

è¿›å…¥[Slack å®šåˆ¶é›†æˆé…ç½®é¡µé¢](https://netlifedesign.slack.com/apps/manage/custom-integrations)ï¼Œç‚¹å‡» *Incoming Webhooks* å’Œ*æ·»åŠ é…ç½®*ã€‚ä½ å¯ä»¥éšæ„å®šåˆ¶ï¼Œå®Œæˆåè®°å¾—æŒ‰ä¿å­˜æŒ‰é’®ã€‚å¤åˆ¶ webhook ç½‘å€(çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:`https://hooks.slack.com/services/<code>/<code>/<code>`)ã€‚

åœ¨ä½ çš„ webtask ç¼–è¾‘å™¨(`$ wt editor`æˆ–ã€webtask.io/makeã€‘T2)ä¸­ï¼Œæ·»åŠ  webhook ä½œä¸ºå¯†åŒ™ã€‚æ‰¾åˆ°æ‰³æ‰‹å›¾æ ‡ï¼Œåœ¨èœå•ä¸­é€‰æ‹©*ç§˜å¯†*ã€‚å°†æ–°é”®å‘½åä¸º`SLACK_WEBHOOK_URL`ï¼Œå¹¶å°† webhook ä½œä¸ºå€¼ã€‚ç°åœ¨ï¼Œwebtask çŸ¥é“å°†æ›´æ–°æ¶ˆæ¯å‘é€åˆ°å“ªé‡Œã€‚

æ˜¯çš„ï¼Œä¸€å®šè¦æŠŠä½ çš„ webhook URLs ä¿å¯†ã€‚å¦‚æœæœ‰äººå¾—åˆ°äº†å®ƒä»¬ï¼Œä»–ä»¬å°†èƒ½å¤Ÿç”¨åƒåœ¾ä¿¡æ¯æ·¹æ²¡ä½ çš„ç©ºé—²é¢‘é“ã€‚

### 3ã€‚å°†æ‚¨çš„ webtask URL æ·»åŠ åˆ° Sanity webhooks

å¤åˆ¶ç¼–è¾‘å™¨é¡µé¢åº•éƒ¨ä¸€è¡Œæ‰“å°çš„ webtask-URL(åº”è¯¥çœ‹èµ·æ¥åƒ`https://wt-<SECRET CODE>.sandbox.auth0-extend.com/<SCRIPT NAME>`)å¹¶è¿è¡Œ`sanity hook create name-of-your-choosing`ã€‚é€‰æ‹©æ‚¨æƒ³è¦æŠ¥å‘Šçš„æ•°æ®é›†ï¼Œå¹¶åœ¨å‡ºç°æç¤ºæ—¶ç²˜è´´åˆ°æ‚¨çš„ webtask-URL ä¸­ã€‚

[![Animation of the flow](../Images/738a9501e2661f1b4541aeaefe9f9ac8.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ikalVNyX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn.sanity.io/images/3do82whm/production/d4fd812b62724bf0f2e0b0d74bcb9ced63f9dc1f-1905x1016.gif%3Fw%3D1000)

## è‡ªå®šä¹‰

æŸ¥çœ‹ Github ä¸Šçš„[è„šæœ¬ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨è¿‡æ»¤å™¨æŸ¥è¯¢ä¸­è®¾ç½®æ›´å¤šå‚æ•°(å¦‚æœæ‚¨åªæƒ³æ›´æ–°æŸä¸ªç±»å‹ç­‰)ï¼Œæˆ–è€…é€šè¿‡è°ƒæ•´](https://github.com/sanity-io/webtask-sanity-slack-update)[æ¶ˆæ¯æ ¼å¼](https://api.slack.com/docs/messages/builder)ï¼Œè½»æ¾åœ°å¯¹å…¶è¿›è¡Œå®šåˆ¶ã€‚å¦‚æœä½ å¯¹ç†æ™ºæ„Ÿå…´è¶£ï¼Œ[çœ‹çœ‹æ–‡æ¡£](https://docs.sanity.io/?utm_source=devto&utm_medium=cpc&utm_campaign=serverless)ã€‚

å¦‚æœä½ å°è¯•è¿™æ ·åšï¼Œæˆ‘ä»¬å¾ˆä¹æ„åœ¨è¯„è®ºä¸­å¬åˆ°ã€‚ç¥ä½ å¥½è¿ï¼Œæ— æœåŠ¡å™¨ï¼