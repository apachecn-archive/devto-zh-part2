# ç°ä»£ JavaScript ä¸­çš„ä¼˜é›…æ¨¡å¼:RORO

> åŸæ–‡:[https://dev . to/billsourour/elegant-patterns-in-modern-JavaScript-roro-5b 5i](https://dev.to/billsourour/elegant-patterns-in-modern-javascript-roro-5b5i)

[![](../Images/b48b8091bed35b7f8efaa552d4eaf713.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Mde8R_69--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/5ui7h5hll0p7z57474vd.jpg)

JavaScript è¯­è¨€å‘æ˜åä¸ä¹…ï¼Œæˆ‘å°±å†™äº†æˆ‘çš„å‰å‡ è¡Œä»£ç ã€‚å¦‚æœä½ å½“æ—¶å‘Šè¯‰æˆ‘ï¼Œæœ‰ä¸€å¤©æˆ‘ä¼šå†™ä¸€ç³»åˆ—å…³äº JavaScript ä¸­çš„**ä¼˜é›…**æ¨¡å¼çš„æ–‡ç« [çš„è¯ï¼Œæˆ‘ä¼šç¬‘å¾—æŠŠä½ èµ¶å‡ºæˆ¿é—´ã€‚æˆ‘è®¤ä¸º JavaScript æ˜¯ä¸€ç§å¥‡æ€ªçš„å°è¯­è¨€ï¼Œå‡ ä¹ç§°ä¸ä¸Šâ€œçœŸæ­£çš„ç¼–ç¨‹â€](https://medium.com/search?q=Elegant%20patterns%20in%20JavaScript)

ä»é‚£ä»¥åçš„ 20 å¹´é‡Œå‘ç”Ÿäº†å¾ˆå¤šå˜åŒ–ã€‚æˆ‘ç°åœ¨åœ¨ JavaScript ä¸­çœ‹åˆ°äº†é“æ ¼æ‹‰æ–¯Â·å…‹æ´›å…‹ç¦ç‰¹å†™ã€ŠT2 JavaScript:ç²¾å½©éƒ¨åˆ†ã€‹æ—¶çœ‹åˆ°çš„ä¸œè¥¿:â€œä¸€ç§æ°å‡ºçš„ã€åŠ¨æ€çš„ç¼–ç¨‹è¯­è¨€â€¦â€¦å…·æœ‰å·¨å¤§çš„è¡¨è¾¾èƒ½åŠ›ã€‚â€

æ‰€ä»¥ï¼Œäº‹ä¸å®œè¿Ÿï¼Œè¿™æ˜¯æˆ‘æœ€è¿‘åœ¨ä»£ç ä¸­ä½¿ç”¨çš„ä¸€ä¸ªå¥‡å¦™çš„å°æ¨¡å¼ã€‚æˆ‘å¸Œæœ›ä½ èƒ½å’Œæˆ‘ä¸€æ ·å–œæ¬¢å®ƒã€‚

***è¯·æ³¨æ„*** *:æˆ‘å¾ˆç¡®å®šè¿™äº›éƒ½ä¸æ˜¯æˆ‘å‘æ˜çš„ã€‚æˆ‘å¾ˆå¯èƒ½åœ¨åˆ«äººçš„ä»£ç ä¸­å‘ç°äº†å®ƒï¼Œå¹¶æœ€ç»ˆè‡ªå·±é‡‡ç”¨äº†å®ƒã€‚*

## [](#receive-an-object-return-an-object%C2%A0roro)æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡(RORO)

æˆ‘çš„å¤§å¤šæ•°å‡½æ•°ç°åœ¨æ¥å—ç±»å‹ä¸º`object`çš„å•ä¸ªå‚æ•°ï¼Œå…¶ä¸­è®¸å¤šå‡½æ•°ä¹Ÿè¿”å›æˆ–è§£æä¸ºç±»å‹ä¸º`object`çš„å€¼ã€‚

éƒ¨åˆ†å½’åŠŸäº ES2015 ä¸­å¼•å…¥çš„*ææ„*åŠŸèƒ½ï¼Œæˆ‘å‘ç°è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ¨¡å¼ã€‚æˆ‘ç”šè‡³ç»™å®ƒèµ·äº†ä¸€ä¸ªæ„šè ¢çš„åå­—â€œRORO â€,å› ä¸ºâ€¦â€¦å“ç‰Œï¼ŸğŸ¤·â€â™‚ï¸

***æ³¨:*** *ææ„æ˜¯æˆ‘æœ€å–œæ¬¢çš„ç°ä»£ JavaScript ç‰¹æ€§ä¹‹ä¸€ã€‚æˆ‘ä»¬å°†åœ¨æ•´ç¯‡æ–‡ç« ä¸­å……åˆ†åˆ©ç”¨å®ƒï¼Œæ‰€ä»¥å¦‚æœä½ ä¸ç†Ÿæ‚‰å®ƒï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ¥è‡ª [Beau Carnes](https://www.youtube.com/playlist?list=PLWKjhJtqVAbk2qRZtWSzCIN38JC_NdhW5) çš„å¿«é€Ÿè§†é¢‘æ¥å¸®åŠ©ä½ äº†è§£å®ƒã€‚*

[https://www.youtube.com/embed/-vR3a11Wzt0](https://www.youtube.com/embed/-vR3a11Wzt0)

ä»¥ä¸‹æ˜¯æ‚¨å–œæ¬¢è¿™ç§æ¨¡å¼çš„ä¸€äº›åŸå› :

*   å‘½åå‚æ•°
*   æ¸…æ´å‰‚é»˜è®¤å‚æ•°
*   æ›´ä¸°å¯Œçš„è¿”å›å€¼
*   ç®€æ˜“åŠŸèƒ½ç»„åˆ

è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ¯ä¸€ä¸ªã€‚

## [](#named-parameters)å‘½åå‚æ•°

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°è¿”å›ç»™å®šè§’è‰²çš„ç”¨æˆ·åˆ—è¡¨ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªé€‰é¡¹æ¥åŒ…å«æ¯ä¸ªç”¨æˆ·çš„è”ç³»ä¿¡æ¯ï¼Œä»¥åŠå¦ä¸€ä¸ªé€‰é¡¹æ¥åŒ…å«ä¸æ´»åŠ¨çš„ç”¨æˆ·ï¼Œä¼ ç»Ÿä¸Šæˆ‘ä»¬å¯ä»¥å†™:

```
function findUsersByRole (
  role,
  withContactInfo,
  includeInactive
) {...} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯¹è¿™ä¸ªå‡½æ•°çš„è°ƒç”¨å¯èƒ½çœ‹èµ·æ¥åƒ:

```
findUsersByRole(
  'admin',
  true,
  true
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„æœ€åä¸¤ä¸ªå‚æ•°æœ‰å¤šæ¨¡ç³Šã€‚â€œçœŸï¼ŒçœŸâ€æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ

å¦‚æœæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå‡ ä¹ä»ä¸éœ€è¦è”ç³»ä¿¡æ¯ï¼Œä½†å‡ ä¹æ€»æ˜¯éœ€è¦ä¸æ´»è·ƒçš„ç”¨æˆ·ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬ä¸å¾—ä¸ä¸€ç›´ä¸è¿™ä¸ªä¸­é—´å‚æ•°ä½œæ–—äº‰ï¼Œå°½ç®¡å®ƒå®é™…ä¸Šå¹¶ä¸ç›¸å…³(åé¢ä¼šæœ‰æ›´å¤šçš„ä»‹ç»)ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œè¿™ç§ä¼ ç»Ÿçš„æ–¹æ³•ç•™ç»™æˆ‘ä»¬çš„æ˜¯æ½œåœ¨çš„æ¨¡ç³Šã€å˜ˆæ‚çš„ä»£ç ï¼Œè¿™äº›ä»£ç æ›´éš¾ç†è§£ã€æ›´éš¾ç¼–å†™ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬æ¥æ”¶åˆ°å•ä¸ªå¯¹è±¡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ:

```
function findUsersByRole ({
  role,
  withContactInfo,
  includeInactive
}) {...} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„æˆ‘ä»¬çš„å‡½æ•°çœ‹èµ·æ¥å‡ ä¹ä¸€æ ·ï¼Œé™¤äº†**æˆ‘ä»¬åœ¨å‚æ•°**å‘¨å›´æ”¾äº†å¤§æ‹¬å·ã€‚è¿™è¡¨æ˜æˆ‘ä»¬çš„å‡½æ•°ç°åœ¨æœŸæœ›ä¸€ä¸ªå…·æœ‰å±æ€§åä¸º`role`ã€`withContactInfo`å’Œ`includeInactive`çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ¥æ”¶ä¸‰ä¸ªä¸åŒçš„å‚æ•°ã€‚

è¿™æ˜¯å› ä¸º ES2015 ä¸­å¼•å…¥äº†ä¸€ä¸ªåä¸º*destructing*çš„ JavaScript åŠŸèƒ½ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™æ ·è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°:

```
findUsersByRole({
  role: 'admin',
  withContactInfo: true,
  includeInactive: true
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™è¿œæ²¡æœ‰é‚£ä¹ˆæ¨¡ç³Šï¼Œè€Œä¸”æ›´å®¹æ˜“é˜…è¯»å’Œç†è§£ã€‚å¦å¤–ï¼Œçœç•¥æˆ–é‡æ–°æ’åºæˆ‘ä»¬çš„å‚æ•°ä¸å†æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬ç°åœ¨æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å‘½åå±æ€§ã€‚

æ¯”å¦‚è¿™ä¸ªä½œå“:

```
findUsersByRole({
  withContactInfo: true,
  role: 'admin',
  includeInactive: true
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿˜æœ‰è¿™ä¸ªä¹Ÿæ˜¯:

```
findUsersByRole({
  role: 'admin',
  includeInactive: true
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¹Ÿä½¿å¾—åœ¨ä¸ç ´åæ—§ä»£ç çš„æƒ…å†µä¸‹æ·»åŠ æ–°å‚æ•°æˆä¸ºå¯èƒ½ã€‚

è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œæ¢å¥è¯è¯´ï¼Œå¦‚æœä¸‹é¢æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„è°ƒç”¨â€¦

```
findUsersByRole() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

â€¦æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„å‚æ•°å¯¹è±¡è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå°±åƒè¿™æ ·:

```
function findUsersByRole ({
  role,
  withContactInfo,
  includeInactive
} = {}) {...} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯¹æˆ‘ä»¬çš„å‚æ•°å¯¹è±¡ä½¿ç”¨ææ„çš„ä¸€ä¸ªé¢å¤–å¥½å¤„æ˜¯å®ƒä¿ƒè¿›äº†ä¸å˜æ€§ã€‚å½“æˆ‘ä»¬åœ¨å‡½æ•°ä¸­ææ„`object`æ—¶ï¼Œæˆ‘ä»¬å°†å¯¹è±¡çš„å±æ€§èµ‹ç»™æ–°çš„å˜é‡ã€‚æ›´æ”¹è¿™äº›å˜é‡çš„å€¼ä¸ä¼šæ”¹å˜åŸå§‹å¯¹è±¡ã€‚

è€ƒè™‘ä»¥ä¸‹æƒ…å†µ:

```
const options = {
  role: 'Admin',
  includeInactive: true
}

findUsersByRole(options)

function findUsersByRole ({
  role,
  withContactInfo,
  includeInactive
} = {}) {
  role = role.toLowerCase()
  console.log(role) // 'admin'
  ...
}

console.log(options.role) // 'Admin' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å³ä½¿æˆ‘ä»¬æ”¹å˜äº†`role`çš„å€¼ï¼Œä½†æ˜¯`options.role`çš„å€¼ä¿æŒä¸å˜ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œææ„ä¼šç”Ÿæˆä¸€ä¸ª _ ***æµ…***_ å‰¯æœ¬ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬çš„å‚æ•°å¯¹è±¡çš„ä»»ä½•å±æ€§æ˜¯å¤æ‚ç±»å‹(ä¾‹å¦‚`array`æˆ–`object`)ï¼Œæ›´æ”¹å®ƒä»¬ç¡®å®ä¼šå½±å“åŸå§‹å¯¹è±¡ã€‚

## [](#cleaner-default-parameters)æ¸…æ´å‰‚é»˜è®¤å‚æ•°

é€šè¿‡ ES2015ï¼ŒJavaScript å‡½æ•°è·å¾—äº†å®šä¹‰é»˜è®¤å‚æ•°çš„èƒ½åŠ›ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬æœ€è¿‘åœ¨ä¸Šé¢çš„`findUsersByRole`å‡½æ•°ä¸­å°†`={}`æ·»åŠ åˆ°å‚æ•°å¯¹è±¡æ—¶ä½¿ç”¨äº†ä¸€ä¸ªé»˜è®¤å‚æ•°ã€‚

ä½¿ç”¨ä¼ ç»Ÿçš„é»˜è®¤å‚æ•°ï¼Œæˆ‘ä»¬çš„`findUsersByRole`å‡½æ•°å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºã€‚

```
function findUsersByRole (
  role,
  withContactInfo = true,
  includeInactive
) {...} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæˆ‘ä»¬æƒ³å°†`includeInactive`è®¾ç½®ä¸º`true`ï¼Œæˆ‘ä»¬å¿…é¡»æ˜¾å¼åœ°å°†`undefined`ä½œä¸º`withContactInfo`çš„å€¼æ¥ä¼ é€’ï¼Œä»¥ä¿æŒé»˜è®¤å€¼ï¼Œå°±åƒè¿™æ ·:

```
findUsersByRole(
  'Admin',
  undefined,
  true
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¤šå¯æ€•å•Šã€‚

å°†å…¶ä¸ä½¿ç”¨å¦‚ä¸‹å‚æ•°å¯¹è±¡è¿›è¡Œæ¯”è¾ƒ:

```
function findUsersByRole ({
  role,
  withContactInfo = true,
  includeInactive
} = {}) {...} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æˆ‘ä»¬å¯ä»¥å†™â€¦

```
findUsersByRole({
  role: â€˜Adminâ€™,
  includeInactive: true
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

â€¦å¹¶ä¸”æˆ‘ä»¬çš„é»˜è®¤å€¼`withContactInfo`è¢«ä¿ç•™ã€‚

## [](#bonus-required-parameters)å¥–é‡‘:å¿…é€‰å‚æ•°

ä½ å¤šä¹…å†™ä¸€æ¬¡è¿™æ ·çš„ä¸œè¥¿ï¼Ÿ

```
function findUsersByRole ({
  role,
  withContactInfo,
  includeInactive
} = {}) {
  if (role == null) {
    throw Error(...)
  }
  ...
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

***æ³¨:*** *æˆ‘ä»¬ç”¨ä¸Šé¢çš„åŒç­‰å·(==)æ¥æµ‹è¯•ç”¨ä¸€æ¡è¯­å¥åŒæ—¶æµ‹è¯•* `null` *å’Œ* `undefined` *ã€‚*

å¦‚æœæˆ‘å‘Šè¯‰æ‚¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤å‚æ•°æ¥éªŒè¯å¿…éœ€çš„å‚æ•°ï¼Œé‚£ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªæŠ›å‡ºé”™è¯¯çš„`requiredParam()`å‡½æ•°ã€‚

åƒè¿™æ ·:

```
function requiredParam (param) {
  const requiredParamError = new Error(
   `Required parameter, "${param}" is missing.`
  )

  // preserve original stack trace
  if (typeof Error.captureStackTrace === â€˜functionâ€™) {
    Error.captureStackTrace(
      requiredParamError,
      requiredParam
    )
  }

  throw requiredParamError
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### [](#i-know-i-know-requiredparam-doesnt-roro-thats-why-i-said-many-of-my-functions%E2%80%8A%E2%80%8Anot-all-)*æˆ‘çŸ¥é“ï¼Œæˆ‘çŸ¥é“ã€‚requiredParam ä¸ ROROã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘è¯´* ***æˆ‘çš„åŠŸèƒ½ä¸­æœ‰å¾ˆå¤š****â€”â€”è€Œä¸æ˜¯æ‰€æœ‰***ã€‚**

 *ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹`requiredParam`çš„è°ƒç”¨è®¾ç½®ä¸º`role`çš„é»˜è®¤å€¼ï¼Œæ¯”å¦‚:

```
function findUsersByRole ({
  role = requiredParam('role'),
  withContactInfo,
  includeInactive
} = {}) {...} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœä»»ä½•äººåœ¨æ²¡æœ‰æä¾›`role`çš„æƒ…å†µä¸‹è°ƒç”¨`findUsersByRole`ï¼Œä»–ä»¬å°†å¾—åˆ°ä¸€ä¸ªè¡¨ç¤º`Required parameter, â€œroleâ€ is missing.`çš„`Error`

ä»æŠ€æœ¯ä¸Šè®²ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿™ç§æŠ€æœ¯ä¸å¸¸è§„é»˜è®¤å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼›æˆ‘ä»¬ä¸ä¸€å®šéœ€è¦ä¸€ä¸ªå¯¹è±¡ã€‚ä½†è¿™ä¸€æ‹›å¤ªæœ‰ç”¨äº†ï¼Œä¸èƒ½ä¸æã€‚

## [](#richer-return-values)æ›´ä¸°å¯Œçš„è¿”å›å€¼

JavaScript å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚å¦‚æœè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ª`object`ï¼Œå®ƒå¯ä»¥åŒ…å«æ›´å¤šçš„ä¿¡æ¯ã€‚

è€ƒè™‘ä¸€ä¸ªå°†`User`ä¿å­˜åˆ°æ•°æ®åº“çš„å‡½æ•°ã€‚å½“è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒå¯ä»¥å‘è°ƒç”¨è€…æä¾›å¤§é‡ä¿¡æ¯ã€‚

ä¾‹å¦‚ï¼Œä¸€ç§å¸¸è§çš„æ¨¡å¼æ˜¯åœ¨ä¿å­˜å‡½æ•°ä¸­â€œå‘ä¸Šæ’å…¥â€æˆ–â€œåˆå¹¶â€æ•°æ®ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å°†è¡Œæ’å…¥æ•°æ®åº“è¡¨(å¦‚æœå®ƒä»¬ä¸å­˜åœ¨)æˆ–æ›´æ–°å®ƒä»¬(å¦‚æœå®ƒä»¬å­˜åœ¨)ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒçŸ¥é“æˆ‘ä»¬çš„ä¿å­˜å‡½æ•°æ‰§è¡Œçš„æ“ä½œæ˜¯`INSERT`è¿˜æ˜¯`UPDATE`ä¼šå¾ˆæ–¹ä¾¿ã€‚è·å¾—æ•°æ®åº“ä¸­å­˜å‚¨å†…å®¹çš„å‡†ç¡®è¡¨ç¤ºä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼Œäº†è§£æ“ä½œçš„çŠ¶æ€ä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼›å®ƒæˆåŠŸäº†å—ï¼Ÿå®ƒä½œä¸ºä¸€ä¸ªæ›´å¤§çš„äº‹åŠ¡çš„ä¸€éƒ¨åˆ†æŒ‚èµ·äº†å—ï¼Ÿå®ƒè¶…æ—¶äº†å—ï¼Ÿ

å½“è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¾ˆå®¹æ˜“ä¸€æ¬¡ä¼ è¾¾æ‰€æœ‰è¿™äº›ä¿¡æ¯ã€‚

å¤§æ¦‚æ˜¯:

```
async saveUser({
  upsert = true,
  transaction,
  ...userInfo
}) {
  // save to the DB
  return {
    operation, // e.g 'INSERT'
    status, // e.g. 'Success'
    saved: userInfo
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä»æŠ€æœ¯ä¸Šè®²ï¼Œä¸Šé¢è¿”å›äº†ä¸€ä¸ªè§£æä¸ºä¸€ä¸ª`object`çš„`Promise`,ä½†æ˜¯ä½ æ˜ç™½äº†ã€‚

## [](#easy-function-composition)ç®€æ˜“å‡½æ•°æ„å›¾

> â€œåŠŸèƒ½ç»„åˆæ˜¯å°†ä¸¤ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½ç»„åˆèµ·æ¥äº§ç”Ÿä¸€ä¸ªæ–°åŠŸèƒ½çš„è¿‡ç¨‹ã€‚å°†å‡½æ•°ç»„åˆåœ¨ä¸€èµ·å°±åƒæ˜¯å°†ä¸€ç³»åˆ—ç®¡é“è¿æ¥åœ¨ä¸€èµ·ï¼Œè®©æˆ‘ä»¬çš„æ•°æ®æµè¿‡ã€‚â€â€”åŸƒé‡Œå…‹Â·åŸƒåˆ©å¥¥ç‰¹

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»ä¼¼äº
çš„`pipe`å‡½æ•°æ¥ç»„åˆå‡½æ•°

```
function pipe(...fns) {
  return param => fns.reduce(
    (result, fn) => fn(result),
    param
  )
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šé¢çš„å‡½æ•°è·å–ä¸€ä¸ªå‡½æ•°åˆ—è¡¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯ä»¥ä»å·¦åˆ°å³åº”ç”¨è¯¥åˆ—è¡¨çš„å‡½æ•°ï¼Œä»ç»™å®šçš„å‚æ•°å¼€å§‹ï¼Œç„¶åå°†åˆ—è¡¨ä¸­æ¯ä¸ªå‡½æ•°çš„ç»“æœä¼ é€’ç»™åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå‡½æ•°ã€‚

å¦‚æœä½ æ„Ÿåˆ°å›°æƒ‘ï¼Œä¸è¦æ‹…å¿ƒï¼Œä¸‹é¢æœ‰ä¸€ä¸ªä¾‹å­å¯ä»¥è®©ä½ æ˜ç™½ã€‚

è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªé™åˆ¶æ˜¯åˆ—è¡¨ä¸­çš„æ¯ä¸ªå‡½æ•°åªèƒ½æ¥æ”¶ä¸€ä¸ªå‚æ•°ã€‚å¹¸è¿çš„æ˜¯ï¼Œå½“æˆ‘ä»¬æ»šçš„æ—¶å€™è¿™ä¸æ˜¯é—®é¢˜ï¼

è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª`saveUser`å‡½æ•°ï¼Œå®ƒé€šè¿‡ä¸‰ä¸ªç‹¬ç«‹çš„å‡½æ•°æ¥ä¼ é€’ä¸€ä¸ª`userInfo`å¯¹è±¡ï¼Œè¿™ä¸‰ä¸ªå‡½æ•°ä¾æ¬¡éªŒè¯ã€è§„èŒƒåŒ–å’ŒæŒä¹…åŒ–ç”¨æˆ·ä¿¡æ¯ã€‚

```
function saveUser(userInfo) {
  return pipe(
    validate,
    normalize,
    persist
  )(userInfo)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„`validate`ã€`normalize`å’Œ`persist`å‡½æ•°ä¸­ä½¿ç”¨ [rest å‚æ•°](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters)æ¥ä»…ææ„æ¯ä¸ªå‡½æ•°éœ€è¦çš„å€¼ï¼Œå¹¶ä¸”ä»ç„¶å°†æ‰€æœ‰å†…å®¹ä¼ é€’å›è°ƒç”¨è€…ã€‚

è¿™é‡Œæœ‰ä¸€å°æ®µä»£ç å¯ä»¥å‘Šè¯‰ä½ å®ƒçš„è¦ç‚¹:

```
function validate(
  id,
  firstName,
  lastName,
  email = requiredParam(),
  username = requiredParam(),
  pass = requiredParam(),
  address,
  ...rest
) {
  // do some validation
  return {
    id,
    firstName,
    lastName,
    email,
    username,
    pass,
    address,
    ...rest
  }
}

function normalize(
  email,
  username,
  ...rest
) {
  // do some normalizing
  return {
    email,
    username,
    ...rest
  }
}

async function persist({
  upsert = true,
  ...info
}) {
  // save userInfo to the DB
  return {
    operation,
    status,
    saved: info
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#to-ro-or-not-to-ro-that-is-the-question)è¦ RO è¿˜æ˜¯ä¸è¦ ROï¼Œè¿™æ˜¯ä¸ªé—®é¢˜

æˆ‘åœ¨ä¸€å¼€å§‹å°±è¯´è¿‡ï¼Œ**æˆ‘çš„å¤§å¤šæ•°**å‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œ**å®ƒä»¬ä¸­çš„è®¸å¤š**ä¹Ÿè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚

åƒä»»ä½•æ¨¡å¼ä¸€æ ·ï¼ŒRORO åº”è¯¥è¢«çœ‹ä½œæ˜¯æˆ‘ä»¬å·¥å…·ç®±ä¸­çš„å¦ä¸€ä¸ªå·¥å…·ã€‚æˆ‘ä»¬é€šè¿‡ä½¿å‚æ•°åˆ—è¡¨æ›´åŠ æ¸…æ™°å’Œçµæ´»ï¼Œä»¥åŠä½¿è¿”å›å€¼æ›´å…·è¡¨è¾¾æ€§ï¼Œåœ¨å®ƒå¢åŠ ä»·å€¼çš„åœ°æ–¹ä½¿ç”¨å®ƒã€‚

å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåªéœ€è¦æ¥æ”¶ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œé‚£ä¹ˆæ¥æ”¶ä¸€ä¸ª`object`å°±å¤ªè¿‡åˆ†äº†ã€‚åŒæ ·ï¼Œå¦‚æœæ‚¨æ­£åœ¨ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ªç®€å•çš„å€¼å‘è°ƒç”¨è€…ä¼ è¾¾ä¸€ä¸ªæ¸…æ™°ç›´è§‚çš„å“åº”ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦è¿”å›ä¸€ä¸ª`object`ã€‚

ä¸€ä¸ªæˆ‘å‡ ä¹ä»ä¸å‡ºé”™çš„ä¾‹å­æ˜¯æ–­è¨€å‡½æ•°ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°`isPositiveInteger`æ¥æ£€æŸ¥ä¸€ä¸ªç»™å®šçš„å‚æ•°æ˜¯å¦æ˜¯æ­£æ•´æ•°ï¼Œè¿™æ ·çš„å‡½æ•°å¯èƒ½æ ¹æœ¬ä¸ä¼šä» RORO ä¸­å—ç›Šã€‚

* * *

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç‚¹å‡»â™¥ï¸å›¾æ ‡å¸®åŠ©ä¼ æ’­ã€‚å¦‚æœä½ æƒ³é˜…è¯»æ›´å¤šç±»ä¼¼çš„ä¸œè¥¿ï¼Œè¯·æ³¨å†Œä¸‹é¢çš„æˆ‘çš„å¼€å‘æŒæ¡æ—¶äº‹é€šè®¯ã€‚

# [](#sign-up-to-the-devmastery-newsletter)[æ³¨å†Œ DevMastery ç®€è®¯](https://upscri.be/83d379/)

æˆ‘ä¼šä¿å¯†ä½ çš„ä¿¡æ¯ï¼Œä»ä¸å‘é€åƒåœ¾é‚®ä»¶ã€‚*