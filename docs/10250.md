# JavaScript ä¸­çš„å‡½æ•°æ ‡è¯†ï¼Œæˆ–è€…å¦‚ä½•æ­£ç¡®ç§»é™¤äº‹ä»¶ä¾¦å¬å™¨

> åŸæ–‡:[https://dev . to/smotchkkiss/function-identity-in-JavaScript-or-how-to-remove-event-listeners-proper-1ll 3](https://dev.to/smotchkkiss/function-identity-in-javascript-or-how-to-remove-event-listeners-properly-1ll3)

ä¸Šå‘¨ï¼Œæˆ‘æŸ¥çœ‹äº†æˆ‘çš„ä¸€ä¸ªåŒäº‹å†™çš„ JavaScriptï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„é”™è¯¯ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå› ä¸ºæˆ‘çŸ¥é“æˆ‘è‡ªå·±åœ¨æŸä¸ªæ—¶å€™è¢«è¿™ä¸ªé—®é¢˜ç»Šå€’äº†ï¼Œåœ¨åˆ«äººçš„ä»£ç ä¸­çœ‹åˆ°å®ƒè®©æˆ‘çŸ¥é“è¿™ç¡®å®æ˜¯ä¸€ä¸ªæ›´å¤šäººæ­£åœ¨åŠªåŠ›è§£å†³çš„æ£˜æ‰‹é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºå®ƒå¯èƒ½å€¼å¾—åˆ†äº«ã€‚

(æˆ‘è¿˜ä¸ºä»–ä»¬å†™äº†ä¸€ç¯‡å¾ˆé•¿çš„æ–‡ç« ï¼Œæè¿°äº†è¿™ä¸ªé—®é¢˜ä»¥åŠå¦‚ä½•è§£å†³å®ƒï¼Œè¿™æ˜¯è¿™ç¯‡æ–‡ç« çš„åŸºç¡€ã€‚)

è¿™æ˜¯é—®é¢˜ä»£ç çš„ç¬¬ä¸€éƒ¨åˆ†(æˆ‘ä»¬è®¨è®ºçš„æ˜¯æµè§ˆå™¨ä¸­çš„æ™®é€š ES6ï¼Œæ²¡æœ‰æ¡†æ¶ã€‚è¿™ä¹Ÿä¸æ˜¯åŸå§‹ä»£ç ï¼Œæˆ‘åˆ é™¤äº†æ‰€æœ‰ä¸æˆ‘æƒ³è¡¨è¾¾çš„è§‚ç‚¹æ— å…³çš„å†…å®¹):

â“

```
// For completeness, imagine these being something sensible:
let elements = document.querySelectorAll(/* ... */)
function mouseenterHandler(element) {
  // ...
}

// This is the interesting part:
elements.forEach(element => {
  element.addEventListener('mouseenter', () => {
    mouseenterHandler(element)
  })
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æŸ¥è¯¢ä¸€äº› DOM å…ƒç´ ï¼Œå¹¶ä¸ºæ¯ä¸ªå…ƒç´ é™„åŠ äº‹ä»¶ä¾¦å¬å™¨ã€‚

ç„¶åï¼Œåœ¨æ›´æ·±å¤„çš„æŸä¸ªåœ°æ–¹ï¼Œåœ¨æ‹†å¸ç¨‹åºä¸­:

â“‘

```
elements.forEach(element => {
  element.removeEventListener('mouseenter', () => {
    mouseenterHandler(element)
  })
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯è¯•å›¾é€šè¿‡ä½¿ç”¨*ç­‰ä»·çš„åŒ¿åå‡½æ•°*ä½œä¸ºå‚æ•°è°ƒç”¨`removeEventListener`æ¥æ³¨é”€äº‹ä»¶ç›‘å¬å™¨ã€‚

## [](#the-problem)é—®é¢˜

`() => { this.mouseenterHandler(element) }`åœ¨â“ä¸­æ˜¯ä¸€ä¸ª*åŒ¿åå‡½æ•°*ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨(å³ï¼Œå®ƒæ²¡æœ‰ä¿å­˜åœ¨å˜é‡ä¸­ï¼Œä¹Ÿæ²¡æœ‰ä»¥ä»»ä½•æ–¹å¼å‘½å)ã€‚

`() => { this.mouseenterHandler(element) }`åœ¨â“‘æ˜¯ä¸€ä¸ª*ç­‰ä»·çš„åŒ¿åå‡½æ•°*ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œå®ƒä»¬æ˜¯*ç­‰ä»·çš„*ï¼Œè€Œä¸æ˜¯*ç›¸åŒçš„*ã€‚

## JavaScript å¦‚ä½•æ¯”è¾ƒå‡½æ•°

JavaScript ä¸­çš„å‡½æ•°æ˜¯å¯¹è±¡ï¼Œåƒæ‰€æœ‰å…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œå®ƒä»¬é€šè¿‡å¼•ç”¨è¿›è¡Œæ¯”è¾ƒã€‚è¿™æ„å‘³ç€ JavaScript æ— æ³•ç¡®å®šä¸¤ä¸ªå‡½æ•°çš„ç­‰ä»·æ€§ã€‚

### ä½ æ²¡æœ‰è¿è½½å®ƒä»¬å—ï¼Ÿ

ç°åœ¨æˆ‘ä»¬å¯èƒ½ä¼šæƒ³ï¼ŒJavaScript å·²ç»å¯ä»¥åºåˆ—åŒ–å‡½æ•°äº†ï¼Œä¸ºä»€ä¹ˆä¸ç®€å•åœ°é€šè¿‡å­—ç¬¦ä¸²è¡¨ç¤ºæ¥æ¯”è¾ƒå®ƒä»¬å‘¢ï¼Ÿ

```
let f1 = (x) => { return x + 1 }
let f2 = (x) => { return x + 1 }

console.log(f1.toString()) // '(x) => { return x + 1 }'
console.log(f2.toString()) // '(x) => { return x + 1 }'

// ... so:
console.log(f1.toString() === f2.toString()) // true - yay!? 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯è®©æˆ‘ä»¬æ¥è€ƒè™‘è¿™ä¸ªç•¥æœ‰ä¸åŒï¼Œä½†å¯ä»¥è¯´æ˜¯ç­‰ä»·çš„å‡½æ•°:

```
function f3(x) {
  return x + 1
}

console.log(f3.toString()) // 'function f3(x) {\n  return x + 1\n}' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¾ˆæ˜æ˜¾ï¼Œ`f1.toString() === f3.toString()`å’Œ`f2.toString() === f3.toString()`å°†ä¸ºå‡ï¼Œå°½ç®¡å¯¹äº[ `Number.MIN_SAFE_INTEGER`ï¼Œ`Number.MAX_SAFE_INTEGER - 1` ]ä¸­ä»»ä½•ç»™å®šçš„ xï¼Œ`f1(x) === f3(x)`å’Œ`f2(x) === f3(x)`å°†ä¸ºçœŸä¹Ÿæ˜¯å¾®ä¸è¶³é“çš„(å®é™…ä¸Šå¯¹äº`x`çš„è®¸å¤šå…¶ä»–å€¼ä¹Ÿæ˜¯å¦‚æ­¤)ã€‚

æ‰€ä»¥è¿™ä¸ªæ–¹æ³•åªé€‚ç”¨äºä»¥å®Œå…¨ç›¸åŒçš„æ–¹å¼å†™å‡ºçš„å‡½æ•°ã€‚

### [](#how-its-actually-done)å®é™…ä¸Šæ˜¯æ€ä¹ˆåšçš„

åœ¨ JavaScript ä¸­ï¼ŒåŸºæœ¬ä¸Šæœ‰ä¸‰ç§*åŸºæœ¬æ•°æ®ç±»å‹æ˜¯ä¸å¯å˜çš„*ï¼Œè¿™æ˜¯ä¸€ç§å¥‡ç‰¹çš„æ¯”è¾ƒç§‘å­¦çš„è¯´æ³•ï¼Œå®ƒä»¬çš„è¡Œä¸ºæœ‰ç‚¹åƒçº¸ç¬”æ•°å­¦ä¸­çš„äº‹æƒ…ã€‚å…¶ä¸­ä¸€ç§å°±æ˜¯`Number`å‹ã€‚åœ¨æ•°å­¦ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ•°å­—ğŸ.åœ¨è¿™é‡Œè°ˆè®ºè¿™ä¸ªğŸï¼Œåœ¨é‚£é‡Œè°ˆè®ºé‚£ä¸ªğŸæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚æˆ‘ä»¬å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°å†™å‡º*å­—ç¬¦* ğŸï¼Œä½†å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªä»ç„¶æ˜¯å¯¹åŒä¸€ä¸ªå•ä¸€æ•°å­—ğŸ.çš„å¼•ç”¨åœ¨ JavaScript ä¸­ä¹Ÿæ˜¯å¦‚æ­¤:* 

 *```
let a = 2
let b = 2

console.log(a === b) // true 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

JS ä¸­å¦å¤–ä¸¤ä¸ª*åŸºæœ¬æ•°æ®ç±»å‹æ˜¯`String`å’Œ`Boolean`ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ç­‰ä»·æ¥æ¯”è¾ƒ`f1`ã€`f2`å’Œ`f3`çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚

**JavaScript ä¸­çš„å…¶ä»–æ‰€æœ‰ä¸œè¥¿**éƒ½é€šè¿‡å¼•ç”¨è¿›è¡Œæ¯”è¾ƒ*ã€‚æ¯æ¬¡æˆ‘ä»¬å†™`[]`ï¼Œæˆ‘ä»¬åˆ›å»º*ä¸€ä¸ªæ–°çš„æ•°ç»„*ï¼Œå®ƒæ˜¯*è€Œä¸æ˜¯æˆ‘ä»¬ä¸‹æ¬¡å†™`[]`çš„åŒä¸€ä¸ª*ï¼Œæ¯æ¬¡æˆ‘ä»¬å†™`{}`æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ¯æ¬¡æˆ‘ä»¬å†™`() => {}`ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚*

<small>(ä¸¥æ ¼æ¥è¯´ï¼Œä¸æ˜¯æ¯æ¬¡*æˆ‘ä»¬å†™*`[]``{}`æˆ–è€…`() => {}`ï¼Œè€Œæ˜¯æ¯æ¬¡è¿™äº›*ä¸­çš„ä¸€ä¸ªè¢«æ±‚å€¼*ã€‚è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„åŒºåˆ«ã€‚æƒ³è±¡ä¸€ä¸‹åƒ`function makeObj () { return {} }`è¿™æ ·çš„å‡½æ•°â€”â€”æ¯æ¬¡æˆ‘ä»¬è°ƒç”¨`makeObj()`ï¼Œå®ƒéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚)</small>

æ¢å¥è¯è¯´ï¼Œ

```
console.log([] === []) // false
console.log({} === {}) // false
console.log((() => {}) === (() => {})) // false, too! 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯

```
let a1 = []
let a2 = a1
console.log(a2 === a1) // true
let o1 = {}
let o2 = o1
console.log(o2 === o1) // true
let f4 = () => {}
let f5 = f4
console.log(f5 === f4) // also true 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## è¿™å’Œæˆ‘ä»¬çš„ eventListeners æœ‰ä»€ä¹ˆå…³ç³»

æƒ³è±¡ä¸€ä¸‹ï¼Œå¯¹äº DOM ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼ŒJavaScript åˆ›å»ºä¸€ä¸ªæ•°ç»„æ¥ä¿å­˜æ‰€æœ‰çš„ mouseenter ä¾¦å¬å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
let myElementMouseenterListeners = [] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¯æ¬¡æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œæ¯”å¦‚

```
myElement.addEventListener('mouseenter', () => { console.log('yay') }) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

JavaScript åœ¨å†…éƒ¨åªæ˜¯å°†å®ƒæ·»åŠ åˆ°æ•°ç»„:

```
let myListenerToAdd = () => { console.log('yay') }

myElementMouseenterListeners.push(myListenerToAdd)

console.log(myElementMouseenterListeners) // [ [Function] ] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“`'mouseenter'`äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒJS å°†è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸ªå‡½æ•°:

```
let myMouseenterEvent = new MouseEvent('mouseenter')

myElementMouseenterListeners.forEach(mouseenterListener => {
  mouseenterListener(myMouseenterEvent)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“æˆ‘ä»¬è¯•å›¾åˆ é™¤ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨æ—¶ï¼ŒJavaScript å°†éå†äº‹ä»¶ç›‘å¬å™¨æ•°ç»„ï¼Œå°†å…¶ä¸­çš„æ¯ä¸ªå‡½æ•°ä¸æˆ‘ä»¬è¯•å›¾åˆ é™¤çš„å‡½æ•°è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ°å¥½æ˜¯*ç›¸åŒçš„*ï¼Œåˆ™å°†å®ƒä»æ•°ç»„ä¸­åˆ é™¤ã€‚

æƒ³è±¡æˆ‘ä»¬åš:

```
myElement.removeEventListener('mouseenter', () => { console.log('yay') }) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è€Œ JavaScript åšåˆ°äº†:

```
let myListenerToRemove = () => { console.log('yay') }

for (let i = 0; i < myElementMouseenterListeners.length; i++) {
  if (myElementMouseenterListeners[i] === myListenerToRemove) {
    myElementMouseenterListeners.splice(i, 1)
    break
  }
}

console.log(myElementMouseenterListeners) // still [ [Function] ] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ„å‘³ç€ï¼Œå½“å¾ªç¯åˆ°è¾¾æˆ‘ä»¬åœ¨å¼€å§‹æ—¶æ·»åŠ çš„ä¾¦å¬å™¨æ—¶ï¼Œå®ƒä¼šå°†å®ƒä¸æˆ‘ä»¬æä¾›ç»™`removeEventListener`çš„ä¾¦å¬å™¨è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥å‘ç”Ÿçš„äº‹æƒ…åŸºæœ¬ä¸Šæ˜¯è¿™æ ·çš„:

```
() => { console.log('yay') } === () => { console.log('yay') } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è®¨è®ºçš„ï¼Œç»“æœä¸ºå‡ã€‚

è¿™æ„å‘³ç€åƒ
è¿™æ ·çš„ä»£ç 

```
element.removeEventListener('eventname', () => { console.log('event handled') }) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç”¨é‚£ä¸ªæ—¶åˆ»åˆšåˆšåˆ›å»ºçš„*åŒ¿åå‡½æ•°*ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°è°ƒç”¨`removeEventListener`ï¼Œ**æ°¸è¿œä¸ä¼šå¯¹**äº§ç”Ÿä»»ä½•å½±å“ã€‚ç›¸åï¼Œå®ƒä¼šæ— å£°æ— æ¯åœ°å¤±è´¥ã€‚

## [](#what-we-need-to-do-instead-possible-solutions)æˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…(å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ)

ä¸ºäº†è®©`removeEventListener`ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¿…é¡»æä¾›ä¸€ä¸ªå¯¹æˆ‘ä»¬ä¹‹å‰é€šè¿‡`addEventListener`æ³¨å†Œçš„å‡½æ•°çš„å¼•ç”¨ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œç±»ä¼¼äº

```
let element = document.querySelector(/* ... */)
function mouseenterHandler() {
  // ...
}

element.addEventListener('mouseenter', mouseenterHandler)

element.removeEventListener('mouseenter', mouseenterHandler) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å°†ä¼šèµ·ä½œç”¨ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä»»ä½•åœ°æ–¹éƒ½ä½¿ç”¨å¯¹åŒä¸€ä¸ªå‡½æ•°çš„å¼•ç”¨ï¼Œæ‰€ä»¥å½“è°ƒç”¨`removeEventListener`æ—¶ï¼Œå®ƒä¼šåƒ`this.mouseenterHandler === this.mouseenterHandler`ä¸€æ ·é€šè¿‡æ¯”è¾ƒæ¥æ‰¾å‡ºè¦åˆ é™¤å“ªä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ˜¯åƒçœŸä¸‡ç¡®çš„ã€‚

ç°åœ¨çš„â€œé—®é¢˜â€æ˜¯æˆ‘ä»¬å®é™…çš„`mouseenterHandler`è¢«ä¸€èˆ¬åŒ–äº†â€”â€”å®ƒå°†ä¸€ä¸ªå…ƒç´ ä½œä¸ºå‚æ•°ã€‚è¿™æ— ç–‘æ˜¯ä¸€ä¸ªæ¯”ä¸ºæˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æ¯ä¸ªå…ƒç´ ç¼–å†™ä¸€ä¸ªæ–°çš„`mouseenterHandler`å‡½æ•°æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å°†å‚æ•°æ”¾å…¥å…¶ä¸­ï¼Œå¹¶ä¸”å°†å¯¹`mouseenterHandler`çš„è°ƒç”¨åŒ…è£…åœ¨åŒ¿åå‡½æ•°ä¸­åœ¨è¿™é‡Œæ˜¯è¡Œä¸é€šçš„ï¼Œæ­£å¦‚æˆ‘åœ¨ä¸Šé¢è¯¦ç»†è¯´æ˜çš„é‚£æ ·ã€‚

### [](#solution-1-create-specialised-versions-of-the-event-handlers-for-each-element)è§£å†³æ–¹æ¡ˆ 1:ä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºä¸“é—¨ç‰ˆæœ¬çš„äº‹ä»¶å¤„ç†ç¨‹åº

æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸“é—¨ç‰ˆæœ¬çš„`mouseenterHandler`ï¼Œåœ¨æˆ‘ä»¬å¡«å……`elements`ä¹‹åï¼Œå®ƒå·²ç»åŒ…å«äº†é¢å¤–çš„å‚æ•°ã€‚ç±»ä¼¼äº:

```
let elements = document.querySelectorAll(/* ... */)
let enhancedElements = []

elements.forEach(element => {
  enhancedElements.push({
    element,
    mouseenterHandler() { mouseenterHandler(element) },
  })
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åï¼Œæ›´æ”¹ä»£ç ï¼Œå°†å¤„ç†ç¨‹åºæ·»åŠ åˆ°

â“

```
enhancedElements.forEach(ee => {
  ee.element.addEventListener('mouseenter', ee.mouseenterHandler)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å’Œç§»é™¤ï¼Œåˆ†åˆ«è¿›å…¥

â“‘

```
enhancedElements.forEach(ee => {
  ee.element.removeEventListener('mouseenter', ee.mouseenterHandler)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯å¯è¡Œçš„ï¼Œä½†ä¹Ÿä¼šä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºä¸€ä¸ªé¢å¤–çš„å¯¹è±¡å’Œå‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰é‚£ä¹ˆå¤šå…ƒç´ ï¼Œè¿™å¯èƒ½ä¸æ˜¯é—®é¢˜ï¼Œä½†ä»ç„¶æœ‰ä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼â€¦

### è§£å†³æ–¹æ¡ˆ 2:æ”¹å˜æˆ‘ä»¬çš„äº‹ä»¶å¤„ç†ç¨‹åºæ¥å¤„ç†ä»–ä»¬å·²ç»å¾—åˆ°çš„å‚æ•°

æµè§ˆå™¨å°†è°ƒç”¨æˆ‘ä»¬çš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°†äº‹ä»¶ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚äº‹ä»¶åªæ˜¯ä¸€ä¸ªå…·æœ‰è®¸å¤šå±æ€§çš„å¯¹è±¡ï¼Œå…¶ä¸­ä¸€ä¸ªå±æ€§æ˜¯`event.target`ï¼Œå®ƒæ˜¯å¯¹å‘ç”Ÿäº‹ä»¶çš„å…ƒç´ çš„å¼•ç”¨ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸æ”¹å˜æˆ‘ä»¬çš„äº‹ä»¶å¤„ç†ç¨‹åºæ¥ä½¿ç”¨å®ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸éœ€è¦æ‰‹å·¥æŠŠå…ƒç´ ç¡¬å¡è¿›å»äº†ï¼Ÿ

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„ mouseenterHandler çœ‹èµ·æ¥åƒè¿™æ ·:

```
mouseenterHandler(element) {
  element.classList.add(/* ... */)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¹æˆä½¿ç”¨`event.target`æ¥ä»£æ›¿:

```
mouseenterHandler(event) {
  event.target.classList.add(/* ... */)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ–è€…åœ¨å‚æ•°åˆ—è¡¨ä¸­ä½¿ç”¨ææ„ rightï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨é‡å¤`event.`éƒ¨åˆ†:

```
 mouseenterHandler({ target }) {
  target.classList.add(/* ... */)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ‰äº†è¿™ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥è®©`let elements = document.querySelectorAll(/* ... */)`çº¿ä¿æŒåŸæ ·ï¼›ä¸éœ€è¦é¢å¤–çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œæˆ‘ä»¬åªè¦æŠŠâ“æ”¹æˆ:

```
elements.forEach(element => {
  element.addEventListener('mouseenter', mouseenterHandler)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å’Œâ“‘å¯¹å·å…¥åº§:

```
elements.forEach(element => {
  element.removeEventListener('mouseenter', mouseenterHandler)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬çš„äº‹ä»¶å¤„ç†ç¨‹åºç°åœ¨æ˜¯â€œé€šç”¨çš„â€ï¼Œå¯ä»¥ä¸åŠ ä¿®æ”¹åœ°ç”¨äºä»»ä½•å…ƒç´ ã€‚

<small>*æˆ‘æ’’è°äº†ã€‚`undefined`ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ã€‚</small>

* * *

æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼è¿™æ˜¯æˆ‘åœ¨ dev.to ä¸Šçš„ç¬¬ä¸€ç¯‡å¸–å­ï¼Œè€Œä¸”æˆ‘çš„æ¯è¯­ä¸æ˜¯è‹±è¯­ï¼Œæ‰€ä»¥å…³äºé£æ ¼ã€æœ‰ç”¨æ€§ç­‰çš„ä¸€èˆ¬åé¦ˆã€‚ä¸èƒœæ„Ÿæ¿€:)*