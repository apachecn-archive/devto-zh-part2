# 应用环境

> 原文：<https://dev.to/isaacdlyman/application-environments--g3o>

# 环境到底是什么？

大多数软件公司都将他们的产品部署到几个不同的环境中，这些环境的名称有*本地*、*开发*、*测试*、*阶段*和*生产*。在我成为开发人员的第一天，我很困惑为什么在开发人员的电脑和客户使用的应用程序之间有这么多步骤。这似乎效率低下，官僚作风严重。不过，我已经开始欣赏这些环境，这些天，如果有人谈论直接部署到生产环境，我会出一身冷汗。如果您对这些术语不熟悉，或者如果您也想知道为什么应用程序需要如此多的环境，请不要离开:我将向您介绍每一个环境的内幕。

但首先，什么是环境？它是一台运行你的软件并由你控制的计算机(真实的或虚拟的)。如果您使用持续集成工具(如 VSTS、特拉维斯、GitLab 或我个人最喜欢的 TeamCity)，您可能可以访问一个整洁的环境列表，旁边有构建项目最新版本并将其部署到这些环境的按钮。您可能还有可以在每个环境中运行的任务，比如单元测试或端到端测试。你自己的电脑就是一个环境，简称*本地*，提供客户访问你产品的服务器就是*生产*环境。

让我们来讨论一下这些环境的用途以及每种环境的最佳实践。我的假设是您正在使用 Git 并开发一个在 web 上运行的应用程序，但是同样的原则也适用于其他版本控制系统和平台。

# 标准环境之旅

### 本地

这是所有开发工作发生的地方。除了你，没人能接触到这个环境，谢天谢地，因为如果你和我一样，它通常都会坏掉。您使用本地环境来迭代您自己的任务，并查看代码更改的结果。

最佳实践:

*   经常提交。
*   定期从您团队的主分支合并。
*   在打开一个拉请求之前，运行项目的所有自动化测试。你有测试，对吗？
*   如果你知道某个东西坏了，就不要把它合并回 master。有时候这样做可能是有意义的，但是一定要提前通知你的团队。

### 开发

这是开发工作的前沿。所有最新的代码都在这里。对于开发人员来说，这是一个很好的地方，他们可以用模拟数据测试新功能，并验证他们的代码与其他人的代码是否兼容。

最佳实践:

*   产品开发和工程部门之外的任何人都不能访问 Dev。连 QA 都没有。
*   Dev 不应*用于演示产品。它半生不熟。它随时被打破是完全可以接受的；开发人员尽量不破坏它，但那只是为了他们自己的生产力。*
*   任何抱怨 Dev 被破坏的人都应该准备好被扔芹菜杆和奶酪。
*   每次有新的提交时，Dev 应该从主分支自动部署。

### 测试

这是该公司第一次有机会检查他们的开发人员和自动化测试没有发现的任何问题。

最佳实践:

*   除非已经通过了项目的所有自动化测试和手动健全性检查，否则不应该部署任何东西进行测试。
*   公司应该将其 QA 资源集中在测试环境上。在每个计划发布的前几天，熟悉产品的人应该在那里开始回归测试。从测试开始到代码进入阶段，唯一要测试的新代码应该是错误修复。
*   当在测试中发现错误时，应该立即向项目经理报告。当测试失败时，任何人都可以投诉，但是测试不应该用来演示产品。

### 阶段

Stage 旨在以尽可能多的方式模拟生产。这是防止释放 bug 的最后一道防线。Stage 还可用于演示新功能，并针对即将到来的应用程序更改对高接触客户进行培训。

最佳实践:

*   将一个应用程序部署到 Stage 应该表明它已经被公司的 QA 团队批准，并且被认为是没有错误的。
*   如果你的应用在舞台上以某种方式工作，你应该有 99.9%的把握它会在生产中以同样的方式工作。一个可行的方法是在同一个基础设施上并行运行 Stage 和 Production，并在发布时从一个切换到另一个。例如，微软 Azure 允许你将应用部署到“应用插槽”，并通过命令行交换任意两个插槽。类似地，Heroku 允许您使用管道接口将应用程序从一个环境移动到另一个环境。
*   如果可能，应该定期用生产中的数据覆盖阶段数据库。
*   舞台上的 bug 应该像生产 bug 一样被划分优先级。
*   大多数时候，舞台和制作应该有完全相同的代码。如果计划在未来几天发布，Stage 可能会在生产之前。

### 生产(现场)

生产是唯一面向客户的环境。这是其他环境存在的原因。随着公司的成长，生产往往变得越来越神圣。如果生产中断，客户将会离开，公司可靠性的声誉将会受损。制作过程中发生的任何事情都有可能出现在新闻中，不管是好是坏。

最佳实践:

*   不要中断生产。
*   你会中断生产的。当你这样做的时候，主动通知你的客户，诚实地面对情况，尽快解决问题，并准备好赔偿任何受到影响的人。
*   不要跳过产品错误修复的 QA。当然，如果情况需要，你可以加快或减少你的质量保证过程。但是要尽最大努力确保修复不会破坏其他地方的东西。

# 最后的想法

这些是大公司的标准环境。如果你的产品还没有上市，开发速度比应用程序的稳定性更重要，你可能只需要几个。随着用户群的增长和容错能力的下降，您可以添加环境来匹配您组织的结构和您可以支配的资源。每个环境都是另一个合适的眼睛可以防止 bug 进入生产环境并影响用户的地方。