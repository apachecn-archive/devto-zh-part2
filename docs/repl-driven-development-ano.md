# REPL 驱动的发展

> 原文：<https://dev.to/jr0cket/repl-driven-development-ano>

Clojure 是一种用于开发应用程序和服务的强大、有趣且高效的语言。这种清晰的语言设计得到了一个强大的开发环境的支持，这个开发环境被称为 REPL (read，evaluate，print，loop)。REPL 为您提供关于代码执行情况的即时反馈，使您能够测试单个表达式或运行整个应用程序(包括测试)。

我采用的方法被称为 REPL 驱动开发，我将在这里详细解释。

## 总是跑着一辆 REPL

我一打开 Clojure 文件，就会启动 REPL。没有 REPL 的编码感觉就像把我的手绑在背后。当我设计代码时，我想从代码中快速获得反馈，测试我的假设和设计选择。

我使用 [Spacemacs](https://spacemacs.org/) 作为我的编辑器，它允许我评估代码并在线显示各个表达式的结果。

当我设计我的代码时，我计算表达式并在表达式下打印结果作为注释。将结果添加为注释是在日志中展示代码设计的一个很好的方式。

## 设计期刊

强烈建议记录您的设计过程，使您的代码更容易理解和维护。日志避免了长时间的移交或开发人员入职流程，因为设计决策的过程已经记录在案。

建议在每个名称空间的底部创建一个设计日志部分。该日志应涵盖

*   用来创建最终命名空间代码的所有重要的 REPL 实验。
*   关于设计选择的讨论，包括那些没有被采用的设计及其原因。
*   可以用来解释函数或函数的一部分如何工作的表达式

设计日志可用于非常容易地为项目创建有意义的文档，并应避免花费时间重复完全相同的对话。

> [使用试剂、clojurescript 和可缩放矢量图形为 TicTacToe 游戏设计日志](https://github.com/jr0cket/tictactoe-reagent/blob/master/src/tictactoe_reagent/core.cljs#L124)

## 维护质量和惯用代码

为了创建高质量的代码，并与 Clojure 社区的其他部分保持一致的风格，我使用了林挺工具，这些工具在我编写代码时也能提供快速反馈。

Joker 和 Eastwood 是 linter 工具，可以高亮显示不符合风格的代码，并可以在您键入时进行配置。这使得在小错误变成令人讨厌的 bug 之前很快修复它们。

Kibit 是一个针对 Clojure、ClojureScript 和 Clojure common 的静态代码分析器。它使用 core.logic 来搜索可以用更惯用的函数或宏重写的代码模式。这有助于使完成的代码更加优雅，当然也是惯用的 Clojure。

## 测试驱动开发和 REPL 驱动开发

你可以一起使用测试驱动开发和 REPL 驱动开发。这些方法非常自然地融合在一起，因为它们都鼓励渐进的变化和持续的反馈。测试驱动开发也很适合吊床时间，因为你应该花更多的时间考虑你想做什么，而不是输入代码。测试提供了一个简单的方法来定义和测试你的设计的假设

借助 REPL 的力量，很容易就能获得关于您的代码到底是如何工作的反馈。测试为你不断发展的设计提供了代码，并在你破坏设计时给你反馈。

在生产之前的某个时候，您应该围绕项目中每个名称空间的公共 API 进行单元测试，以便在提交之前捕捉回归。就思考时间而言，创建这些测试更有效率，因为你可以在事后稳定设计。所以将这些测试作为设计过程的一部分是有意义的。

> 设置一个自动测试运行程序，它将在每次文件保存时运行

## 持续整合

连接一个持续集成服务器，该服务器在每次共享提交时运行测试并构建代码(或者，如果您在本地运行 CI 服务器，则在每次提交时运行代码)。

如果您不共享分支(即推至共享主分支或开发分支)，则根据预定义的分支提交或每次提交，加速您的应用或服务的可测试部署，例如 Heroku 管道。

## 总结

REPL 驱动开发为你提供了一种强大而有趣的软件设计方式，为你的代码设计提供了多方面的快速反馈。

REPL 驱动开发的唯一风险是你可能再也不想在没有 REPL 的情况下编码了。

谢谢

【李】实用