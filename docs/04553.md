# 自动移除 Wordpress 页面中未使用的 CSS？

> 原文:[https://dev . to/benny powers/automatically-remove-unused-CSS-from-WordPress-pages-38p 0](https://dev.to/bennypowers/automatically-removing-unused-css-from-wordpress-pages-38p0)

## 问题

一个客户向我推荐了一个 WordPress 站点(100 多页),它需要 20 多秒才能加载。我用 lighthouse 和其他工具分析了这个网站，发现主页上至少有 2mb 无用的 CSS 和其他垃圾加载。

看看 WP 的设置，它使用了一个现成的(主题商店)主题，带有典型的大量无用的垃圾。

## 天真的解决方法

我可以浏览每一页，用浏览器扩展分析未使用的 CSS，然后将这些分析的结果整理成一个(希望更小的)主题`style.css`这将需要几个小时的重复机械工作，有很多潜在的人为错误。

## 首选策略

像`purifycss`这样的工具能够静态地分析页面的最终呈现标记，并剥离 CSS 文件，只包含使用过的规则。我认为应该很有可能编写一个插件，在每次页面加载时做如下事情:

1.  将所有 CSS 文件连接在一起
2.  用单个链接替换所有 CSS 链接
3.  呈现页面
4.  对呈现的输出运行 purifycss，将缩小和优化的 css 保存到一个具有散列名称的新文件中
5.  用指向新优化文件的链接替换连接的链接
6.  服务页面

所有这些都应该发生在缓存插件之前。

## 提问

这样的东西已经存在了吗？我的计划怎么样，合理吗？我是否忽略了任何潜在的问题？