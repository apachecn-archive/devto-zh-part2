# åœ¨ Jest æµ‹è¯•ä¸­æ¨¡ä»¿ JavaScript çš„å½“å‰æ—¥æœŸ

> åŸæ–‡:[https://dev . to/Hugo _ _ df/mocking-JavaScript s-current-date-in-jest-tests-412j](https://dev.to/hugo__df/mocking-javascripts-current-date-in-jest-tests-412j)

æœ‰äº›æƒ…å†µä¸‹ä¼šåœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­ä½¿ç”¨`Date.now`ã€‚è¿™äº›ä»£ç éœ€è¦è¢«æµ‹è¯•ï¼Œè®°ä½å¦‚ä½•æ¨¡ä»¿`Date.now`æ€»æ˜¯å¾ˆå›°éš¾ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªç¥å¥‡çš„ç‰‡æ®µ:

```
const literallyJustDateNow = () => Date.now();

test('It should call and return Date.now()', () => {
  const realDateNow = Date.now.bind(global.Date);
  const dateNowStub = jest.fn(() => 1530518207007);
  global.Date.now = dateNowStub;

  expect(literallyJustDateNow()).toBe(1530518207007);
  expect(dateNowStub).toHaveBeenCalled();

  global.Date.now = realDateNow;
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> è¿™æ˜¯ä¸Šå‘¨ä¸€ç”¨ Hugo ç®€è®¯ä»¥[ä»£ç å‘å‡ºçš„ã€‚](https://buttondown.email/hugo) [è®¢é˜…](https://buttondown.email/hugo)å¯ä»¥åœ¨ä½ çš„æ”¶ä»¶ç®±é‡Œè·å¾—æœ€æ–°çš„å¸–å­(æ¯”ä»»ä½•äººéƒ½è¦æ—©)ã€‚

è¿™å®é™…ä¸Šä¸æ˜¯ä¸€ä¸ª Jest ç‰¹æœ‰çš„æŠ€å·§ï¼Œæˆ‘ä»¬åªæ˜¯è®¿é—®èŠ‚ç‚¹`global`å¯¹è±¡å¹¶ç”¨ä¸€ä¸ªå­˜æ ¹æ›¿æ¢`Date.now`ã€‚
æˆ‘ä»¬ä¹Ÿæ˜¯è‰¯å¥½çš„å•å…ƒæµ‹è¯•å…¬æ°‘ï¼Œå¹¶æŠŠåŸæ¥çš„`global.Date.now`å®ç°æ”¾å›å»ğŸ˜‡ã€‚

å¸ƒè±æ–¯Â·å·´å…‹åœ¨ Unsplash ä¸Šæ‹æ‘„çš„å°é¢ç…§ç‰‡ã€‚