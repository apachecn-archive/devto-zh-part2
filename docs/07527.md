# è‡ªåŠ¨ç”Ÿæˆ laravel apis æ–‡æ¡£çš„ä¸¤ç§æ–¹æ³•

> åŸæ–‡:[https://dev . to/whoisryosuke/2-ways-to-auto-generate-documentation-for-laravel-APIs-48ba](https://dev.to/whoisryosuke/2-ways-to-auto-generate-documentation-for-laravel-apis--48ba)

æœ€è¿‘ï¼ŒKushy API ç»ˆäºå‘å¸ƒäº† v1 çš„æµ‹è¯•ç‰ˆï¼Œæˆ‘é‡æ–°è®¾è®¡äº† Kushy API æ–‡æ¡£ä»¥ä½¿ç”¨ GatsbyJSã€‚æ–‡æ¡£æœ¬èº«æ˜¯ç”¨ Markdown æ‰‹å†™çš„ï¼Œå…¶ç»“æ„å—å¤§å¤šæ•° API æ–‡æ¡£çš„å¯å‘(å¸¦æœ‰æè¿°ã€ä»£ç ç‰‡æ®µå’Œå“åº”ç¤ºä¾‹çš„ç«¯ç‚¹)ã€‚

è¿™å¾ˆå¿«å˜å¾—éå¸¸ä¹å‘³ï¼Œå½“ API å‘ç”Ÿä»»ä½•å°çš„æ›´æ–°å¹¶éœ€è¦æ‰‹åŠ¨ä¿®æ”¹å•ç‹¬çš„æ–‡æ¡£æŠ¥å‘Šæ—¶ï¼Œè¿™ç«‹å³æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚æ˜¯æ—¶å€™ä»æˆ‘ä»¬çš„ä»£ç åº“è‡ªåŠ¨ç”Ÿæˆæˆ‘ä»¬çš„æ–‡æ¡£ï¼Œå¹¶åœ¨ Laravel æ¡†æ¶å†…å‘ç°å®ç°è¿™ä¸€ç‚¹çš„æœ€ä½³æ–¹å¼äº†ã€‚

ç»è¿‡ä¸€äº›ç ”ç©¶åï¼Œé€‰æ‹©ç›¸å½“å°‘:

1.  ä½¿ç”¨ API è§„èŒƒ **Swagger** æ¥è®°å½•æˆ‘ä»¬çš„ä»£ç å¹¶è¾“å‡ºä¸€ä¸ª Swagger JSON æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ **docblocks** è®°å½•æˆ‘ä»¬çš„ä»£ç ï¼Œå¹¶æ‰¾åˆ°ä¸€ä¸ªç”Ÿæˆå™¨æ¥æ‰«æä»£ç å¹¶å°†å…¶è½¬æ¢ä¸º Markdownã€‚

## [](#say-no-to-swagger)å¯¹éœ¸æ°”è¯´ä¸

æˆ‘ä¸å–œæ¬¢ PHP ä¸­çš„ Swagger å®ç°ã€‚å†™æ–‡æ¡£çœ‹èµ·æ¥å¾ˆç³Ÿç³•ï¼Œæ›´éš¾é˜…è¯»ï¼Œå¹¶ä¸”ç»™æˆ‘çš„äº§å“ä»£ç åº“å¢åŠ äº†è¿‡å¤šçš„ä»£ç ã€‚æˆ‘å®æ„¿ä¸º PHP ç¼–å†™æ ‡å‡†çš„æ–‡æ¡£å—ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸º API æ–‡æ¡£çš„åŸºç¡€ã€‚

### [](#screw-you-i-prefer-swagger)â€œå»ä½ çš„ï¼Œæˆ‘æ›´å–œæ¬¢æ‹›æ‘‡â€

è¿™å¾ˆé…·ï¼Œæˆ‘ç†è§£ Swagger è§„èŒƒçš„è½»æ¾ã€‚èƒ½å¤Ÿè¿è¡Œè„šæœ¬å¹¶ç”Ÿæˆå¯ä»¥å¯¼å…¥åˆ°å…¶ä»–åº“/æ¡†æ¶/ç”Ÿæˆå™¨ä¸­çš„ JSON æ–‡ä»¶çœŸæ˜¯å¤ªæ£’äº†ã€‚å¦‚æœä½ å–œæ¬¢ä½¿ç”¨ Swaggerï¼Œæˆ‘æ¨èä½¿ç”¨ [InfyOm Laravel ç”Ÿæˆå™¨](https://github.com/InfyOmLabs/laravel-generator)ã€‚

æ‚¨å¯ä»¥ç”¨ä¸€ä¸ªç›¸å½“ç®€å•çš„ CLI ç”Ÿæˆæ•´ä¸ª APIã€‚åœ¨ä¸€ä¸ªç®€å•çš„`artisan`å‘½ä»¤å’Œå‡ ä¸ªå›ç­”çš„é—®é¢˜ä¸­ï¼Œæ‚¨æ‹¥æœ‰äº†ä¸€ä¸ªæ§åˆ¶å™¨ã€æ¨¡å‹ã€è¿ç§»ã€èµ„æºã€éªŒè¯å’Œ API æµ‹è¯•ã€‚å®ƒè¿˜å¯ä»¥ä¸ºå®ƒåˆ›å»ºçš„ API æ§åˆ¶å™¨ç”Ÿæˆ Swagger è®¤å¯çš„æ–‡æ¡£ï¼Œåªéœ€å¯¹é…ç½®è¿›è¡Œç®€å•çš„æ›´æ”¹ã€‚

## [](#easy-to-write-docs)è½»æ¾ç¼–å†™æ–‡æ¡£

å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªåŒ…å¯ä»¥å®Œæˆæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½- [Laravel API æ–‡æ¡£ç”Ÿæˆå™¨](https://github.com/mpociot/laravel-apidoc-generator)ã€‚å®ƒæ‰«ææ‚¨çš„ API ç«¯ç‚¹ï¼Œå¹¶å®é™…è¿è¡Œå®ƒä»¬æ¥ç”Ÿæˆæ–‡æ¡£(è‡ªåŠ¨ä¸ºæ‚¨çš„æ–‡æ¡£åˆ›å»º JSON å“åº”å¯¹è±¡)ã€‚å®ƒå°†æ§åˆ¶å™¨çš„ç±»/æ–¹æ³•ä¹‹ä¸Šçš„ PHP æ–‡æ¡£å—ä¸è¯·æ±‚éªŒè¯ã€JSON å“åº”å’Œç›®å½•ç»“åˆèµ·æ¥ã€‚

å¦‚æœæ‚¨è¿è¡Œçš„æ˜¯ Laravel 5.5+ï¼Œåªéœ€è¿è¡Œä¸‹é¢è¿™ä¸€è¡Œæ¥å®‰è£…åŒ…:

```
composer require mpociot/laravel-apidoc-generator 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶ä½¿ç”¨ Artisan CLI å‘½ä»¤å¼€å§‹ç”Ÿæˆæ–‡æ¡£:

```
php artisan api:generate --routePrefix="api/*" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½¿ç”¨è¿™ä¸ªåŒ…æœ‰å¾ˆå¤šå¥½å¤„:

### [](#custom-written-content)è‡ªå®šä¹‰ä¹¦å†™å†…å®¹

ä½ ä¸å±€é™äºè‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ï¼Œè¿™ä¸ªåŒ…ä¹Ÿèƒ½å¤Ÿé™„åŠ å…¶ä»– Markdown æ–‡ä»¶çš„å†…å®¹ã€‚éå¸¸é€‚åˆç¼–å†™é¢å¤–çš„è®¤è¯æ–‡æ¡£ã€‚

### [](#authenticating-api-requests)è®¤è¯ API è¯·æ±‚

å®ƒç”šè‡³å¤„ç†è„è¿›ç¨‹ï¼Œæ¯”å¦‚è®¤è¯ API è°ƒç”¨:

```
php artisan api:generate --routePrefix="api/*" --actAsUserId=1 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#postman)é‚®é€’å‘˜

è¿™ä¸ªåŒ…è¿˜ä¸ºæŸ¥è¯¢ API çš„ app[Postman](https://www.getpostman.com/)ç”Ÿæˆä¸€ä¸ª JSONâ€˜collectionâ€™æ–‡ä»¶ã€‚å¦‚æœä½ åƒæˆ‘ä¸€æ ·ç”¨å®ƒæ¥æµ‹è¯•ä½ çš„ APIï¼Œé‚£å°±æ–¹ä¾¿äº†ã€‚[æ‚¨å¯ä»¥å¯¼å…¥é›†åˆ](https://www.getpostman.com/docs/v6/postman/collections/creating_collections)ï¼Œå¹¶æ‹¥æœ‰ä¸€ä¸ªåŒ…å«æ‚¨æ‰€æœ‰ç«¯ç‚¹çš„æ–‡ä»¶å¤¹ã€‚

### [](#dont-comment-code-dont-worry)ä¸è¯„è®ºç ï¼Ÿæ”¾å¿ƒå§ï¼

ç”±äºè¿™ä¸ªåŒ…åˆ†æäº†æ‚¨çš„æ•´ä¸ªè·¯ç”±æ–‡ä»¶å¹¶æŸ¥è¯¢æ¯æ¡è·¯ç”±çš„æ•°æ®ï¼Œå®ƒå°†ä¸ºæ¯æ¡è·¯ç”±ç”Ÿæˆ API æ–‡æ¡£â€”â€”å³ä½¿å®ƒæ²¡æœ‰æ–‡æ¡£/æ–‡æ¡£å—/æ³¨é‡Šï¼ç”Ÿæˆå™¨åˆ›å»ºä¸€ä¸ªâ€œgeneralâ€éƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«æ‚¨æ²¡æœ‰åœ¨*â€œresourcesâ€*ä¸­åˆ†ç»„çš„æ‰€æœ‰ç«¯ç‚¹ã€‚

## [](#issues-with-autogeneration)è‡ªåŠ¨ç”Ÿæˆçš„é—®é¢˜

ä»ä¸€å¼€å§‹ï¼Œæˆ‘å°±å¯¹é›†æˆæ–‡æ¡£ç”Ÿæˆå™¨æ„Ÿåˆ°ä¸å®‰ã€‚è‡ªåŠ¨åŒ–æœ‰å‡ ä¸ªé™·é˜±ï¼Œå¯¼è‡´æ›´å¤šçš„å·¥ä½œç”±å¼€å‘äººå‘˜å®Œæˆï¼Œæˆ–è€…æ›´ç³Ÿï¼Œä»£ç è¢«æå¤§åœ°é‡æ„ã€‚

### [](#one-giant-markdown-file)ä¸€ä¸ªå·¨å¤§çš„é™ä»·æ–‡ä»¶

å°½ç®¡èƒ½å¤Ÿç”¨ API ç”Ÿæˆå™¨å°†ä¸œè¥¿åˆ†æˆâ€œèµ„æºâ€ï¼Œä½†æ˜¯ç”Ÿæˆå™¨åˆ›å»ºäº†ä¸€ä¸ªå·¨å¤§çš„é™ä»·æ–‡ä»¶ã€‚æ¯ä¸ªâ€œèµ„æºâ€æˆ– API æ§åˆ¶å™¨éƒ½è¢«åˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼Œä½†æ˜¯æ²¡æœ‰å•ç‹¬çš„æ–‡ä»¶ï¼Œè¿™ä½¿å¾—ç”¨ GatsbyJS è¿™æ ·çš„æ¡†æ¶è¿›è¡Œè§£ææ›´åŠ å›°éš¾ã€‚

### [](#no-comment-blocks-inaccurate-docs)æ²¡æœ‰è¯„è®ºå—ï¼Ÿä¸å‡†ç¡®çš„æ–‡ä»¶ã€‚

æˆ‘åœ¨ä½¿ç”¨ docblock å’Œ*ç”šè‡³ Swagger documentation* æ—¶é‡åˆ°çš„æœ€åˆé—®é¢˜æ˜¯éœ€è¦ä¸€ä¸ªç‰©ç†æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªç«¯ç‚¹çš„æ³¨é‡Šã€‚

å¦‚æœæˆ‘ä½¿ç”¨ä¸€ä¸ªåŸºç±»æ¥æ‰©å±•æˆ‘çš„ API æ§åˆ¶å™¨ä¼šæ€ä¹ˆæ ·ï¼Ÿæˆ‘æ‰€æœ‰çš„ä¸»è¦ç«¯ç‚¹(ç´¢å¼•ã€å­˜å‚¨ç­‰)éƒ½å­˜å‚¨åœ¨åŸºæœ¬æ§åˆ¶å™¨ä¸­ï¼Œæˆ‘åªåœ¨å®é™…çš„ç«¯ç‚¹æ§åˆ¶å™¨ä¸­æ·»åŠ äº†å‡ ä¸ªé¢å¤–çš„ç«¯ç‚¹ã€‚

åŸºæœ¬æ§åˆ¶å™¨:

```
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;

abstract class ApiController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index(Request $request)
    {
        // Does API stuff
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç”Ÿæˆå™¨ä½¿ç”¨åŸºç±»ä¸­çš„æ–‡æ¡£å—ç»„åˆæ‰©å±•ç±»ä¸­çš„æ³¨é‡Šã€‚é—®é¢˜ï¼Ÿé™¤éæˆ‘ä»¬åœ¨ç«¯ç‚¹æ§åˆ¶å™¨ä¸­é‡æ–°è®¾ç½®æ–¹æ³•ï¼Œå¦åˆ™æˆ‘ä»¬ä¼šå¾—åˆ°ä»åŸºç±»æ‰©å±•çš„ä»»ä½•ç«¯ç‚¹çš„ä¸€èˆ¬æ³¨é‡Šã€‚

è¿™å¯¼è‡´äº†é‡å¤çš„ä»£ç ã€å¤šä½™çš„ä»£ç å’Œå¯¹åˆ›æ–°çš„é™åˆ¶ã€‚

## [](#handwritten-gt-docblocks-gt-swagger)æ‰‹å†™>æ–‡æ¡£å—>å¤§æ‘‡å¤§æ‘†

é™¤éæ‚¨çš„ API æ˜¯ä¸ºå®ƒè®¾ç½®çš„ï¼Œæˆ–è€…æ‚¨æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªä¸æ–­å˜åŒ–çš„åºå¤§ APIï¼Œå¦åˆ™æœ€å¥½è¿˜æ˜¯æ‰‹å·¥ç¼–å†™æ–‡æ¡£ã€‚

**ä½¿ç”¨ç”Ÿæˆå™¨ä½œä¸ºèµ·ç‚¹å¾ˆå¥½ï¼Œ**å› ä¸ºå®ƒå°†ç”Ÿæˆæ‰€æœ‰çš„ç«¯ç‚¹/è¯·æ±‚å¯¹è±¡ç­‰ã€‚ä½†æ˜¯å¯¹äº*çš„é•¿æœŸ*ç»´æŠ¤æ¥è¯´ï¼Œä¼¼ä¹å°±è¿å‘ç”µæœºä¹Ÿä¸æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„â€”â€”éœ€è¦å¦‚æ­¤å¤šçš„ç»´æŠ¤ä»¥è‡³äºè¶…è¿‡äº†å®ƒçš„æ•ˆç”¨ã€‚

ç„¶è€Œï¼Œå¦‚æœä½ æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªä¸æ˜¯åŸºäº Swagger çš„ç”Ÿæˆå™¨ï¼Œmpociot çš„ laravel-API doc-generator(T2)åšäº†è¶³å¤Ÿæ‰å®çš„å·¥ä½œæ¥ç”Ÿæˆæ–‡æ¡£ã€‚**å¦‚æœä½ å¯¹ Swagger** æ²¡æ„è§ï¼ŒInfyOmLabs çš„ Laravel ç”Ÿæˆå™¨å¯ä»¥å¾ˆå¥½åœ°åˆ›å»º API æ‰€éœ€çš„ä¸€åˆ‡(æ§åˆ¶å™¨ã€éªŒè¯ã€æ¨¡å‹ã€è¿ç§»ã€æµ‹è¯•ï¼Œä¸€åˆ‡ï¼).

## [](#making-it-work-for-me)(å¯¹æˆ‘æ¥è¯´)æˆåŠŸ

æˆ‘é‡åˆ°çš„ä¸»è¦é—®é¢˜æ˜¯é™ä»·çš„ç”Ÿæˆæ ¼å¼ã€‚è¿™æ˜¯ä¸€ä¸ªå•ä¸€çš„å¤§æ–‡ä»¶ï¼Œä¸ Slate ç­‰æ–‡æ¡£ç”Ÿæˆå™¨å…¼å®¹ï¼Œä½†ä¸æˆ‘çš„ GatsbyJS è®¾ç½®ä¸å…¼å®¹ã€‚å¯¹äºæˆ‘çš„ Gatsby æ–‡æ¡£ï¼Œå®ƒä»¬æ˜¯ä»ä¸€ä¸ª`docs`æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆçš„ï¼Œæ¯ä¸ªèµ„æºç»„æœ‰ä¸€ä¸ªå­æ–‡ä»¶å¤¹(`docs/endpoint/`)ã€‚ç„¶åæˆ‘ä»¬ä¸ºæ¯æ¡è·¯çº¿åˆ›å»ºä¸€ä¸ªæ–‡ä»¶(`docs/posts/get-all-posts.md`)ã€‚

### [](#using-javascript)ä½¿ç”¨ Javascript

æˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ç¼–å†™ä¸€ä¸ª NodeJS è„šæœ¬æ¥è§£æå¤§é‡çš„ Markdown æ–‡ä»¶ï¼Œå¹¶æŠŠå®ƒåˆ†æˆæˆ‘éœ€è¦çš„å—ã€‚æˆ‘ä½¿ç”¨ NodeJS è¯»å–æ–‡ä»¶å†…å®¹ï¼Œä½¿ç”¨ markdown-js å°† MD è§£æä¸ºå¯éå†çš„æ ‘ï¼Œç„¶åè§£æä¸º HTMLï¼Œä½¿ç”¨ turndown å°† HTML è½¬æ¢å› MD

```
var fs = require('fs');
var markdown = require("markdown").markdown;
var TurndownService = require("turndown");
var turndownService = new TurndownService();

// Grab API markdown master file and dump file into variable
let docs = fs.readFileSync('public/docs/source/index.md', 'utf8');

// Parse the markdown into a JSONML tree 
// (giant array with objects that contain MD data)
// [
//     {
//         'header',
//         {
//             level: 1
//         },
//         'The actual header content'
//     },
// ]
var tree = markdown.parse(docs);
var i = 0;
var separateDocs = [];

// Loop through tree to find headers
// Whenever header is found, insert last collection, 
// and make new collection variable to insert ongoing data into
// Each collection should contain name (used for filename) and data
var collection = [];
tree.forEach(function(element) {
    if(element[0] === 'header')
    {
        if(element[1].level === 1)
        {
            // Put collection the main doc array
            // Then wipe it out and start fresh
            separateDocs.push(collection);

            collection = [
                'markdown'
            ]
        }
    }

    collection.push(element);

    i++
});

// console.log(separateDocs);

// Convert from JSONML to HTML then to MD
// Then save the file
var convertedDocs = []
separateDocs.forEach(function(doc) {
    console.log(doc[1][0])
    var header
    if(doc[1][0] == 'header') {
        header = doc[1][2];
    } else {
        header = 'index';
    }
    var html = markdown.renderJsonML(markdown.toHTMLTree(doc));
    var convertedMarkdown = turndownService.turndown(html);
    convertedDocs.push(convertedMarkdown);

    fs.writeFile(`tmp/${header}.md`, convertedMarkdown, function (err) {
        if (err) {
            return console.log(err);
        }

        console.log("The file was saved!");
    }); 

}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨å¯ä»¥ä½¿ç”¨ CLI è¿è¡Œè¯¥è„šæœ¬:`node generate-api-docs.js`

ç»è¿‡ä¸€ç‚¹ä¿®è¡¥ï¼Œæˆ‘å‘ç°æˆ‘å¯ä»¥å®Œæˆæˆ‘æ‰€éœ€è¦çš„ï¼Œä½†åŸå§‹ææ–™å˜å¾—é€€åŒ–äº†ã€‚ä» MD -> JSON -> HTML -> MD çš„è½¬æ¢å¯¼è‡´äº†æ ¼å¼é—®é¢˜ã€‚

### [](#back-to-the-source)å›åˆ°æºå¤´

æˆ‘æ„è¯†åˆ°ä¿®æ”¹æœ€ç»ˆäº§å“å¹¶ä¸å¯å–ï¼Œç¼–è¾‘ç”Ÿæˆå™¨çš„è¾“å‡ºä»£ç ä¼šæ›´å®¹æ˜“ã€‚åœ¨å››å¤„çª¥æ¢æºä»£ç åï¼Œæˆ‘æ‰¾åˆ°äº†æˆ‘éœ€è¦çš„æ–¹æ³•:`writeMarkdown()`ã€‚ç¨åŠ ä¿®æ”¹ï¼Œæˆ‘æœ€ç»ˆå¾—åˆ°äº†è¿™ä¸ªç»“æœ:

```
 /**
     * @param  Collection $parsedRoutes
     *
     * @return void
     */
    private function writeMarkdown($parsedRoutes)
    {
        $outputPath = $this->option('output');

        $infoText = view('apidoc::partials.info')
            ->with('outputPath', ltrim($outputPath, 'public/'))
            ->with('showPostmanCollectionButton', ! $this->option('noPostmanCollection'));

        $parsedRouteOutput = $parsedRoutes->map(function ($routeGroup) {
            return $routeGroup->map(function ($route) {
                $route['output'] = (string) view('apidoc::partials.route')->with('parsedRoute', $route);

                return $route;
            });
        });

        $documentarian = new Documentarian();

        $parsedRouteOutput->each(function ($routeGroup) use ($infoText, $outputPath) {
            $routeGroup->each(function ($route) use ($infoText, $outputPath) {
                // dd($route);

                // $cleanResource = preg_replace('/\s+/', '', $route['resource']);
                $routeUrl = str_replace('api/v1/', '', $route['uri']);
                $safeUrl = str_replace('/', '-', $routeUrl);
                $safeUrl = str_replace('{', '', $safeUrl);
                $safeUrl = str_replace('}', '', $safeUrl);
                $cleanResource = explode('\n', $route['resource']);
                $cleanResource = $cleanResource[0];
                // $cleanResource = trim(preg_replace('/\s+/', ' ', $route['resource']));
                $title = strtolower($route['methods'][0] . '-' . $safeUrl);

                $folder = $outputPath.DIRECTORY_SEPARATOR.'dist'.DIRECTORY_SEPARATOR.strtolower($cleanResource);
                $this->createFolder($folder);
                $targetFile = $folder.DIRECTORY_SEPARATOR.$title.'.md';

                $frontmatter = view('apidoc::partials.frontmatter')
                    ->with('method', $route['methods'][0])
                    ->with('route', $routeUrl)
                    ->with('title', $route['title'])
                    ->with('date', date('Y-m-d'));

                $markdown = view('apidoc::singledoc')
                    ->with('writeCompareFile', false)
                    ->with('frontmatter', $frontmatter)
                    ->with('infoText', $infoText)
                    ->with('outputPath', $this->option('output'))
                    ->with('showPostmanCollectionButton', ! $this->option('noPostmanCollection'))
                    ->with('route', $route)
                    ->with('group', $cleanResource);

                // Write output file
                file_put_contents($targetFile, $markdown);

                $this->info('Wrote '. $title .' to: '.$outputPath);
            });
        });

        if ($this->option('noPostmanCollection') !== true) {
            $this->info('Generating Postman collection');

            file_put_contents($outputPath.DIRECTORY_SEPARATOR.'collection.json', $this->generatePostmanCollection($parsedRoutes));
        }
    } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç¡®ä¿å°†è¿™ä¸ª helper æ–¹æ³•æ·»åŠ åˆ°`GenerateDocumentation`ç±»ä¸­(æˆ‘æŠŠå®ƒæ‰”åœ¨äº†æœ€ä¸‹é¢):

```
 /**
     * Create folder if none exists
     *
     * @param string $folder
     * @return void
     */
    private function createFolder($folder)
    {
        if (!file_exists($folder)) {
            mkdir($folder, 0777, true);
        }
    } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œæ˜¯è§†å›¾æ–‡ä»¶`singledoc.blade.php` :

```
---
{!! $frontmatter !!}
---

@if($group)
# {{$group}}
@endif
@if($writeCompareFile === true)
{!! $route['output']!!}
@else
{!! isset($route['modified_output']) ? $route['modified_output'] : $route['output']!!}
@endif 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

1.  æˆ‘ä»¬é€šè¿‡`$routeGroupsOutput`è¿›è¡Œå¾ªç¯ï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‰ç»„åæ’åºçš„è·¯ç”±é›†åˆã€‚
2.  ç„¶åï¼Œæˆ‘ä»¬éå†æ¯ä¸ªç»„ï¼Œä»¥è·å¾—æ¯ä¸ªèµ„æºçš„è·¯ç”±(æ–‡æ¡£å—ä¸­æ ‡è®°ä¸º`@Resource`çš„æ¯ä¸ªéƒ¨åˆ†)ã€‚
3.  æˆ‘ä»¬ç”¨æˆ‘ä»¬çš„è·¯çº¿æ•°æ®å¡«å……ä¸€ä¸ªè§†å›¾æ–‡ä»¶ï¼Œç„¶åå°†è§†å›¾ä¿å­˜åˆ°ä¸€ä¸ª Markdown æ–‡ä»¶(ä½¿ç”¨`file_put_contents()`)ã€‚

> æˆ‘æš‚æ—¶ç§»é™¤äº†æ¯”è¾ƒåŠŸèƒ½ã€‚é€šå¸¸è¿™ä¸ªåŒ…ä¼šåˆ›å»ºä¸¤ä¸ª Markdown æ–‡ä»¶ï¼Œå¹¶æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„å·®å¼‚ï¼Œä½†æ˜¯æˆ‘è¿˜æ²¡æœ‰å°è¯•è®©å®ƒä¸æ–°çš„è®¾ç½®ä¸€èµ·å·¥ä½œã€‚

### [](#results)ç»“æœ

ç¨å¾®ç¼–è¾‘äº†ä¸€ä¸‹è¿™ä¸ªåŒ…ä¹‹åï¼Œæˆ‘èƒ½å¤Ÿå®Œæˆæˆ‘æ‰€éœ€è¦çš„ï¼Œå¹¶ä¸”åˆ›å»ºâ€”â€”è‡³å°‘â€”â€”æˆ‘çš„ API æ–‡æ¡£çš„åŸºç¡€ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œè¿™å¯ä»¥ä½œä¸ºä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£çš„è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯ï¼Œå˜¿ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨å®è·µä¸­æ•ˆæœå¦‚ä½•ã€‚å½“è¶…è¶Šæ€æƒ³å¹¶ä»˜è¯¸è¡ŒåŠ¨æ—¶ï¼Œäº‹æƒ…æ€»æ˜¯ä¸ä¸€æ ·çš„ã€‚

**ç›®å‰ä¸ºæ­¢çš„é—®é¢˜**:

*   æœ¬åœ°å¼€å‘ URL æ˜¾ç¤ºåœ¨æŸ¥è¯¢çš„ JSON ç»“æœä¸­
*   æ— æ³•ä½¿ç”¨ç”¨æˆ· ID éªŒè¯è¯·æ±‚ã€‚ä¸ç¡®å®šæ˜¯å› ä¸ºæˆ‘ä½¿ç”¨ UUIDs è¿˜æ˜¯æˆ‘çš„ä¸­é—´ä»¶è®¾ç½®ã€‚
*   æ‘†è„± HTML æ¯”è¾ƒæ³¨é‡Š
*   åˆ é™¤`public/docs/`æ–‡ä»¶å¤¹å¹¶ç¡®ä¿å®ƒä¸ä¼šç”Ÿæˆ
*   å®‰è£…åˆ†å‰åŒ…(æˆ–åˆ›å»ºä¸€ä¸ªæ–°åŒ…åˆ°`composer install`)

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[æˆ‘çš„ Laravel API æ–‡æ¡£ç”Ÿæˆå™¨çš„ forkã€‚](https://github.com/whoisryosuke/laravel-apidoc-generator)

å¸Œæœ›è¿™å¯¹æ‚¨çš„ API è‡ªåŠ¨åŒ–æœç´¢æœ‰æ‰€å¸®åŠ©ï¼ğŸ»
è‰¯

* * *

**å‚è€ƒæ–‡çŒ®**:

*   [laravel-apidoc-generator](https://github.com/mpociot/laravel-apidoc-generator)
*   [InfyOmLabs Laravel å‘ç”Ÿå™¨](https://github.com/InfyOmLabs/laravel-generator)