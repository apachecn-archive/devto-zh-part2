# IE 11、现代网络和你(以 StencilJS 为特色)

> 原文：<https://dev.to/scott_yeatts/ie-11-the-modern-web-and-you-featuring-stenciljs-25cb>

这篇文章的另一个标题是:我如何认识到企业用户也是人。

### IE11 最差

所以。IE11 最差。没有人应该再支持它，应该避免它的存在(除了那些依赖它并对您的运营至关重要的特定应用程序。你的公司应该在 3 年前就开始走出困境...但我们都知道那是怎么回事)。

我对我的工作项目非常兴奋，因为我正在用 Ionic 团队的 [Stenciljs](https://stenciljs.com) 测试 web 组件。它在我测试过的所有浏览器中都运行良好...除了 IE11(不，我对此并不感到惊讶....更让我吃惊的是，在我开始从事概念验证工作后，我发现了支持需求，并说“让我们试试吧...我相信我们可以在需要的地方编写/使用 polyfills”)。

### 引起骚动

昨天我发现一个问题，IE11 不知道 CSS.supports()是什么。我(带着一点痛苦)解决了这个问题，然后继续前进。它实际上是在一个依赖关系中，所以我可以直接拿出这个依赖关系，自己编写它，然后继续前进，但是我在这个项目中只进行了大约一周，所以我仍然处于学习模式中。

今天玩的时候，我发现在我的 ES5 版本中引用了 Symbol。符号是 ES6。TypeScript 还没有完全实现它，但是除了 IE11，每个浏览器都有，当然，IE11 的实现率是 0%。它将永远不会实现，因为 IE11 是一个死浏览器保存一些安全更新。

作为题外话，抛出的错误？它来自一个聚合填充物。让它深入人心。当你试图填充它时，IE11 开始损坏。它已经超过 3 年没有接受新功能了[。这是我们在 2018 年使用 IE11 创造的局面...这相当于在 2011 年使用](https://en.wikipedia.org/wiki/Internet_Explorer_11)[网景浏览器](https://en.wikipedia.org/wiki/Netscape_Navigator)

我正在考虑退回到使用框架，因为我知道随着我构建的越来越多，我会不断发现这些问题。这是....至少可以说令人沮丧。

### 说真的，试试 Stencil。

完全公开，Stencil 是在 1.0 之前的模式，才出来一年多一点。这是一个工具，而不是将部署到最终用户的东西，所以我个人对此没意见。你需要咨询你自己的良心，你的里程可能会有所不同。

我看着聚合物，滑板和苗条...但是它们都比我想要的更抽象，本质上都是某种框架。我想尽可能用我所能得到的最小的框架风格的耦合来构建真正的普通 JS web 组件(我实际上尝试了一个概念验证)。Stencil 赢了。

在 Stencil 中，我可以构建一个具有端点属性的搜索组件，并在 HTML 中调用，如下所示:

`<search-component api="/some/url/string"></search-component>`

然后我可以`npm run build`一个没有框架代码的*dist 文件夹，只有普通的 JavaScript。我可以`npm pack`将它打包成一个 tarball，发布到 npm，保存在本地注册表中，或者走低技术、不良实践、不可扩展的路线，将它们保存在 repo 和`npm install <tarball location>`的目录中(说真的，不要对生产代码这样做...拜托了。).*

之后就是一个简单的`import 'search-component'`或适当的语法，我可以在任何地方开始使用它。我可以在`index.html`上放置一个脚本标签，在页面上不使用其他 JavaScript 调用它。

最精彩的部分？这些是可组合的组件。你需要写 3 个组件来组成一个特性吗？您可以将它们打包在一起，并且只有一个导入。

### 我们会失去什么？

因为支持 IE11，我们失去了什么？

1.  Vanilla Shadow DOM v1 和 Custom Elements v1 为我们提供了每个组件的完整封装
2.  访问 ionic v4 的 web 组件库(也是测试版)，用 Stencil 构建(尽管我是一个长期的 AngularJS/Angular guy，但我从未使用或想过使用 ionic，但他们让我对这个非常兴奋...预构建组件和/或如何构建它们的示例？是的，请吧。)
3.  普通的 JS 实现可以永远存在于 tarball 或 npm 中，直到 W3C 弃用它。在管道构建时不再需要依赖项的版本控制，不再需要担心在依赖项的依赖项中中断更改，不再需要代理 npm 以防从注册表中删除包和我的构建中断。都不是。我可以用同一个人工制品很多年，直到我觉得有必要再做一次。然后，我可以只更新一个组件，其他任何组件都不会受到影响。这变得如此精细，以至于在 Ionic 中，他们的网格系统已经到了 col 级别....他们在响应网格中有一个列组件。太酷了。
4.  能够走在技术曲线的前面，而不是每 6 个月更新一次 Angular/Vue/React。
5.  轻松创建 PWA(实际上他们有一个 PWA 生成器，或者您可以在配置中定义服务人员文件)
6.  无论我最初是否内置爱奥尼亚，用爱奥尼亚进行简单的原生转换。路线和布局是组件。只需旋转一个 ionic 或 *insert web 到本地框架这里的*实例，然后即插即用。(警告:我从未这样做过，所以这可能是我在鹦鹉学舌的无脑营销宣传....但是看起来很容易...伊什...但是我们都知道当有人说“这应该很容易，对吗？”)
7.  内置的 polyfills 用于不适合每个浏览器的内容。80%的浏览器都支持其中的大部分。不幸的是，多填充物是破坏 IE11 的原因。Firefox 将在 63 版中支持阴影 DOM 和自定义元素 v1，这是我撰写本文时的下一个版本，但我不想自己管理所有其他浏览器的 polyfills。
8.  使用编译器和框架。不再为了使用 1/10 的功能而下载大量代码。不会以任何方式向浏览器发送模具代码。这让我很开心。有了 IE11，这不是一个选项。
9.  一旦 Web 组件得到完全支持，从现在起两个月或两年内摆脱模板的能力。火狐发布 63 版，Edge 出于‘考虑’而实施它，这就足够了...注意到这个模式了吗？看看[自定义元素 v1](https://caniuse.com/#feat=custom-elementsv1) 和[阴影 DOM v1](https://caniuse.com/#feat=shadowdomv1) 的[can use](https://caniuse.com/)页面。一旦这些得到支持，我们就可以直接用普通的 JS 编写定制组件了。现在我要花点时间指出下一句话非常重要，因为我已经在一个非常大的应用程序上完成了 AngularJS 到 Angular 的升级。我们不必回去转换旧的模板组件。它们会一直存在，我们可以随时进行延迟升级，或者只对那些组件继续使用模板。为了支持 IE11，我们放弃了这种灵活性。
10.  我们开发时间的 10-30%(统计数据来自于无中生有的经验)，因为不管我们使用什么技术，除了(可能)JQuery，我们都会遇到‘在 IE11 上不起作用’的问题。

### 我刚才做了什么？

我想我刚刚写了说服我放弃 IE11 支持的论点，并告诉任何仍在使用它的人使用现代浏览器...我们走着瞧。我在绝望中开始这篇文章，但是我想这些是我周一带给团队的论点。我们假设我们的员工使用浏览器的比例与全球平均水平不同...为什么？我们是否认为我们的员工没有平均水平聪明或精通技术，没有下载 Chrome 或 Firefox，快乐地使用一个可能每天都会抛出越来越多奇怪错误的应用程序？没有。总体而言，至少有 2.66%的人仍在使用 IE。我猜想，如果我们考虑到不喜欢将外部应用程序下载到工作电脑上的人，以及技术上无能的人，公司内部的这一比例可能会高达 15%。我可以告诉这些用户去下载一个真正的浏览器。见鬼，我会为他们做的！

但是，嘿，如果它不起作用，我开始转而开发一个 Vue 应用程序，至少我不会被迫使用 TypeScript，amirite？