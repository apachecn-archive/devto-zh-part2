# 使用 Powershell 自动安装 IP 打印机

> 原文：<https://dev.to/mrpowerscripts/automate-installing-ip-printers-with-powershell-ga3>

作为系统管理员，我最喜欢的节省时间的方法之一是自动安装打印机。你不需要 Powershell。我经常使用简单的批处理脚本。PowerShell 目前在 Windows 世界中非常流行，这就是为什么视频示例使用它的原因。

在以前的工作中，学习如何自动安装打印机确实为我节省了很多时间，但改变手工操作的文化并不容易。有时候你必须等待合适的机会。

[点击此处观看教程视频](https://www.youtube.com/embed/E2x6NG72tn4)

我在一家商业银行工作，担任公司的客户支持和初级系统管理员。他们的支持团队没有自动化任何东西。我以前来自这样的工作文化，我们尽最大努力让自己自动失业。这令人沮丧，但我看到了一个绝佳的机会，让我的团队生活更轻松，并改善支持体验。我的计划有一个问题。没有人想改变他们的方式。等等，什么？这显然是一种更好的做事方式？他们怎么能不接受这个呢？

很长一段时间我不得不放弃。如果人们需要(重新)安装打印机，我们继续手动将 VNC 输入他们的计算机。我讨厌它。所以。很多。当一个大型办公项目成为焦点时，形势发生了转变。我们需要重命名办公室中所有网络打印机的名称和 IP 地址。两层楼的人需要更新他们电脑上的所有打印机，以使用新的命名约定。随着打印机名称和 IP 地址的更新，我们被指示为办公室中的每个用户手动执行此操作。有太多令人沮丧的问题闪过我的脑海，却没有很好的答案。

我们怎么知道哪些用户会受到变化的影响呢？没有办法知道谁在他们的机器上安装了什么。我们应该做出假设。更新每个人的机器需要多长时间？有些人安装了四五台打印机。为了给每个人安装打印机，我不得不来回查阅文件。这是用户工作日中的一次重大中断，总的来说，对我和我的团队来说是一次巨大的痛苦。

在我决定写一个为我们做所有这些工作的剧本之前，我们花了第一天去打断别人。我最初收到了很多反对意见。当我给他看时，团队中的一位资深同事告诉我不要使用它，因为它没有得到管理层的批准。所以，我去找了我们的经理。他最初也反对这个想法。当我向他展示它的功能时，他拒绝了。

我很难过。我沮丧地回到办公桌前，准备打断更多人的节日。“呃，这要花多长时间？”。“我走后你能做吗？”。不，我也想在下午 5 点离开这里，布拉德。我想我们的经理最终明白了。我不知道是什么改变了他的想法，但他后来找到我，问我是否认为它可以用于真人表演。当然，这是自动化时代！

剧本很简单。我们有一个 excel 文档，其中包含旧的计算机名称和它们的新名称/IP 组合。我将这些数据嵌入到 PowerShell 脚本中。当你运行这个脚本时，它会检查你的计算机上是否有旧的名字。如果它发现一个旧名称，它会卸载它，然后安装相应的新名称/IP。结合文件服务器上的批处理脚本，可以单击电子邮件中的链接来运行脚本并更新该计算机上的所有计算机。它在电脑上生成了一个小报告，这样我们就可以检查如果有人报告问题会发生什么。

这改变了整个游戏。这是一个预计需要一周多时间的项目。这将耗费我们团队和公司其他人许多小时的生产力。最后，我们能够发送一封带有链接的电子邮件，用户可以在方便的时候尝试转换。那有多美？

这不是我第一次试图改变“我们这里的做事方式”，但这是最令人满意的一次。从那以后，我有了很大的自由来编写日常问题的解决方案。人们会来问我是否可以用脚本来解决一些问题。它鼓励团队中的其他人参加 PowerShell 的一些课程，并以不同的方式思考我们如何解决办公室中的问题。观察文化的变化是很棒的。从那以后，我更加喜欢在那里工作了。也许并不总是改变事情的正确时机，但是你可以一直睁大眼睛寻找那些机会。