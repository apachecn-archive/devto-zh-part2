# 。NET MSTest 和 DeploymentItem 属性

> 原文：<https://dev.to/briannipper/net-mstest-and-deploymentitem-attribute-1nbe>

[![](../Images/17652fcc3381203c7beffdc4df1254dd.png)](https://1.bp.blogspot.com/-yUScwKt9f9U/W8fwKMIkjpI/AAAAAAAAHM8/XOOQefRICNkqfBvzhV0FQxt9DdxoZu3WACKgBGAs/s1600/CA5FCC3D-1D3E-4C3B-BA16-72809A47E0BA.jpeg) 
最近有人提醒我，在尝试排除间歇性单元测试故障时，操作顺序可能会影响你。

首先，我将第一个承认，如果你想避免单元测试的问题，最好避免任何实际代码库之外的依赖，像数据库、API 甚至文件系统这样的东西最好避免在单元测试的执行中。最后一个，文件系统，在某些应用程序中是很难避免的。

如果您碰巧正在使用 MSTest，那么 DeploymentItem 是对您的测试很有帮助的属性。这个特殊的属性允许您在单元测试项目中定义一个文件，假设它被标记为“总是复制”。有了这个属性，就可以将它与 TestContext 结合起来。DeploymentDirectory 找到这个示例文件，然后做您需要做的事情。

在我的特殊案例中，我遇到了单元测试在构建机器上失败的问题，而不是在本地。跌跌撞撞地走了一会儿之后，我终于感觉回到了老的调试标准，即将整个目录的文件打印到控制台上。在这一点上，我意识到我能够在预期的位置创建文件，为什么我找不到 DeploymentItem 呢？答案，副作用。

在一个测试中，我“移动”了资源项，这只是一个本地测试“发生”执行顺序的情况，移动操作发生在测试周期的末尾，从而掩盖了问题。当我将有问题的测试切换到“复制”文件时，这仍然是一个有效的测试，请注意，我的问题消失了。

作为解决这个问题的另一种方法，您可以将该文件作为一个嵌入式资源，然后在测试的排列部分，将该文件写出到磁盘，然后执行测试以确保该文件始终存在于开始处。

我希望这些信息能帮助其他人避免在这些愚蠢的操作顺序问题上浪费时间。