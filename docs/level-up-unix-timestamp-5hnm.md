# 升级:UNIX 时间戳

> 原文：<https://dev.to/ghost/level-up-unix-timestamp-5hnm>

[![UNIX Timestamp](../Images/7de67967ee8b8aa17bf3943862394692.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--qiD4ZoGh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/qbvhtvrcsysldoy7kllt.png)

# 什么是 UNIX 时间戳？

简单地说，UNIX 时间戳(或只是一个“时间戳”)是计算机显示时间的方式。稍微简化一下，你的计算机基本上记录了每一秒的计数，并以整数的形式存储。

更确切地说，UNIX 时间戳是从过去某个任意点开始的秒数(包括闰秒)，即 UTC 1970 年 1 月 1 日**00:00:00**。“UTC”代表“世界协调时间”，恰好与“GMT”或伦敦格林威治皇家天文台的[太阳时相同。](https://en.wikipedia.org/wiki/Greenwich_Mean_Time)

您可能认为 1970 年是现代计算时代的开端，所以称之为 UNIX 时代也是合适的。

因此，UNIX 时间戳`0`对应于 UNIX 纪元的开始或 1970 年 1 月 1 日的午夜。当我写这篇文章时，当前的时间戳大约是`1534954799`，时间过得很快。

继续在你的机器上抓取当前的时间戳；打开一个终端，像这样使用`date` *命令:

```
date +%s 
```

Enter fullscreen mode Exit fullscreen mode

`date(1)`当用格式说明符`%s`调用时，应该显示你的 PC 的当前时间戳(当然这是假设一个 POSIX 兼容的 shell)。

*以下是 windows power shell 上的相同内容，只是为了娱乐价值:

```
[int][double]::Parse((Get-Date (get-date).touniversaltime() -UFormat %s)) 
```

Enter fullscreen mode Exit fullscreen mode

要从另一个方向将时间戳转换为日期/时间字符串，请使用以下方法之一:

```
# BSD/OSX
date -r 1534954799
# Linux
date -d @1534954799
Wed Aug 22 12:19:59 EDT 2018 
```

Enter fullscreen mode Exit fullscreen mode

您还会发现，大多数编程语言和日期库都非常支持使用 UNIX 时间戳。

## 为什么要用时间戳？

计算机使用时间戳的第一个也可能是最基本的原因是，计算机。对于大多数操作系统来说，用 16、32 或 64 位的值(或一组小数秒的值)来记录系统时间是很容易的。

选择 UNIX 时间戳作为在 POSIX 兼容系统上跟踪时间的方法还简化了在不同计算机上协调时间的任务。所有在 UNIX 时间戳中记录时间流逝的系统共享相同的时间戳，([理论上是](http://www.ntp.org/))，不管它们位于地球上的什么地方。

还要注意，时间戳既是日期也是时间，因为“日期”对应于一个*日历日期*,“时间”对应于给定的 24 小时日中的某个时间点*，也有本地化的“UTC”。这一切，都包含在随处可见的 PC 上的一个简单数字里，都同时数到无穷大，[注定失败](https://en.wikipedia.org/wiki/Year_2038_problem)，不过我跑题了:)。*

## 时间戳的喜悦

您可能会开始意识到，作为软件开发人员，将日期和时间存储为时间戳相当方便。在跨时区的大型系统上工作时尤其如此。

如果我们只需要一秒钟的分辨率，那么在我们的系统上发生事情的日期和时间可以作为单个整数值(当然有符号，因为时间在 1970 年之前)清晰地表示和存储在我们的数据库、日志文件或任何地方。

另一种方法要求我们捕获一些人类可读的日期/时间字符串(当然要有时区本地化)并将其作为一个值存储。但是不用担心，这些年来已经有很多日期时间字符串的标准化。这完全可行，但也有其自身的挑战。

## 用时间戳工作的尝试

时间戳对计算机和任何协调系统来说都很好，但对人类来说就没那么容易了。因此，任何使用时间戳的人都需要注意几个陷阱。一旦你掌握了这些，你就会爱上时间戳。

### 陷阱 1:日期/时间转换

当跨不同时区处理时间时，使用 UNIX 时间戳会非常方便。如果纽约是`1534955931`，柏林也是`1534955931`。然而，当将时间戳转换为日期/时间时(记住日历时间和时钟时间的某种格式)，我们必须引用一个时区。

因为柏林比纽约早 6 个小时(现在纽约是‘CEST’对‘东部时间’)，所以当从时间戳转换到上述两个位置中的任何一个时，必须考虑到这一点。因此，在我们的示例中，同一个时间戳`1534955931`对两个城市有以下两种日期/时间表示:

```
Wed Aug 22 12:38:51 EDT 2018 # New York
Wed Aug 22 18:38:51 CEST 2018 # Berlin 
```

Enter fullscreen mode Exit fullscreen mode

将时间戳转换成本地日期/时间的挑战是由操作系统处理的*通常是*。您的操作系统将您的当前时区存储在某个地方，大多数像`date(1)`这样的命令将从系统环境或其他方式访问这个值。但是当将时间戳转换为另一个地区时，您需要指定目标时区，或者手动考虑可能的时差。

所以请记住，当您*记录*一个时间戳时，该值被保存为 UTC，但是当您*将时间戳转换为日期/时间时，该值需要引用一个时区(有时默认为本地时间，有时默认为“UTC”)。*

### 陷阱二:分辨率

UNIX 时间戳通常表示为秒。然而，大多数操作系统的分辨率比这高得多。如果您需要高于一秒的分辨率，您可能需要使用一个扩展的时间戳，它包含一个对应于小数秒的小数部分。

获得亚秒级分辨率的时间戳并不是一个真正的问题，但是您可能会发现一些日期库在这方面有所限制，或者具有不同级别的分辨率。

例如，Javascript 以 64 位格式存储数字，因此浮点时间戳的分辨率将低于现代单调时钟的分辨率，后者返回的时间分辨率高达 128 位。有办法解决这个问题，但是要意识到当使用日期库和高分辨率时间戳 ymmv 时。

### 陷阱三:同步

据说有一块手表的人总是知道现在是什么时间，但有两块手表的人却从来不确定。

UNIX 时间戳的标准化是为协调时间提供框架的重要一步，但是它留下了同步的问题。程序员通常不得不依靠额外的手段来提供高精度的时间同步，如网络时间协议( [ntp](//ntp.org) )。

如果您正在设计一个需要高度精确的时间计算的分布式系统，请确保您有一些方法来促进系统时间的同步。NTP 通常是一个不错的选择，但是在某些情况下，您需要配置您的系统来使用它。

## 展示和讲述

很多时候，一些东西被记录为时间戳，我需要快速转换为人类可读的日期/时间字符串。

为了简化我的生活，我创建了一个简单的实用程序来帮助我在终端上将时间戳转换为本地时间，并做一些其他很酷的事情。这没什么神奇的，但我发现它真的很有帮助。

检查一下，如果有帮助的话，可以随意使用或分享。

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png) [卡莱南森](https://github.com/KalenAnson) / [ tsc](https://github.com/KalenAnson/tsc)

### UNIX 时间戳实用程序

<article class="markdown-body entry-content container-lg" itemprop="text">

# ThermalStressCracking 热应力龟裂

`tsc`是一个简单的 UNIX 时间戳实用程序。它可以获得当前的 UNIX 时间戳，将时间戳转换为本地化的时间和不同的时间戳。

## 例子

1.  获取当前的 UNIX 时间戳:(我知道这对于`date(1)`来说是微不足道的，但是*你*多久谷歌一次这个。)

    ```
     $ tsc
     1534947844 
    ```

2.  将时间戳转换为本地时间:

    ```
     $ tsc 1534950044
     1534950044 -> Wed Aug 22 11:00:44 EDT 2018 
    ```

    `tsc`也接受来自`stdin`的输入，格式与其参数相同(`timestamp timestamp ...`)

    ```
     $ echo 1534947844 | tsc
     1534947844 -> Wed Aug 22 10:24:04 EDT 2018 
    ```

3.  差异时间戳(计算最小和最大参数的持续时间):

    ```
     $ tsc 1534947844 1534947904
     1534947844 -> Wed Aug 22 10:24:04 EDT 2018
     1534947904 -> Wed Aug 22 10:25:04 EDT 2018
     Duration: 00:01:00 
    ```

    也是一个一流的实用程序，所以它可以很好地处理管道。这里我们区别时间戳和“现在”…

</article>

[View on GitHub](https://github.com/KalenAnson/tsc)

我希望在阅读本文后，您对 UNIX 时间戳的了解会更多一点。