# å­¦ä¹  React åŠå…¶è™šæ‹Ÿ DOM å¦‚ä½•å·¥ä½œçš„å¿«é€ŸæŒ‡å—

> åŸæ–‡:[https://dev . to/jbar don/a-quick-guide-to-learn-react-and-how-its-virtual-DOM-works-4 BCI](https://dev.to/jbardon/a-quick-guide-to-learn-react-and-how-its-virtual-dom-works-4bci)

<figure>[![](../Images/d52afb9966c3e4b491fd8ec074a55e7a.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--sbN-Vr-l--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/proxy/0%2AvQXljCx6DN_aNLWD.jpg) 

<figcaption>å›¾ç‰‡ç”± [@simonmigaj](http://twitter.com/simonmigaj) æ¥è‡ª Unsplash</figcaption>

</figure>

è¦ä¸è¦å­¦ React ä¸çˆ¬[æ–‡æ¡£](https://reactjs.org/docs/hello-world.html)(é¡ºä¾¿è¯´ä¸€å¥å†™å¾—ä¸é”™)ï¼Ÿä½ ç‚¹å‡»äº†æ­£ç¡®çš„æ–‡ç« ã€‚

æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç”¨ä¸€ä¸ª HTML æ–‡ä»¶è¿è¡Œ Reactï¼Œç„¶åå±•ç¤ºç¬¬ä¸€ä¸ªä»£ç ç‰‡æ®µã€‚

æœ€åï¼Œä½ å°†èƒ½å¤Ÿè§£é‡Šè¿™äº›æ¦‚å¿µ:é“å…·ã€åŠŸèƒ½ç»„ä»¶ã€JSX å’Œè™šæ‹Ÿ DOMã€‚

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ¶é€ ä¸€æ¬¾æ˜¾ç¤ºå°æ—¶å’Œåˆ†é’Ÿçš„æ‰‹è¡¨ã€‚React æä¾›ç”¨ç»„ä»¶æ¥æ„å»ºæˆ‘ä»¬çš„ä»£ç ã€‚è®©æˆ‘ä»¬åˆ›å»ºæ‰‹è¡¨ç»„ä»¶ã€‚

```
<!-- Skipping all HTML5 boilerplate -->
<script src="https://unpkg.com/react@16.2.0/umd/react.development.js"></script> <script src="https://unpkg.com/react-dom@16.2.0/umd/react-dom.development.js"></script> 
<!-- For JSX support (with babel) -->
<script src="https://unpkg.com/babel-standalone@6.24.2/babel.min.js" charset="utf-8"></script>  
<div id="app"></div> <!-- React mounting point--> 
<script type="text/babel">
  class Watch extends React.Component {
    render() {
      return <div>{this.props.hours}:{this.props.minutes}</div>;
    }
  }

  ReactDOM.render(<Watch hours="9" minutes="15"/>, document.getElementById('app'));
</script> 
```

Enter fullscreen mode Exit fullscreen mode

å¿½ç•¥ HTML æ ·æ¿æ–‡ä»¶å’Œè„šæœ¬å¯¼å…¥çš„ä¾èµ–å…³ç³»(ç”¨ [unpkg](https://unpkg.com/#/) ï¼Œè§ [React ç¤ºä¾‹](https://raw.githubusercontent.com/reactjs/reactjs.org/master/static/html/single-file-example.html))ã€‚å‰©ä¸‹çš„å‡ è¡Œå®é™…ä¸Šæ˜¯ React ä»£ç ã€‚

é¦–å…ˆï¼Œå®šä¹‰è§‚å¯Ÿç»„ä»¶åŠå…¶æ¨¡æ¿ã€‚ç„¶ååœ¨ DOM ä¸­æŒ‚è½½ React å¹¶è¯·æ±‚å‘ˆç°ä¸€ä¸ªæ‰‹è¡¨ã€‚

### å°†æ•°æ®æ³¨å…¥ç»„ä»¶

æˆ‘ä»¬çš„æ‰‹è¡¨å¾ˆç¬¨ï¼Œå®ƒæ˜¾ç¤ºæˆ‘ä»¬æä¾›ç»™å®ƒçš„å°æ—¶å’Œåˆ†é’Ÿã€‚

æ‚¨å¯ä»¥å°è¯•æ”¹å˜è¿™äº›å±æ€§çš„å€¼(åœ¨ React ä¸­ç§°ä¸º **props** )ã€‚å®ƒä¼šä¸€ç›´æ˜¾ç¤ºä½ æ‰€è¦æ±‚çš„ï¼Œå³ä½¿å®ƒä¸æ˜¯æ•°å­—ã€‚

è¿™ç§åªå…·æœ‰æ¸²æŸ“åŠŸèƒ½çš„ React ç»„ä»¶æ˜¯**åŠŸèƒ½ç»„ä»¶ã€‚ä¸ç±»ç›¸æ¯”ï¼Œå®ƒä»¬æœ‰æ›´ç®€æ´çš„è¯­æ³•ã€‚** 

```
const Watch = (props) =>
  <div>{props.hours}:{props.minutes}</div>; 
ReactDOM.render(<Watch hours="Hello" minutes="World"/>, document.getElementById('app')); 
```

Enter fullscreen mode Exit fullscreen mode

é“å…·åªæ˜¯ä¼ é€’ç»™ç»„ä»¶çš„æ•°æ®ï¼Œé€šå¸¸ç”±å‘¨å›´çš„ç»„ä»¶ä¼ é€’ã€‚è¯¥ç»„ä»¶ä½¿ç”¨ props è¿›è¡Œä¸šåŠ¡é€»è¾‘å’Œå‘ˆç°ã€‚

ä½†æ˜¯ä¸€æ—¦é“å…·ä¸å±äºç»„ä»¶ï¼Œå®ƒä»¬å°±**ä¸å¯å˜**ã€‚å› æ­¤ï¼Œæä¾› props çš„ç»„ä»¶æ˜¯å”¯ä¸€èƒ½å¤Ÿæ›´æ–° props å€¼çš„ä»£ç ã€‚

ä½¿ç”¨é“å…·éå¸¸ç®€å•ã€‚ç”¨ç»„ä»¶åä½œä¸ºæ ‡è®°ååˆ›å»ºä¸€ä¸ª DOM èŠ‚ç‚¹ã€‚ç„¶åèµ‹äºˆå®ƒä»¥é“å…·å‘½åçš„å±æ€§ã€‚ç„¶åé“å…·ä¼šé€šè¿‡ç»„ä»¶ä¸­çš„`this.props`å¯ç”¨ã€‚

### ä¸åŠ å¼•å·çš„ HTML æ€ä¹ˆåŠï¼Ÿ

æˆ‘ç¡®ä¿¡ä½ ä¼šæ³¨æ„åˆ°ç”±`render`å‡½æ•°è¿”å›çš„æœªåŠ å¼•å·çš„ HTMLã€‚è¿™æ®µä»£ç ä½¿ç”¨çš„æ˜¯ JSX è¯­è¨€ï¼Œè¿™æ˜¯ä¸€ç§åœ¨ React ç»„ä»¶ä¸­å®šä¹‰ HTML æ¨¡æ¿çš„é€Ÿè®°è¯­æ³•ã€‚

```
// Equivalent to JSX: <Watch hours="9" minutes="15"/>
React.createElement(Watch, {'hours': '9', 'minutes': '15'}); 
```

Enter fullscreen mode Exit fullscreen mode

ç°åœ¨ä½ å¯èƒ½æƒ³é¿å… JSX æ¥å®šä¹‰ç»„ä»¶çš„æ¨¡æ¿ã€‚å®é™…ä¸Šï¼ŒJSX çœ‹èµ·æ¥åƒæ˜¯[å¥æ³•ç³–](https://en.wikipedia.org/wiki/Syntactic_sugar)ã€‚

çœ‹çœ‹ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼Œå®ƒå±•ç¤ºäº† JSX å’Œ React è¯­æ³•æ¥å»ºç«‹ä½ çš„è§‚ç‚¹ã€‚

```
// Using JS with React.createElement
React.createElement('form', null, 
  React.createElement('div', {'className': 'form-group'},
    React.createElement('label', {'htmlFor': 'email'}, 'Email address'),
    React.createElement('input', {'type': 'email', 'id': 'email', 'className': 'form-control'}),
  ),
  React.createElement('button', {'type': 'submit', 'className': 'btn btn-primary'}, 'Submit')
)

// Using JSX
<form>
  <div className="form-group">
    <label htmlFor="email">Email address</label>
    <input type="email" id="email" className="form-control"/>
  </div>
  <button type="submit" className="btn btn-primary">Submit</button> </form> 
```

Enter fullscreen mode Exit fullscreen mode

### ä¸è™šæ‹Ÿ DOM æ›´è¿›ä¸€æ­¥

è¿™æœ€åä¸€éƒ¨åˆ†æ›´å¤æ‚ï¼Œä½†éå¸¸æœ‰è¶£ã€‚å®ƒå°†å¸®åŠ©æ‚¨ç†è§£ React æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

æ›´æ–°ç½‘é¡µä¸Šçš„å…ƒç´ (DOM æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹)éœ€è¦ä½¿ç”¨ DOM APIã€‚å®ƒä¼šé‡æ–°ç»˜åˆ¶é¡µé¢ï¼Œä½†æ˜¯ä¼šå¾ˆæ…¢(åŸå› è§[è¿™ç¯‡æ–‡ç« ](https://hashnode.com/post/the-one-thing-that-no-one-properly-explains-about-react-why-virtual-dom-cisczhfj41bmssp53mvfwmgrq))ã€‚

React å’Œ Vue.js ç­‰å¾ˆå¤šæ¡†æ¶éƒ½ç»•å¼€äº†è¿™ä¸ªé—®é¢˜ã€‚ä»–ä»¬æå‡ºäº†ä¸€ä¸ªåä¸ºè™šæ‹Ÿ DOM çš„è§£å†³æ–¹æ¡ˆã€‚

```
{
   "type":"div",
   "props":{ "className":"form-group" },
   "children":[
     {
       "type":"label",
       "props":{ "htmlFor":"email" },
       "children":[ "Email address"]
     },
     {
       "type":"input",
       "props":{ "type":"email", "id":"email", "className":"form-control"},
       "children":[]
     }
  ]
} 
```

Enter fullscreen mode Exit fullscreen mode

è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•ã€‚è¯»å–å’Œæ›´æ–° DOM æ ‘æ˜¯éå¸¸æ˜‚è´µçš„ã€‚æ‰€ä»¥å°½å¯èƒ½å°‘åšæ”¹åŠ¨ï¼Œå°½å¯èƒ½å°‘æ›´æ–°èŠ‚ç‚¹ã€‚

å‡å°‘å¯¹ DOM API çš„è°ƒç”¨åŒ…æ‹¬å°† DOM æ ‘è¡¨ç¤ºä¿å­˜åœ¨å†…å­˜ä¸­ã€‚æ—¢ç„¶æˆ‘ä»¬åœ¨è®¨è®º JavaScript æ¡†æ¶ï¼Œé€‰æ‹© JSON å¬èµ·æ¥æ˜¯åˆç†çš„ã€‚

è¿™ç§æ–¹æ³•ç«‹å³åæ˜ äº†è™šæ‹Ÿ DOM çš„å˜åŒ–ã€‚

æ­¤å¤–ï¼Œå®ƒæ”¶é›†ä¸€äº›æ›´æ–°ï¼Œä»¥ä¾¿ç¨åç«‹å³åº”ç”¨åˆ°çœŸå®çš„ DOM ä¸Š(ä»¥é¿å…æ€§èƒ½é—®é¢˜)ã€‚

ä½ è¿˜è®°å¾—`React.createElement`å—ï¼Ÿå®é™…ä¸Šï¼Œè¿™ä¸ªå‡½æ•°(ç›´æ¥è°ƒç”¨æˆ–é€šè¿‡ JSX è°ƒç”¨)åœ¨è™šæ‹Ÿ DOM ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–°èŠ‚ç‚¹ã€‚

```
// React.createElement naive implementation (using ES6 features)
function createElement(type, props, ...children) {
  return { type, props, children };
} 
```

Enter fullscreen mode Exit fullscreen mode

ä¸ºäº†åº”ç”¨æ›´æ–°ï¼Œè™šæ‹Ÿ DOM æ ¸å¿ƒç‰¹æ€§å¼€å§‹å‘æŒ¥ä½œç”¨ï¼Œå³[åè°ƒç®—æ³•](https://reactjs.org/docs/reconciliation.html)ã€‚

å®ƒçš„å·¥ä½œæ˜¯æå‡ºæœ€ä½³çš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³å…ˆå‰å’Œå½“å‰è™šæ‹Ÿ DOM çŠ¶æ€ä¹‹é—´çš„å·®å¼‚ã€‚

ç„¶åå°†æ–°çš„è™šæ‹Ÿ DOM åº”ç”¨äºçœŸå® DOMã€‚

### è¿›ä¸€æ­¥é˜…è¯»

æœ¬æ–‡æ·±å…¥æ¢è®¨äº† React å†…éƒ¨å’Œè™šæ‹Ÿ DOM çš„è§£é‡Šã€‚å°½ç®¡å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨ä¸€ä¸ªæ¡†æ¶æ—¶ï¼Œäº†è§£å®ƒçš„å·¥ä½œåŸç†è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚

å¦‚æœæ‚¨æƒ³è¯¦ç»†äº†è§£è™šæ‹Ÿ DOM æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¯·éµå¾ªæˆ‘çš„é˜…è¯»å»ºè®®ã€‚ä½ å¯ä»¥[ç¼–å†™è‡ªå·±çš„è™šæ‹Ÿ DOM](https://medium.com/@deathmood/how-to-write-your-own-virtual-dom-ee74acc13060) å’Œ[äº†è§£ DOM æ¸²æŸ“](http://www.html5rocks.com/en/tutorials/internals/howbrowserswork/)ã€‚

æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚æŠ±æ­‰ï¼Œå¦‚æœè¿™å¯¹äºæ‚¨çš„ React ç¬¬ä¸€æ­¥æ¥è¯´å¤ªä¸“ä¸šäº†ã€‚ä½†æ˜¯æˆ‘å¸Œæœ›ç°åœ¨ä½ çŸ¥é“ä»€ä¹ˆæ˜¯é“å…·ã€åŠŸèƒ½ç»„ä»¶ã€JSX å’Œè™šæ‹Ÿ DOMã€‚

* * *

å¦‚æœæœ‰ç”¨ï¼Œè¯·ç‚¹å‡»â¤ï¸å’ŒğŸ¦„æŒ‰é’®ï¼Œè®©åˆ«äººæ‰¾åˆ°æ–‡ç« ï¼Œå¹¶è¡¨æ˜ä½ çš„æ”¯æŒï¼ğŸ‘Š

æ›´å¤šæ–‡ç« è¯·æŸ¥çœ‹æˆ‘çš„[åª’ä½“ç®€ä»‹](https://medium.com/@jbardon/latest)å¹¶å…³æ³¨æˆ‘ä»¥è·å¾—æˆ‘å³å°†å‘å¸ƒçš„æ–‡ç« çš„é€šçŸ¥ğŸ™

*æœ€åˆå‘å¸ƒäº[www.linkedin.com](https://www.linkedin.com/pulse/intro-react-virtual-dom-jeremy-bardon)2018 å¹´ 2 æœˆ 6 æ—¥ã€‚*

* * *