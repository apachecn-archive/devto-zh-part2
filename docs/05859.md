# 通过 NPM 保护你的应用安全

> 原文:[https://dev . to/Jimmy Roberts/keeping-your-app-secure-with-NPM-5 CNE](https://dev.to/jimmyroberts/keeping-your-app-secure-with-npm--5cne)

作为开发人员，我们更喜欢使用开源库来改进我们的开发过程，而不是一遍又一遍地重新发明轮子。

虽然这很方便，可以节省大量开发时间，但应用程序可能会面临各种安全风险。

这是怎么回事？

发生这种情况的方式有很多，我没有足够的时间一一列举。然而，一种方法是，有人正在检查一个拉请求，没有注意到一些恶意代码，并批准了拉请求，随后将一个蠕虫引入到存储库中，然后该蠕虫可以传播并造成损害。

通常存储库遵循[语义版本](https://semver.org/)标准(尽管有些可能使用[情感版本](http://sentimentalversioning.org/)；请不要)，意思是补丁版本会有磕碰。

每当您将一个存储库作为依赖项安装时，它将被添加到您的 *package.json* 中，并带有安装时的版本号。

*如)* `“repo”: “^3.0.0”`

这可能会损害你的身材。这意味着只要有新版本，只要主版本低于 4，它就会被安装。(也可以只打补丁- `~`，或者任何版本- `*`)

因此，如果被入侵的版本最后变成了 *`3.6.4`* ，那么下次运行`npm install`时，您将会不幸地将蠕虫添加到您的库。

如何预防这种情况？

首先，更严格的代码审查。尽管这还不是全部的解决办法。

在我看来，最好的防御是在你的 *package.json* 中保存确切的版本。可以手动进去把版本改成:`”repo”: “3.0.0”`的样子。

您也可以安装带有`--save-exact`或`-E`标志的依赖项。

以及运行一个命令，使其在以后的安装中成为默认值:

`npm set save-exact true`

虽然这将阻止您自动获得错误修复或依赖关系的新功能，但保存准确的版本将有助于防止您受到人为错误或恶意的攻击。

我的依赖关系怎么办？

您的依赖项很可能也依赖于其他存储库。所以你也可以考虑把它们锁起来。

你可以用`npm shrinkwrap`来做到这一点。如果你不熟悉这个，它和 *package-lock.json* 完全一样，只是你可以发布它。如果你已经有一个*包-lock.json* ，它将被替换为 *npm-shrinkwrap.json* 。如果由于某种原因两者都在您的存储库中，那么 *npm-shrinkwrap.json* 将优先。

*最后一件事……*

当您运行`npm install`时，NPM 会自动对您的依赖项进行审计。如果您的依赖关系已经受损，NPM 应该会提醒您该漏洞。然后您可以运行`npm audit fix`，如果已经发布了一个补丁，它将安装对易受攻击的依赖项的更新。

* * *

**TL；博士**

更新你的 package.json，只使用精确的版本，以防止恶意代码或错误影响你的存储库。

P.S .锁定版本也防止了经典的“嗯，在我机器上能用，所以没坏。”注释，因为所有 node_modules 在所有机器上都是相同的版本。

如果你认为我错过了什么，请告诉我！

干杯！