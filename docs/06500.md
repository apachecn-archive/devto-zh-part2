# æˆ‘å¾ˆæ— èŠï¼Œå°±æŠŠè‡ªå·±çš„ç½‘ç«™åšæˆäº†ä¸€ä¸ªèŠ‚ç‚¹åŒ…ã€‚ä»¥ä¸‹æ˜¯æ–¹æ³•ã€‚

> åŸæ–‡:[https://dev . to/shal vah/I-was-bored-so-I-make-my-website-into-a-node-package-heres-how-2id 3](https://dev.to/shalvah/i-was-bored-so-i-made-my-website-into-a-node-package-heres-how-2id3)

> æ›´æ–°:æˆ‘å·²ç»ä¿®æ”¹äº†æˆ‘çš„ç½‘ç«™ï¼Œä»ç»ˆç«¯è®¾è®¡å¼€å§‹ï¼Œä½†æ˜¯ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°é‚£ä¸ªç‰ˆæœ¬ã€‚

å•Šå“ˆï¼ŒæŠ“åˆ°ä½ äº†ï¼ä½ ä¸Šå½“äº†ï¼Œç¬¨è›‹ã€‚å¥½å§ï¼Œæˆ‘è¯¥åœæ­¢èƒ¡é—¹äº†ã€‚è¿™ç¯‡æ–‡ç« çš„æ ‡é¢˜å®é™…ä¸Šæ˜¯çœŸå®çš„ï¼Œä½†æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚è¿™æ˜¯æˆ‘çš„ç½‘ç«™:

[![](../Images/0eaf47905ce8a517b0e3d6df8376ae6d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Yfcti2yC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://blog.shalvah.me/store/media/zplj307cguvkz41v6y6l.gif)

è¿™å°†æ˜¯ä¸€ä¸ªæœ‰ç‚¹é•¿çš„é˜…è¯»ï¼Œæ‰€ä»¥å¦‚æœä½ è¿˜æ²¡æœ‰å‡†å¤‡å¥½ï¼Œè¿™é‡Œæœ‰ä½ éœ€è¦çš„é“¾æ¥:

*   [æˆ‘çš„ç½‘ç«™](https://shalvah.me)
*   [ç½‘ç«™æ¥æº](https://github.com/shalvah/shalvah.github.io)
*   [ä¸ºç½‘ç«™æä¾›åŠ¨åŠ›çš„ NPM åŒ…çš„æ¥æº](https://github.com/shalvah/shalvah)

## [](#why-did-i-do-this)æˆ‘ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ

æˆ‘è®¨åŒå»ºç«‹ç½‘ç«™ã€‚

å¥½å§ï¼Œè¿™æœ‰ç‚¹è¿‡äº†ã€‚æˆ‘ä¸ºç½‘ç»œå†™è½¯ä»¶ï¼Œä½†æ˜¯æˆ‘ä¸å–œæ¬¢å»ºç«‹ç½‘ç«™ã€‚æˆ‘æ›´å–œæ¬¢*åº”ç”¨*ã€‚æˆ‘çŸ¥é“ï¼Œè¯­ä¹‰ã€‚

ä½†æ˜¯è¯´çœŸçš„ï¼Œæˆ‘è®¨åŒæ‹…å¿ƒè¿™ä¸ªå›¾ç‰‡åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œæˆ–è€…é‚£ä¸ªæ¨ªå¹…åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œä»¥åŠåœ¨å“ªé‡Œæ”¾ç½®ä¸€å †é“¾æ¥ã€‚

å˜¿ï¼Œè¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä¸å–œæ¬¢æ¼‚äº®çš„ç½‘ç«™ã€‚æˆ‘çŸ¥é“â€”â€”å°¤å…¶æ˜¯å½“å®ƒä»¬æ˜¯ä¸€å¤§å †åŠŸèƒ½çš„å…³é”®æ—¶ã€‚

æˆ‘æ›´å–œæ¬¢ç½‘ç»œåº”ç”¨ï¼Œç½‘ç«™ä¸åªæ˜¯æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œæ˜¯æ¥å—ä½ çš„è¾“å…¥ï¼Œç”¨å®ƒåšä¸€äº›å¾ˆé…·çš„äº‹æƒ…ã€‚æˆ‘å°¤å…¶å–œæ¬¢åœ¨ä»–ä»¬çš„åç«¯å·¥ä½œã€‚

ä¸ºäº†è®©ä½ çŸ¥é“æˆ‘æœ‰å¤šä¸å–œæ¬¢ç½‘ç«™ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ç½‘ç«™ä»¥å‰çš„ç‰ˆæœ¬:

[![](../Images/409f50593a83c2a4f54dfbea042d4881.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Ex0CE2V7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.shalvah.me/store/media/ad5uvtvo11211jlxsdu5.PNG)

æ˜¯çš„ï¼Œä¼™è®¡ä»¬ã€‚å°±æ˜¯è¿™æ ·ã€‚ä¸€äº›æ–‡å­—ï¼Œä¸€äº›å›¾æ ‡ã€‚æˆ‘æƒ³ä½ å¯ä»¥è¯´å®ƒçœ‹èµ·æ¥å¾ˆä½“é¢ï¼Œä»¥æç®€ä¸»ä¹‰çš„æ–¹å¼ã€‚æˆ‘ä¸é¡¾ä¸€åˆ‡åœ°æƒ³åœ¨é‡Œé¢åŠ å…¥ä¸€äº›å·¥ç¨‹æŒ‘æˆ˜ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ª hack æ¥è·å–å’Œæ˜¾ç¤ºæˆ‘æœ€è¿‘çš„ä¸€äº›åª’ä½“æ–‡ç« ã€‚

æˆ‘å·²ç»è€ƒè™‘é‡å»ºæˆ‘çš„ç½‘ç«™æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå°¤å…¶æ˜¯æˆ‘ä¸€ç›´åœ¨æé«˜æˆ‘çš„å‰ç«¯æŠ€èƒ½ã€‚ä½†æ˜¯åšå¦ä¸€ä¸ªç½‘ç«™çš„å‰æ™¯è®©æˆ‘æ„Ÿåˆ°åŒçƒ¦ï¼Œæ‰€ä»¥æˆ‘é—®ï¼Œ*æˆ‘æ€æ ·æ‰èƒ½æŠŠå®ƒåšæˆæŸç§åº”ç”¨ç¨‹åºï¼Ÿ*

ä½ è¯´è¿‡åº¦å·¥ç¨‹ï¼Œæˆ‘è¯´ po-tah-toã€‚

ç„¶åæˆ‘æƒ³èµ·å‡ å‘¨å‰æˆ‘æ›¾è¯•å›¾ç”¨ CSS å’Œ jQuery æ„å»ºä¸€ä¸ªå‘½ä»¤è¡Œ UIã€‚ä¸ºä»€ä¹ˆä¸æŠŠæˆ‘çš„ç½‘ç«™å˜æˆä¸€ä¸ªç»ˆç«¯ï¼Ÿæˆ‘è§è¿‡å‡ ä¸ªè¿™æ ·çš„ç½‘ç«™ï¼Œå®ƒä»¬çœŸçš„å¾ˆé…·ã€‚ä»é‚£æ—¶èµ·ï¼Œæˆ‘å¼€å§‹æ€è€ƒï¼Œ*æˆ‘ä¸€ç›´æƒ³å¼€å‘ä¸€ä¸ª CLI åº”ç”¨*ï¼Œæ‰€ä»¥ä¸‹ä¸€ä¸ªæƒ³æ³•æ˜¯*åŠ¨æ‰‹å§ï¼è®©å®ƒæˆä¸ºä¸€ä¸ª CLI åº”ç”¨ç¨‹åºï¼Œè¿˜å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ*ï¼_ Yasssï¼

æ‰€ä»¥æˆ‘å¼€å§‹å·¥ä½œã€‚

## CLI å·¥å…·

é¦–å…ˆï¼Œæˆ‘çŸ¥é“æˆ‘å°†å‘ CLI å’Œæµè§ˆå™¨å±•ç¤ºç›¸åŒçš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»æˆ‘çš„`src/shalvah.js`(å› ç›¸å…³æ€§è€Œè¢«æˆªæ–­):
å¼€å§‹

```
const shalvah = {
    bio: "Hi, I'm Shalvah. I'm a backend software engineer based in Lagos, Nigeria.",
    prompt: 'Want to know more about me? Check me out on these sites:',
    links: [
        {
            name: 'GitHub',
            value: 'https://github.com/shalvah',
        },
        {
            name: 'dev.to',
            value: 'https://dev.to/shalvah',
        },
        {
            name: 'Twitter',
            value: 'https://twitter.com/theshalvah',
        }
    ],
    email: 'hello@shalvah.me'
};

module.exports = shalvah; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªå¯¹è±¡ä¿å­˜äº†æˆ‘çš„æ‰€æœ‰ä¿¡æ¯ã€‚ç½‘ç«™æˆ– CLI ä¸­çš„å…¶ä»–å†…å®¹åªæ˜¯ä¸€ç§å‘ˆç°å’Œäº¤äº’çš„æ–¹å¼ã€‚

ç„¶åæˆ‘å¼€å§‹å†™ CLI ç•Œé¢ã€‚æˆ‘ä½¿ç”¨äº†ä¸‰ä¸ªä¸»è¦å·¥å…·:

*   ç”¨äºåˆ›å»ºå‘½ä»¤è¡Œåº”ç”¨ç¨‹åº
*   [inquirer.js](https://github.com/SBoudrias/Inquirer.js) -ç”¨äºåˆ›å»ºäº¤äº’å¼ CLI æç¤º
*   å—¯ï¼Œä¸ºäº†ä»ç»ˆç«¯æ‰“å¼€ä¸œè¥¿

åœ¨æˆ‘çš„åŒ…é‡Œ. json:

```
{  "main":  "src/shalvah.js",  "bin":  "cli.js"  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   `main`:æˆ‘ä¹‹å‰åˆ›å»ºçš„æ–‡ä»¶ï¼Œæ‰€ä»¥æ— è®ºä½•æ—¶ä½ è¿è¡Œ`require('shalvah')`ï¼Œä½ éƒ½ä¼šå¾—åˆ°é‚£ä¸ªå¯¹è±¡ã€‚è¿™æ ·æˆ‘å°±å¯ä»¥åœ¨å®ƒå‘¨å›´åŒ…è£…ä¸€ä¸ªæµè§ˆå™¨ UI(æˆ–è€…ä»»ä½•æˆ‘é€‰æ‹©çš„ä¸œè¥¿)ã€‚
*   `bin`:èŠ‚ç‚¹å°†é“¾æ¥åˆ°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ‰€ä»¥å½“ä½ `npm install -g shalvah`ï¼Œç„¶åä½ è¿è¡Œ`shalvah`ï¼ŒNode ä¼šæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚

è¿™é‡Œæ˜¯`cli.js`ä¸­çš„å†…å®¹(å†æ¬¡å› ç›¸å…³æ€§è€Œè¢«æˆªæ–­):

```
#!/usr/bin/env node const program = require('commander');
const inquirer = require('inquirer');
const opn = require('opn');
const shalvah = require('./src/shalvah');

program.description('Shalvah in your command-line')
    .parse(process.argv);

console.log(shalvah.bio);
inquirer.prompt({
    name: 'link',
    type: 'list',
    message: shalvah.prompt,
    choices: shalvah.links
}).then(answers => {
    console.log(`Opening ${answers.link}`);
    opn(answers.link);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¾ˆç®€å•ï¼Œæœ€ç»ˆã€‚æ„Ÿè°¢è¿™ä¸‰ä¸ªäº†ä¸èµ·çš„å·¥å…·ï¼Œç”¨å‡ è¡Œä»£ç å°±å®Œæˆäº†æˆç†Ÿçš„ CLI åº”ç”¨ç¨‹åºã€‚

ä¹‹åï¼Œå‰©ä¸‹è¦åšçš„å°±æ˜¯å°†åŒ…å‘å¸ƒåˆ° NPMï¼Œç„¶åç”¨`npm install -g shalvah`å®‰è£…ï¼Œç§:

[![](../Images/e405f70d34e7a1ec02066b211bb6f64b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--24EUk_0Z--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://blog.shalvah.me/store/media/qqjes6p80semcjy8tboz.gif)

## [](#building-the-website)å»ºè®¾ç½‘ç«™

è¿™æœ‰ç‚¹å¤æ‚ã€‚æˆ‘çš„æ„å›¾æ˜¯å®‰è£…æˆ‘çš„ NPM åŒ…ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª`index.js`ä½œä¸ºæµè§ˆå™¨çš„å…¥å£ç‚¹ï¼Œå°±åƒ`cli.js`æ˜¯ CLI çš„å…¥å£ç‚¹ä¸€æ ·ã€‚`index.js`å°†å»ºç«‹ç»ˆç«¯ç¯å¢ƒå¹¶å‘åŒ…å‘é€è°ƒç”¨ã€‚æ€ä¹ˆæ ·äº†ï¼Ÿ

è‰¯å¥½çš„...

### [](#creating-a-terminal-ui)åˆ›å»ºç»ˆç«¯ UI

æˆ‘è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å¤„ç†ç»ˆç«¯ UIã€‚æˆ‘æœ€è¿‘ä¸€ç›´åœ¨æå‡æˆ‘çš„å‰ç«¯æŠ€èƒ½ï¼Œæ‰€ä»¥æˆ‘å¾ˆæƒ³è‡ªå·±åŠ¨æ‰‹ã€‚æˆ‘æœ€ç»ˆå†³å®šä½¿ç”¨ä¸€ä¸ªåº“ï¼Œå› ä¸ºæˆ‘æ„è¯†åˆ°æˆ‘éœ€è¦å¾ˆå¤šä¸œè¥¿(æ¯”å¦‚äº‹ä»¶å¤„ç†ç¨‹åºå’Œè‡ªå®šä¹‰é”®å¤„ç†ç¨‹åº),è¿™å°†èŠ±è´¹æˆ‘å¾ˆå¤šæ—¶é—´æ¥ç¼–å†™ã€æµ‹è¯•å’Œé‡æ„ã€‚æˆ‘ä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„å…³äºç»ˆç«¯ã€ç¼“å†²åŒºå’Œ I/O æµå¦‚ä½•å·¥ä½œçš„çŸ¥è¯†ã€‚

æˆ‘åšäº†ä¸€äº›ç ”ç©¶ï¼Œæˆ‘èƒ½æ‰¾åˆ°çš„æœ€å¯è¡Œçš„é€‰é¡¹æ˜¯ [xterm.js](https://xtermjs.org/) ã€‚Xterm.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç½‘ç»œç»ˆç«¯æ¨¡æ‹Ÿå™¨ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒçš„æ–‡æ¡£æ€¥éœ€æ”¹è¿›ï¼Œæ‰€ä»¥æˆ‘èŠ±äº†å¾ˆé•¿æ—¶é—´æ‰å¼„æ˜ç™½å¦‚ä½•ä½¿ç”¨å®ƒã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æ”¯æŒå¾ˆå¤šç‰¹æ€§ï¼Œä½†å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯åœ¨åº•å±‚å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä¸å¾—ä¸å›´ç»•è¿™äº›ç‰¹æ€§ç¼–å†™å®šåˆ¶çš„å¤„ç†ç¨‹åºã€‚

### [](#porting-the-console-to-the-browser)å°†æ§åˆ¶å°ç§»æ¤åˆ°æµè§ˆå™¨

æ¥ä¸‹æ¥æˆ‘æƒ³åˆ°çš„æ˜¯ï¼Œæˆ‘çœŸçš„å¾ˆå–œæ¬¢æ§åˆ¶å°ä¸Šçš„ Inquirer.js æç¤ºã€‚æˆ‘ä¹Ÿæƒ³åœ¨ç½‘ç«™ä¸Šå‘å¸ƒè¿™äº›ä¿¡æ¯ã€‚åŒæ ·ï¼Œé€‰æ‹©æ˜¯:ç¼–å†™ä½ è‡ªå·±çš„ä»£ç æˆ–è€…æ‰¾ä¸€ä¸ªåº“ã€‚å‡ºäºåŒæ ·çš„åŸå› ï¼Œæˆ‘å†æ¬¡é€‰æ‹©äº†åº“ã€‚æˆ‘å†³å®šåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ä¸ CLI ç›¸åŒçš„åº“(Inquirer.js å’Œ Commander)ã€‚

æˆ‘é¢ä¸´çš„ä¸€äº›æŒ‘æˆ˜:

### [](#how-do-i-use-packages-designed-for-the-commandline-in-the-browser)*å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ä¸ºå‘½ä»¤è¡Œè®¾è®¡çš„åŒ…ï¼Ÿ*

åœ¨è¿™é‡Œï¼Œ [Browserify](https://github.com/browserify/browserify) å‰æ¥æ•‘æ´ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰çš„è¯ï¼ŒBrowserify æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨èŠ‚ç‚¹åŒ…ã€‚å®ƒè¿˜ä¸ºåƒ`process`å’Œ`__dirname`è¿™æ ·çš„èŠ‚ç‚¹äº‹ç‰©æä¾›äº†â€œå«ç‰‡â€(ä¸€ä¸ªå«ç‰‡å°±åƒä¸€ä¸ªèµå“)ã€‚

### [](#plugging-in-commander)å µåœ¨æŒ‡æŒ¥å®˜èº«è¾¹

è¿™ç›¸å¯¹å®¹æ˜“ï¼Œå› ä¸ºå®ƒçš„ API å¸Œæœ›æ‚¨ä¼ å…¥å‘½ä»¤è¡Œå‚æ•°(é€šå¸¸æ˜¯`process.argv`)ã€‚åœ¨å‘½ä»¤è¡Œä¸Šï¼Œè¿è¡Œ`shalvah help`ä¼šç”¨ç±»ä¼¼äº`['/usr/bin/node', 'shalvah', 'help']`çš„ä¸œè¥¿å¡«å……`process.argv`ï¼Œæ‰€ä»¥åœ¨æµè§ˆå™¨ä¸­æˆ‘åšäº†:

```
 commander.parse([''].concat(args)); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#integrating-inquirerjs)æ•´åˆæŸ¥è¯¢è€…. js

è¿™æ˜¯ä¸€ä¸ªæ›´å¤§çš„é—®é¢˜ã€‚å®ƒçš„ä»£ç å¤§éƒ¨åˆ†è¯»å†™åˆ°`process.stdout` / `process.stdin`ï¼Œéƒ½æ˜¯ [`Readline.Interface`](https://nodejs.org/api/readline.html#readline_class_interface) çš„å®ä¾‹ã€‚å¥½æ¶ˆæ¯æ˜¯:

*   åº“ä¾èµ–äºè¡Œä¸º(æŸäº›æ–¹æ³•çš„å­˜åœ¨)ï¼Œè€Œä¸æ˜¯ç»§æ‰¿(`x instanceof Readline.Interface`)ï¼Œä»¥åŠ
*   Xterm.js å·²ç»æ”¯æŒ readline çš„å¤§éƒ¨åˆ†åŠŸèƒ½ã€‚æˆ‘å†™äº†ä¸€ä¸ª shimï¼Œå‡è£…`xterm.js`æ˜¯æ¥å£çš„ä¸€ä¸ªå®ä¾‹ï¼Œç„¶åæˆ‘ç”¨ Browserify çš„ [aliasify è½¬æ¢æ¥æ›¿æ¢ Inquirer æœŸæœ›ç”¨æˆ‘çš„æ¥æ›¿æ¢çš„`readline`ã€‚shim çš„ç®€åŒ–ç‰ˆæœ¬å¦‚ä¸‹æ‰€ç¤º:](https://github.com/benbria/aliasify)

```
module.exports = {
  createInterface({ input, output }) {
      // so we don't redefine these properties
      if (input.readlineified) {
          return input;
      }
      // normally, input and output should be the same xterm.Terminal instance
      input.input = input;
      input.output = input;
      input.pause = function () {};
      input.resume = function () {};
      input.close = function () {};
      input.setPrompt = function () {};
      input.removeListener = input.off.bind(input);

      Object.defineProperty(input, 'line', {
          get: function () {
              return input.textarea.value;
          }
      });
      input.readlineified = true;
      return input;
  }
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Xterm.js å·²ç»æœ‰äº†ä¸€ä¸ª`write`å‡½æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦å®šä¹‰å®ƒã€‚

æˆ‘è¿˜å¿…é¡»åšä¸€äº›éå¸¸å…·ä½“çš„å«ç‰‡:

```
 // The most important shim. Used by both Commander and Inquirer.
    // We're tricking them into thinking xterm is a TTY 
    // (see https://nodejs.org/api/tty.html)
    term.isTTY = true;

    // Xterm is both our input and output
    process.stdout = process.stdin = process.stderr = term;

    // Shim process.exit so calling it actually halts execution. Used in Commander
    process.exit = () => {
        term.emit('line-processed');
        throw 'process.exit';
    };
    // catch the process.exit so no error is reported
    window.onerror = (n, o, p, e, error) => {
        if (error === 'process.exit') {
            console.log(error);
            return true;
        }
    };

    // For inquirer.js to exit when Ctrl-C is pressed (SIGINT)
    process.kill = () => {
        process.running = false;
        term.writeln('');
        term.writeThenPrompt('');
    }; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#sizing-the-terminal-appropriately)é€‚å½“è°ƒæ•´ç»ˆç«¯å°ºå¯¸

æˆ‘é¢ä¸´çš„å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯è°ƒæ•´ç»ˆç«¯çš„å¤§å°ï¼Œä½¿å®ƒåœ¨æ¡Œé¢å’Œç§»åŠ¨ä¸Šéƒ½å¾ˆå¥½çœ‹ï¼Œæ²¡æœ‰ä»»ä½•éš¾çœ‹çš„æ»šåŠ¨æ¡ã€‚ä»¥ä¸‹æ˜¯æˆ‘å¸Œæœ›å®ƒåœ¨æ‰‹æœºä¸Šçš„æ ·å­:

[![](../Images/ef4e19e36e33d1974ea6d3061cc9147d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--mqlYhor6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.shalvah.me/store/media/axgjx11utkix6d7cis85.PNG)

è¦åšåˆ°è¿™ä¸€ç‚¹æœ‰ç‚¹å›°éš¾ï¼Œå› ä¸ºç»ˆç«¯çª—å£çš„å¤§å°ä¸ä»…å— CSS è§„åˆ™çš„å½±å“ï¼Œè¿˜å—æ¯è¡Œçš„è¡Œæ•°å’Œåˆ—æ•°çš„å½±å“ï¼Œè€Œè¡Œæ•°å’Œåˆ—æ•°åˆå—å­—ä½“å¤§å°çš„å½±å“ã€‚è¿™éå¸¸æ£˜æ‰‹ã€‚å¦‚æœåˆ—æ•°å¤šäº† 1 ä¸ªå•ä½ï¼Œå°±ä¼šå‡ºç°æ»šåŠ¨æ¡ã€‚åœ¨åšäº†ä¸€äº›ç ”ç©¶å¹¶å°è¯•äº†è®¸å¤šæ–¹æ³•ä¹‹åï¼Œæˆ‘å†³å®šé‡‡ç”¨è¿™ä¸ªæ–¹æ³•:

```
 const term = new Terminal({
        cursorBlink: true,
        convertEol: true,
        fontFamily: "monospace",
        fontSize: '14',
        rows: calculateNumberOfTerminalRows(),
        cols: calculateNumberOfTerminalCols(),
    });

    // This measures the height of a single character using a div's height
    // and uses that to figure out how many rows can fit in about 80% of the screen
    function calculateNumberOfTerminalRows() {
        let testElement = document.createElement('div');
        testElement.innerText = 'h';
        testElement.style.visibility = 'hidden';
        document.querySelector('.term-container').append(testElement);
        testElement.style.fontSize = '14px';
        let fontHeight = testElement.clientHeight + 1;
        testElement.remove();
        return Math.floor(screen.availHeight * 0.8 / fontHeight) - 2;
    }

    // This measures the width of a single character using canvas
    // and uses that to figure out how many columns can fit in about 60% (80% for mobile) of the screen
    function calculateNumberOfTerminalCols() {
        const ctx = document.createElement("canvas").getContext('2d');
        ctx.font = '14px monospace';
        const fontWidth = ctx.measureText('h').width + 1;
        const screenWidth = screen.availWidth;
        return Math.floor(screenWidth * ((screenWidth > 600) ? 0.6 : 0.8) / fontWidth) + 3;
    } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹å¤¸å¼ ï¼Œä½†è¿™æ˜¯æˆ‘èƒ½æƒ³åˆ°çš„æœ€å¯é çš„æ–¹æ³•ã€‚

### [](#colour-support)é¢œè‰²æ”¯æŒ

æˆ‘å¸Œæœ›æˆ‘çš„ç»ˆç«¯æœ‰é¢œè‰²(è°ä¸æƒ³å‘¢ï¼Ÿ)ï¼Œè€Œç”¨äºæ­¤çš„ç¨‹åºæ˜¯ã€‚ä¸å¹¸çš„æ˜¯ï¼Œchalk ä¼¼ä¹ä¸èƒ½ä¸ Xterm.js ä¸€èµ·å·¥ä½œï¼Œæ‰€ä»¥ç»è¿‡å‡ ä¸ªå°æ—¶çš„è°ƒè¯•ï¼Œæˆ‘å‘ç°é—®é¢˜æ¥è‡ªäº[ä¸€ä¸ªç”¨äºæ£€æµ‹é¢œè‰²çš„å¤–éƒ¨ä¾èµ–](https://www.npmjs.com/package/supports-color) chalkï¼Œæ‰€ä»¥æˆ‘ç”¨æˆ‘çš„å«ç‰‡æ›¿æ¢äº†å®ƒ:

```
module.exports = {
    stdout: {
        level: 2,
        hasBasic: true,
        has256: true,
        has16m: false
    }
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#switching-prompts-on-mobile)åˆ‡æ¢æ‰‹æœºä¸Šçš„æç¤º

æ‚¨ä¼šæ³¨æ„åˆ°ï¼Œåœ¨æˆ‘ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªåä¸º`list`çš„è¯¢é—®æç¤ºï¼Œå®ƒå…è®¸æ‚¨ä½¿ç”¨ç®­å¤´é”®æ¥é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ã€‚ä¸è¿‡ï¼Œåœ¨æ‰‹æœºä¸Šï¼Œé€šå¸¸æ²¡æœ‰ç®­å¤´é”®ã€‚æ‰€ä»¥æˆ‘ä¸å¾—ä¸åˆ‡æ¢åˆ°æ‰‹æœºä¸Šçš„`rawlist`æç¤º(ä½¿ç”¨æ•°å­—è¾“å…¥):

```
 inquirer.prompt({
        name: 'link',
        type: (screen.width > 600) ? 'list' : 'rawlist'
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¼«é•¿çš„å‡ ä¸ªå°æ—¶åï¼Œç»ˆç«¯ç»ˆäºå·¥ä½œäº†ï¼

[![](../Images/0eaf47905ce8a517b0e3d6df8376ae6d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Yfcti2yC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://blog.shalvah.me/store/media/zplj307cguvkz41v6y6l.gif)

## [](#was-it-worth-it)å€¼å¾—å—ï¼Ÿ

æ€»çš„æ¥è¯´ï¼Œè¿™å¯¹æˆ‘æ¥è¯´æ˜¯ä¸€æ¬¡æœ‰å‹åŠ›ä½†æœ‰è¶£çš„ç»å†ï¼Œæˆ‘å­¦åˆ°äº†å¾ˆå¤šæ–°ä¸œè¥¿ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä¸æˆ‘åœ¨è¿™é‡Œæè¿°çš„å¤§éƒ¨åˆ†å†…å®¹ä¸€èµ·å·¥ä½œï¼Œç”šè‡³å­¦ä¹ ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªèƒœåˆ©ã€‚æˆ‘ç”šè‡³æœ€ç»ˆèƒ½å¤ŸåŠ å…¥ä¸€äº›åŸºæœ¬çš„ Unix å®ç”¨ç¨‹åºï¼Œæ¯”å¦‚`cd`å’Œ`ls`(è¯•è¯•å§ï¼ğŸ˜ğŸ˜)

ä»ç„¶æœ‰ä¸€äº› bugï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œä½†æ˜¯æˆ‘å·²ç»åŒå€¦äº†ç­‰å¾…ä¸€åˆ‡éƒ½å˜å¾—å®Œç¾ï¼Œå¹¶ç»§ç»­å‘è¡¨è¿™ç¯‡æ–‡ç« ã€‚å¸Œæœ›ä½ å–œæ¬¢ï¼