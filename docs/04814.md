# ä¸ºä»€ä¹ˆåº”è¯¥åŒ…è£…(JavaScript)ä¾èµ–é¡¹

> åŸæ–‡:[https://dev . to/Hugo _ _ df/why-you-should-wrap-your-JavaScript-dependencies-48o 2](https://dev.to/hugo__df/why-you-should-wrap-your-javascript-dependencies-48o2)

> ä¸€ä¸ªé‚®ä»¶å‘é€çš„ä¾‹å­ã€‚

*   [ä½¿ç”¨å‘é€ç½‘æ ¼çš„ç¤ºä¾‹](#example-using-sendgrid)
*   æˆ‘ä»¬å¦‚ä½•æ¶ˆè´¹è¿™ä¸ªï¼Ÿ
*   [åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç”µå­é‚®ä»¶æä¾›å•†](#switching-to-another-email-provider)

> è¿™æ˜¯ç”¨é›¨æœç®€è®¯çš„[ä»£ç å‘å‡ºçš„ã€‚](https://buttondown.email/hugo) [è®¢é˜…](https://buttondown.email/hugo)å¯ä»¥åœ¨ä½ çš„æ”¶ä»¶ç®±é‡Œè·å¾—æœ€æ–°çš„å¸–å­(æ¯”ä»»ä½•äººéƒ½è¦æ—©)ã€‚

## ä½¿ç”¨ SendGrid çš„ä¾‹å­

åœ¨éå¸¸åŸºæœ¬çš„å±‚é¢ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå‘é€ç”µå­é‚®ä»¶ã€‚

ç”¨ä»£ç æœ¯è¯­æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ª`send`å‡½æ•°ã€‚æœ€å¥½æœ‰ä¸€ç§æŠ½è±¡æ¶ˆæ¯åˆ›å»ºçš„æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ª`makeMailMessage`å‡½æ•°ã€‚

å‚è§ä¸‹é¢çš„ä»£ç :

```
const sgMail = require('@sendgrid/mail');

const {
  SENDGRID_API_KEY,
  EMAIL_OVERRIDE_TO_ADDRESS,
  EMAIL_FROM_ADDRESS
} = process.env;

sgMail.setApiKey(SENDGRID_API_KEY);

function makeMailMessage ({
  to,
  from = EMAIL_FROM_ADDRESS,
  subject,
  text,
  html
}) {
  return {
    to: EMAIL_OVERRIDE_TO_ADDRESS || to,
    from,
    subject,
    ...(html ? { html } : { text })
  };
}
function send (message) {
  return sgMail.send(message);
}
module.exports = {
  makeMailMessage,
  send
}; 
```

Enter fullscreen mode Exit fullscreen mode

## æˆ‘ä»¬å¦‚ä½•æ¶ˆè´¹è¿™ä¸ªï¼Ÿ

```
function doSomeSending(name, email) {
  const message = makeMailMessage({
    from: 'hi@codewithhugo.com',
    to: email,
    subject: 'Welcome to Code with Hugo',
    text: `Hi ${name}, welcome to Code with Hugo.`
  });
  return send(message); 
} 
```

Enter fullscreen mode Exit fullscreen mode

## åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç”µå­é‚®ä»¶æä¾›å•†

æ¯”å¦‚è¯´æˆ‘ä»¬æƒ³æ¢ä¸€ä¸ªæä¾›å•†ï¼Œä¹Ÿå°±æ˜¯ Mailgunã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸æƒ³æ”¹å˜ä»»ä½•åº”ç”¨ç¨‹åºä»£ç ã€‚

```
const {
  MAILGUN_API_KEY,
  EMAIL_DOMAIN,
  EMAIL_OVERRIDE_TO_ADDRESS,
  EMAIL_FROM_ADDRESS
} = process.env;
const mailgun = require('mailgun-js')({
  apiKey: MAILGUN_API_KEY,
  domain: EMAIL_DOMAIN
});

function makeMailMessage ({
  to,
  from = EMAIL_FROM_ADDRESS,
  subject,
  text,
  html
}) {
  return {
    to: EMAIL_OVERRIDE_TO_ADDRESS || to,
    from,
    subject,
    ...(html ? { html } : { text })
  };
}

function send (message) {
  return new Promise((resolve, reject) => {
    mailgun.messages().send(message, (error, body) => {
      if (error) {
        return reject(error);
      }
      resolve(body);
    });
  });
}

module.exports = {
  makeMailMessage,
  send
}; 
```

Enter fullscreen mode Exit fullscreen mode

æˆ‘ä»¬çš„`mail`æ¨¡å—çš„ API ä¿æŒä¸å˜ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»æ”¹å˜äº†å¹•åçš„æä¾›è€…ğŸ‘ã€‚

å¡ç¼ªå°”Â·æ³½å‹’