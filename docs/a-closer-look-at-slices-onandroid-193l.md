# 近距离观察 Android 上的切片

> 原文：<https://dev.to/ditn/a-closer-look-at-slices-onandroid-193l>

在 Google IO 2018 的筹备过程中，在仔细研究了 Android P Alpha 版本后，一些人注意到 P SDK 文档中有一个神秘的新“切片”类。有很多关于切片实际上做了什么的猜测，诺沃达的塞巴斯蒂安·波吉对当时已知的东西做了一个伟大的深入研究。

但是现在 IO 已经过去了，我们对切片有什么了解，我们如何在我们的应用中利用它们，我们为什么还要这样做？要回答这个问题，让我们从应用程序操作开始。

## 随处行动

应用程序动作，也称为谷歌上的动作，是一个新框架的一部分，允许开发者将其应用程序与谷歌助手、搜索、Play Store 和谷歌未来想要的任何地方进行深度整合。虽然应用程序动作甚至还没有进入开发者预览版，但我们从概览网站和 T2 在 IO 上的各种演讲中对它们有所了解。

你可以通过应用程序操作做很多事情，例如通过谷歌助手直接交互和注册自定义意图，但现在我们将专注于它们如何作为切片功能的桥梁。

在一个高层次上，谷歌用他们自己的数据方案定义了一个不断增长的意图集。然后，开发人员将他们应用程序中的内容暴露给这些意图，并通过深度链接提供功能。出于本文的目的，我们将着眼于`actions.intent.GET_CRYPTOCURRENCY_PRICE`意图，由于显而易见的原因，这让我相当兴奋。

像`GET_CRYPTOCURRENCY_PRICE`这样的意图可以被谷歌混淆地称为*的语义意图*所触发——这些语义意图通常是对谷歌助手或搜索的口头或打字查询。对于我们的示例意图，语义意图可能是:

*   比特币目前的美元价格是多少？
*   ETH 今天在做什么？
*   Dogecoin 值多少钱？

对于一个应用程序来说，自己处理这样的查询将是极其困难的，但相反，谷歌可以识别用户的意图，然后以一种我们可以以某种方式处理的格式提供结果:

```
{
  "cryptocurrency": {
    "name": "string"
  },
  "exchange": {
    "name": "string"
  },
  "target monetary spec": {
    "currency": "string",
    "valid_at": "date string (ISO 8601 format)"
  }
} 
```

在上面的例子中，找到加密货币的名称是相当容易的，但法定货币通常是隐含的——我会假设谷歌正在使用设备区域设置或地理位置来推断最可能的本地货币。很多话语都是隐含的，谷歌在很多情况下为你处理这个困难的任务。

这一切都很好，但是我们如何注册我们的应用程序来利用这些意图呢？

## 输入 actions.xml

`actions.xml`是一个新文件，您可以将它包含在您的应用中，它定义了应用操作意图和您希望您的应用处理的 URIs 之间的映射。在这个文件中，您可以从由意图定义的应用程序操作模式中提取值，然后将它们插入到您的应用程序接受的任何 URL 格式中: