# 在 PostgreSQL 中只使用 Select 我学到了什么

> 原文：<https://dev.to/jenc/what-i-learned-from-only-using-select-in-postgresql-3na>

[![Fritz the Rescue Horse](img/6f010a9d7da295e77a7b06b2afa1ba99.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--03CnGTMv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zl8g0vtk8w19prwyuwry.png)

我的任务是为工作中的一个项目收集详细的指标，并被建议只使用 select(作为 Postgres 的新手，并对生产进行查询)，这样我就不会破坏整个系统。

我不能详细介绍我发现的很酷的数据，但我觉得有必要写一个虚拟的帖子，因为一个全新的世界向我敞开了大门😂标记书呆子们请原谅我——这是在 iOS 键盘上写的，没有反斜杠。

## 关系数据库是表格，其单元格与其他表格中的单元格有关系

对于我来说，这实际上是最难理解的事情，因为我来自 MongoDB，我不得不不断地使用每个表名来查找我需要的信息。我思维活跃，所以在没有询问我的同事的情况下，我倾向于认为某些表嵌套了其他表。

本·辛克莱对我在上面试图说的话作了也许更容易理解的澄清:

> 关系数据库中的“关系”只是指表内的关系，即所有属于一个表的字段形成一种关系。你所说的关于其他表的是外键。”

## 连接对于发现表之间的粒度(编辑:不是格兰诺拉麦片)趋势和共性非常有用，但有时也有点过头了

慎入。我加入的表越多，我必须管理的别名就越多。最后，如果两个表之间真的没有可靠的公共键，我不确定从连接中收集的结果在何种意义上是有效的。是偶然的重叠，还是精确的关联？我只知道左内连接，而不是右内连接，外连接等等。先学好一门再学两门，因为你的结果会不一样。

## 标签会骗人

我对人口和家庭数量等一般统计数据感到困惑。如果你不能确定一个家庭是由什么组成的，或者不是每个人都使用它，那么根据家庭来寻找一个特性的使用率值得吗？如果人口统计只是来自维基百科或者 2011 年的人口普查呢？很多事情开始变得神经质的不准确。由于人口密度和地形、天气的差异，无论是城市还是城镇，数据都必须标准化...等等。我必须评估是否值得花时间去标准化或寻找每个城市的使用数据。

## 不要试图在一个查询中完成太多，否则你会把自己逼疯的。

很容易陷入数字和表格演示的泥潭。我想使用我在 from，where conditions，group by 和 order by 方面学到的所有新的、有价值的东西。有时需要一些查询来深入到我真正需要的几条信息，以产生有用的结果并得出具体的结论。因为否则，我就没有演讲了。

## 在 Vim 中使用' \e '逐行构建您的查询

或者你会因为按下控制台而丢失它，或者浪费时间使用箭头键回到你的打字错误...结果却意外地按下了 enter 键，提交了一个错误的查询，不得不回滚。
...或者更好的是，将其保存为. sql 文件并在 bash 中运行！

## 将您的查询导出为 csv 格式

所以你可以惊叹于你的发现，并证明你确实工作 lol。
' \复制(选择...从...在哪里...)' path/to/file.csv' CSV 头；'

## 你可以用 5000 万种方法分割数据，但你需要想出一些艰难而真实的答案

一段时间内的趋势和所有时间一样重要。为你的第一个查询设置有限的约束，否则它会很快变得混乱。从每周或每月的大量数据开始。

## 不要太在意准确性，除非那真的很重要。

在我的案例中，度量标准的意义不在于监控，而是看我能在哪些地方改进我们的用户体验，减少使用内部软件的痛点。我们不得不接受一定的误差，但有足够多的数字表明我们肯定可以降低这里的回复率或那里的投诉率。归根结底，这是为了对我们同事的工作生活产生影响。

## 您在 select 中输入的每一列都将成为一个集合，并且应该出现在“分组依据”中

我发现这特别烦人，因为有时信息是多余的，group by 只将结果组织成列，这样就不会有一长串记录

## 你不一定需要创建视图

除非你打算一直用它。这只会占用空间和处理能力。

Dian Fay 稍微纠正了我上面的假设:

> 视图只是在您调用视图时运行的存储查询。空间和功耗可以忽略不计，除非您创建一个实际存储其结果的物化视图(因此必须手动刷新)。

> 只有在实际进行聚合计算时，才有必要使用 GROUP BY。如果您只是提取单个记录，而不进行计数、求和或从多行中导出一个值，您甚至不需要指定它。如果您只想过滤掉重复的行，可以选择 DISTINCT。

如果你是 PostgreSQL 或 SQL 的粉丝，你认为它最擅长什么？最适合它的用例是什么？您完成过哪些实施 pg 数据库的项目？让我知道！