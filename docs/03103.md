# ç”¨å“ˆæ¯”ç¥ã€MongoDBã€Vue.js æ­å»ºä¸€ä¸ªä»»åŠ¡ app

> åŸæ–‡:[https://dev . to/Connor 11528/build-a-task-app-with-hapi-MongoDB-and-vue js-7d 9](https://dev.to/connor11528/build-a-task-app-with-hapi-mongodb-and-vuejs-7d9)

> æœ€åˆåœ¨åª’ä½“ä¸Šå‘å¸ƒçš„å¸–å­

æœ¬æ•™ç¨‹çš„æƒ³æ³•æ˜¯ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Node.jsã€MongoDB å’Œ Vue.js æ„å»ºä¸€ä¸ªä»»åŠ¡åº”ç”¨ç¨‹åºã€‚ç”¨æˆ·å°†èƒ½å¤Ÿä»ä»–ä»¬çš„ web æµè§ˆå™¨ä¸­è¯»å–ã€åˆ›å»ºå’Œåˆ é™¤ä»»åŠ¡ã€‚æ‰€æœ‰ä»»åŠ¡éƒ½å°†å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæ›´æ–°å°†ä» web æµè§ˆå™¨å¼‚æ­¥è¿›è¡Œã€‚è¿™æ„å‘³ç€ç”¨æˆ·ä¸å¿…åˆ·æ–°é¡µé¢å°±èƒ½çœ‹åˆ°æ›´æ”¹ç”Ÿæ•ˆã€‚è¿™ä¸ªåº”ç”¨ç¨‹åºå¾ˆç®€å•ï¼Œåº”è¯¥æ¸…æ¥šåœ°ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨è¿™äº›æŠ€æœ¯è¿›è¡Œæ„å»ºã€‚

æœ€ç»ˆäº§å“çœ‹èµ·æ¥ä¼šåƒè¿™æ ·:

ä½¿ç”¨ Node.js æœåŠ¡å™¨ã€Mongo æ•°æ®åº“å’Œ Vue å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„ todo åº”ç”¨ç¨‹åºç¤ºä¾‹ã€‚
ğŸ™æœåŠ¡å™¨ç«¯ä»£ç åœ¨ GitHub ä¸Šæ˜¯å¼€æºçš„ã€‚

ğŸ±å®¢æˆ·ç«¯ä»£ç åœ¨ GitHub ä¸Šæ˜¯å¼€æºçš„ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä»æ„å»ºæœåŠ¡å™¨å¼€å§‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ä»‹ç»â€¦

Hapijs
å“ˆæ¯”ç¥æ˜¯ä¸€ä¸ª Node.js æœåŠ¡å™¨æ¡†æ¶ï¼Œè¢« Lobã€Stitch Labs å’Œ Auth0 ç­‰å¤§å…¬å¸ä½¿ç”¨ã€‚è¦å¼€å§‹ä½¿ç”¨ npm init ç”Ÿæˆä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶å°†å…¶ç”¨ä½œæ‚¨çš„ä¸»æœåŠ¡å™¨æ–‡ä»¶:

```
const Hapi     = require('hapi');
const routes   = require('./routes');
require('./utils/database');
const server = Hapi.server({
  port: 3000,
  host: 'localhost',
  routes: { cors: true }
});
const startServer = async () => {
  try {
    routes.forEach((route)=>{
      server.route(route);
    });
await server.start();
    console.log(`Server running at: ${server.info.uri}`);
  } catch (err) {
    console.error(err);
  }
};
startServer();
module.exports = server; 
```

å¦‚æœä½ ç†Ÿæ‚‰ expressï¼Œè¿™çœ‹èµ·æ¥å¾ˆåƒä¸€ä¸ª express åº”ç”¨ç¨‹åºã€‚å°½ç®¡æˆ‘ä»¬ä½¿ç”¨äº† async / await å‡½æ•°ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ã€‚è¿™æ˜¯ Node.js æœ€æ–°ç‰ˆæœ¬çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œä¹Ÿæ˜¯å¯¹ Javascript è¯­è¨€çš„ä¸€ä¸ªå¾ˆå¥½çš„è¡¥å……ã€‚æœ¬è´¨ä¸Šï¼Œå‰ç¼€ä¸ºâ€œasyncâ€çš„å‡½æ•°å¯ä»¥ä¿æŒæ‰§è¡Œï¼Œç›´åˆ° await promise è°ƒç”¨è¢«è¿”å›ã€‚å¼‚æ­¥å‡½æ•°è¿”å›æ‰¿è¯ºã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œç”¨é»˜è®¤çš„å“ˆæ¯”ç¥é€‰é¡¹é…ç½® corsï¼Œå¹¶é€šè¿‡ require è¯­å¥è¿æ¥åˆ°æ•°æ®åº“ã€‚

ä¸ºäº†è¿æ¥ä¸€ä¸ª d query MongoDBï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå«åš mongose çš„ ORM æ¥æŸ¥è¯¢å’Œå†™å…¥ Mongoã€‚

```
const mongoose = require('mongoose');
require('../models');
mongoose.connect('mongodb://localhost/task-app-backend', {
  useNewUrlParser: true
}, (err) => {
  if (err) throw err;
}); 
```

å®ƒè¿æ¥åˆ° MongoDB æ•°æ®åº“(æ‚¨å¯èƒ½éœ€è¦è®© mongod åœ¨æœ¬åœ°æœºå™¨ä¸Šçš„ä¸€ä¸ªå•ç‹¬çš„é€‰é¡¹å¡ä¸­è¿è¡Œ)ã€‚

åœ¨ MongoDB ä¸­ï¼Œæ²¡æœ‰æ•°æ®åº“è¿ç§»ã€‚ORM åŒ…è£…å™¨æœ‰ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„æ¨¡å‹æ¦‚å¿µã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªä»»åŠ¡åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä»»åŠ¡æ¨¡å‹ã€‚

```
const mongoose = require('mongoose');
const taskModel = mongoose.Schema({
  name: {type: String, required: '{PATH} is required!'},
  description: {type: String},
}, {
  timestamps: true
});
module.exports = mongoose.model('Task', taskModel); 
```

è¿™ä¸ºæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª MongoDB é›†åˆï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªè¡¨ï¼Œå½¢çŠ¶åƒä¸€ä¸ªæ—§çš„å¤§å‹ Javascript å¯¹è±¡ã€‚ä»–ä»¬ä½¿ç”¨ä¸€ç§å«åš BSON çš„ä¸œè¥¿ï¼Œä»–ä»¬åœ¨ MongoDB ä¸Šå†™äº†ä¸€ä»½ç™½çš®ä¹¦ã€‚

MongoDB è‚¡ä»·ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼ŒMongoose æ˜¯ä¸€ä¸ªå¼€æºçš„ npm åŒ…ã€‚

æˆ‘ä»¬å¯ä»¥å°†è·¯ç”±å®šä¹‰ä¸º Javascript å¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰â€œæ–¹æ³•â€ã€â€œè·¯å¾„â€å’Œâ€œå¤„ç†ç¨‹åºâ€å±æ€§ã€‚æ‚¨è¿˜å¯ä»¥åŒ…å«ä¸€ä¸ªå¯é€‰çš„â€œoptionsâ€å±æ€§ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒç»‘å®šåˆ° api/index.js æ–‡ä»¶ã€‚

å“ˆæ¯”ç¥è·¯ç”±æ–‡ä»¶

```
const api = require('./api');
const routes = [
  {
    method: 'GET',
    path: '/',
    handler: (request, h) => {
      return {success: true};
    }
  },
  {
    method: 'GET',
    path: '/api',
    handler: (request, h) => {
      return {success: true};
    }
  },
  {
    method: 'GET',
    path: '/api/task',
    options: api.task.all
  },
  {
    method: 'POST',
    path: '/api/task',
    options: api.task.create
  },
  {
    method: 'GET',
    path: '/api/task/{task}',
    options: api.task.get
  },
  {
    method: 'PUT',
    path: '/api/task/{task}',
    options: api.task.update
  },
  {
    method: 'DELETE',
    path: '/api/task/{task}',
    options: api.task.remove
  },
];
module.exports = routes; 
```

æœ€åï¼Œå¯¹äº CRUD ç«¯ç‚¹ï¼Œè¿™æ˜¯æˆ‘æ‰€æ‹¥æœ‰çš„:

```
const {Task} = require('./../models');
const Boom = require('boom');
const taskApi = {
  all: {
    async handler(request, h) {
      try {
        return await Task.find({}).sort({ createdAt: 'desc' });
      } catch (err) {
        Boom.badImplementation(err);
      }
    }
  },
  create: {
    async handler(request, h) {
      try {
        const task = await new Task({
          name: request.payload.name,
          description: request.payload.description
        });
        task.save();
        return { message: "Task created successfully", task };
      } catch (err) {
        Boom.badImplementation(err);
      }
    }
  },
  get: {
    async handler(request, h) {
      try {
        const task = request.params.task;
        return await Task.findOne({
            _id: task.id
        });
      } catch (err) {
          Boom.badImplementation(err);
      }
    }
  },
  update: {
    async handler(request, h) {
      try {
        const task = request.params.task;
        const updates = request.payload;
        // todo: submit a pull request

      } catch (err) {
          Boom.badImplementation(err);
      }
    }
  },
  remove: {
    async handler(request, h){
        try {
            const task = await  Task.findById(request.params.task).remove();
            return { success: true, message: 'Successfully removed task!' };
        } catch (err) {
            Boom.badImplementation(err);
        }
    }
  }
};
module.exports = taskApi; 
```

è¿™ä¸ªæ–‡ä»¶ä½¿ç”¨ Mongoose ä»æ•°æ®åº“ä¸­è·å–æˆ‘ä»¬çš„è®°å½•ã€‚await è°ƒç”¨è§£ææ‰¿è¯ºï¼Œå¹¶åœ¨æ‰¿è¯ºè§£ææ—¶é˜»æ­¢æ‰§è¡Œã€‚è¯·æ±‚å¯¹è±¡æ¥è‡ªæˆ‘ä»¬çš„ Vue.js åº”ç”¨ç¨‹åºï¼Œå®ƒå°†å­˜æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„ repo ä¸­ã€‚

Vue.js
è¿™æ˜¯ Vueï¼ŒReactï¼ŒLindsay Lohanï¼ŒTaylor Swift çš„æ¡†æ¶å¯¹æ¯”ã€‚

çœ‹èµ·æ¥è°·æ­Œé¢„æµ‹æ³°å‹’åœ¨æœªæ¥å‡ å‘¨ä¼šæœ‰å¤§ä½œä¸ºã€‚

ä»ä¸Šå›¾æ¥çœ‹ï¼Œæ³°å‹’Â·æ–¯å¨å¤«ç‰¹æ˜¾ç„¶æ˜¯æ¡†æ¶æ¯”è¾ƒçš„èµ¢å®¶ã€‚æŠ±æ­‰ï¼Œååº”è¿‡æ¥ã€‚
ä¸ç®¡æ€æ ·ï¼Œå‰ç«¯æºä»£ç åœ¨è¿™é‡Œã€‚å®ƒä½¿ç”¨ä¸€ä¸ªåä¸º vue-webpack-simple çš„ä¾¿æ·åº”ç”¨ç”Ÿæˆå™¨ï¼Œç”± Vue.js æ ¸å¿ƒå›¢é˜Ÿç»´æŠ¤ã€‚

æˆ‘å­¦åˆ°çš„ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿æ˜¯ï¼Œæœ‰ä¸€ä¸ªè¿‡æ¸¡å’Œè¿‡æ¸¡ç»„ç»„ä»¶ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥ç”¨ CSS æ’åˆ—åŠ¨ç”»ã€‚è¯¥ç»„ä»¶çš„ HTML ç±»ä¼¼äº:

```
<transition-group name="task-list">    
  <div class="row mb-2" v-for="(task, index) in tasks" :key="task._id">       
    <div class="col-sm-4">          
      {{ task.name }}       
    </div>       
    <div class="col-sm-2">          
      <span @click='updateTask(task._id, index)' class="task-action"><i class="fas fa-pencil-alt"></i>
      </span>          
      <span @click='deleteTask(task._id, index)' class="task-action badge badge-danger badge-pill">X</span>
    </div>    
  </div> 
</transition-group> 
```

åœ¨ Vue.js ä¸»é¡µä¸Šæœ‰å¾ˆå¤šä¸åŒç”¨ä¾‹çš„å¾ˆæ£’çš„å…¥é—¨ç¤ºä¾‹ä»£ç ï¼Œç”¨äºæ–‡æ¡£:è¿›å…¥/ç¦»å¼€&åˆ—å‡ºè½¬æ¢ã€‚

å½“è¿›å…¥å’Œç¦»å¼€è½¬æ¢å‘ç”Ÿæ—¶ï¼ŒVue.js åº”ç”¨ç‰¹æ®Šçš„ç±»ã€‚é€šè¿‡å°†è¿‡æ¸¡ç»„å‘½åä¸ºâ€œtask-list â€, task-list å°†è¢«é™„åŠ åˆ°ç‰¹æ®Šçš„ Vue.js äº‹ä»¶ç±»åä¸­:

```
.task-list-item {
   display: inline-block;
   margin-right: 10px;
}
.task-list-enter-active, .task-list-leave-active {
   transition: opacity .5s;
}
.task-list-enter, .task-list-leave-to {
   opacity: 0;
} 
```

å½“æˆ‘ä»¬æ·»åŠ å’Œåˆ é™¤ä»»åŠ¡æ—¶ï¼ŒVue.js äº‹ä»¶ä¸ transition CSS å±æ€§ä¸€èµ·è´Ÿè´£æ·¡å…¥æ·¡å‡ºã€‚(è§†é¢‘åœ¨æœ€ä¸Šé¢ã€‚)

å·®ä¸å¤šå°±æ˜¯è¿™æ ·ï¼å¼€æ”¾æºä»£ç é“¾æ¥å¦‚ä¸‹:

ğŸ™æœåŠ¡å™¨ç«¯ä»£ç åœ¨ GitHub ä¸Šæ˜¯å¼€æºçš„ã€‚

ğŸ±å®¢æˆ·ç«¯ä»£ç åœ¨ GitHub ä¸Šæ˜¯å¼€æºçš„ã€‚

å¦‚æœä½ åœ¨æ¹¾åŒºçš„å°±ä¸šå¸‚åœºä¸Šï¼Œè¯·è€ƒè™‘åœ¨ Employbl.com ä¸Šåˆ›å»ºä¸€ä¸ªæ±‚èŒè€…æ¡£æ¡ˆã€‚