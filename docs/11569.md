# â¤Â·æ‹‰å§†è¾¾-å¸¦æœ‰ç‰¹æ®Šå ä½ç¬¦çš„éƒ¨åˆ†åº”ç”¨ç¨‹åº

> åŸæ–‡:[https://dev.to/joelnet/i-æ‹‰å§†è¾¾-éƒ¨åˆ†åº”ç”¨-ä¸åº“é‡Œ-2b02](https://dev.to/joelnet/i--ramda---partial-application-with-curry-2b02)

[![I â¤ Ramda - Partial Application with a Special Placeholder](../Images/e24e23c014da829f8cf84c5fa01a7ee1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--3k7R0mS_--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://github.com/joelnet/articles/raw/master/articles/2018-05-09---i-heart-ramda--partial_application_with_curry/puzzle-3223941_1920-2.png)

# â¤Â·æ‹‰å§†è¾¾ç®€ä»‹

I â¤æ‹‰å§†è¾¾ç³»åˆ—å°†ç•¥æœ‰ä¸åŒï¼Œå…¶ä»–ä½ å¯èƒ½å·²ç»çœ‹åˆ°äº†ã€‚æœ¬ç³»åˆ—æ²¡æœ‰ä½¿ç”¨å…¸å‹çš„`foo`ã€`bar`ã€`baz`ç¤ºä¾‹ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨æ¼”ç¤ºç‹¬ç«‹å‡½æ•°çš„æ–‡ç« ï¼Œè€Œæ˜¯æ—¨åœ¨å±•ç¤º Ramda.js çš„å®é™…åº”ç”¨

è¿™æ˜¯ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå°†é‡ç‚¹è®¨è®ºå¸¦æœ‰ç‰¹æ®Šå ä½ç¬¦çš„*éƒ¨åˆ†åº”ç”¨ã€‚*

# [](#partial-application-with-bind)å±€éƒ¨åº”ç”¨ä¸ç»‘å®š

å¦‚æœä½ ç”¨è¿‡`bind`ï¼Œä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰äº†å±€éƒ¨åº”ç”¨çš„æ¦‚å¿µã€‚

```
const multiply = (a, b) => a * b

// partially apply 2 to multiply to create double
const double = multiply.bind(null, 2)

double(3) //=> 6 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½¿ç”¨`bind`ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°†å€¼`2`éƒ¨åˆ†åº”ç”¨äºå‡½æ•°`multiply`åˆ°**ä¸­çš„å‚æ•°`a`ï¼Œåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å‡½æ•°** `double`ã€‚

ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆ(ç”¨`bind`)å·¥ä½œå¾—å¾ˆå¥½ï¼Œå³ä½¿æˆ‘ä»¬å¿…é¡»è°ƒç”¨`bind`å¹¶ä¼ å…¥ä¸Šä¸‹æ–‡(åœ¨æœ¬ä¾‹ä¸­æ˜¯`null`)ã€‚

# [](#partial-application-with-curry)å±€éƒ¨æ¶‚ä»¥å’–å–±

å¤„ç†éƒ¨åˆ†åº”ç”¨ç¨‹åºçš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯**è°ƒç”¨**çš„`multiply`å‡½æ•°ã€‚

```
import curry from 'ramda/src/curry'

const multiply = curry((a, b) => a * b)

// partially apply 2 to multiply to create double
const double = multiply(2)

double(3) //=> 6 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¥½äº†ï¼Œç°åœ¨ä»£ç æ˜¯...ä¸åŒçš„ T1ï¼Œä½†æ˜¯ä½ ä¸å…´å¥‹ï¼Œæˆ‘æ˜ç™½ã€‚ä½†æ˜¯åšæŒä½ï¼Œå› ä¸º **ğŸ§™é­”æœ¯å³å°†å¼€å§‹**ã€‚

## [](#where-bind-falls-short)å“ªé‡Œç»‘çš„ä¸å¤Ÿ

è®©æˆ‘ä»¬è€ƒè™‘è¿™ä¸ªä¾‹å­...

```
import fs from 'fs'

const output = (err, data) => {
  if (err) return console.log('ERROR:', err)
  console.log(data)
}

// How do I partially apply utf8?
fs.readFile('README.md', 'utf8', output)
fs.readFile('package.json', 'utf8', output) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰€æœ‰å¯¹`readFile`çš„è°ƒç”¨éƒ½å°†æ˜¯`utf8`ï¼Œç°åœ¨æˆ‘æƒ³åˆ°äº†ï¼Œå®ƒä»¬éƒ½å°†ä½¿ç”¨ç›¸åŒçš„`output`
å‡½æ•°ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ**ä¸èƒ½ä½¿ç”¨**ç»‘å®šï¼Œå› ä¸º`bind`åªèƒ½ä»å·¦åˆ°å³åº”ç”¨å‚æ•°ã€‚å¿…é¡»åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„åŠŸèƒ½ã€‚

```
// Harrumph!
const outputUtf8File = file =>
  fs.readFile(file, 'utf8', output) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#special-placeholder)ç‰¹æ®Šå ä½ç¬¦

Ramda æœ‰ä¸€ä¸ªä»–ä»¬ç§°ä¹‹ä¸º**çš„ç‰¹æ®Šå ä½ç¬¦**ï¼Œç”¨äºéƒ¨åˆ†åº”ç”¨å‚æ•°ï¼Œè€Œä¸ç®¡ä½ç½®å¦‚ä½•ã€‚
è¦ä½¿ç”¨è¿™ä¸ªç‰¹æ®Šçš„å ä½ç¬¦ï¼Œé¦–å…ˆå¿…é¡»ç®€åŒ–è¿™ä¸ªå‡½æ•°ã€‚

```
import curry from 'ramda/src/curry'
import __ from 'ramda/src/__' // Special Placeholder
import fs from 'fs'

// curry fs.readFile to add the magic
const readFile = curry(fs.readFile) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ—¢ç„¶`fs.readFile`å·²ç»è¢«ç®€åŒ–ä¸º`readFile`ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Ramda çš„ç‰¹æ®Šå ä½ç¬¦(`__`)ä½œä¸ºæ–‡ä»¶åå‚æ•°ï¼Œå¹¶éƒ¨åˆ†åº”ç”¨ã€`utf8`å’Œ`output`åˆ°`readFile`ã€‚

```
// partially apply utf8 and output.
const outputUtf8File = readFile(__, 'utf8', output)

outputUtf8File('README.md')
outputUtf8File('package.json') 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸ˜å¦‚æœæ­¤æ—¶ä½ ä¸å…´å¥‹ï¼Œå»çœ‹åŒ»ç”Ÿå§ï¼Œå› ä¸ºä½ å†…å¿ƒå·²ç»æ­»äº†ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›é‡æ„æ¥ç»“æŸè¿™ä¸ªä¾‹å­ã€‚

```
// let's refactor this:
outputUtf8File('README.md')
outputUtf8File('package.json')

// into this:
const files = ['README.md', 'package.json']
files.map(outputUtf8File) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¹Ÿå¯ä»¥è¿™æ ·ä½¿ç”¨ï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬æœ‰äº†æ›´å¤šçš„é€‰æ‹©ï¼

```
files.map(readFile(__, 'utf8', output)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#homework)ä½œä¸š

æœ€å¥½çš„å­¦ä¹ æ–¹æ³•æ˜¯*åš*ğŸ˜‰ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œè¯•ç€åœ¨å‡½æ•°`fetch`çš„åŸºç¡€ä¸Šåˆ›å»ºä¸¤ä¸ªæ–°å‡½æ•°`fetchGet`å’Œ`fetchPost`ã€‚

```
import curry from 'ramda/src/curry'
import __ from 'ramda/src/__'
import fetch from 'node-fetch' // might need this in node.js land.

const url = '???' // pick a url to test

// fetch(url, { method: 'GET' })

const fetchGet = /* ??? */
const fetchPost = /* ??? */ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœéœ€è¦å¸®åŠ©ï¼Œåœ¨è¯„è®ºåŒºå‘å¸–æé—®ï¼Œæˆ‘ä¼šå°½åŠ›å›ç­”æ¯ä¸€ä¸ªé—®é¢˜ï¼

# [](#what-else-can-we-do)è¿˜èƒ½åšä»€ä¹ˆï¼Ÿ

è¿™æ˜¯æˆ‘æ­£åœ¨åšçš„ä¸€ä¸ªé¡¹ç›®çš„ç®€åŒ–ç‰‡æ®µã€‚é¦–å…ˆæˆ‘ä¼šæŠŠ`tokenContract`å‰”é™¤ï¼Œè¿™æ ·**ä½ ä¹Ÿå¯ä»¥è¿è¡Œè¿™ä¸ªä¾‹å­**ã€‚

åŒæ ·ï¼Œä¸è¦å¯¹è¿™éƒ¨åˆ†ä»£ç åšè¿‡å¤šè§£è¯»ï¼Œè¿™åªæ˜¯è®¾ç½®ã€‚ä½†æ˜¯è¯·æ³¨æ„ä¸‹é¢å¦‚ä½•ä½¿ç”¨`curry`å‡½æ•°ã€‚

```
import curry from 'ramda/src/curry'
import __ from 'ramda/src/__'

// example stub so you can run the code below
const tokenContract = {
  getTokenIndex: curry((account, tokenId) =>
    account === 1 && tokenId === 123
      ? Promise.resolve(1000)
      : Promise.reject()),
  getTokenAtIndex: curry((account, index) =>
    account === 1 && index === 1000
      ? Promise.resolve('success')
      : Promise.reject('fail')),
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æ˜¯è‚‰ğŸ–

```
const account = 1

// without partial application
tokenContract.getTokenIndex(account, 123) //=> then 1000
  .then(i => tokenContract.getTokenAtIndex(account, i)) //=> then "success"

// with partial application
tokenContract.getTokenIndex(account, 123) //=> then 1000
  .then(tokenContract.getTokenAtIndex(account)) //=> then "success" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Curry å’Œéƒ¨åˆ†åº”ç”¨ç¨‹åºå…è®¸æˆ‘ä»¬åœ¨`then`ä¸­å»æ‰å‡½æ•°çš„ä¸¤ç«¯`i =>`å’Œ`, i`ã€‚è¿™æ˜¯ä¸€ä¸ªä½ 
ä¼šç»å¸¸*çœ‹åˆ°*çš„æ¨¡å¼ã€‚ä»`then`å‡½æ•°æä¾›çš„å•ä¸ªå‚æ•°(åœ¨æœ¬ä¾‹ä¸­æ˜¯`i`)å°†æˆä¸ºåœ¨`tokenContract.getTokenAtIndex`ä¸­è°ƒç”¨çš„å‡½æ•°çš„æœ€ç»ˆå‚æ•°ã€‚

è¿›ä¸€æ­¥ç ”ç©¶:çœç•¥ç»“å°¾çš„`i`çš„è¿‡ç¨‹ç§°ä¸ºæ— ç‚¹æˆ–é»˜è®¸ç¼–ç¨‹ï¼Œè‡ªå˜é‡`i`ä¸ºâ€œç‚¹â€ã€‚

å› ä¸ºæˆ‘çŸ¥é“æˆ‘æ­£åœ¨åšçš„å·¥ä½œæ€»æ˜¯é’ˆå¯¹`account`ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥å°†`account`å€¼åº”ç”¨äºä¸¤ä¸ªå‡½æ•°ã€‚

```
const getToken = tokenContract.getTokenIndex(account)
const getTokenAtIndex = tokenContract.getTokenAtIndex(account)

getToken(123) //=> then 1000
  .then(getTokenAtIndex) //=> then "success" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#extra-credit)é¢å¤–å­¦åˆ†

**å‡½æ•°ç»„åˆå°†åœ¨ä»¥åçš„æ–‡ç« **ä¸­è®¨è®ºï¼Œä½†æ˜¯ç°åœ¨æˆ‘æƒ³æŠŠè¿™ä¸ªä½œä¸ºé¢å¤–çš„å­¦åˆ†ç•™ç»™ä½ 
å»ç ”ç©¶å’Œä¿®æ”¹:

```
const account = 1

const getTokenIndex = tokenContract.getTokenIndex(account)
const getTokenAtIndex = tokenContract.getTokenAtIndex(account)

// Ramda's pipeP asynchronous function composer
const getToken = pipeP(
  getTokenIndex,
  getTokenAtIndex,
)

getToken(123) //=> then "success" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#summary)æ€»ç»“

æœ¬æ–‡ç®€è¦ä»‹ç»äº†**å±€éƒ¨åº”ç”¨**ã€**å¥‰æ‰¿**ï¼Œç”šè‡³**åŠŸèƒ½ç»„åˆ**ã€‚å‰å¾€ [Ramda](http://ramdajs.com/) äº†è§£æ›´å¤šä¿¡æ¯ã€‚åœ¨è¯„è®ºé‡Œæé—®ï¼Œæ¯ä¸€ä¸ªé—®é¢˜æˆ‘éƒ½ä¼šå›å¤ï¼

å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰è¶£ï¼Œæˆ‘æœ‰æ›´å¤šå…³äº[åª’ä½“](https://medium.com/@joelthoms/latest)å’Œ[å‘å±•åˆ°](https://dev.to/joelnet)çš„æ–‡ç« ã€‚

åœ¨ [Twitter](https://twitter.com/joelnet) ã€ [Medium](https://medium.com/@joelthoms/latest) ã€ [dev.to](https://dev.to/joelnet) å’Œ [steemit](https://steemit.com/@joelnet) æˆ–[joel.net](http://joel.net)è®¢é˜…ï¼Œä»¥è·å¾—æœªæ¥æ–‡ç« çš„é€šçŸ¥ã€‚

[åŸè´´äºæ­¤](https://github.com/joelnet/articles/blob/master/2018-05-09---i-heart-ramda--partial_application_with_curry/Partial_Application_with_Curry.md)

å¹²æ¯ï¼

[![license CC BY 4.0](../Images/cfdf14d8c8a99476d3457617d720b6eb.png)T2ã€‘](https://creativecommons.org/licenses/by/4.0/)