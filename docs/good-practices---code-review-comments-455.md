# 良好实践-代码评审意见

> 原文：<https://dev.to/gabeguz/good-practices---code-review-comments-455>

如果您进行代码审查，您可能会一次又一次地遇到相同的问题。第一次为您的代码库做贡献的人可能不知道您团队的内部标准，他们可能来自不同的语言，做的事情也略有不同。新员工可能需要快速向您的存储库提交变更。您如何确保这些情况得到处理，同时将对您的代码审查人员的影响降至最低？一个有用的工具是“代码评审评论”文档。

“代码评审评论”文档是在代码评审会议中反复出现的评论的集合。例如，如果您总是不得不告诉人们“在向 SQL server 发送输入时，请确保使用准备好的语句”，您可以将它添加到这个文档中，然后当您看到未转义的 SQL 时，只需将提交者指向您的文档。

# 新开发人员入职

当一个新的开发人员加入您的团队时，您可以让他们参考这个文档，这样他们就可以快速了解您的标准实践。这是放东西的好地方，比如:

1.  所有代码在提交审查之前都必须符合我们内部的代码风格标准(你*有代码标准吗？)*
2.  作为 PR 提交的代码应该在合并之前由另一个开发人员测试
3.  我们更喜欢使用“保护子句”而不是深度嵌套的 if / else 块(参见:[https://www . thecrishow . com/2009/02/16/using-guard-clauses-in-your-ruby-code/](https://www.thechrisoshow.com/2009/02/16/using-guard-clauses-in-your-ruby-code/)

你的 linter/code formatter 没有涉及到的任何东西都可以存在于这个文档中。

# 认知负荷递减

阅读代码通常被认为比编写代码更难，所以任何减轻评审者认知负担的事情都是好的。如果所有简单的东西都包含在您的代码评审注释文档中，那么评审者就可以专注于变更请求的实质，而不必担心他们不应该担心的东西。这也将有助于消除评估中可能出现的个人风格差异。如果很明显你的团队更喜欢较短的变量名，那么在这种情况下，有人很难争辩，他们真的认为对于循环索引来说，`loopIndexVariable`比`i`更好，因为它更具描述性。

# 限制自行车脱落

如果你发现自己经常为一些并不重要的事情争吵，你可以把它扔进文档(一旦团队就油漆自行车棚的最佳颜色达成共识)，然后任何时候有人认为另一种颜色会更好，只要把他们链接到文档就可以了。更多关于[自行车脱落](https://en.wikipedia.org/wiki/Law_of_triviality)的信息。

# 形式化团队标准

通常，一个团队一起工作的时间越长，他们就越喜欢他们的代码。这很有效，直到你尝试把一个新人带进团队。新人需要通过反复试验来发现这些标准，这可能会令人沮丧，而且需要时间。维护一个代码评审评论文档可以帮助正式化这些不言而喻的标准，并减少新成员加入团队时的摩擦。新开发人员可以直接阅读文档，而不是因为其他人都知道的内部标准而不得不拒绝几次代码审查。

# 不要过犹不及

对于这种类型的文档，你绝对*不想做的一件事是用太多的细节来填充它，以至于它本身成为开发人员认知负荷的来源。它应该相当简洁，易于阅读。一个很好的例子是 go teams [代码评审评论](https://github.com/golang/go/wiki/CodeReviewComments)文档。它充满了在代码评审中反复出现的东西，并被添加到文档中以改善提交者和评审者的开发和代码评审体验。*

# 自己出发

这样开始一个文档真的很容易。任何时候你在做代码审查，并且不得不对同一件事做不止一次的评论，把它添加到文档中。让你的团队也这样做，然后你们可以不时地一起回顾文档，决定保留什么，丢弃什么。当新的贡献者加入团队时，在他们提交他们的第一个 PR 之前发送文档给他们，这样他们可以确保他们的代码已经准备好接受代码评审。

# 结论

维护一个代码评审评论文档是一个很好的方法，可以让新的开发人员加入进来，减少评审人员的认知负荷，并使不成文的团队标准正式化。新的贡献者可以浏览文档并快速跟上新团队的内部标准，而不必通过反复试验来发现这些东西。这可以减少新开发人员的摩擦，并改善各方的代码审查体验。

你的团队使用这样的文档吗？反馈，想法？留下评论。