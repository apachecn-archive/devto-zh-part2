# 初学者数据库设计入门

> 原文:[https://dev.to/joshghent/beginners-database-design-primer-5a hi](https://dev.to/joshghent/beginners-database-design-primer--5ahi)

[![](../Images/b127d30f868a82335602f9cb42c035f8.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--tG6dQbK---/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AMVAr8Mf47z5vIxwVz69L0Q.png)

你的老板刚刚和一个客户通完电话，他想要一个针对利基市场的定制社交网站。他们想让你负责这个项目。你从未建立过社交网络。你会想到脸书、推特和 Instagram。它们是由成千上万拥有天才级智商和学位的人建造的。你怎么能竞争？

这至少是我发现自己的处境。

我的任务是首先为这个社交网络客户端设计一个数据库。这是我想要阅读的建议和帮助。请注意:这通常适用于所有数据库设计。社交网络将仅仅被用作例子。

### 但是为什么我感觉数据库设计这么关键？

1.  糟糕的数据库设计会导致费力而缓慢的查询
2.  重复数据和不正确的列数据类型会占用更多的磁盘空间

### 思考你的特征以及它们之间的关系

网站有什么特色？**真的** **分解它**。你把它分解得越多，就越少“*哦，对了，让我们为那个*添加一个表格，你以后会得到的。我建议使用类似于 [draw.io](https://www.draw.io/) 的工具，在将表放入实际的数据库之前，先绘制出它们。

由于我们正在建立一个社交网络，主要的功能是让用户发帖，并允许其他(授权)用户发表评论。这里我们有一个一对多的关系，因为一个用户可以有很多帖子和评论。

[![](../Images/9a4e05ccfdcdcb0e07603c9d43f8fbdc.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--y2B4IIMb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/0%2AFyqSEsID4A_2jE_n.)

我们还会有其他需要多对多关系的实例，比如用户“喜欢”(比如喜欢一个页面或群组)，因为一个用户会有许多喜欢，而这些喜欢会有许多不同的属性。

良好的数据库设计的主要目标之一是删除冗余数据并增加数据的完整性。通常，人们会组合具有一对一关系的表。例如存储用户数据和他们的地址。让我们看看为什么:

[![](../Images/9809de5e647d4876b47f98ebe2275c31.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--avdwEsh7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/0%2AJVxQ1FSGDaEupI9Z.)

左边的例子结合了用户表和那个人的地址。在右边，我们将它分成不同的表格。但是哪种方法是最佳的呢？

嗯，和大多数事情一样，**这取决于**。当我构建这个特定的应用程序时，地址是一个可选字段，因此将这些位置存储在另一个表中是最合适的。此外，今后将考虑允许一个用户有多个地址。因此，在我的例子中，将它们存储在同一个表中只会将我限制在一对一的关系中，从而限制了我对未来特性的使用。

这里性能可能是一个因素，因为“关系”表越多，需要进行的连接就越多，从而降低了查询时间。随着规模的扩大，这可能会产生影响。

### 思考你将需要哪些数据

这引出了我的下一个观点，即仔细考虑你的应用程序将显示什么。想一想获取这些数据的查询。如果为了提取信息，您必须进行大量的连接和子查询以及各种操作，那么您可能需要重新考虑您的设计。

在思考分析时，我最能体会到这个原则。例如，在这个社交网络应用程序中，我们希望分析应用程序的使用位置。如果我们只是通过为用户存储的地址字段来完成这项工作(没有任何 IP 位置向导)，那么我们可以选择将 counties 列表存储在一个单独的表中，然后将它与主 addresses 表链接起来。这将使我们能够快速查询特定的 country_id，并确定有多少用户在那里注册。我们*可以*将国家作为用户的文本输入，但这可能会导致错误的国家拼写和其他重复数据，从而导致错误的统计数据。

总的来说，了解您的应用程序需要什么，并围绕它进行设计，同时仍然灵活地适应未来的扩展。

### 想想存储在列中的数据

数据库设计中被低估的一点是列数据类型。通常，列被赋予简单的 **VARCHAR** 或 **INT** 数据类型，这并不总是设计它们和更改数据类型的最高效或最节省内存的方式，因为这可能会导致这些列中的数据损坏。

熟悉不同的数据类型，这些数据类型在所有编程语言和数据库中几乎都是通用的，并且允许您在较低的抽象层次上思考您正在处理的数据。

如前所述，低效数据类型的一个主要问题是它们占用了太多的磁盘空间。例如，假设我们存储了一个标志，用于检查用户的帖子是否被删除。因为该列仅有的两个值应该是 0 或 1(前者表示未删除，后者表示已删除)，所以我们不需要 4 个字节来存储一个整数(可以是从-2147483648 到 2147483648 之间的任何数字)。我们只需要 **TINYINT** 数据类型(或者 MySQL 中的 **BOOLEAN** )，它只占用 1 个字节。整整小了 4 倍！现在比零小 4 倍仍然是零，所以这可能看起来像是一个不必要的减少，将节省一小部分磁盘空间。而且在*大多数*的情况下，你**很可能是对的**；但是如果服务扩展到几十万甚至几百万行，那么你的老板会感谢你通过选择 TINYINT 选项为他们节省了大量的硬盘空间。花时间为您的数据库考虑最高效和最精简的设计。就像你是在为脸书水平的规模而设计一样——这将会有回报。

### 避免存储计算列

设计数据库时的一个常见错误是存储应用程序可以计算的冗余信息。在我的例子中，我们希望在用户的个人资料中显示用户的年龄。也许可以将用户的年龄直接存储在一个列中，但是如果我们有他们的出生日期，那么我们可以简单地计算他们的年龄。如果速度成为一个无法进行计算的问题，那么最好在最终存储计算出的值之前，将速度缓存在应用程序或 Redis 这样的键值数据库中。可能建议计算信息存储的其他示例是考试平均分或个人下的订单数量。

### 你还有哪些数据库设计的小技巧？

我试图在这里针对“ [Pareto 问题](https://en.wikipedia.org/wiki/Pareto_principle)”——在我看来，这意味着这 20%的技巧将解决 80%的基本数据库设计问题。也就是说，还有很多**的东西**需要学习，如果你有兴趣，一旦你完全理解了这篇文章中的信息，请查看[数据库规范化规则(NF)](https://en.wikipedia.org/wiki/Database_normalization) 。

👋我可以作为一个自由应聘的应用顾问/开发人员。如果你想讨论任何你想到的项目，请打电话到[hola@joshghent.com](//mailto:hola@joshghent.com)和我联系。

* * *