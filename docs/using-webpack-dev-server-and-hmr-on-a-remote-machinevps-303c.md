# 在远程机器/VPS 上使用 webpack-dev-server 和 HMR

> 原文：<https://dev.to/vinneycavallo/using-webpack-dev-server-and-hmr-on-a-remote-machinevps-303c>

在远程机器上设置 webpack-dev-server HMR 来运行 nginx 并不有趣，但是使用它却很有趣。

**问题:**在远程机器上使用`webpack-dev-server`的肝下载和 HMR 功能(可能通过 nginx)

**解决方案**在本页下方，供不耐烦的*(或者那些很可能不在乎阅读我是如何陷入这种情况以及我花了多长时间解决它的人！)*。

## 蓬松的背景故事

我最近才开始关注肝脏下载、热模块替换、即时风格更新及其相关的快速亲属的乐趣。现在我已经看到了这耀眼的光芒，在黑暗的小巷中不停地打开浏览器窗口的想法让我[非常痛苦。我最近采用了一个工作流程，涉及到在终端中通过`SSH`在远程托管的 VPS 上工作。我喜欢几乎所有关于它的事情，但它短暂地将我推入了黑暗的 T2 小巷。主要原因很简单:你不再点击`localhost:NNNN`页面——而是通过互联网出去。](https://dev.tojavascript:void(0))

有几个问题:

*   网站的磁盘版本与内存版本
*   主机和 DNS
*   端口(谁使用哪个端口，谁知道这个，如何告诉各方什么在哪里)
*   防火墙
*   关于 HTML 标题的事情
*   关于 websockets 的事情

我花了很多时间在谷歌上搜索我能想到的所有内容。有时，在盘旋之后，我会回到旧的谷歌搜索结果，但这次我会有一组不同的配置组合，作为浏览*以前的*谷歌搜索结果的结果，所以我会尝试将这些东西与我已经尝试过的其他东西的奇怪组合混合在一起。

这是一个端口、主机、web 服务器组合的大傻逼沙拉。

总而言之，可行的解决方案是:

*   一个可公开访问的 URL(姑且称之为`http://devenv.com`)。我已经检查过了，这是用 DNS 记录指向这个域名的 VPS 的 IP 地址。
*   在`/dist`的文件的静态构建版本，由一个简单的 nginx 服务器块提供，当导航到`http://devenv.com`时指向静态`index.html`。
*   webpack-dev-server 正在运行，通过本地端口`8080`提供站点的内存版本。
    *   另一个 nginx 服务器阻塞*使用一个子域，比如* `http://live-and-hmr.devenv.com`，它代理 websocket 连接到上面的`8080`上的 webpack-dev-server 进程。

我最初不明白的是，webpack-dev-server **是一个服务器**(咄),因此 nginx 不应该是*为那个资源提供服务*。它只需要靠边站，把责任交给 webpack-dev-server。这在概念上使我犯了一个错误，在它点击之前，阻止了我对解决方案进行足够正确的推理，以便更早地找到它。

人们不必使用这两个 URL(有或没有进入静态和开发服务器版本的子域),但我发现在 90%的时间里能够在 HMR 开发服务器版本上工作是很方便的，同时保持了构建网站和翻转到静态选项卡的便利，以获得一种更多的`productiony`体验。

我思考了一下为什么关于这个解决方案的栈溢出帖子或博客文章如此之少，我得出的结论是:远程开发 vps 方法相对不常见，在前端开发人员中可能更不常见。这是一个假设，可能有点粗鲁，但它是基于这种偏见:前端开发人员更有可能把他们的宝贵时间花在 JavaScript/web pack/gulp/样式化工作流上，等等。-所有这些都是高尚的追求和美好的，但是很容易在那个世界里花很多时间，而不必担心托管细节、nginx、进程/端口等等。

明确一点，这不是一个价值判断。恰恰相反；作为一个主要从事后端开发的人，我一开始对上面列出的前端挑战知之甚少，我非常尊重那些对这些东西了如指掌的人。对我来说，这是一次漫长而有益的旅程。

## 解

我唠叨够了！当我最终让这个东西工作起来时，我匆忙地把它记录在 GitHub 的一个要点中(在做了许多疯狂的、夹杂咒骂的庆祝手势之后)。对于精通 webpack 及其配置的人来说，这个要点可能有足够的意义，但我不知道这是否是最清楚的事情。如果你有问题，请告诉我。

*   [链接至要点](https://gist.github.com/vcavallo/4f11985c4364bc4edfdf56556bff4ccf)

嵌入(页边距在开发到时关闭。转到上面链接的源..):