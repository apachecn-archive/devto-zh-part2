# JAMStack 项目的良好实践

> 原文:[https://dev . to/diegoeis/good-practices-in-jam stack-projects-45ka](https://dev.to/diegoeis/good-practices-in-jamstack-projects-45ka)

使用基于 JavaScript、API 和预生成代码的架构的网站革命被称为 JAMStack。这样做网站的目的是为了减轻维护网站或系统的架构。以我的网站 Tableless.com.br 为例。在那里，我们维护了一个基于 Wordpress 的架构，这意味着我们需要一个 MySQL 数据库...基本上是一个灯架构。这样，为了便于组织，我们在 DigitalOcean 的两个不同的水滴中维护这个架构。今天我们关闭了 Wordpress，网站全部由 Hugo 制作，托管在 Netlify，代码在 Github 上。

这不是一件困难的事情，但是存在一些好的实践，你可以遵循，使你的方式变得容易。

## [](#use-cdn)使用 CDN

这不是必需的(顺便说一句，这些主题都不是)，但由于加载纯静态 HTML 文件，你的网站已经很轻了，如果我们使用 CDN，它可能会得到改善。基于 JAMStack 的项目不需要服务器端代码或类似的东西，它们可以更容易地分发。

最受欢迎的 CDN 是 CloudFlare，但还有许多其他服务可以将您的资产放在那里，但通常情况下，它们已经为您的项目提供了最受欢迎的 JavaScript 框架和库。一些链接:

*   [谷歌托管图书馆](https://developers.google.com/speed/libraries/#libraries)
*   [Yandex CDN](https://tech.yandex.ru/jslibs/)
*   jsdelivr
*   [cdnjs](https://cdnjs.com/)

## [](#all-the-code-live-in-git)所有的代码都活在 GIT 中

这是生活法则。今天不使用某种代码版本服务的团队是不正常的。GIT 是最受欢迎的，我们知道像 GitHub 这样的服务让我们做了很多困难的工作。在 JAMStack 项目中，任何人都需要在几分钟内在自己的机器上下载并运行代码。在许多环境中安装数据库，运行依赖项等等都是不需要的。静态堆栈的简单性将基于 JAMStack 思想的项目贡献的摩擦减少到几乎为零，此外，我们还简化了测试和试运行工作流。

## [](#build-tools)构建工具

根据项目的不同，使用构建工具是很有趣的。这个想法是所有的过程都需要自动化。结果将是静态的 HTML、CSS 和 JS 文件，但它需要遵循良好的实践来构建。你可以使用所有好的东西:前/后 CSS 处理器，使用 WebPacks 和常规任务运行程序，如 Gulp、Grunt、Babel 和任何你喜欢用来使你的构建生活更容易的东西。

这里我们基本上只使用 SASS 来传递 CSS，仅此而已。我们没有太多的 JS 来精简代码。这些图像存放在 [imgur](http://imgur.com) 中。静态文件由[雨果](https://gohugo.io)生成。因此，我拒绝任何可能给项目带来更多复杂性的东西。今天，我们有超过 1800 篇文章和帖子要创建。使用[网络](http://netlify.com)，这需要 5 分钟来构建产品。

## [](#automated-builds)自动化构建

因为 JAMStack 项目是由预先构建的代码构成的，所以当我们更改内容或界面时，只有在您运行构建过程后，这些更新才会应用到产品中。当您上传新代码到您的存储库时，您的环境需要知道这一点，以便自动构建文件并发布您的项目。我知道有很多服务可以做到这一点，但它们都更复杂，因为大多数常规项目都依赖于某种后端语言。在一个简单的 JAMStack 网站中，你可以制作自己的 webhooks 或者使用一些提供这种功能的服务，比如 Netlify。

## [](#atomic-deploys)原子部署

原子部署是在所有修改文件的上传结束后，所有系统才进入生产环境的情况下部署的。通常会对内容或界面进行一些更改，需要部署几个文件。在您上传每个文件之前，可能会有一段时间不一致，直到上传过程完成。

想象一下:新的 HTML 代码比 CSS 先被上传，在一个短暂的瞬间，布局将打破。这种情况随时都有可能发生，这取决于您进行更改的频率。

## [](#cache-invalidation)缓存失效

我们正在谈论静态文件。缓存出现问题是很常见的。缓存是网络的坏事也是好事。在这种情况下，我们必须确保环境正在使缓存失效，尤其是在我们使用 CDN 的情况下。你需要确保浏览器会下载新文件。

Netlify(不，Netlify 并没有付钱让我说这些)有一个叫做即时缓存失效的特性，它不需要任何工作就可以使旧的缓存失效。

## [](#conclusion)结论

我说的很多东西都是我们在日常生活中制造的。但是，通常，我们这样做只是为了简化项目的一部分。但是，我已经知道有些团队的前端需要在推送代码之前构建您的资产，因为现有的工作流不构建这种类型的文件。当我们谈论一个像 JAMStack propose 这样的轻量级架构的项目时，我们不能添加手动任务，但是，我们不能将所有事情自动化到使项目变得复杂的程度。

显然，一个 JAMStack 项目无法与复杂系统相提并论。我说的是互联网上的大多数网站。个人小博客，个人网站，公司机构网站等...在巴西，我看到了一些公司的讨论，他们希望使用 React 来制作自己的网站。这有什么意义？我们需要学会使用正确的工具来解决正确的问题。从小处着手。在很长一段时间里，当我们需要创建一个网站时，第一个回答是“使用 Wordpress”。但是制作网站的技术在很久以前就已经存在了，它叫做 HTML。