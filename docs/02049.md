# åœ¨ Dart 2 ä¸­æ„å»ºä¸€ä¸ªèŠå¤©åº”ç”¨ç¨‹åº(ç¬¬ 1 éƒ¨åˆ†)

> åŸæ–‡:[https://dev . to/graphic beacon/build-a-basic-chat-application-in-dart-2-part-1-4 ekj](https://dev.to/graphicbeacon/build-a-basic-chat-application-in-dart-2-part-1-4ekj)

å®æ—¶ä½“éªŒä¸»å®°äº†ä»Šå¤©çš„ç½‘ç»œã€‚å¦‚æœæ“ä½œæ­£ç¡®ï¼Œè¿™å°†äº§ç”Ÿå“åº”è¿…é€Ÿã€æµç•…çš„ç•Œé¢ï¼Œæœ‰åŠ©äºè·å¾—è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

åœ¨è¿™ä¸ªç”±ä¸‰éƒ¨åˆ†ç»„æˆçš„ç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ„å»ºå¿…å¤‡çš„èŠå¤©åº”ç”¨ç¨‹åºæ¥å®ç°å®æ—¶åŠŸèƒ½ã€‚æˆ‘ä»¬å°†ä¸å„ç§å„æ ·çš„åº“ä¸€èµ·å·¥ä½œï¼Œè¿™äº›åº“å¸¦æœ‰ç”¨äºå®ç°è¿™ä¸€ç‚¹çš„ [Dart](https://dartlang.org) SDK å’Œç”¨äº UI é£æ ¼çš„[å¸ƒå°”ç› CSS æ¡†æ¶](https://bulma.io)ã€‚

åœ¨è¿™ä¸€éƒ¨åˆ†çš„æœ€åï¼Œæˆ‘ä»¬å°†æœ‰æˆ‘ä»¬èŠå¤©åº”ç”¨çš„ç¬¬ä¸€ä¸ª UI è§†å›¾ã€‚ä»»ä½•è®¿é—®è¯¥åº”ç”¨ç¨‹åºçš„ç”¨æˆ·éƒ½å¿…é¡»åœ¨è¿›å…¥èŠå¤©å®¤ä¹‹å‰åœ¨ç™»å½•è§†å›¾ä¸­è¾“å…¥è‡ªå·±çš„åå­—ã€‚

ä¸‹å›¾è¯¦ç»†æè¿°äº†æ•´ä¸ªæµç¨‹:

[![Diagram of chat flow](../Images/cf822f44196a79f3dcab32ed3be1e671.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PYzJqyQh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/l1s6n4fkcpur4hy7xwe2.png)

èŠå¤©æµç¨‹æ˜¯è¿™æ ·çš„:

1.  è®¿é—®è€…è¾“å…¥ä»–ä»¬çš„åå­—å¹¶ç‚¹å‡»**åŠ å…¥èŠå¤©**æŒ‰é’®ã€‚è¿™å°†ç”¨æˆ·åé€šè¿‡`POST`è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬çš„åç«¯ã€‚
2.  åç«¯æ¥æ”¶å¹¶æ£€æŸ¥ç”¨æˆ·åï¼Œå¦‚æœæœ‰æ•ˆï¼Œè¿”å›ä¸€ä¸ª`200 OK`å“åº”ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª`400 Bad Request`ã€‚
3.  åœ¨`200 OK`å±å¹•å°†è¢«åˆ‡æ¢åˆ°èŠå¤©å®¤ã€‚
4.  ä»è¿™é‡Œå¼€å§‹ï¼Œå°†æœ‰ä¸€ä¸ª WebSocket è¿æ¥ç›‘å¬ä»è¾“å…¥å­—æ®µå‘é€çš„æ¶ˆæ¯ï¼Œå¹¶å¹¿æ’­ç»™èŠå¤©ä¸­çš„å…¶ä»–ç”¨æˆ·ã€‚
5.  ç‚¹å‡»**ç¦»å¼€èŠå¤©**æŒ‰é’®å°†å…³é—­ WebSocket è¿æ¥å¹¶è¿”å›ç”¨æˆ·åç™»å½•å±å¹•ã€‚

æˆ‘ä»¬å¼€å§‹å§ï¼Œå¥½å—ï¼Ÿ

* * *

## [](#1-set-up-your-project)1ã€‚è®¾ç½®æ‚¨çš„é¡¹ç›®

å®‰è£… [Stagehand](https://pub.dartlang.org/packages/stagehand) åŒ…å¹¶åˆ›å»ºä¸€ä¸ª web é¡¹ç›®:

```
$ pub global activate stagehand 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶åˆ›å»ºä¸€ä¸ª web é¡¹ç›®:

```
$ mkdir chat_app && cd chat_app
$ stagehand web-simple # scaffold a web project
$ pub get # install dependencies in `pubspec.yaml` file 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®‰è£… [webdev](https://pub.dartlang.org/packages/webdev) å·¥å…·æ¥å¯åŠ¨æˆ‘ä»¬çš„æœåŠ¡å™¨è¿›è¡Œæœ¬åœ°å¼€å‘:

```
$ pub global activate webdev
$ webdev serve --live-reload # live reload is supported in Chrome 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®¿é—®`http://localhost:8080`å°†å‘æ‚¨æ˜¾ç¤ºæ­¤å±å¹•:

[![Dart web on localhost](../Images/09da9bdf1664668a87b215f7447f382f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--wF4bdCOz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/d2cwofqlhki4hm8o8o8b.png)

## [](#2-mark-up-our-html-page)2ã€‚æ ‡è®°æˆ‘ä»¬çš„ HTML é¡µé¢

æˆ‘ä»¬å°†ä½¿ç”¨å¸ƒå°”ç›çš„ UI æ ·å¼ç±»æ¥æ„å»ºæˆ‘ä»¬çš„å±å¹•ã€‚

åœ¨`web/index.html`ä¸­ï¼Œåœ¨`<link rel="stylesheet" href="styles.css">`å‰çš„`<head>`ä¸­æ·»åŠ ä¸‹é¢çš„é“¾æ¥æ ‡ç­¾ï¼Œå¯¼å…¥æœ€æ–°çš„ç¼©å°æ ·å¼å’Œå­—ä½“ Awesome å›¾æ ‡å­—ä½“ä¾èµ–:

```
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" integrity="sha256-zIG416V1ynj3Wgju/scU80KAEWOsO5rRLfVyRDuOv7Q=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" /> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`web/styles.css`ä¸­ï¼Œå°†æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹:

```
html,
body {
  background-color: #f5f5f5;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`web/index.html`ä¸­ï¼Œå°†`<div id="output"></div>`æ›¿æ¢ä¸ºæˆ‘ä»¬å±å¹•çš„æ ‡è®°:

```
<section class="section">
  <div class="container">

    <div id="ChatSignin">
      <h1 class="title">Chatter ğŸ¯</h1>
      <div class="columns">
        <div class="column is-6">
          <div class="field">
            <label class="label">Please enter your name</label>
            <div class="control is-expanded has-icons-left">
              <input class="input is-medium" type="text" placeholder="Enter your name and hit ENTER" />
              <span class="icon is-medium is-left">
                <i class="fas fa-user"></i>
              </span>
            </div>
            <p class="help is-danger"></p>
          </div>
          <div class="field">
            <div class="control">
              <button class="button is-medium is-primary">
                Join chat
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="ChatRoom" hidden>
      <h1 class="title">Success!</h1>
    </div>

  </div>
</section> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ ‡è®°åŒ…å«ç™»å½•å’ŒèŠå¤©å®¤å±å¹•çš„è§†å›¾ï¼Œåœ¨`<div id="ChatSignin">...</div>`å’Œ`<div id="ChatRoom" hidden>...</div>`ä¸­å¯ä»¥çœ‹åˆ°ã€‚`#ChatRoom`æœ‰ä¸€ä¸ª`hidden`å±æ€§éšè—å®ƒï¼Œç›´åˆ°æˆ‘ä»¬ç¨åéªŒè¯ç”¨æˆ·åæ—¶åˆ é™¤å®ƒã€‚

ä¸ºäº†é˜²æ­¢é”™è¯¯ï¼Œä»`web/main.dart` :
ä¸­çš„`main()`å‡½æ•°ä¸­ç§»é™¤å®ç°

```
import 'dart:html';

void main() {
  // delete the line below
  // querySelector('#output').text = 'Your Dart app is running.';
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬ç°åœ¨åº”è¯¥ä¼šçœ‹åˆ°ä¸‹é¢çš„è¾“å‡º:

[![Chatter sign in UI](../Images/484e742cb7f301ec471a18552d9e3959.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--XvIGz480--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/vgzc4i81sv7hkibzgk8c.png)

## [](#3-implement-browser-logic-for-signin-flow)3ã€‚å®ç°ç™»å½•æµç¨‹çš„æµè§ˆå™¨é€»è¾‘

è®©æˆ‘ä»¬æ·»åŠ æ¥æ”¶ç”¨æˆ·åå¹¶å‘é€åˆ°åç«¯çš„é€»è¾‘ã€‚

åœ¨`web/main.dart`ä¸­ï¼Œæˆ‘ä»¬å°†ä»ä¸‹é¢çš„å†…å®¹å¼€å§‹:

```
import 'dart:html';

void main() {
  // Selectors
  var chatSigninBox = querySelector('#ChatSignin');
  var chatRoomBox = querySelector('#ChatRoom');
  var validationBox = chatSigninBox.querySelector('p.help');
  InputElement nameField = chatSigninBox.querySelector('input[type="text"]');
  ButtonElement submitBtn = chatSigninBox.querySelector('button');

  // Event listeners
  nameField.addEventListener('input', (evt) {
    // TODO: Run field validation
  });

  submitBtn.addEventListener('click', (evt) async { // using async/await ;)
    // TODO: Run name field validation
    // TODO: Submit name field to backend
    // TODO: Handle success response
    // TODO: Handle failure responses
  });
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯¥ä»£ç ç‰‡æ®µä»¥æˆ‘ä»¬çš„`dart:html`å¯¼å…¥å¼€å§‹ï¼Œå®ƒå…è®¸è®¿é—®`window`å’Œ`document`å¯¹è±¡ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„æ–¹æ³•ã€‚

åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨`querySelector()`é¡¶çº§å‡½æ•°æ¥é€‰æ‹©æˆ‘ä»¬çš„ DOM å…ƒç´ å¹¶ç›‘å¬å®ƒä»¬ä¸Šçš„å„ç§äº‹ä»¶ã€‚

* * *

### æˆ‘å¯¹å®šä¹‰é€‰æ‹©å™¨çš„ä¸€ä¸ªå»ºè®®...

**å°½å¯èƒ½æŒ‡å®šç±»å‹ï¼**æ¢å¥è¯è¯´ï¼Œä¸æ˜¯ä½¿ç”¨`var`å…³é”®å­—ï¼Œè€Œæ˜¯æ›¿æ¢ä¸ºé¢„æœŸçš„å¯¹è±¡ç±»å‹ï¼Œæ‰€ä»¥:

```
InputField nameField = chatSigninBox.querySelector('input[type="text"]'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯å› ä¸º`querySelector()`æ–¹æ³•è¿”å›ä¸€ä¸ªç±»å‹ä¸º`Element`çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ç‰¹å®š DOM å…ƒç´ ä¸Šçš„ç‰¹å®šå±æ€§å¯¹äº Dart analyser( *åº”è¯¥æ˜¯*)æ˜¯ä¸å¯è§çš„ï¼Œå°±åƒ`nameField`ä¸Šçš„`value`ä¸€æ ·ï¼Œå› ä¸ºå®ƒä¸å­˜åœ¨äº`Element`ä¸‹ã€‚å°†`InputElement`ä½œä¸ºå­ç±»å‹å…è®¸åˆ†æå™¨æ‰¾åˆ°`value`å±æ€§ï¼Œå¹¶é˜²æ­¢å½“æ‚¨è¯•å›¾è®¿é—®`Element` :
ä¸‹çš„`value`æ—¶æŠ›å‡ºé”™è¯¯

```
// Bad
var nameField = chatSigninBox.querySelector('input[type="text"]');
print(nameField.value); // Analyser will throw an error

// Good
InputElement nameField = chatSigninBox.querySelector('input[type="text"]');
print(nameField.value); // Analyser sees value prop in `InputElement` 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¤ªå¥½äº†ï¼ç»§ç»­å‰è¿›...

* * *

è®©æˆ‘ä»¬ä¸ºç”¨æˆ·åå­—æ®µå®ç°äº‹ä»¶ç›‘å¬å™¨:

```
nameField.addEventListener('input', (evt) {
  if (nameField.value.trim().isNotEmpty) {
    nameField.classes
      ..removeWhere((className) => className == 'is-danger')
      ..add('is-success');
    validationBox.text = '';
  } else {
    nameField.classes
      ..removeWhere((className) => className == 'is-success')
      ..add('is-danger');
  }
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†éªŒè¯è¯¥å­—æ®µï¼Œå¹¶ä¸ºæˆåŠŸå’Œå¤±è´¥çŠ¶æ€æ·»åŠ é€‚å½“çš„ç±»ã€‚è¿™äº›ç±»å(`is-success`å’Œ`is-danger`)æ˜¯ç”±å¸ƒå°”ç›æä¾›çš„ã€‚

è®©æˆ‘ä»¬å®ç°æäº¤æŒ‰é’®çš„äº‹ä»¶ç›‘å¬å™¨:

```
submitBtn.addEventListener('click', (evt) async {
  // 1\. Validate name field
  if (nameField.value.trim().isEmpty) {
    nameField.classes.add('is-danger');
    validationBox.text = 'Please enter your name';
    return;
  }

  submitBtn.disabled = true;

  try {
    // 2\. Submit name to backend via POST
    var response = await HttpRequest.postFormData(
      'http://localhost:9780/signin', // TODO: Endpoint to be created in next step
      {
        'username': nameField.value,
      },
    );

    // 3\. Handle success response and switch view
    chatSigninBox.hidden = true;
    chatRoomBox.hidden = false;
  } catch (e) {
    // 4\. Handle failure response
    submitBtn
      ..disabled = false
      ..text = 'Failed to join chat. Try again?';
  }
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç‚¹å‡»**åŠ å…¥èŠå¤©**æŒ‰é’®åä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µ:

1.  æˆ‘ä»¬æ£€æŸ¥ç”¨æˆ·åå­—æ®µä¸­çš„æœ‰æ•ˆæ¡ç›®ã€‚å¦‚æœæ— æ•ˆï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸€æ¡é”™è¯¯æ¶ˆæ¯å¹¶åœæ­¢è¿›ä¸€æ­¥æ‰§è¡Œã€‚å¦‚æœæœ‰æ•ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬è½¬åˆ°æ­¥éª¤ 2ã€‚
2.  æˆ‘ä»¬åœ¨`http://localhost:9780/signin`å°†è¡¨å•æ•°æ®å‘é€åˆ°ç«¯ç‚¹
3.  æˆåŠŸå“åº”åï¼Œæˆ‘ä»¬å°†éšè—ç”¨æˆ·ç•Œé¢ä¸­çš„èŠå¤©æ ‡å¿—ï¼Œå¹¶æ˜¾ç¤ºèŠå¤©å®¤ç”¨æˆ·ç•Œé¢
4.  å¦‚æœåç«¯è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬å°†æ›¿æ¢**åŠ å…¥èŠå¤©**æŒ‰é’®çš„æ–‡æœ¬ï¼Œå¹¶é¼“åŠ±ç”¨æˆ·å†è¯•ä¸€æ¬¡

ä»¥ä¸‹æ˜¯æ‚¨ç°åœ¨åº”è¯¥æ‹¥æœ‰çš„:

[![Chat signin form](../Images/3f8606cb3277631c29cd5c7221a79df6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--5EH3zClS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/3b6aa4n61l0yqal35q8k.gif)

æäº¤ç”¨æˆ·åä¼šæ˜¾ç¤ºå¤±è´¥æ¶ˆæ¯ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°åç«¯ã€‚

## [](#4-implement-logic-for-the-backend)4ã€‚å®ç°åç«¯é€»è¾‘

æˆ‘ä»¬ç°åœ¨éœ€è¦åç«¯æ¥æ”¶åŒ…å«ç”¨æˆ·åçš„è¯·æ±‚ã€‚

åˆ›å»ºä¸€ä¸ª`bin/server.dart`æ–‡ä»¶å¹¶åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨:

```
import 'dart:io';
import 'dart:convert';

main() async {
  // TODO: Get port from environment variable
  var port = 9780;
  var server = await HttpServer.bind(InternetAddress.loopbackIPv4, port);

  print('Server listening on port $port');

  await for (HttpRequest request in server) {
    // TODO: Handle requests
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

äº†è§£æ›´å¤šå…³äºåœ¨ Dart ä¸­ç¼–å†™ HTTP æœåŠ¡å™¨å’Œå¤„ç† POST è¯·æ±‚çš„[ã€‚](https://dev.to/graphicbeacon/quick-tip-write-an-http-server-in-dart--5c7n)

å°†`// TODO: Handle requests`è¡Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹:

```
// TODO: Only needed in local development. Will be removed in future
request.response.headers.add('Access-Control-Allow-Origin', 'http://localhost:8080');

switch (request.uri.path) {
  case '/signin':
    String payload = await request.transform(Utf8Decoder()).join();
    var username = Uri.splitQueryString(payload)['username'];

    if (username != null && username.isNotEmpty) {
      // TODO: Check username is unique
      request.response
        ..write(username)
        ..close();
    } else {
      request.response
        ..statusCode = 400
        ..write('Please provide a valid user name')
        ..close();
    }
    break;
  case '/ws':
    // TODO: Upgrade request to Websocket connection
    break;
  default:
    // TODO: Forward to static file server
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªç‰‡æ®µä»¥ä¸€ä¸ª CORS å¤´å¼€å§‹ï¼Œå…è®¸æ¥è‡ªæˆ‘ä»¬çš„`webdev`æœåŠ¡å™¨çš„è¿æ¥ã€‚è¿™ä»…åœ¨å½“åœ°å‘å±•æ—¶éœ€è¦ã€‚å½“æ„å»ºäº§å“æ—¶ï¼Œæˆ‘ä»¬å°†é‡æ„è¿™ä¸€è¡Œã€‚

ç„¶åæˆ‘ä»¬æœ‰ä¸€ä¸ª switch è¯­å¥æ¥æ ¹æ®è¯·æ±‚çš„è·¯å¾„æ‰§è¡Œé€‚å½“çš„é€»è¾‘ã€‚ç°åœ¨ç›¸å…³çš„é¢†åŸŸå°±æ˜¯`/signin`çš„æƒ…å†µã€‚å®ƒéªŒè¯ç”¨æˆ·åå¹¶å‘é€æ­£ç¡®çš„å“åº”ã€‚

ç”¨ä¸‹é¢çš„å‘½ä»¤è¿è¡Œè¿™ä¸ªæ–‡ä»¶:

```
$ dart bin/server.dart
  Server listening on port 9780 # You should see this message 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿”å›`http://localhost:8080`å¹¶é‡è¯•:

[![Successful username sign in](../Images/f070c5ed71ed77c292b7c1d294ee03bc.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--lOnibLxh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/yosso0vsncnlzpaz8t97.gif)

## [](#conclusion)ç»“è®º

æœ¬ç³»åˆ—çš„ç¬¬ 1 éƒ¨åˆ†åˆ°æ­¤ç»“æŸã€‚ä¸€å¦‚æ—¢å¾€ï¼Œæˆ‘å¸Œæœ›è¿™æ˜¯æœ‰è§åœ°çš„ï¼Œä½ ä»Šå¤©å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿ã€‚è€Œå·¥ä½œæ–¹æ¡ˆå°±æ˜¯è¿™é‡Œçš„[è¿™é‡Œçš„](https://github.com/graphicbeacon/dart-bulma-chat-app)ã€‚

ä½ èµ°ä¹‹å‰è¿˜æœ‰ä¸€ä»¶äº‹...**è®¢é˜…[æˆ‘çš„ Youtube é¢‘é“](https://www.youtube.com/channel/UCHSRZk4k6e-hqIXBBM4b2iA?view_as=subscriber)è·å– Dart** ä¸Šçš„æœ€æ–°è§†é¢‘ã€‚è°¢è°¢ï¼

**å–œæ¬¢ï¼Œ[åˆ†äº«](https://twitter.com/home?status=%22How%20to%20build%20a%20basic%20chat%20application%20in%20Dart%20(Part%201)%22%20https%3A//dev.to/graphicbeacon/build-a-basic-chat-application-in-dart-2-part-1-4ekj%20%20%23dartlang%20%23bulmacss%20%23DEVCommunity)å…³æ³¨æˆ‘**ğŸ˜æœ‰å…³ Dart çš„æ›´å¤šå†…å®¹ã€‚

## [](#continue-reading)ç»§ç»­é˜…è¯»:

[![graphicbeacon image](../Images/ebd69e31cdafde0c3cc551828feae27a.png)](/graphicbeacon) [## åœ¨ Dart 2 ä¸­æ„å»ºä¸€ä¸ªèŠå¤©åº”ç”¨ç¨‹åº(ç¬¬ 2 éƒ¨åˆ†)

### æ°æ¢…å› å¥¥å½­ 11 æœˆ 8 æ—¥ 187 åˆ†é’Ÿé˜…è¯»

#dart #http #beginners #showdev](/graphicbeacon/build-a-chat-application-in-dart-2-part-2-48df)

## [](#further-reading)è¿›ä¸€æ­¥é˜…è¯»

1.  [dart:html åº“](https://api.dartlang.org/stable/2.0.0/dart-html/dart-html-library.html)
2.  [å¦‚ä½•åœ¨æ‚¨çš„ Dart åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ JavaScript åº“](https://dev.to/graphicbeacon/how-to-use-javascript-libraries-in-your-dart-applications--4mc6)
3.  [**å…è´¹é£é•–æˆªå±åœ¨ Egghead.io**](https://egghead.io/instructors/jermaine-oppong)