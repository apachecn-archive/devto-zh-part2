# Ecto å…¥é—¨ç¬¬ 1 éƒ¨åˆ†:å®‰è£…å’Œé…ç½® Ecto

> åŸæ–‡:[https://dev . to/Edgar 971/getting-started-with-ecto-part-1-installing-and-configuring-ecto-4b 37](https://dev.to/edgar971/getting-started-with-ecto-part-1-installing-and-configuring-ecto-4b37)

æ¬¢è¿æ¥åˆ°ã€ŠEcto å…¥é—¨ã€‹çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚è¿™ç¯‡æ–‡ç« æ˜¯æ•™ä½ å¦‚ä½•ä½¿ç”¨ Ecto çš„ç³»åˆ—æ–‡ç« çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘å°†ä»‹ç»å¦‚ä½•è®¾ç½® Ectoã€åˆ›å»ºè¿ç§»å’Œæ¨¡å¼ï¼Œä»¥åŠç®€å•å’Œå¤æ‚çš„æŸ¥è¯¢ã€‚åˆ°æœ¬ç³»åˆ—ç»“æŸæ—¶ï¼Œæ‚¨å°†èƒ½å¤Ÿåœ¨æ‚¨çš„é…å‰‚åº”ç”¨ç¨‹åºä¸­è½»æ¾åœ°ä½¿ç”¨ Ecto å’Œ Postgresã€‚

## [](#what-is-ecto)ä»€ä¹ˆæ˜¯ Ectoï¼Ÿ

Ecto æ˜¯ä¸€ä¸ªç”¨äº Elixir åº”ç”¨ç¨‹åºçš„æ•°æ®åº“åŒ…ã€‚å®ƒç”¨äºç¼–å†™æ•°æ®åº“æŸ¥è¯¢å’Œä¸æ•°æ®åº“äº¤äº’ã€‚ä½¿ç”¨ Ectoï¼Œæ‚¨å¯ä»¥åˆ›å»ºè¿ç§»ã€å®šä¹‰æ¨¡å¼ã€åˆ›å»ºå’Œæ›´æ–°è®°å½•ä»¥åŠæŸ¥è¯¢æ•°æ®åº“ã€‚å½“å‰ç‰ˆæœ¬æ”¯æŒ PostgreSQL å’Œ MySQLã€‚å°†æ¥ä¼šå¢åŠ å¯¹ MSSQLã€SQLite å’Œ MongoDB çš„æ”¯æŒã€‚

## [](#installation-and-setup)å®‰è£…å’Œè®¾ç½®

è®©æˆ‘ä»¬ä»åœ¨æˆ‘ä»¬çš„ Elixir åº”ç”¨ç¨‹åºä¸­æ·»åŠ å’Œé…ç½® Ecto å¼€å§‹ã€‚å¦‚æœæ‚¨å·²ç»è¿™æ ·åšäº†ï¼Œæˆ–è€…å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Phoenixï¼Œè¯·éšæ„è·³è¿‡è¿™ä¸€æ­¥ã€‚

1.  è®©æˆ‘ä»¬å°†`ecto`å’Œ`postgrex`åŒ…æ·»åŠ åˆ°`mix.exs`æ–‡ä»¶ä¸­çš„`deps`å‡½æ•°ä¸­:

```
defp deps do
    [
      {:ecto, "~> 2.2"},
      {:postgrex, "~> 0.13.5"}
    ]
end 
```

æ³¨æ„:Postgrex ç”¨äºå¯¹æˆ‘ä»¬çš„ Postgres æ•°æ®åº“æ‰§è¡Œ Ecto æŸ¥è¯¢ã€‚

1.  è¿è¡Œ`mix deps.get`æ¥å®‰è£…æˆ‘ä»¬æ·»åŠ çš„ä¾èµ–é¡¹ã€‚

ç°åœ¨æˆ‘ä»¬å·²ç»å®‰è£…äº†è¿™äº›åŒ…ï¼Œè®©æˆ‘ä»¬æ¥é…ç½® Ectoã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œä¸‹é¢çš„[ç”Ÿæˆå™¨å‘½ä»¤](https://hexdocs.pm/ecto/Mix.Tasks.Ecto.html) :
æ¥å®ç°

```
mix ecto.gen.repo -r GettingStartedWithEcto.Repo 
```

è¿™å°†åœ¨`lib/getting_started_with_ecto/repo.ex` :
ä¸­ç”Ÿæˆæˆ‘ä»¬çš„ Repoï¼Œç”¨äºè¿æ¥å’ŒæŸ¥è¯¢æˆ‘ä»¬çš„æ•°æ®åº“

```
defmodule GettingStartedWithEcto.Repo do
  use Ecto.Repo, otp_app: :getting_started_with_ecto
end 
```

å¹¶æ›´æ–°æˆ‘ä»¬çš„é…ç½®ä»¥è¿æ¥åˆ°æ•°æ®åº“:

```
config :getting_started_with_ecto, GettingStartedWithEcto.Repo,
  adapter: Ecto.Adapters.Postgres,
  database: "getting_started_with_ecto_repo",
  username: "user",
  password: "pass",
  hostname: "localhost" 
```

ç”Ÿæˆå™¨æ²¡æœ‰åšçš„ä¸€ä»¶äº‹æ˜¯å‘Šè¯‰æˆ‘ä»¬çš„é•¿ç”Ÿä¸è€è¯åº”ç”¨ç¨‹åºå…³äºæˆ‘ä»¬çš„`GettingStartedWithEcto.Repo`ã€‚
åœ¨`config.exs`çš„æœ«å°¾å¢åŠ ä»¥ä¸‹ä¸€è¡Œ:

```
config :getting_started_with_ecto, ecto_repos: [GettingStartedWithEcto.Repo] 
```

æ³¨æ„:æ‚¨çš„ Postgres é…ç½®å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚

1.  å¦‚æœæ‚¨åœ¨è¿æ¥æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·ä»”ç»†æ£€æŸ¥æ‚¨çš„ç”¨æˆ·åã€å¯†ç å’Œä¸»æœºã€‚
2.  ä½¿ç”¨é»˜è®¤ç«¯å£`5432`ï¼Œä½†æ˜¯æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ åˆ°ä¸Šé¢çš„é…ç½®æ¥æ›´æ”¹å®ƒ:`port: 15432`

æˆ‘ä»¬éœ€è¦åšçš„æœ€åä¸€ä»¶äº‹æ˜¯å°†`GettingStartedWithEcto.Repo`è®¾ç½®ä¸º`lib/getting_started_with_ecto/application.ex` :
å†…æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„
ç›‘ç£æ ‘ä¸­çš„ç›‘ç£äºº

```
def start(_type, _args) do
    children = [
      GettingStartedWithEcto.Repo
    ]
    opts = [strategy: :one_for_one, name: GettingStartedWithEcto.Supervisor]
    Supervisor.start_link(children, opts)
end 
```

## [](#creating-the-database)åˆ›å»ºæ•°æ®åº“

å¦‚æœå®‰è£…å’Œé…ç½®æ­£ç¡®ï¼Œæœ€åä¸€æ­¥åº”è¯¥å¾ˆå®¹æ˜“ã€‚

ä»¥ä¸‹å‘½ä»¤åˆ›å»ºæˆ‘ä»¬çš„æ•°æ®åº“:

```
mix ecto.create 
```

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯:

```
The database for GettingStartedWithEcto.Repo has been created 
```

`GettingStartedWithEcto.Repo`æ˜¯å¤„ç†æ•°æ®åº“æŸ¥è¯¢çš„å­˜å‚¨åº“ã€‚

## [](#congratulations)ç¥è´ºä½ ğŸ‰ ğŸ‰ ğŸ‰

æ‚¨å·²ç»å®‰è£…å¹¶é…ç½®äº† Ectoã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨æˆ‘ä»¬çš„ Elixir åº”ç”¨ç¨‹åºä¸­åˆ›å»ºè¿ç§»å’Œæ¨¡å¼ã€‚