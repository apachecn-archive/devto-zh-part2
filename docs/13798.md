# OCaml Speedrunï¼ğŸ«ğŸª

> åŸæ–‡:[https://dev.to/swyx/ocaml-speedrun-3f7g](https://dev.to/swyx/ocaml-speedrun-3f7g)

OCaml æ˜¯ [ReasonML](https://reasonml.github.io/) çš„åŸºç¡€ï¼Œä½œä¸ºä¸€ç§é¢†å…ˆçš„ç¼–è¯‘åˆ° JS è¯­è¨€ï¼Œå®ƒå—åˆ°äº†å¾ˆå¤šå…³æ³¨ã€‚ä»Šå¤© Jane Street åœ¨çº½çº¦æä¾›äº†ä¸€ä¸ªå…è´¹çš„ OCaml ç ”è®¨ä¼šï¼Œæ‰€ä»¥æˆ‘å†³å®šå‚åŠ å¹¶åœ¨è¿™é‡Œåˆ†äº«æˆ‘çš„ç¬”è®°ã€‚Jane Street å¤šå¹´æ¥å·²ç»è½¬ç§»äº†æ•°åäº¿ç¾å…ƒæ¥è¿è¡Œ OCaml ä»£ç åº“ï¼Œå› æ­¤å®ƒä»¬æ˜¯ä¸€ä¸ªæå…¶å¯é çš„ä¸“ä¸šçŸ¥è¯†æ¥æºã€‚

å…¬å¹³çš„è­¦å‘Š:è¿™ç¯‡æ–‡ç« ä¸åƒä¸€ä¸ªæ™®é€šçš„å¼€å‘ã€‚æ¥è¯´æ˜è¿™æ˜¯ä¸€æ¬¡ç ”è®¨ä¼šçš„å¼•å¯¼å¼æ¼”ç»ƒâ€”â€”ä½ åº”è¯¥è·Ÿç€åšä»£ç ï¼Œå¦åˆ™è¿™å°†å¯¹ä½ æ¯«æ— ç”¨å¤„ã€‚ä½†æ˜¯é€šè¿‡è¿™ 24 ä¸ªä¾‹å­(**èŠ±äº†å¤§çº¦ 2-3 ä¸ªå°æ—¶**)ï¼Œæ‚¨åº”è¯¥å¯¹ OCaml ä¸­çš„å…³é”®è¯­è¨€ç‰¹æ€§æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼

å£°æ˜:æˆ‘ä»¥å‰æœ‰è¿‡ä½¿ç”¨ Haskell çš„ç»éªŒï¼Œæ‰€ä»¥æˆ‘å¯èƒ½å¯¹é™æ€ç±»å‹/å‡½æ•°è¯­è¨€æœ‰ä¸€äº›æ— æ„è¯†çš„äº†è§£ã€‚

* * *

*   [åœ¨ç³»ç»Ÿä¸Šå®‰è£… OCaml](#installing-ocaml-on-your-system)
*   [åŸºç¡€çŸ¥è¯†](#basic-knowledge)
*   [å‚è§‚è½¦é—´](#going-through-the-workshop)
*   [ä½ å¥½ä¸–ç•Œ:`/01-introduction`](#hello-world----01-introduction-)
*   [åŸºæœ¬æ•°æ®ç±»å‹:`/02-basic_types`](#basic-data-types----02-basic-types-)
*   [å®šä¹‰åŠŸèƒ½:`/03-define_functions`](#defining-functions----03-define-functions-)
*   [è°ƒç”¨åŠŸèƒ½:`/04-call_functions`](#calling-functions----04-call-functions-)
*   [å……å½“è®ºå…ƒ:`/05-twice`](#functions-as-arguments----05-twice-)
*   [æ¨¡å¼åŒ¹é…:`/06-pattern-matching`](#pattern-matching----06-pattern-matching-)
*   [é€’å½’:`/07-simple_recursion`](#recursion----07-simple-recursion-)
*   [æ•°æ®ç±»å‹:é“¾è¡¨:`/08-list_intro`](#data-type--linked-lists----08-list-intro-)
*   [å»ºç­‘åˆ—è¡¨:`/09-list_range`](#building-lists----09-list-range-)
*   [é€’å½’éå†åˆ—è¡¨:`/10-list_product`](#recursing-through-a-list----10-list-product-)
*   [æŠ½è±¡åŠŸèƒ½:`/11-sum_product`](#abstracting-functions----11-sum-product-)
*   [æµ®åŠ¨åŠŸèƒ½:`/12-list_min`](#float-functions----12-list-min-)
*   [æŠ½è±¡å’Œæµ®ç‚¹å‡½æ•°:`/13-largest_smallest`](#abstractions-and-float-functions----13-largest-smallest-)
*   [æ•°æ®ç±»å‹:å˜ä½“ç±»å‹åˆåæšä¸¾`/14-variants`](#data-type--variant-types-aka-enums---14-variants-)
*   [æ•°æ®ç±»å‹:å…ƒç»„å’Œå‚æ•°åŒ–ç±»å‹`/15-tuples`](#data-type--tuples-and-parameterized-types---15-tuples-)
*   [è´´ä¸Šæ ‡ç­¾çš„è®ºç‚¹`/16-labelled_arguments`](#labelled-arguments---16-labelled-arguments-)
*   [æ•°æ®ç±»å‹:é€‰é¡¹`/17-options`](#data-type--options---17-options-)
*   [åŒ¿åå‡½æ•°`/18-anonymous_functions`](#anonymous-functions---18-anonymous-functions-)
*   [åˆ—è¡¨æ“ä½œ`/19-list_operations`](#list-operations---19-list-operations-)
*   [ç±»å‹å®šä¹‰ï¼`/20-reading_sigs`](#type-definitions----20-reading-sigs-)
*   [æŠ˜å¿ƒ`/21-writing_list_operations`](#folding-cardio---21-writing-list-operations-)
*   [æ•°æ®ç±»å‹:ä¸å¯å˜è®°å½•`/22-records`](#data-type--immutable-records---22-records-)
*   [æ•°æ®ç±»å‹:å¯å˜è®°å½•`/23-mutable_records`](#data-type--mutable-records---23-mutable-records-)
*   [æ•°æ®ç±»å‹:å‚è€ƒæ–‡çŒ®`/24-refs`](#data-type--refs---24-refs-)
*   [éƒ½æ˜¯ä¹¡äº²ä»¬ï¼](#that-s-all-folks-)
*   [é¢å¤–çŸ¥è¯†](#extra-knowledge)

* * *

# [](#installing-ocaml-on-your-system)åœ¨ç³»ç»Ÿä¸Šå®‰è£… OCaml

è·Ÿç€è¿™ä¸ª:[https://github.com/janestreet/install-ocaml](https://github.com/janestreet/install-ocaml)ã€‚æŒ‰ç…§è¿™äº›è¯´æ˜ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚å¯¹äºæˆ‘çš„å¼€å‘ç¯å¢ƒï¼Œæˆ‘é€‰æ‹©äº† VS ä»£ç ä¸­çš„â€œreason IDEâ€æ‰©å±•ï¼Œä½†æ˜¯ vim/emacs ä¼¼ä¹ä¹Ÿå¾—åˆ°äº†å¾ˆå¥½çš„æ”¯æŒã€‚ä¸æ”¯æŒ Sublimeã€‚

# [](#basic-knowledge)åŸºç¡€çŸ¥è¯†

[opam](https://opam.ocaml.org/) æ˜¯ OCaml çš„åŒ…ç®¡ç†å™¨ã€‚å¦‚æœä½ æŒ‰ç…§ä¸Šé¢çš„è¯´æ˜ï¼Œä½ å·²ç»ä½¿ç”¨å®ƒã€‚

ä½œä¸ºä¸Šè¿°è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œä½ è¿˜éœ€è¦å®‰è£… [utop](https://github.com/diml/utop) ï¼ŒJane Street æ¨èè¿™æ˜¯ä¸€ä¸ªæ¯”é»˜è®¤è®¾ç½®æ›´å¥½çš„â€œé¡¶å±‚â€ã€‚ä¸€ä¸ªâ€œé¡¶çº§â€ä¹Ÿè¢«ç§°ä¸º [REPL](https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop) ã€‚

merlin æ˜¯ç”¨äºç¼–è¯‘/è¯­æ³•çªå‡ºæ˜¾ç¤º/ä»£ç å®Œæˆçš„å·¥å…·ã€‚

æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨â€œåŸå§‹çš„ OCamlâ€â€”â€”æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Jane Street çš„ [Base flavor](https://opensource.janestreet.com/) ï¼Œå®ƒç”¨ä¸€äº›ä»–ä»¬çš„è§‚ç‚¹è¦†ç›–äº† OCaml çš„ stdlibã€‚è¿™æ˜¯ä½ ä¼šåœ¨æ‰€æœ‰ä¹ é¢˜é›†çš„ç¬¬ä¸€è¡Œçœ‹åˆ°çš„:

```
open! Base 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¨¡å—å¯¼å…¥éƒ½æ˜¯è¿™æ ·åšçš„ã€‚ç¨åæˆ‘ä»¬ä¼šçœ‹åˆ°æ›´å¤šã€‚

# [](#going-through-the-workshop)ç©¿è¿‡è½¦é—´

`git clone https://github.com/janestreet/learn-ocaml-workshop`

å¹¶å¼€å¯`/02-exercises`ã€‚æˆ‘ä»¬è¦æŠŠè¿™äº›éƒ½è¿‡ä¸€éï¼

# [](#hello-world-raw-01introduction-endraw-)ä½ å¥½ä¸–ç•Œ:`/01-introduction`

æ­£å¦‚åœ¨`problem.ml`ä¸­æ‰€è¯´ï¼Œåªéœ€è¿è¡Œ`jbuilder runtest`å°±å¯ä»¥çœ‹åˆ°é”™è¯¯:

```
 âœ î‚° learn-ocaml-workshop/02-exercises/01-introduction> jbuilder runtest
Entering directory '/Users/swyx/ocaml/learn-ocaml-workshop'
         ppx 02-exercises/01-introduction/problem.pp.ml (exit 1)
(cd _build/default && ./.ppx/ppx_jane/ppx.exe --dump-ast --cookie 'library-name="problem_1"' -o 02-exercises/01-introduction/problem.pp.ml --impl 02-exercises/01-introduction/problem.ml)
File "02-exercises/01-introduction/problem.ml", line 25, characters 22-23:
Error: String literal not terminated 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰€ä»¥ï¼Œå¦‚æœä½ ä¿®æ”¹ç¬¬ 25 è¡Œ:`let () = Stdio.printf "Hello, World!"`åŠ ä¸Šæœ€åä¸€ä¸ªå¼•å·ï¼Œä½ ä¼šå¾—åˆ°

```
 âœ î‚° learn-ocaml-workshop/02-exercises/01-introduction> jbuilder runtest
Entering directory '/Users/swyx/ocaml/learn-ocaml-workshop'
         run alias 02-exercises/01-introduction/runtest
Hello, World! 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸–ç•Œå¿«ä¹ï¼è¯·æ³¨æ„ï¼Œå½“æ‚¨è¿è¡Œ`jbuilder`æ—¶ï¼Œä¸€ä¸ªæ–°çš„`.merlin`æ–‡ä»¶æ˜¯å¦‚ä½•æ·»åŠ çš„â€”â€”è¿™æ˜¯ç¼–è¯‘å™¨åœ¨å·¥ä½œã€‚

# [](#basic-data-types-raw-02basictypes-endraw-)åŸºæœ¬æ•°æ®ç±»å‹:`/02-basic_types`

å†æ¬¡è½¬åˆ°`problem.ml`å¹¶é˜…è¯»ã€‚æ‚¨çš„ä»»åŠ¡æ˜¯å®ç°ç¬¬ 65 è¡Œå’Œç¬¬ 68 è¡Œçš„ä¸¤ä¸ªå‡½æ•°:

```
let int_average x y = failwith "For you to implement"
(* val float_average : float -> float -> float *)
let float_average x y = failwith "For you to implement" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ‚¨å†æ¬¡è¿è¡Œ`jbuilder`ï¼Œæ‚¨å°†ä¼šçœ‹åˆ°é”™è¯¯ï¼Œå› ä¸ºè¿™äº›å‡½æ•°ç›®å‰æ˜¯ç”¨â€œfailwithâ€å®ç°çš„ã€‚æ˜¯æ—¶å€™å¼€å§‹å®æ–½äº†ï¼

è¯·æ³¨æ„ï¼Œç±»å‹ç­¾åè¢«æ³¨é‡Šæ‰äº†ã€‚è¿™ä¸ªæ–‡ä»¶å¤¹ä¹Ÿæœ‰ä¸€ä¸ª`problem.mli`æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å£°æ˜äº†ç›¸å…³æ–‡ä»¶çš„æ¥å£ï¼Œå¹¶ä¸”ç¢°å·§æœ‰æ‚¨éœ€è¦çš„ç­¾åï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æ‹…å¿ƒå®ƒã€‚

### [](#solution)è§£

`int_average`å¯ä»¥ç”¨:`let int_average x y = (x + y) / 2`æ¥è§£å†³ï¼Œå“ªä¸ªæœ‰é“ç†ã€‚ä½†æ˜¯`float_average`éœ€è¦ç‰¹å®šäºæµ®ç‚¹çš„æ“ä½œç¬¦(è¿™ä¸åŒäº Haskell ),å¦åˆ™ä½ ä¼šå¾—åˆ°è¿™ä¸ªé”™è¯¯:

```
File "02-exercises/02-basic_types/problem.ml", line 163, characters 27-29:
Error: This expression has type float but an expression was expected of type Base__Int.t = int 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨å®é™…è½¬åˆ°ç¬¬ 163 è¡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ç”Ÿæˆè¯¥é”™è¯¯çš„æµ‹è¯•ã€‚ä½ å¯ä»¥ç”¨æµ®ç‚¹æ“ä½œç¬¦æ¥è§£å†³è¿™ä¸ªé—®é¢˜(åœ¨ç¬¬ 13-15 è¡Œä¸­æåˆ°):

`let float_average x y = (x +. y) /. 2.`

# [](#defining-functions-raw-03definefunctions-endraw-)å®šä¹‰åŠŸèƒ½:`/03-define_functions`

è¿™ä¸ªå¾ˆç®€å•ã€‚æˆ‘ç¡®å®å–œæ¬¢è¿™æ ·çš„äº‹å®

> åœ¨ OCaml ä¸­ï¼Œåœ¨å­—ç¬¦ä¸²ä¹‹å¤–ï¼Œç©ºç™½å’Œæ¢è¡Œç¬¦æ˜¯ä¸€æ ·çš„ã€‚

### [](#solution)è§£

```
let plus x y   = x + y

let times x y  = x * y

let minus x y  = x - y

let divide x y = x / y 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#calling-functions-raw-04callfunctions-endraw-)è°ƒç”¨å‡½æ•°:`/04-call_functions`

ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ç›¸åŠ ç„¶åå‡åŠã€‚

### [](#solution)è§£

```
let average x y = half (add x y) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç©å¼„å¤šè¡Œè¯­æ³•å’Œéšå¼è¿”å›ï¼Œè¿™ä¹Ÿæ˜¯å¯è¡Œçš„:

```
let average x y =
  let res = add x y in
  half res 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿˜æœ‰è¿™ä¸ªä¹Ÿæ˜¯:

```
let average x y =
  let res = add
    x
    y in
  half
    res 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#functions-as-arguments-raw-05twice-endraw-)å……å½“è®ºå…ƒ:`/05-twice`

æˆ‘è§‰å¾—ï¼Œç°åœ¨ä½œä¸ºä¸€ç­‰å…¬æ°‘çš„èŒèƒ½åœ¨ä»»ä½•åœ°æ–¹éƒ½æ˜¯ä¸€ä¸ªè¢«å¹¿æ³›æ¥å—çš„æ¦‚å¿µã€‚

### [](#solution)è§£

```
let add1 x = x + 1
let square x = x * x
let twice f x = f (f x)
let add2 = twice add1
let raise_to_the_fourth = twice square 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#pattern-matching-raw-06patternmatching-endraw-)æ¨¡å¼åŒ¹é…:`/06-pattern-matching`

å¦ä¸€ä¸ªç†Ÿæ‚‰çš„æ¨¡å¼æ¥è‡ª [Haskell](https://www.haskell.org/tutorial/patterns.html) ï¼Œå¹¶åœ¨ [Javascript](https://github.com/tc39/proposal-pattern-matching) ä¸­è¢«æå‡ºã€‚ä½†æ˜¯éœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„å…³é”®å­—`match _ with`

### [](#solution)è§£

```
let non_zero x =
  match x with
  | 0 -> false
  | _ -> true 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#recursion-raw-07simplerecursion-endraw-)é€’å½’:`/07-simple_recursion`

è¯·å‚é˜…:é€’å½’ã€‚é€’å½’å‡½æ•°éœ€è¦ç”¨`let rec`å£°æ˜

### [](#solution)è§£

```
let rec add_every_number_up_to x =
  (* make sure we don't call this on negative numbers! *)
  assert (x >= 0);
  match x with
  | 0 -> 0
  | _ -> x + (add_every_number_up_to (x-1))

(* Let's write a function to multiply every number up to x. Remember: [factorial 0] is 1 *)
let rec factorial x =
  assert (x >= 0);
  match x with
  | 0 -> 1
  | 1 -> 1
  | _ -> x * (factorial (x-1)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-linked-lists-raw-08listintro-endraw-)æ•°æ®ç±»å‹:é“¾è¡¨:`/08-list_intro`

æœ¬ç»ƒä¹ å°†æ•°ç»„ä¸æ¨¡å¼åŒ¹é…å’Œé€’å½’é…å¯¹ã€‚è¿™é‡Œæ£˜æ‰‹çš„ä¸€ç‚¹æ˜¯ç«‹å³ç ´åä½ æ­£åœ¨åŒ¹é…çš„åˆ—è¡¨ï¼Œè¿™è®©æˆ‘æœ‰ç‚¹å›°æƒ‘ã€‚ä½†æ˜¯å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œæä¾›çš„ä¾‹å­æ˜¯æœ‰å¯å‘æ€§çš„ã€‚

### [](#solution)è§£

```
let rec sum lst =
  match lst with
  | [] -> 0
  | hd :: tl -> hd + (sum(tl)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#building-lists-raw-09listrange-endraw-)å»ºç­‘åˆ—è¡¨:`/09-list_range`

è¿™åˆæ˜¯ä¸€ä¸ªé€’å½’çš„å›ç­”ã€‚ä½ æƒ³è®©`range`å‡½æ•°é€’å½’ï¼Œç„¶åä¸€ç›´è°ƒç”¨å®ƒè‡ªå·±ï¼Œç›´åˆ°`from`ç­‰äº`to_`ã€‚æˆ‘æœ€åˆæ˜¯è¿™æ ·å°è¯•çš„:

```
let rec range from to_ =
  match from with
  | to_ -> []
  | _ -> (from :: (range (from + 1) to_)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºåŒ¹é…çš„*å°†*åˆ†é…ç»™`to_`è€Œä¸æ˜¯ä¸ä¹‹æ¯”è¾ƒï¼Œè¿™å¾ˆçƒ¦äººã€‚

### [](#solution)è§£

```
let rec range from to_ =
  match from = to_ with
  | true -> []
  | false -> (from :: (range (from + 1) to_)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œçš„å•ä¸ª`=`æ˜¯ä¸€ä¸ªâ€œä¸­ç¼€ç­‰å¼â€æ“ä½œç¬¦ï¼Œå®ƒå¯¹æ•´æ•°å¾ˆæœ‰æ•ˆï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨å®ƒçš„åŸå› ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œä»–ä»¬ä¸å¾—ä¸ä½¿ç”¨â€œPPX é‡å†™å™¨â€(å‚è§â€œé¢å¤–çŸ¥è¯†â€éƒ¨åˆ†)æ¥å®ç°åŒä¸€ä¸ªé—®é¢˜é›†ä¸­çš„åˆ—è¡¨æ¯”è¾ƒ`[%compare.equal: int list]`ã€‚

# [](#recursing-through-a-list-raw-10listproduct-endraw-)é€’å½’éå†åˆ—è¡¨:`/10-list_product`

è¿™ä¸ªå’Œä½ åšåˆ—è¡¨æ±‚å’Œçš„ç»ƒä¹  8 å·®ä¸å¤šã€‚

### [](#solution)è§£

```
let rec product xs =
  match xs with
  | [] -> 1
  | a :: b -> a * product(b) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#abstracting-functions-raw-11sumproduct-endraw-)æŠ½è±¡åŒ–åŠŸèƒ½:`/11-sum_product`

è¿™æ˜¯ä¸€ä¸ªç›¸å½“æ£˜æ‰‹çš„é—®é¢˜ã€‚æˆ‘ä»¬æ­£åœ¨åˆ›é€ ä¸€ä¸ªåˆ›é€ ä¸€ä¸ªåŠŸèƒ½çš„åŠŸèƒ½ï¼ŒæŠ½è±¡å‡ºé‡å¤çš„è¡Œä¸ºã€‚ä»ç¬¬ 5-36 è¡Œå¼€å§‹ï¼Œä»–ä»¬ä¼šå¸¦ä½ çœ‹ä¸€ä¸ªå¦‚ä½•åšçš„ä¾‹å­ï¼Œç„¶åä»ç¬¬ 47 è¡Œå¼€å§‹ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç›¸ä¼¼ä½†ä¸åŒçš„è¡Œä¸ºæ¨¡å¼ã€‚ç¥ä½ å¥½è¿ï¼Œå¹¶æ³¨æ„æ­£åœ¨ä½¿ç”¨çš„æ¨¡å¼ï¼

### [](#solution)è§£

```
let rec every answer combine xs =
  match xs with
  | [] -> answer
  | x :: ys -> combine x (every answer combine ys)

(* Now let's rewrite sum and product in just one line each using every *)
let simpler_sum xs     = every 0 plus xs
let simpler_product xs = every 1 times xs 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç›¸å½“æ•´æ´ï¼æ‚¨ä¹Ÿå¯ä»¥å°†ä¸­ç¼€æ“ä½œç¬¦ä½œä¸ºå‡½æ•°(`let simpler_sum xs = every 0 (+) xs`)ä¼ é€’ï¼Œä½†æ˜¯æ‚¨ä¸èƒ½å¯¹`*`æ“ä½œç¬¦è¿™æ ·åšï¼Œå› ä¸º`(*)`ä¸ OCaml ä¸­çš„æ³¨é‡Šç›¸å†²çªã€‚

# [](#float-functions-raw-12listmin-endraw-)æµ®åŠ¨åŠŸèƒ½:`/12-list_min`

æˆ‘ä»¬ç¬¬ä¸€æ¬¡é‡åˆ°`Float.max`ã€`Float.min`ã€`Float.infinity`å’Œ`Float.neg_infinity`ã€‚ç›¸å½“ç›´æ¥ã€‚

### [](#solution)è§£

```
let rec smallest xs =
  match xs with
  | [] -> Float.infinity
  | x :: ys -> Float.min x (smallest ys) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#abstractions-and-float-functions-raw-13largestsmallest-endraw-)æŠ½è±¡å’Œæµ®ç‚¹å‡½æ•°:`/13-largest_smallest`

ç»“åˆæœ€åä¸¤ä¸ªç»ƒä¹ â€”â€”å†æ¬¡æŠ½è±¡å‡½æ•°å¹¶ä½¿ç”¨æµ®åŠ¨å‡½æ•°ã€‚

### [](#solution)è§£

```
let simpler_largest  xs = every Float.neg_infinity Float.max xs
let simpler_smallest xs = every Float.infinity Float.min xs 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-variant-types-aka-enums-raw-14variants-endraw-)æ•°æ®ç±»å‹:å˜ä½“ç±»å‹åˆåæšä¸¾`/14-variants`

å˜ä½“çš„å·¥ä½œæ–¹å¼ç±»ä¼¼æšä¸¾ï¼Œåªæ˜¯å®ƒä»¬å®é™…ä¸Šå¯ä»¥æºå¸¦æ•°æ®:

```
type card_value =
  | Ace
  | King
  | Queen
  | Jack
  | Number of int

let one_card_value : card_value = Queen
let another_card_value : card_value = Number 8 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è€Œä¸”è¿™ä¸ªå¾ˆå¥½å¬:)

### [](#solution)è§£

```
let card_value_to_score card_value =
  match card_value with
  | Ace      -> 11
  | King     -> 10
  | Queen    -> 10
  | Jack     -> 10
  | Number i -> i 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¹Ÿé€‚ç”¨äºâ€œæˆ–â€åŒ¹é…

```
let card_value_to_score card_value =
  match card_value with
  | Ace      -> 11
  | King
  | Queen
  | Jack     -> 10
  | Number i -> i 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-tuples-and-parameterized-types-raw-15tuples-endraw-)æ•°æ®ç±»å‹:å…ƒç»„å’Œå‚æ•°åŒ–ç±»å‹`/15-tuples`

å…ƒç»„åœ¨å…¶ä»–è¯­è¨€ä¸­å°±æ˜¯è¿™æ ·ï¼Œä½†æ˜¯å®ƒä»¬çš„ç±»å‹å®šä¹‰çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ª

```
type int_and_string_and_char = int * string * char
let example : int_and_string_and_char = (5, "hello", 'A') 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å‡½æ•°ä¸å¿…äº‹å…ˆå®šä¹‰å®ƒä»¬çš„ç±»å‹ã€‚å®ƒä»¬å¯ä»¥è¿”å›ä¼ é€’ç»™å®ƒä»¬çš„ç›¸åŒç±»å‹çš„ä¸œè¥¿:

```
type 'a pair = 'a * 'a` 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#solution)è§£

æ‚¨å¯ä»¥åœ¨å‡½æ•°å®šä¹‰ä¸­è¿›è¡Œææ„:

```
(* this works *)
(* let add coord1 coord2 =
  let (a, b) = coord1 in
  let (c, d) = coord2 in
  (a+c, b+d) *)

(* this also works *)
let add (a, b) (c, d) = (a+c, b+d) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶ä¸”å†æ¬¡

```
(* this works *)
(* let first pair =
  let (a, _) = pair in
  a *)
(* this too *)
let first (a, _) = a
(* this *)
let second (_,b) = b 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å†…ç½®å‡½æ•°`fst`å’Œ`snd`ä¹ŸåšåŒæ ·çš„äº‹æƒ…ã€‚

# [](#labelled-arguments-raw-16labelledarguments-endraw-)è´´ä¸Šæ ‡ç­¾çš„è®ºç‚¹`/16-labelled_arguments`

æ ‡è®°è®ºç‚¹...

```
val divide : dividend:int -> divisor:int -> int
let divide ~dividend ~divisor = dividend / divisor 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¸¦æ ‡ç­¾çš„å‚æ•°å¯ä»¥ä»¥ä»»ä½•é¡ºåºä¼ å…¥ã€‚)

### [](#solution)è§£

```
let modulo ~dividend ~divisor = dividend - (divisor * divide ~dividend ~divisor) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-options-raw-17options-endraw-)æ•°æ®ç±»å‹:é€‰é¡¹`/17-options`

['a option]è¦ä¹ˆæ˜¯[None]ï¼Œæ„æ€æ˜¯ç¼ºå°‘æ•°æ®ï¼Œè¦ä¹ˆæ˜¯[Some x]ï¼Œæ„æ€æ˜¯
æ•°æ®å­˜åœ¨ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯[x]ã€‚

### [](#solution)è§£

```
let safe_divide ~dividend ~divisor =
  match divisor = 0 with
  | true -> None
  | false -> Some (dividend / divisor) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#anonymous-functions-raw-18anonymousfunctions-endraw-)åŒ¿åå‡½æ•°`/18-anonymous_functions`

lambda å‡½æ•°ï¼ç”¨`fun`å…³é”®å­—å®šä¹‰ã€‚ä¾‹å¦‚åŒé‡åŠŸèƒ½:

```
(fun i -> 2 * i) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®½åˆºçš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜æ ¹æœ¬æ²¡æœ‰æµ‹è¯•è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚

### [](#solution)è§£

```
let apply_if_nonzero f i =
  match i = 0 with
  | true -> 0
  | false -> f i 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#list-operations-raw-19listoperations-endraw-)åˆ—è¡¨æ“ä½œ`/19-list_operations`

ç°åœ¨æ­£åœ¨ä»‹ç»`List`çš„æ“ä½œ:`List.map`ã€`List.iter`ã€`List.fold_left`ã€`List.find`ã€`List.find_exn`ã€‚

### [](#solution)è§£

è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å°–é”çš„å›ç­”

```
let divide dividend divisor  = dividend / divisor
let modulo ~dividend ~divisor = dividend - (divisor * divide dividend divisor)
let mod2 x = modulo x 2
let ifEven x =
  match mod2 x with
  | 0 -> 1
  | _ -> 0
let num_even_ints ints =
  let first = List.map
    ~f:(fun x -> ifEven x)
    ints in
  sum_of_my_ints first 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯ç®€è¡—çš„æ ¸å¿ƒæ˜¾ç„¶æœ‰è¿‡æ»¤å’Œè®¡æ•°åŠŸèƒ½:

```
Core.List.count ~f:(fun x -> x mod 2 = 0) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#type-definitions-raw-20readingsigs-endraw-)ç±»å‹å®šä¹‰ï¼`/20-reading_sigs`

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰ä»»ä½•ç¼–å†™è‡ªå·±çš„ç±»å‹å®šä¹‰çš„å®è·µï¼Œæ‰€ä»¥è¿™å°†æ˜¯æ£˜æ‰‹çš„ã€‚æˆ‘ä»¬å¿…é¡»åœ¨å¤§çº¦ 80 è¡Œä¸­ç¼–å†™è‡ªå·±çš„ typedefsã€‚è¿™é‡Œæœ‰ä¸¤ä»¶äº‹éœ€è¦æ³¨æ„:

1.  æˆ‘ä»¬å¿…é¡»è¿”å›æŠ½è±¡ç±»å‹`t`ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç åˆ°`int`ï¼Œå³ä½¿æµ‹è¯•æ˜¯`int`
2.  å¸¦æ ‡ç­¾çš„å‚æ•°ä¹Ÿå¯ä»¥æ”¾å…¥ typedefï¼

åœ¨è¿™é‡Œï¼Œæ‚¨è¿˜å¯ä»¥çœ‹åˆ°æ¨¡å—å¯¼å…¥è¯­æ³•ã€‚æˆ‘ä»¬é€šè¿‡åœ¨å¼€å¤´æ·»åŠ `open! Prelude`(æ³¨æ„å¤§å†™é¦–å­—æ¯)æ¥å¯¼å…¥`prelude.ml`ã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œä¹Ÿå¼€å§‹ç”¨å…³é”®å­—`module`å®šä¹‰ä½œç”¨åŸŸæ¨¡å—ï¼Œç”¨ç±»å‹çš„`sig/end`å¯¹ï¼Œç„¶åç”¨ä»£ç çš„`struct/end`å¯¹:

```
module Example : sig
  (*  type defs *)
end = struct
  (*  code *)
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#solutions)æ–¹æ¡ˆ

```
 val create: numerator:int -> denominator:int -> t
  val value: t -> float 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#folding-cardio-raw-21writinglistoperations-endraw-)æŠ˜å æœ‰æ°§`/21-writing_list_operations`

è¿™é‡Œæœ‰ä¸€å †ç»ƒä¹ ã€‚æˆ‘ç¬¬ä¸€æ¬¡å¤±è´¥æ˜¯å› ä¸ºç›´æ¥è¿½åŠ æ–¹æ³•`a :: [b]`ä»¥é”™è¯¯çš„é¡ºåºè¿½åŠ å†…å®¹ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ä½¿ç”¨`List.append`æ¥åˆ‡æ¢é¡ºåºï¼Œå› ä¸º`[b] :: a`ä¸æ˜¯æœ‰æ•ˆçš„è¯­æ³•ã€‚(ä¹Ÿå¯ä»¥ç”¨`List.fold_right`

### [](#solutions)æ–¹æ¡ˆ

```
 let map f lst = List.fold_left
    lst
    ~init:[]
    ~f:(fun acc x ->  List.append acc [f(x)])

  let iter f lst = List.fold_left
    lst
    ~init:()
    ~f:(fun acc x -> f(x))

  let filter f lst = List.fold_left
    lst
    ~init:[]
    ~f:(fun acc x ->
      match f(x) with
      | true -> List.append acc [x]
      | _ -> acc
    ) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-immutable-records-raw-22records-endraw-)æ•°æ®ç±»å‹:ä¸å¯å˜è®°å½•`/22-records`

æ–°æ•°æ®ç±»å‹ï¼å¹¶åˆ›å»ºä¸€ä¸ªè¿”å›è®°å½•çš„å‡½æ•°ã€‚

### [](#solutions)æ–¹æ¡ˆ

```
let modify_person (person : person) =
  match person.first_name with
  | "Jan" -> {person with age = 30}
  | _ -> {person with number_of_cars = person.number_of_cars + 6} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-mutable-records-raw-23mutablerecords-endraw-)æ•°æ®ç±»å‹:å¯å˜è®°å½•`/23-mutable_records`

å¯å˜è®°å½•ç”¨
å£°æ˜

```
type color =
  | Red
  | Yellow
  | Green [@@deriving compare]

type stoplight =
  { location      : string (* stoplights don't usually move *)
  ; mutable color : color  (* but they often change color *)
  } [@@deriving compare] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶ä¿®æ”¹ä¸º:

```
let set_color stoplight color =
  stoplight.color <- color 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#solutions)æ–¹æ¡ˆ

```
let advance_color stoplight =
  match stoplight.color with
  | Red -> set_color stoplight Green
  | Yellow -> set_color stoplight Red
  | Green -> set_color stoplight Yellow 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#data-type-refs-raw-24refs-endraw-)æ•°æ®ç±»å‹:å¼•ç”¨`/24-refs`

å®ƒä»¬è¢«å£°æ˜ä¸º:

```
let x = ref 0 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶ä¿®æ”¹ä¸º:

```
let () =
  x := !x + 1 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªè§£å†³æ–¹æ¡ˆåœ¨æ²¡æœ‰ ref:
çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å·¥ä½œ

```
let take op a b =
  match op a b with
  | true -> a
  | false -> b

let min_and_max lst =
  List.fold_left
    lst
    ~init:(Int.max_value, Int.min_value)
    ~f:(fun (curmin, curmax) x ->
      (take (<) curmin x, take (>) curmax x)
    ) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#solutions)æ–¹æ¡ˆ

ä½¿ç”¨`ref`çš„ä¸€äº›æ³¨æ„äº‹é¡¹:

*   æ‚¨åº”è¯¥åœ¨å‡½æ•°ä¸­é™å®šå®ƒçš„èŒƒå›´ï¼Œå¦åˆ™å‡½æ•°ä¹‹é—´ä¼šæœ‰ä¸€ä¸ªæŒä¹…çŠ¶æ€
*   `List.iter`æ˜¯`List.map`ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œä¼šæœ‰ä¸€ä¸ªè­¦å‘Šã€‚

```
let take op a b =
  match op a b with
  | true -> a
  | false -> b

let min_and_max lst =
  let min = ref Int.max_value in
  let max = ref Int.min_value in
  List.iter
    ~f:(fun x ->
      min := take (<) !min x;
      max := take (>) !max x;
      )
    lst;
  (!min, !max) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* *æ³¨æ„:ä¹Ÿå¯ä»¥åœ¨è¯„è®ºä¸­çœ‹åˆ° Christophe çš„è§£å†³æ–¹æ¡ˆ**

# [](#thats-all-folks)é‚£éƒ½æ˜¯ä¹¡äº²ä»¬ï¼

è¿˜ä¸ç®—å¤ªç³Ÿï¼Œæ˜¯å—ï¼Ÿæ¥ä¸‹æ¥ï¼Œæ‚¨å¯ä»¥å°è¯•å¤„ç†ä»–ä»¬çš„â€œfroggyâ€ç¤ºä¾‹ï¼Œä½†æ˜¯ä½¿ç”¨`Js_of_ocaml`åº“æœ‰å¾ˆå¤šå®ç°ç‰¹å®šçš„ä¸œè¥¿ã€‚

# [](#extra-knowledge)é¢å¤–çŸ¥è¯†

PPX é‡å†™å™¨ç”¨æ–°çš„è¯­æ³•æ‰©å±•äº†åŸºæœ¬çš„ ocaml è¯­è¨€ï¼Œå®ƒå°†ç¼–è¯‘æˆåŸå§‹çš„ OCamlã€‚ä»–ä»¬æ˜¯ OCaml çš„â€œå·´åˆ«å¡”â€ã€‚ä¾‹å¦‚

```
assert([%compare.equal: int list]
        (5 : :[1;8;4])
        [5;1;8;4]) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#-raw-let-endraw-goes-with-raw-in-endraw-and-the-raw-endraw-trick)`let`ä¸`in`å¹¶é©¾é½é©±ï¼Œä¸`;;`ç»æ‹›

æ²¡æœ‰ä¸`in`æˆå¯¹å‡ºç°çš„`let`å¯ä»¥è·³åˆ°ä¸‹ä¸€è¡Œå¯èƒ½ä¸ç›¸å…³çš„ä»£ç ã€‚æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ åŒåˆ†å·æ¥æ•è·é”™è¯¯ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨çŸ¥é“æ‚¨å·²ç»å®Œæˆäº†é¡¶çº§å®šä¹‰ã€‚

```
let min_and_max lst =
  let min = ref Int.max_value in
  let max = ref Int.min_value in
  List.iter
    ~f:(fun x ->
      min := take (<) !min x;
      max := take (>) !max x;
      )
    lst;
  (!min, !max)
;; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#four-ways-to-compare-things)æ¯”è¾ƒäº‹ç‰©çš„å››ç§æ–¹å¼

è¿™äº›åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨æˆ‘ä»¬è½¦é—´è¯•è¿è¡Œä¸­è¢«æ‰“ç ´çš„ä¸œè¥¿ï¼›æ‚¨åº”è¯¥ä¸ä¼šé‡åˆ°è¿™äº›ï¼Œä½†æ˜¯è¿™äº›æ˜¯è°ƒç”¨ OCaml è¯­æ³•çš„æœ‰ç”¨å‚è€ƒ(ä¸ä»…ä»…æ˜¯ä¸ºäº†æ¯”è¾ƒ)

```
 assert ([%compare.equal: string] s "hello");
  assert (String.equal s "hello");
  assert (String.(=) s "hello");
  assert String.(s = "hello"); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>